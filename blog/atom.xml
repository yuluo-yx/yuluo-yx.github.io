<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://yuluo-yx.github.io/blog</id>
    <title>ç‰§ç”Ÿ</title>
    <updated>2025-06-27T23:34:54.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://yuluo-yx.github.io/blog"/>
    <subtitle>feedId:41215011978385457+userId:41840354283324416</subtitle>
    <icon>https://yuluo-yx.github.io/img/favicon.ico</icon>
    <rights>Copyright Â© 2025 ç‰§ç”Ÿ Built with Docusaurus.&lt;p&gt;Everything Wins ğŸ‰&lt;/p&gt;.</rights>
    <entry>
        <title type="html"><![CDATA[Google ADK Java QuickStart]]></title>
        <id>https://yuluo-yx.github.io/blog/google-adk-java-quickstart</id>
        <link href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart"/>
        <updated>2025-06-27T23:34:54.000Z</updated>
        <summary type="html"><![CDATA[1. ADK ä»‹ç»]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-adk-ä»‹ç»">1. ADK ä»‹ç»<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#1-adk-%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="1. ADK ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="1. ADK ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Agent Development Kit (ADK) æ˜¯ä¸€ä¸ªçµæ´»çš„æ¨¡å—åŒ–æ¡†æ¶ï¼Œç”¨äºå¼€å‘å’Œéƒ¨ç½² AI Agentã€‚ADK å¯¹ Gemini å’Œ Google ç”Ÿæ€ç³»ç»Ÿè¿›è¡Œäº†ä¼˜åŒ–ã€‚åŒæ—¶ä¸æ¨¡å‹å’Œéƒ¨ç½²æ— å…³ï¼Œå¹¶ä¸”ä¸å…¶ä»–æ¡†æ¶å…¼å®¹ã€‚ADK æ—¨åœ¨ä½¿ Agent å¼€å‘æ›´åƒè½¯ä»¶å¼€å‘é‚£æ ·ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ›´è½»æ¾åœ°åˆ›å»ºã€éƒ¨ç½²å’Œç¼–æ’ä»ç®€å•ä»»åŠ¡åˆ°å¤æ‚å·¥ä½œæµçš„ Agent åº”ç”¨ã€‚</p>
<p>ä¸»è¦ç‰¹ç‚¹</p>
<ul>
<li><strong>ä¸°å¯Œçš„å·¥å…·ç”Ÿæ€ç³»ç»Ÿ</strong>ï¼šåˆ©ç”¨é¢„å…ˆæ„å»ºçš„å·¥å…·ã€è‡ªå®šä¹‰åŠŸèƒ½ã€OpenAPI è§„èŒƒæˆ–é›†æˆç°æœ‰å·¥å…·ï¼Œä¸ºä»£ç†æä¾›å¤šæ ·åŒ–çš„åŠŸèƒ½ï¼Œæ‰€æœ‰è¿™äº›éƒ½æ˜¯ä¸ºäº†ä¸ Google ç”Ÿæ€ç³»ç»Ÿç´§å¯†é›†æˆã€‚</li>
<li><strong>ä»£ç ä¼˜å…ˆå¼€å‘</strong>ï¼šç›´æ¥åœ¨ Python ä¸­å®šä¹‰ä»£ç†é€»è¾‘ã€å·¥å…·å’Œç¼–æ’ï¼Œä»¥å®ç°æœ€å¤§çš„çµæ´»æ€§ã€å¯æµ‹è¯•æ€§å’Œç‰ˆæœ¬æ§åˆ¶ã€‚</li>
<li><strong>æ¨¡å—åŒ–å¤šä»£ç†ç³»ç»Ÿ</strong>ï¼šé€šè¿‡å°†å¤šä¸ªä¸“é—¨çš„ä»£ç†ç»„åˆæˆçµæ´»çš„å±‚æ¬¡ç»“æ„æ¥è®¾è®¡å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºã€‚</li>
<li><strong>éšå¤„éƒ¨ç½²</strong>ï¼šè½»æ¾åœ¨ Cloud Run ä¸Šå®¹å™¨åŒ–å’Œéƒ¨ç½²ä»£ç†ï¼Œæˆ–ä½¿ç”¨ Vertex AI Agent Engine æ— ç¼æ‰©å±•ã€‚</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-adk-java">2. ADK Java<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#2-adk-java" class="hash-link" aria-label="2. ADK Javaçš„ç›´æ¥é“¾æ¥" title="2. ADK Javaçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>è€Œ ADK Java åˆ™æ˜¯ ADK Python çš„ Java å®ç°ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-adk-java-examples">3. ADK Java Examples<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#3-adk-java-examples" class="hash-link" aria-label="3. ADK Java Examplesçš„ç›´æ¥é“¾æ¥" title="3. ADK Java Examplesçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ç¼–å†™ç¤ºä¾‹ä¹‹å‰éœ€è¦è·å–åˆ° Google Genmini æ¨¡å‹çš„ ak å¹¶é…ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">GOOGLE_GENAI_USE_VERTEXAI</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">FALSE</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">GOOGLE_API_KEY</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">AK</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="31-ä»£ç ">3.1 ä»£ç <a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#31-%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="3.1 ä»£ç çš„ç›´æ¥é“¾æ¥" title="3.1 ä»£ç çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ­¤ç¤ºä¾‹ä½¿ç”¨ ADK Java æ–‡æ¡£ä¸­çš„ä»£ç ï¼š<a href="https://google.github.io/adk-docs/get-started/quickstart/#create-agent-project" target="_blank" rel="noopener noreferrer">https://google.github.io/adk-docs/get-started/quickstart/#create-agent-project</a></p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> </span><span class="token namespace">indi</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">yuluo</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">java</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">agent</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">multitool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">agents</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">BaseAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">agents</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">LlmAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">events</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">runner</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">InMemoryRunner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">sessions</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Session</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">tools</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Annotations</span><span class="token import punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Schema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">tools</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">FunctionTool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">genai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">types</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">genai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">types</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">io</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">reactivex</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">rxjava3</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">core</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Flowable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">nio</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">charset</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">StandardCharsets</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">text</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Normalizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">time</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">ZoneId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">time</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">ZonedDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">time</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">format</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">DateTimeFormatter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Scanner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author yuluo</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author &lt;a href="mailto:yuluo08290126@gmail.com"&gt;yuluo&lt;/a&gt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MultiToolAgent</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">USER_ID</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"student"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">NAME</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"multi_tool_agent"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// The run your agent with Dev UI, the ROOT_AGENT should be a global public static variable.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaseAgent</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">ROOT_AGENT</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">initAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaseAgent</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">initAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LlmAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">NAME</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"gemini-2.0-flash"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">description</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Agent to answer questions about the time and weather in a city."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">instruction</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"You are a helpful agent who can answer user questions about the time and weather"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">" in a city."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FunctionTool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MultiToolAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"getCurrentTime"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FunctionTool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MultiToolAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"getWeather"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getCurrentTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Schema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">description </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"The name of the city for which to retrieve the current time"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> city</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> normalizedCity </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Normalizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">normalize</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">city</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Normalizer</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Form</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">NFD</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">trim</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toLowerCase</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">replaceAll</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"(\\p{IsM}+|\\p{IsP}+)"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">replaceAll</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\\s+"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"_"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ZoneId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getAvailableZoneIds</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">zid </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> zid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toLowerCase</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">endsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> normalizedCity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">findFirst</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        zid </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"status"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"success"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"The current time in "</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> city</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">" is "</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ZonedDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ZoneId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">zid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">format</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DateTimeFormatter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">ofPattern</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"HH:mm"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">orElse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"status"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"error"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"Sorry, I don't have timezone information for "</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> city </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getWeather</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Schema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">description </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"The name of the city for which to retrieve the weather report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> city</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">city</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toLowerCase</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"new york"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"status"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"success"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"The weather in New York is sunny with a temperature of 25 degrees Celsius (77 degrees"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                            </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">" Fahrenheit)."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"status"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"error"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"Weather information for "</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> city </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">" is not available."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">InMemoryRunner</span><span class="token plain"> runner </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">InMemoryRunner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">ROOT_AGENT</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Session</span><span class="token plain"> session </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                runner</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">sessionService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">createSession</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">NAME</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">USER_ID</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">blockingGet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Scanner</span><span class="token plain"> scanner </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Scanner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">in</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StandardCharsets</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">UTF_8</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">print</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\nYou &gt; "</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> userInput </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> scanner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nextLine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"quit"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equalsIgnoreCase</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">userInput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Content</span><span class="token plain"> userMsg </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">fromParts</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">fromText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">userInput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flowable</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Event</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> events </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> runner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">runAsync</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">USER_ID</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> session</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> userMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">print</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\nAgent &gt; "</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                events</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">blockingForEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stringifyContent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="32-è¿è¡Œ">3.2 è¿è¡Œ<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#32-%E8%BF%90%E8%A1%8C" class="hash-link" aria-label="3.2 è¿è¡Œçš„ç›´æ¥é“¾æ¥" title="3.2 è¿è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ol>
<li><strong>AdkWebServer</strong> ä¸èƒ½æ›´æ”¹ã€‚</li>
<li>è¿è¡Œæ­¤å‘½ä»¤éœ€è¦è·³è½¬åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼ˆæ—¢ pom.xml æ‰€åœ¨çš„ç›®å½•æ‰§è¡Œï¼‰</li>
</ol>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">mvn exec:java </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-Dexec.mainClass</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">"com.google.adk.web.AdkWebServer"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-Dexec.args</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">"--adk.agents.source-dir=src/main/java"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-Dexec.classpathScope</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">"compile"</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="33-è®¿é—®">3.3 è®¿é—®<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#33-%E8%AE%BF%E9%97%AE" class="hash-link" aria-label="3.3 è®¿é—®çš„ç›´æ¥é“¾æ¥" title="3.3 è®¿é—®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æµè§ˆå™¨æ‰“å¼€ localhost:8080 è®¿é—®å‰ç«¯é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ° Dev UIï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250626233522684" src="https://yuluo-yx.github.io/assets/images/image-20250626233522684-9a5f2073e17b5ac3d7e7d1e5ade84e08.png" width="1895" height="860" class="img_c29J"></p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="AI" term="AI"/>
        <category label="ADK" term="ADK"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Gemini CLI QuickStart]]></title>
        <id>https://yuluo-yx.github.io/blog/gemini-cli-quickstart</id>
        <link href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart"/>
        <updated>2025-06-27T23:34:00.000Z</updated>
        <summary type="html"><![CDATA[Github ä»“åº“ï¼šhttps://github.com/google-gemini/gemini-cli]]></summary>
        <content type="html"><![CDATA[<p>Github ä»“åº“ï¼š<a href="https://github.com/google-gemini/gemini-cli" target="_blank" rel="noopener noreferrer">https://github.com/google-gemini/gemini-cli</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ä»‹ç»">ä»‹ç»<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Gemini CLI æ˜¯ä¸€ä¸ªç”¨äºä¸ Google Gemini å¤§å‹è¯­è¨€æ¨¡å‹äº¤äº’çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ï¼ˆæ®ç›¸å…³æ¶ˆæ¯ï¼Œé€†å‘äº† Claude Codeï¼‰</p>
<p>ä¸ºå¼€å‘è€…ã€ç ”ç©¶å‘˜ä»¥åŠä»»ä½•éœ€è¦é€šè¿‡å‘½ä»¤è¡Œä¸ Gemini æ¨¡å‹äº¤äº’çš„ç”¨æˆ·æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„åŠŸèƒ½ã€‚</p>
<p>Gemini æ˜¯ Google DeepMind å¼€å‘çš„ä¸€ç³»åˆ—å¤šæ¨¡æ€äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œå…·å¤‡è¯­è¨€ã€éŸ³é¢‘ã€ä»£ç å’Œè§†é¢‘ç†è§£èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¤„ç†å¤šç§ä»»åŠ¡ï¼ŒåŒ…æ‹¬æ–‡æœ¬ç”Ÿæˆã€å¤šæ¨¡æ€å¯¹è¯ã€ä»£ç ç”Ÿæˆç­‰ã€‚</p>
<p>åœ¨ 6 æœˆ 25 æ—¥ï¼Œè°·æ­Œæ­£å¼æ¨å‡ºäº†<strong>Gemini CLI</strong> ï¼Œå°† Gemini å¤§æ¨¡å‹çš„å¼ºå¤§èƒ½åŠ›ç›´æ¥èå…¥åˆ°å¼€å‘è€…æ—¥å¸¸å‘½ä»¤è¡Œç•Œé¢ä¸­ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="star-èµ°åŠ¿">Star èµ°åŠ¿<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#star-%E8%B5%B0%E5%8A%BF" class="hash-link" aria-label="Star èµ°åŠ¿çš„ç›´æ¥é“¾æ¥" title="Star èµ°åŠ¿çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>ä¸å¾—ä¸æ Github star èµ°åŠ¿ã€‚åœ¨ 26 å·ï¼ŒGemini CLI é¡¹ç›® star çˆ†å‘å¼å¢é•¿ï¼Œæˆªæ­¢ 6 æœˆ 26 æ—¥ æ™šï¼Œå·²ç»åˆ°äº† 26k starã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20250626235009715" src="https://yuluo-yx.github.io/assets/images/image-20250626235009715-f9e804854278604cd6ef2d9f5c4ec3da.png" width="1131" height="744" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å®‰è£…">å®‰è£…<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E5%AE%89%E8%A3%85" class="hash-link" aria-label="å®‰è£…çš„ç›´æ¥é“¾æ¥" title="å®‰è£…çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># å®‰è£…</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">npm</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-g</span><span class="token plain"> @google/gemini-cli </span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é…ç½®">é…ç½®<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="é…ç½®çš„ç›´æ¥é“¾æ¥" title="é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åŒæ—¶ï¼ŒGemini CLI å¯ä»¥ä½¿ç”¨ Google è´¦å·ç™»é™†ï¼Œå…è®¸æ¯åˆ†é’Ÿæœ€å¤š 60 ä¸ªæ¨¡å‹è¯·æ±‚ï¼Œæ¯å¤©æœ€å¤š 1000 ä¸ªæ¨¡å‹è¯·æ±‚ã€‚</p>
<blockquote>
<p>åœ¨æ­¤ä¹‹å‰ï¼Œéœ€è¦æœ‰ Gemini çš„ AKã€‚å¦‚æœä½“éªŒé«˜çº§åŠŸèƒ½æˆ–è€…ç‰¹å®šæ¨¡å‹éœ€è¦æ­¤é…ç½®ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¯åŠ¨">å¯åŠ¨<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E5%90%AF%E5%8A%A8" class="hash-link" aria-label="å¯åŠ¨çš„ç›´æ¥é“¾æ¥" title="å¯åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>
<p>åœ¨ terminal ä¸­è¾“å…¥ <code>gemini</code> å¯åŠ¨ cliï¼›</p>
</li>
<li>
<p>é€‰æ‹©ä¸»é¢˜ï¼š<strong>ï¼ˆé€šè¿‡ tab + æ–¹å‘ä¸Šä¸‹é”®é€‰æ‹©ï¼‰</strong></p>
<p>åœ¨è¾“å…¥ gemini ä¹‹åï¼Œå°†ä¼šçœ‹åˆ°å¦‚ä¸‹é¡µé¢</p>
<p><img decoding="async" loading="lazy" alt="image-20250626235840772" src="https://yuluo-yx.github.io/assets/images/image-20250626235840772-2d52b6bb4ac8f6e7136388b9300af4b9.png" width="2334" height="838" class="img_c29J"></p>
<p>é—æ†¾çš„æ˜¯ï¼Œä¸ªåˆ«ä¸»é¢˜å¯¹ windows ç»ˆç«¯é€‚é…æœ‰ bugï¼šåƒä¸‹é¢è¿™æ ·ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250626235953023" src="https://yuluo-yx.github.io/assets/images/image-20250626235953023-5a29c62957544b1251c58286b6f698ed.png" width="623" height="475" class="img_c29J"></p>
<p>è¿™é‡Œä¹Ÿæ˜¯é€‰äº†æœ€ç«çš„ Atom One ä¸»é¢˜ã€‚</p>
</li>
<li>
<p>èº«ä»½éªŒè¯ï¼Œå‡ºç°æ—¶ä½¿ç”¨ google è´¦å·ç™»å½•å³å¯ã€‚</p>
</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ä½¿ç”¨ä½“éªŒ">ä½¿ç”¨ä½“éªŒ<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C" class="hash-link" aria-label="ä½¿ç”¨ä½“éªŒçš„ç›´æ¥é“¾æ¥" title="ä½¿ç”¨ä½“éªŒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå°†ä¼šçœ‹åˆ°å¦‚ä¸‹çš„ç»ˆç«¯è¾“å…¥æ¡†ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250627000142982" src="https://yuluo-yx.github.io/assets/images/image-20250627000142982-23efcbf11c89e24900d5292912cd84b3.png" width="2451" height="617" class="img_c29J"></p>
<p>æœ‰è¶£çš„æ˜¯ï¼Œåœ¨ç­‰å¾…è¿‡ç¨‹ä¸­ï¼Œgemini cli ä¼šè¾“å‡ºä¸€äº›å˜æ¢çš„ messageï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250627000907701" src="https://yuluo-yx.github.io/assets/images/image-20250627000907701-3341581bb4ad15af72b5966b3dca078f.png" width="975" height="187" class="img_c29J"></p>
<p>gemini cli è¿˜æ”¯æŒå…¶ä»–åŠŸèƒ½ï¼šç”Ÿæˆä¸€ä¸ªé¡¹ç›®ï¼Œè§£ææœ¬åœ°æ–‡ä»¶æ•°æ®ï¼Œè”ç½‘æœç´¢ç­‰ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é—®é¢˜æ’æŸ¥">é—®é¢˜æ’æŸ¥<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5" class="hash-link" aria-label="é—®é¢˜æ’æŸ¥çš„ç›´æ¥é“¾æ¥" title="é—®é¢˜æ’æŸ¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¦‚æœè®¿é—®å¤±è´¥ï¼Œé‚£ä¹ˆå°±ç”¨é­”æ³•ï¼š</p>
<p>Windows Powershellï¼š<code>$env:https_proxy="http://127.0.0.1:7890"</code></p>
<p>Mac/Linux: <code>$env:https_proxy="http://127.0.0.1:7890</code></p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="AI" term="AI"/>
        <category label="Genmini CLI" term="Genmini CLI"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[spring ai alibaba graph quickstart]]></title>
        <id>https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart</id>
        <link href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart"/>
        <updated>2025-06-14T23:40:21.000Z</updated>
        <summary type="html"><![CDATA[æœ¬æ–‡ä¸­å°†é˜è¿°ä¸‹ AI æµç¨‹ç¼–æ’æ¡†æ¶å’Œ Spring AI Alibaba Graph ä»¥åŠå¦‚ä½•ä½¿ç”¨ã€‚]]></summary>
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸­å°†é˜è¿°ä¸‹ AI æµç¨‹ç¼–æ’æ¡†æ¶å’Œ Spring AI Alibaba Graph ä»¥åŠå¦‚ä½•ä½¿ç”¨ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-agent-æ™ºèƒ½ä½“">1. Agent æ™ºèƒ½ä½“<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#1-agent-%E6%99%BA%E8%83%BD%E4%BD%93" class="hash-link" aria-label="1. Agent æ™ºèƒ½ä½“çš„ç›´æ¥é“¾æ¥" title="1. Agent æ™ºèƒ½ä½“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ç»“åˆ Google å’Œ Authropic å¯¹ Agent çš„å®šä¹‰ï¼šAgent çš„å®šä¹‰ä¸ºï¼šæ™ºèƒ½ä½“ï¼ˆAgentï¼‰æ˜¯èƒ½å¤Ÿç‹¬ç«‹è¿è¡Œï¼Œæ„ŸçŸ¥å’Œç†è§£ç°å®ä¸–ç•Œå¹¶ä½¿ç”¨å·¥å…·æ¥å®ç°æœ€ç»ˆç›®æ ‡çš„åº”ç”¨ç¨‹åºã€‚</p>
<p>ä»æ¶æ„ä¸Šï¼Œå¯ä»¥å°† Agent åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ol>
<li>Workflows ç³»ç»Ÿï¼šäººç±»å¹²é¢„åšæ•´ä½“å†³ç­–ï¼ŒLLMs ä½œä¸º workflows é“¾è·¯çš„èŠ‚ç‚¹ã€‚<!-- -->
<ol>
<li>å…·æœ‰æ˜ç¡®è¯­ä¹‰çš„ç³»ç»Ÿï¼Œé¢„å…ˆå®šä¹‰å¥½ workflows æµç¨‹ï¼›</li>
<li>LLMs é€šè¿‡å„ä¸ª Node èŠ‚ç‚¹å¯¹ Workflows è·¯å¾„ç¼–æ’æ¥è¾¾åˆ°æœ€ç»ˆæ•ˆæœã€‚</li>
</ol>
</li>
<li>æ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆAgentsï¼‰ï¼šLLMs ä½œä¸ºå¤§è„‘å†³ç­–ï¼Œè‡ªé©±åŠ¨å®Œæˆä»»åŠ¡ã€‚<!-- -->
<ol>
<li>LLMs è‡ªå·±ç¼–æ’å’Œè§„åˆ’å·¥å…·è°ƒç”¨ï¼›</li>
<li>é€‚ç”¨äºæ¨¡å‹é©±åŠ¨å†³ç­–çš„åœºæ™¯ã€‚</li>
</ol>
</li>
</ol>
<p><strong>ä»¥ä¸Šä¸¤ç§æ¶æ„éƒ½åœ¨ Spring AI Alibaba é¡¹ç›®ä¸­æœ‰ä½“ç°ï¼šä¸€æ˜¯ JManus ç³»ç»Ÿã€‚äºŒæ˜¯åŸºäº spring ai alibaba graph æ„å»ºçš„ DeepResearch ç³»ç»Ÿã€‚</strong></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-ai-æ™ºèƒ½ä½“æ¡†æ¶ä»‹ç»">1. AI æ™ºèƒ½ä½“æ¡†æ¶ä»‹ç»<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#1-ai-%E6%99%BA%E8%83%BD%E4%BD%93%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="1. AI æ™ºèƒ½ä½“æ¡†æ¶ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="1. AI æ™ºèƒ½ä½“æ¡†æ¶ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨è¿‡å»ä¸€å¹´ä¸­ï¼ŒAI Infra å¿«é€Ÿå‘å±•ï¼Œæ¶Œç°äº†ä¸€ç³»åˆ—ä»¥ LangChain ä¸ºä»£ç çš„ AI åº”ç”¨å¼€å‘æ¡†æ¶ï¼Œåˆ°æœ€åŸºç¡€çš„åº”ç”¨å¼€å‘æ¡†æ¶åˆ°æ™ºèƒ½ä½“ç¼–æ’ï¼ŒAI åº”ç”¨è§‚æµ‹ç­‰ã€‚æ­¤ç« èŠ‚ä¸­ä¸»è¦ä»‹ç»ä¸‹ AI åº”ç”¨çš„æ™ºèƒ½ä½“ç¼–æ’æ¡†æ¶ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="11-microsoft-autogen">1.1 Microsoft AutoGen<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#11-microsoft-autogen" class="hash-link" aria-label="1.1 Microsoft AutoGençš„ç›´æ¥é“¾æ¥" title="1.1 Microsoft AutoGençš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Github  åœ°å€ï¼š<a href="https://github.com/microsoft/autogen" target="_blank" rel="noopener noreferrer">https://github.com/microsoft/autogen</a></p>
<p>ç”±å¾®è½¯å¼€æºçš„æ™ºèƒ½ä½“å¼€å‘æ¡†æ¶ï¼š<strong>AutoGen</strong> æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºå¯è‡ªä¸»è¡ŒåŠ¨æˆ–ä¸äººç±»ååŒå·¥ä½œçš„å¤šæ™ºèƒ½ä½“ AI åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="12-langgraph">1.2 LangGraph<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#12-langgraph" class="hash-link" aria-label="1.2 LangGraphçš„ç›´æ¥é“¾æ¥" title="1.2 LangGraphçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Github åœ°å€ï¼š<a href="https://github.com/langchain-ai/langgraph" target="_blank" rel="noopener noreferrer">https://github.com/langchain-ai/langgraph</a></p>
<p>ä»¥ LangGraph ä¸ºåŸºç¡€ï¼Œä½¿ç”¨å›¾ç»“æ„çš„ AI åº”ç”¨ç¼–æ’æ¡†æ¶ã€‚ç”± LangChain ç¤¾åŒºå¼€å‘ï¼Œç¤¾åŒºæ´»è·ƒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="13-crewai">1.3 CrewAI<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#13-crewai" class="hash-link" aria-label="1.3 CrewAIçš„ç›´æ¥é“¾æ¥" title="1.3 CrewAIçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Github åœ°å€ï¼š<a href="https://github.com/crewAIInc/crewAI" target="_blank" rel="noopener noreferrer">https://github.com/crewAIInc/crewAI</a></p>
<p>CrewAI æ˜¯ä¸€ä¸ªç²¾ç®€ã€å¿«é€Ÿçš„ Python æ¡†æ¶ï¼Œå®Œå…¨ä»é›¶æ„å»ºï¼Œå®Œå…¨<strong>ç‹¬ç«‹äº LangChain æˆ–å…¶ä»–ä»£ç†æ¡†æ¶</strong>ã€‚å®ƒä¸ºå¼€å‘äººå‘˜æä¾›äº†é«˜çº§çš„ç®€æ´æ€§å’Œç²¾ç¡®çš„åº•å±‚æ§åˆ¶ï¼Œéå¸¸é€‚åˆåˆ›å»ºé€‚åˆä»»ä½•åœºæ™¯çš„è‡ªä¸» AI ä»£ç†ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-spring-ai-alibaba-graph">2. Spring AI Alibaba Graph<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#2-spring-ai-alibaba-graph" class="hash-link" aria-label="2. Spring AI Alibaba Graphçš„ç›´æ¥é“¾æ¥" title="2. Spring AI Alibaba Graphçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Github åœ°å€ï¼š<a href="https://github.com/alibaba/spring-ai-alibaba/tree/main/spring-ai-alibaba-graph" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/spring-ai-alibaba/tree/main/spring-ai-alibaba-graph</a></p>
<blockquote>
<p>Spring AI Alibaba Graph æ˜¯ä¸€æ¬¾é¢å‘ Java å¼€å‘è€…çš„<strong>å·¥ä½œæµã€å¤šæ™ºèƒ½ä½“æ¡†æ¶</strong>ï¼Œç”¨äºæ„å»ºç”±å¤šä¸ª AI æ¨¡å‹æˆ–æ­¥éª¤ç»„æˆçš„å¤æ‚åº”ç”¨ã€‚é€šè¿‡å›¾ç»“æ„çš„å®šä¹‰ï¼Œæ¥æè¿°æ™ºèƒ½ä½“ä¸­çš„çŠ¶æ€æµè½¬é€»è¾‘ã€‚</p>
<p>æ¡†æ¶æ ¸å¿ƒåŒ…æ‹¬ï¼š<strong>StateGraph</strong>ï¼ˆçŠ¶æ€å›¾ï¼Œç”¨äºå®šä¹‰èŠ‚ç‚¹å’Œè¾¹ï¼‰ã€<strong>Node</strong>ï¼ˆèŠ‚ç‚¹ï¼Œå°è£…å…·ä½“æ“ä½œæˆ–æ¨¡å‹è°ƒç”¨ï¼‰ã€<strong>Edge</strong>ï¼ˆè¾¹ï¼Œè¡¨ç¤ºèŠ‚ç‚¹é—´çš„è·³è½¬å…³ç³»ï¼‰ä»¥åŠ <strong>OverAllState</strong>ï¼ˆå…¨å±€çŠ¶æ€ï¼Œè´¯ç©¿æµç¨‹å…±äº«æ•°æ®ï¼‰</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-å¿«é€Ÿå…¥é—¨">2.1 å¿«é€Ÿå…¥é—¨<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#21-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8" class="hash-link" aria-label="2.1 å¿«é€Ÿå…¥é—¨çš„ç›´æ¥é“¾æ¥" title="2.1 å¿«é€Ÿå…¥é—¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Demo åœ°å€ï¼š<a href="https://github.com/deigmata-paideias/deigmata-paideias/tree/main/ai/exmaple/spring-ai-alibaba-graph-demo" target="_blank" rel="noopener noreferrer">https://github.com/deigmata-paideias/deigmata-paideias/tree/main/ai/exmaple/spring-ai-alibaba-graph-demo</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="pomxml">pom.xml<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#pomxml" class="hash-link" aria-label="pom.xmlçš„ç›´æ¥é“¾æ¥" title="pom.xmlçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-dashscope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-graph-core</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.0.0.2</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.google.code.gson</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">gson</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencyManagement</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">3.4.5</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-bom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.0.0.2</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencyManagement</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="applicationyml">application.yml<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#applicationyml" class="hash-link" aria-label="application.ymlçš„ç›´æ¥é“¾æ¥" title="application.ymlçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">server</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">port</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">8081</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">dashscope</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">api-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">AI_DASHSCOPE_API_KEY</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="config">Config<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#config" class="hash-link" aria-label="Configçš„ç›´æ¥é“¾æ¥" title="Configçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">GraphRepresentation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">OverAllStateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">action</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">EdgeAction</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">exception</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">GraphStateException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">node</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">state</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">strategy</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">ReplaceStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">indi</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">yuluo</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">customnode</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">RecordingNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">slf4j</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">slf4j</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">chat</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">client</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">chat</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">client</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">advisor</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">context</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Bean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">context</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Configuration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token import static namespace">com</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">alibaba</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">cloud</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">ai</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">graph</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token import static punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static">END</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token import static namespace">com</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">alibaba</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">cloud</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">ai</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">graph</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token import static punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static">START</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token import static namespace">com</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">alibaba</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">cloud</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">ai</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">graph</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">action</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static class-name" style="color:hsl(35, 99%, 36%)">AsyncEdgeAction</span><span class="token import static punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static">edge_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token import static namespace">com</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">alibaba</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">cloud</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">ai</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">graph</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">action</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static class-name" style="color:hsl(35, 99%, 36%)">AsyncNodeAction</span><span class="token import static punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static">node_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * Graph Demoï¼šé¦–å…ˆåˆ¤æ–­è¯„ä»·æ­£è´Ÿï¼Œå…¶æ¬¡ç»†åˆ†è´Ÿé¢é—®é¢˜ï¼Œæœ€åè¾“å‡ºå¤„ç†æ–¹æ¡ˆã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author yuluo</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author &lt;a href="mailto:yuluo08290126@gmail.com"&gt;yuluo&lt;/a&gt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphAutoConfiguration</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphAutoConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å®šä¹‰ä¸€ä¸ªå·¥ä½œæµ StateGraph Bean.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">workflowGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token plain"> builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphStateException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// LLMs Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å®šä¹‰ä¸€ä¸ª OverAllStateFactoryï¼Œç”¨äºåœ¨æ¯æ¬¡æ‰§è¡Œå·¥ä½œæµæ—¶åˆ›å»ºåˆå§‹çš„å…¨å±€çŠ¶æ€å¯¹è±¡ã€‚é€šè¿‡æ³¨å†Œè‹¥å¹² Key åŠå…¶æ›´æ–°ç­–ç•¥æ¥ç®¡ç†ä¸Šä¸‹æ–‡æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ³¨å†Œä¸‰ä¸ªçŠ¶æ€ key åˆ†åˆ«ä¸º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 1. inputï¼šç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 2. classifier_outputï¼šåˆ†ç±»å™¨çš„è¾“å‡ºç»“æœ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 3. solutionï¼šæœ€ç»ˆè¾“å‡ºç»“è®º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä½¿ç”¨ ReplaceStrategyï¼ˆæ¯æ¬¡å†™å…¥æ›¿æ¢æ—§å€¼ï¼‰ç­–ç•¥å¤„ç†ä¸Šä¸‹æ–‡çŠ¶æ€å¯¹è±¡ä¸­çš„æ•°æ®ï¼Œç”¨äºåœ¨èŠ‚ç‚¹ä¸­ä¼ é€’æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllStateFactory</span><span class="token plain"> stateFactory </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token plain"> state </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">registerKeyAndStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"input"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ReplaceStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">registerKeyAndStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifier_output"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ReplaceStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">registerKeyAndStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"solution"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ReplaceStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åˆ›å»º workflows èŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä½¿ç”¨ Graph æ¡†æ¶é¢„å®šä¹‰çš„ QuestionClassifierNode æ¥å¤„ç†æ–‡æœ¬åˆ†ç±»ä»»åŠ¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¯„ä»·æ­£è´Ÿåˆ†ç±»èŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token plain"> feedbackClassifier </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputTextKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"input"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">categories</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive feedback"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"negative feedback"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">classificationInstructions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Try to understand the user's feeling when he/she is giving the feedback."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è´Ÿé¢è¯„ä»·å…·ä½“é—®é¢˜åˆ†ç±»èŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token plain"> specificQuestionClassifier </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputTextKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"input"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">categories</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"after-sale service"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"transportation"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"product quality"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"others"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">classificationInstructions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"What kind of service or help the customer is trying to get from us? Classify the question based on your understanding."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¼–æ’ Node èŠ‚ç‚¹ï¼Œä½¿ç”¨ StateGraph çš„ APIï¼Œå°†ä¸Šè¿°èŠ‚ç‚¹åŠ å…¥å›¾ä¸­ï¼Œå¹¶è®¾ç½®èŠ‚ç‚¹é—´çš„è·³è½¬å…³ç³»</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// é¦–å…ˆå°†èŠ‚ç‚¹æ³¨å†Œåˆ°å›¾ï¼Œå¹¶ä½¿ç”¨ node_async(...) å°†æ¯ä¸ª NodeAction åŒ…è£…ä¸ºå¼‚æ­¥èŠ‚ç‚¹æ‰§è¡Œï¼ˆæé«˜ååæˆ–é˜²æ­¢é˜»å¡ï¼Œå…·ä½“å®ç°æ¡†æ¶å·²å°è£…ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token plain"> stateGraph </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Consumer Service Workflow Demo"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> stateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å®šä¹‰èŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"feedback_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">node_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">feedbackClassifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"specific_question_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">node_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">specificQuestionClassifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">node_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RecordingNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å®šä¹‰è¾¹ï¼ˆæµç¨‹é¡ºåºï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addEdge</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">START</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"feedback_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addConditionalEdges</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"feedback_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token function" style="color:hsl(221, 87%, 60%)">edge_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FeedbackQuestionDispatcher</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"negative"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"specific_question_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addConditionalEdges</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"specific_question_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token function" style="color:hsl(221, 87%, 60%)">edge_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpecificQuestionDispatcher</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"after-sale"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"transportation"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"quality"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"others"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å›¾çš„ç»“æŸèŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addEdge</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">END</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphRepresentation</span><span class="token plain"> graphRepresentation </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> stateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphRepresentation</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Type</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">PLANTUML</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"workflow graph"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\n\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">graphRepresentation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\n\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> stateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FeedbackQuestionDispatcher</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">EdgeAction</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">apply</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> classifierOutput </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifier_output"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">orElse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifierOutput: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> classifierOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">classifierOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">contains</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"negative"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpecificQuestionDispatcher</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">EdgeAction</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">apply</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> classifierOutput </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifier_output"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">orElse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifierOutput: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> classifierOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> classifierMap </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            classifierMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"after-sale"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"after-sale"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            classifierMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"quality"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"quality"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            classifierMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"transportation"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"transportation"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Entry</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> entry </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> classifierMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">entrySet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">classifierOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">contains</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"others"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="è‡ªå®šä¹‰-recordingnode-èŠ‚ç‚¹">è‡ªå®šä¹‰ RecordingNode èŠ‚ç‚¹<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#%E8%87%AA%E5%AE%9A%E4%B9%89-recordingnode-%E8%8A%82%E7%82%B9" class="hash-link" aria-label="è‡ªå®šä¹‰ RecordingNode èŠ‚ç‚¹çš„ç›´æ¥é“¾æ¥" title="è‡ªå®šä¹‰ RecordingNode èŠ‚ç‚¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RecordingNode</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">NodeAction</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RecordingNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">apply</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> feedback </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifier_output"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> updatedState </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">feedback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">contains</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Received positive feedback: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> feedback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            updatedState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"solution"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"Praise, no action taken."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Received negative feedback: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> feedback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            updatedState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"solution"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> feedback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> updatedState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="controller">Controller<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#controller" class="hash-link" aria-label="Controllerçš„ç›´æ¥é“¾æ¥" title="Controllerçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/graph/demo"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CompiledGraph</span><span class="token plain"> compiledGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"workflowGraph"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token plain"> stateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphStateException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">compiledGraph </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> stateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">compile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/chat"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">simpleChat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestParam</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"query"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> compiledGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">invoke</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"input"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">flatMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"solution"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-è®¿é—®æµ‹è¯•">2.2 è®¿é—®æµ‹è¯•<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#22-%E8%AE%BF%E9%97%AE%E6%B5%8B%E8%AF%95" class="hash-link" aria-label="2.2 è®¿é—®æµ‹è¯•çš„ç›´æ¥é“¾æ¥" title="2.2 è®¿é—®æµ‹è¯•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">### æ­£é¢</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://localhost:8081/graph/demo/chat?query="This product is excellent, I love it!"</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># Praise, no action taken.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">### è´Ÿé¢ 1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://localhost:8081/graph/demo/chat?query="è¿™ä¸œè¥¿çœŸåƒåœ¾å•Šï¼Œå¤©å‘ï¼Œå¤ªéš¾ç”¨äº†ï¼"</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ```json</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># {"keywords": ["ä¸œè¥¿", "åƒåœ¾", "éš¾ç”¨"], "category_name": "product quality"}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ```</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">### è´Ÿé¢ 2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://localhost:8081/graph/demo/chat?query="The product broke after one day, very disappointed."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ```json</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># {"keywords": ["product", "broke", "one day", "disappointed"], "category_name": "product quality"}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ```</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-å‚è€ƒèµ„æ–™">3. å‚è€ƒèµ„æ–™<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#3-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" class="hash-link" aria-label="3. å‚è€ƒèµ„æ–™çš„ç›´æ¥é“¾æ¥" title="3. å‚è€ƒèµ„æ–™çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>Google Agent ç™½çš®ä¹¦ï¼š<a href="https://www.kaggle.com/whitepaper-agents" target="_blank" rel="noopener noreferrer">https://www.kaggle.com/whitepaper-agents</a></li>
<li>Authropic Agentï¼š<a href="https://www.anthropic.com/engineering/building-effective-agents" target="_blank" rel="noopener noreferrer">https://www.anthropic.com/engineering/building-effective-agents</a></li>
<li>IBM Agents æ™ºèƒ½ä½“ç¼–æ’ï¼š <a href="https://www.ibm.com/cn-zh/think/topics/ai-agent-orchestration" target="_blank" rel="noopener noreferrer">https://www.ibm.com/cn-zh/think/topics/ai-agent-orchestration</a></li>
<li>Spring AI Alibaba Graphï¼š<a href="https://github.com/alibaba/spring-ai-alibaba/blob/main/spring-ai-alibaba-graph/README-zh.md" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/spring-ai-alibaba/blob/main/spring-ai-alibaba-graph/README-zh.md</a></li>
</ol>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="spring ai alibaba graph" term="spring ai alibaba graph"/>
        <category label="agent" term="agent"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[è°·æ­Œå¼€æº gemini-fullstack-langgraph-quickstart ä½“éªŒ]]></title>
        <id>https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart</id>
        <link href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart"/>
        <updated>2025-06-13T23:34:54.000Z</updated>
        <summary type="html"><![CDATA[- Github åœ°å€ï¼šhttps://github.com/google-gemini/gemini-fullstack-langgraph-quickstart]]></summary>
        <content type="html"><![CDATA[<ul>
<li>Github åœ°å€ï¼š<a href="https://github.com/google-gemini/gemini-fullstack-langgraph-quickstart" target="_blank" rel="noopener noreferrer">https://github.com/google-gemini/gemini-fullstack-langgraph-quickstart</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-ç¯å¢ƒå‡†å¤‡">1. ç¯å¢ƒå‡†å¤‡<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87" class="hash-link" aria-label="1. ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥" title="1. ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>Node.js and npm (or yarn/pnpm)ï¼›</li>
<li>Python 3.8+ï¼›</li>
<li>Genmini æ¨¡å‹ APIKEYï¼Œåœ¨ <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a> ä¸­ç”³è¯·ã€‚</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-æœ¬åœ°å¯åŠ¨">2. æœ¬åœ°å¯åŠ¨<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#2-%E6%9C%AC%E5%9C%B0%E5%90%AF%E5%8A%A8" class="hash-link" aria-label="2. æœ¬åœ°å¯åŠ¨çš„ç›´æ¥é“¾æ¥" title="2. æœ¬åœ°å¯åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨ç¬¬ä¸€æ­¥ç¯å¢ƒå‡†å¤‡å®Œæˆä¹‹åï¼Œå¼€å§‹æ­¤æ­¥éª¤ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-clone-é¡¹ç›®">2.1 Clone é¡¹ç›®<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#21-clone-%E9%A1%B9%E7%9B%AE" class="hash-link" aria-label="2.1 Clone é¡¹ç›®çš„ç›´æ¥é“¾æ¥" title="2.1 Clone é¡¹ç›®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">git</span><span class="token plain"> clone https://github.com/google-gemini/gemini-fullstack-langgraph-quickstart.git</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-æ¨¡å‹-ak-è®¾ç½®">2.2 æ¨¡å‹ AK è®¾ç½®<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#22-%E6%A8%A1%E5%9E%8B-ak-%E8%AE%BE%E7%BD%AE" class="hash-link" aria-label="2.2 æ¨¡å‹ AK è®¾ç½®çš„ç›´æ¥é“¾æ¥" title="2.2 æ¨¡å‹ AK è®¾ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¤åˆ¶ backend ç›®å½•ä¸‹çš„ .env.example å¹¶é‡å‘½åä¸º .env</p>
<p>å†™å…¥åœ¨ç¬¬ä¸€æ­¥è·å¾—çš„ Genmini AKã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="23-é¡¹ç›®ä¾èµ–å®‰è£…">2.3 é¡¹ç›®ä¾èµ–å®‰è£…<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#23-%E9%A1%B9%E7%9B%AE%E4%BE%9D%E8%B5%96%E5%AE%89%E8%A3%85" class="hash-link" aria-label="2.3 é¡¹ç›®ä¾èµ–å®‰è£…çš„ç›´æ¥é“¾æ¥" title="2.3 é¡¹ç›®ä¾èµ–å®‰è£…çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å®‰è£…å‰ç«¯ä¾èµ–ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> gemini-fullstack-langgraph-quickstart/frontend</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">npm</span><span class="token plain"> i</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®‰è£…åç«¯ä¾èµ–ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> backend</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pip </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="24-å¯åŠ¨è¿è¡Œ">2.4 å¯åŠ¨è¿è¡Œ<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#24-%E5%90%AF%E5%8A%A8%E8%BF%90%E8%A1%8C" class="hash-link" aria-label="2.4 å¯åŠ¨è¿è¡Œçš„ç›´æ¥é“¾æ¥" title="2.4 å¯åŠ¨è¿è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†ä¼šåŒæ—¶å¯åŠ¨å‰åç«¯ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">make</span><span class="token plain"> dev</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ–è€…åˆ†å¼€è¿è¡Œï¼š</p>
<ul>
<li>åç«¯ï¼š<code>langgraph dev</code>ï¼ˆé»˜è®¤å¼€æ”¾æ¥å£äº <code>http://127.0.0.1:2024</code>ï¼‰</li>
<li>å‰ç«¯ï¼š<code>npm run dev</code>ï¼ˆé»˜è®¤åœ¨ <code>http://localhost:5173</code>ï¼‰</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-è®¿é—®æµ‹è¯•">3. è®¿é—®æµ‹è¯•<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#3-%E8%AE%BF%E9%97%AE%E6%B5%8B%E8%AF%95" class="hash-link" aria-label="3. è®¿é—®æµ‹è¯•çš„ç›´æ¥é“¾æ¥" title="3. è®¿é—®æµ‹è¯•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨è¿è¡Œ <code>make dev</code> ä¹‹åï¼Œæ‰“å¼€ <code>http://localhost:5173</code> åœ°å€ï¼Œ</p>
<blockquote>
<p>PSï¼šå¦‚æœå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼Œæ‰‹åŠ¨å°† @ æ”¹ä¸º ../ çš„ç›¸å¯¹è·¯å¾„ï¼Œemmm~ æ²¡æ‰¾åˆ°åŸå› ã€‚</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[vite] Internal server error: Failed to resolve import "@/components/WelcomeScreen" from "src/App.tsx". Does the file exist?</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<p>åœ¨æµè§ˆå™¨é¡µé¢è¾“å…¥é—®é¢˜ï¼š<code>spring ai alibaba æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ç”¨ä»–å¼€å‘ä¸€ä¸ª ai åº”ç”¨</code></p>
<p>ç­‰å¾…ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå°†ä¼šçœ‹åˆ°ç ”ç©¶æŠ¥å‘Šè¾“å‡ºã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="4-å‚è€ƒæ–‡ç« ">4. å‚è€ƒæ–‡ç« <a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#4-%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0" class="hash-link" aria-label="4. å‚è€ƒæ–‡ç« çš„ç›´æ¥é“¾æ¥" title="4. å‚è€ƒæ–‡ç« çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li><a href="https://gist.github.com/JimLiu/ca25ba4e4fccac2b6a16270c8e82b11a" target="_blank" rel="noopener noreferrer">https://gist.github.com/JimLiu/ca25ba4e4fccac2b6a16270c8e82b11a</a></li>
<li><a href="https://ai.google.dev/gemini-api/docs/api-key?hl=zh-cn" target="_blank" rel="noopener noreferrer">https://ai.google.dev/gemini-api/docs/api-key?hl=zh-cn</a></li>
</ol>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="AI" term="AI"/>
        <category label="DeepResearch" term="DeepResearch"/>
        <category label="Genmini." term="Genmini."/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring AI Alibaba Playground]]></title>
        <id>https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground</id>
        <link href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground"/>
        <updated>2025-06-07T19:26:00.000Z</updated>
        <summary type="html"><![CDATA[Spring AI Alibaba Playground æ˜¯ Spring AI Alibaba ç¤¾åŒºä»¥ Spring AI Alibaba å’Œ Spring AI ä¸ºæ¡†æ¶æ­å»ºçš„ AI åº”ç”¨ã€‚åŒ…å«å®Œå–„çš„å‰ç«¯ UI + åç«¯å®ç°ï¼Œå…·å¤‡å¯¹è¯ï¼Œå›¾ç‰‡ç”Ÿæˆï¼Œå·¥å…·è°ƒç”¨ï¼ŒRAGï¼ŒMCP ç­‰ä¼—å¤š AI ç›¸å…³åŠŸèƒ½ã€‚åœ¨ playground çš„åŸºç¡€ä¹‹ä¸Šï¼Œæ‚¨å¯ä»¥å¿«é€Ÿå¤åˆ»å‡ºä¸€ä¸ªå±äºè‡ªå·±çš„ AI åº”ç”¨ã€‚å…¶ä¸­å·¥å…·è°ƒç”¨ï¼ŒMCP é›†æˆï¼ŒèŠå¤©æ¨¡å‹åˆ‡æ¢ç­‰åŠŸèƒ½äº¦å¯ä¸ºæ‚¨æ­å»ºè‡ªå·±çš„ AI åº”ç”¨æä¾›å‚è€ƒã€‚]]></summary>
        <content type="html"><![CDATA[<p>Spring AI Alibaba Playground æ˜¯ Spring AI Alibaba ç¤¾åŒºä»¥ Spring AI Alibaba å’Œ Spring AI ä¸ºæ¡†æ¶æ­å»ºçš„ AI åº”ç”¨ã€‚åŒ…å«å®Œå–„çš„å‰ç«¯ UI + åç«¯å®ç°ï¼Œå…·å¤‡å¯¹è¯ï¼Œå›¾ç‰‡ç”Ÿæˆï¼Œå·¥å…·è°ƒç”¨ï¼ŒRAGï¼ŒMCP ç­‰ä¼—å¤š AI ç›¸å…³åŠŸèƒ½ã€‚åœ¨ playground çš„åŸºç¡€ä¹‹ä¸Šï¼Œæ‚¨å¯ä»¥å¿«é€Ÿå¤åˆ»å‡ºä¸€ä¸ªå±äºè‡ªå·±çš„ AI åº”ç”¨ã€‚å…¶ä¸­å·¥å…·è°ƒç”¨ï¼ŒMCP é›†æˆï¼ŒèŠå¤©æ¨¡å‹åˆ‡æ¢ç­‰åŠŸèƒ½äº¦å¯ä¸ºæ‚¨æ­å»ºè‡ªå·±çš„ AI åº”ç”¨æä¾›å‚è€ƒã€‚</p>
<p>Playground ä»£ç åœ°å€ï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground</a></p>
<p>é¡¹ç›®é¦–é¡µé¢„è§ˆï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250607164742879" src="https://yuluo-yx.github.io/assets/images/image-20250607164742879-41e44ad9925e22233c344f6e7ff5edef.png" width="2848" height="1702" class="img_c29J"></p>
<p>æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œå†…å®¹è¾ƒå¤šã€‚æ¶‰åŠè¿è¡Œï¼Œé¡¹ç›®ä»‹ç»ï¼Œé…ç½®ä»‹ç»ç­‰ã€‚åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ä»‹ç» Spring AI Alibaba Playgroundï¼Œæ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è·³è½¬åˆ°ä¸åŒç« èŠ‚æµè§ˆã€‚</p>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç›®å½•">ç›®å½•<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#%E7%9B%AE%E5%BD%95" class="hash-link" aria-label="ç›®å½•çš„ç›´æ¥é“¾æ¥" title="ç›®å½•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#local_run">æœ¬åœ°è¿è¡Œ</a></li>
<li><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#config">é…ç½®ä»‹ç»</a></li>
<li><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#project">é¡¹ç›®ä»‹ç»</a></li>
</ol>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-æœ¬åœ°è¿è¡Œ"><span id="local_run">1. æœ¬åœ°è¿è¡Œ</span><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#1-%E6%9C%AC%E5%9C%B0%E8%BF%90%E8%A1%8C" class="hash-link" aria-label="1-æœ¬åœ°è¿è¡Œçš„ç›´æ¥é“¾æ¥" title="1-æœ¬åœ°è¿è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>æœ¬ç« èŠ‚ä¸­ï¼Œå°†ä¸»è¦ä»‹ç»å¦‚ä½•åœ¨æœ¬åœ°å¯åŠ¨ Playground é¡¹ç›®ã€‚</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-1-ä¸‹è½½æºç ">1. 1 ä¸‹è½½æºç <a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#1-1-%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81" class="hash-link" aria-label="1. 1 ä¸‹è½½æºç çš„ç›´æ¥é“¾æ¥" title="1. 1 ä¸‹è½½æºç çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Playground ä»£ç åœ°å€ï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground</a></p>
<p>playground é¡¹ç›®ä½äº spring-ai-alibaba-example ä»“åº“ä¸‹ï¼Œè¢«è®¾è®¡ä¸ºä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œä¸ä¾èµ–äº spring-ai-alibaba-example pom ç®¡ç†ã€‚è¿™æ„å‘³ç€æ‚¨éœ€è¦ä½¿ç”¨ IDEA å•ç‹¬æ‰“å¼€ playground é¡¹ç›®ç›®å½•ã€‚è€Œä¸æ˜¯åœ¨ example æ ¹ç›®å½•ä¸‹ç›´æ¥å¯åŠ¨ã€‚</p>
<blockquote>
<p>PS: å¦‚æœç›´æ¥å¯åŠ¨éœ€è¦é…ç½® IDEA çš„è¿è¡Œå·¥ä½œç›®å½•ï¼Œè¯·å‚è€ƒ README æè¿°ï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/spring-ai-alibaba-playground/README.md" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/spring-ai-alibaba-playground/README.md</a></p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="12-é…ç½®å˜æ›´">1.2 é…ç½®å˜æ›´<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#12-%E9%85%8D%E7%BD%AE%E5%8F%98%E6%9B%B4" class="hash-link" aria-label="1.2 é…ç½®å˜æ›´çš„ç›´æ¥é“¾æ¥" title="1.2 é…ç½®å˜æ›´çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="121-mcp-é…ç½®å˜æ›´">1.2.1 MCP é…ç½®å˜æ›´<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#121-mcp-%E9%85%8D%E7%BD%AE%E5%8F%98%E6%9B%B4" class="hash-link" aria-label="1.2.1 MCP é…ç½®å˜æ›´çš„ç›´æ¥é“¾æ¥" title="1.2.1 MCP é…ç½®å˜æ›´çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å› ä¸º playground é¡¹ç›®å¼•å…¥äº† mcp stdio çš„æ–¹å¼æ¥æ¼”ç¤º Spring AI å¦‚ä½•æ¥å…¥ MCP æœåŠ¡ã€‚å› æ­¤å½“æ‚¨çš„å¯åŠ¨ç¯å¢ƒä¸º windows æ—¶ï¼Œéœ€è¦å®‰è£…å¹¶é…ç½®å¯åŠ¨ MCP Server éœ€è¦çš„ç¯å¢ƒã€‚</p>
<p>ä»¥ä¸‹é¢çš„ MCP Server json é…ç½®æ–‡ä»¶ä¸ºä¾‹ï¼š</p>
<div class="language-json codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-json codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"mcpServers"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token property" style="color:hsl(5, 74%, 59%)">"github"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"command"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"npx"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"args"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/c"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"npx"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-y"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"@modelcontextprotocol/server-github"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"env"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token property" style="color:hsl(5, 74%, 59%)">"GITHUB_PERSONAL_ACCESS_TOKEN"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"your_github_token"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‚¨éœ€è¦å®‰è£… NPX å·¥å…·ï¼Œå¦‚æœåœ¨ Windows ç³»ç»Ÿå¯åŠ¨ï¼Œéœ€è¦å˜æ›´ command ä¸º <code>npx.cmd</code>ã€‚å¦åˆ™ä¼šå¯åŠ¨å¤±è´¥ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="122-æ•°æ®åº“æ–‡ä»¶å˜æ›´">1.2.2 æ•°æ®åº“æ–‡ä»¶å˜æ›´<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#122-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6%E5%8F%98%E6%9B%B4" class="hash-link" aria-label="1.2.2 æ•°æ®åº“æ–‡ä»¶å˜æ›´çš„ç›´æ¥é“¾æ¥" title="1.2.2 æ•°æ®åº“æ–‡ä»¶å˜æ›´çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>Playground ä½¿ç”¨ SQLite ä½œä¸º Chat Memory çš„å­˜å‚¨æ•°æ®åº“ã€‚åœ¨é¡¹ç›®å¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨åœ¨ <code>src/main/resources</code> ç›®å½•ä¸‹åˆ›å»º saa.db çš„æ•°æ®åº“æ–‡ä»¶ï¼Œå¦‚æœå¯åŠ¨æ—¶æ²¡æœ‰è‡ªåŠ¨åˆ›å»ºï¼Œå‡ºç°å¯åŠ¨å¤±è´¥é”™è¯¯æ—¶ã€‚æ‚¨éœ€è¦æ‰‹åŠ¨åˆ›å»ºæ­¤æ–‡ä»¶ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="123-å‰ç«¯æ‰“åŒ…">1.2.3 å‰ç«¯æ‰“åŒ…<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#123-%E5%89%8D%E7%AB%AF%E6%89%93%E5%8C%85" class="hash-link" aria-label="1.2.3 å‰ç«¯æ‰“åŒ…çš„ç›´æ¥é“¾æ¥" title="1.2.3 å‰ç«¯æ‰“åŒ…çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>playground å‰ç«¯é¡¹ç›®é‡‡ç”¨æ‰“åŒ…ç¼–è¯‘åˆ° jar åŒ…ä¸­ä¸€èµ·å¯åŠ¨æ–¹å¼è¿è¡Œï¼Œå› æ­¤åœ¨å¯åŠ¨åç«¯æ—¶ï¼Œéœ€è¦è¿è¡Œ <code>mvn clean package</code>ã€‚ç¡®ä¿å‰ç«¯é¡¹ç›®æ­£ç¡®æ‰“åŒ…ç¼–è¯‘ï¼Œæ‚¨å¯ä»¥åœ¨ <code>target/classes/static</code> è·¯å¾„ä¸‹çœ‹åˆ°å‰ç«¯èµ„æºæ–‡ä»¶ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="124-å¯è§‚æµ‹é›†æˆ">1.2.4 å¯è§‚æµ‹é›†æˆ<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#124-%E5%8F%AF%E8%A7%82%E6%B5%8B%E9%9B%86%E6%88%90" class="hash-link" aria-label="1.2.4 å¯è§‚æµ‹é›†æˆçš„ç›´æ¥é“¾æ¥" title="1.2.4 å¯è§‚æµ‹é›†æˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>Playground é¡¹ç›®ä¸­é›†æˆäº† Spring AI çš„å¯è§‚æµ‹åŠŸèƒ½ï¼Œå¦‚æœæ‚¨ä¸æƒ³è§‚å¯Ÿ AI åº”ç”¨è¿è¡Œä¸­çš„ä¸€äº›æŒ‡æ ‡æ•°æ®ï¼Œæ‚¨å¯ä»¥å¿½ç•¥æ­¤æ­¥éª¤ã€‚</p>
<blockquote>
<p>PS: å› ä¸º AI å¤§æ¨¡å‹åº”ç”¨çš„è§‚æµ‹æ•°æ®ä¸­åŒ…å«ç”¨æˆ·çš„è¾“å…¥ç­‰ä¿¡æ¯ï¼Œåœ¨ç”Ÿäº§éƒ¨ç½²æ—¶ï¼Œè¯·<strong>ç¡®ä¿æ•æ„Ÿä¿¡æ¯é€‰é¡¹å…³é—­</strong>ã€‚</p>
</blockquote>
<p>åœ¨ spring-ai-alibaba-example ä»“åº“ docker-compose ç›®å½•å‡†å¤‡äº† AI åº”ç”¨å¸¸ç”¨çš„å·¥å…· docker-compose å¯åŠ¨æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥å‚è€ƒå¯åŠ¨ <a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/docker-compose/zipkin/docker-compose.yml" target="_blank" rel="noopener noreferrer">zipkin</a>ã€‚</p>
<p>å¯è§‚æµ‹å®ç°å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-alibaba-observability-arms/?spm=5176.29160081.0.0.2856aa5cenvkmu" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-alibaba-observability-arms/?spm=5176.29160081.0.0.2856aa5cenvkmu</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="125-apikey-é…ç½®">1.2.5 apiKey é…ç½®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#125-apikey-%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="1.2.5 apiKey é…ç½®çš„ç›´æ¥é“¾æ¥" title="1.2.5 apiKey é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>Playground é¡¹ç›®é›†æˆäº† RAGï¼Œå‘é‡æ•°æ®åº“å’Œ Function Call ç­‰åŠŸèƒ½ï¼Œå› æ­¤åœ¨å¯åŠ¨ä¹‹åˆæ‚¨åº”è¯¥é…ç½®å¯¹åº”çš„ akã€‚</p>
<blockquote>
<p>PS: playgrond ä¸­æ‰€æœ‰çš„ key éƒ½é€šè¿‡ env çš„æ–¹å¼æ³¨å…¥ï¼Œå¦‚æœé…ç½®äº† env ä¹‹åï¼Œé¡¹ç›®ä»ç„¶è·å–ä¸åˆ° akï¼Œè¯·<strong>é‡å¯ IDEA</strong></p>
</blockquote>
<ol>
<li>DashScope å¤§æ¨¡å‹ akï¼šAI åº”ç”¨ä½¿ç”¨</li>
<li>é˜¿é‡Œäº‘ IQS ä¿¡æ¯æ£€ç´¢æœåŠ¡ akï¼šæ¨¡å—åŒ– RAG ç¤ºä¾‹ï¼Œweb search ä½¿ç”¨</li>
<li>é˜¿é‡Œäº‘ Analytic é¡¹ç›®æ•°æ®åº“ akï¼šRAG ä½¿ç”¨ï¼›</li>
<li>ç™¾åº¦ç¿»è¯‘å’Œç™¾åº¦åœ°å›¾ akï¼šFunction Call è°ƒç”¨ä½¿ç”¨ï¼›</li>
<li>Github ä¸ªäºº secretï¼šMCP Server æ¼”ç¤ºä½¿ç”¨ã€‚</li>
</ol>
<p>å…³äº AK çš„è·å–æ–¹å¼è‡ªè¡Œæœç´¢ï¼Œè¿™é‡Œä¸åœ¨è¿‡å¤šèµ˜è¿°ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="13-å¯åŠ¨å¹¶è®¿é—®">1.3 å¯åŠ¨å¹¶è®¿é—®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#13-%E5%90%AF%E5%8A%A8%E5%B9%B6%E8%AE%BF%E9%97%AE" class="hash-link" aria-label="1.3 å¯åŠ¨å¹¶è®¿é—®çš„ç›´æ¥é“¾æ¥" title="1.3 å¯åŠ¨å¹¶è®¿é—®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¦‚æœä¸Šé¢çš„é…ç½®æ­¥éª¤å…¨éƒ¨å®Œæˆï¼Œåœ¨ playground é¡¹ç›®å¯åŠ¨ä¹‹åï¼Œåœ¨æµè§ˆå™¨è¾“å…¥ <code>http://localhost:8080</code> æ‚¨å°†ä¼šçœ‹åˆ°æ–‡ç« å¼€å§‹æ—¶çš„é¦–é¡µé¡µé¢ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20250607171739807" src="https://yuluo-yx.github.io/assets/images/image-20250607171739807-d26f673ee4c84498c474407cbf996319.png" width="2552" height="1270" class="img_c29J"></p>
<blockquote>
<p>PS: å¦‚æœä½“éªŒå¯¹åº”çš„ Function Call æˆ–è€… MCP åŠŸèƒ½æ—¶ï¼Œ<strong>è¯·ç¡®ä¿é…ç½®äº†å¯¹åº”çš„æœåŠ¡ AK ä¸” AK æœ‰æ•ˆ</strong>ã€‚</p>
<p><strong>æ­¤é¡¹ç›®ä»…ä½œä¸ºæ¼”ç¤ºä½¿ç”¨ï¼Œä¸€äº›åŠŸèƒ½åˆå…·å½¢çŠ¶ï¼Œå°šä¸å®Œå–„ã€‚æ¬¢è¿è´¡çŒ®ä»£ç å¹¶å®Œå–„é¡¹ç›®ï¼ğŸš€</strong></p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-é…ç½®ä»‹ç»"><span id="config">2. é…ç½®ä»‹ç»</span><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#2-%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="2-é…ç½®ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="2-é…ç½®ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>playground é¡¹ç›®ä½œä¸ºä¸€ä¸ªè¾ƒå®Œå–„çš„ AI åº”ç”¨é¡¹ç›®ï¼Œæ¶‰åŠè¾ƒå¤šçš„é…ç½®æ–‡ä»¶ï¼Œåœ¨æ­¤ç« èŠ‚ä¸­å°†ä¸€ä¸€è¯´æ˜ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-resources-é…ç½®">2.1 resources é…ç½®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#21-resources-%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="2.1 resources é…ç½®çš„ç›´æ¥é“¾æ¥" title="2.1 resources é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>resource ç›®å½•é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">resources</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ application-dev.yml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ application-prod.yml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ application.yml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ banner.txt</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ db</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ logback-spring.xml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ mcp-config.yml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ mcp-libs</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ models.yaml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€ rag</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol>
<li>db ä¸º saa.db ç›®å½•ï¼Œä¸»è¦ä¸º playground çš„ chat memory æä¾›å­˜å‚¨æ”¯æŒï¼›</li>
<li>mcp-libsï¼šMCP Stdio çš„æœåŠ¡ jar ç›®å½•ï¼›</li>
<li>ragï¼šRAG åŠŸèƒ½çš„çŸ¥è¯†åº“æ–‡æ¡£ç›®å½•ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æ—¶ï¼Œå°†è‡ªåŠ¨å‘é‡åŒ–æ–‡æ¡£å¹¶å­˜å…¥å‘é‡æ•°æ®åº“ï¼›</li>
<li>mcp-config.yamlï¼špalyground é¡¹ç›®å¢å¼ºçš„ mcp-server é…ç½®ï¼›</li>
<li>application-*.ymlï¼šé¡¹ç›®å¯åŠ¨é…ç½®ã€‚</li>
</ol>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="211-mcp-config-å¢å¼º">2.1.1 MCP Config å¢å¼º<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#211-mcp-config-%E5%A2%9E%E5%BC%BA" class="hash-link" aria-label="2.1.1 MCP Config å¢å¼ºçš„ç›´æ¥é“¾æ¥" title="2.1.1 MCP Config å¢å¼ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>è§£å†³çš„é—®é¢˜ï¼šåœ¨ playground ä¸­ä½¿ç”¨ MCP Stdio çš„æ–¹å¼æ¥é›†æˆå’Œæ¼”ç¤º MCP åŠŸèƒ½ï¼Œåœ¨æ¶‰åŠåˆ°æœ¬åœ°æœåŠ¡æ—¶ï¼Œä¾‹å¦‚ä»¥ä¸‹é…ç½®ï¼š</p>
<div class="language-json codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-json codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"mcpServers"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token property" style="color:hsl(5, 74%, 59%)">"weather"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"command"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"java"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"args"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.ai.mcp.server.stdio=true"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.main.web-application-type=none"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dlogging.pattern.console="</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-jar"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"D:\\open_sources\\spring-ai-alibaba-examples\\spring-ai-alibaba-mcp-example\\spring-ai-alibaba-mcp-build-example\\mcp-stdio-server-example\\target\\mcp-stdio-server-example-1.0.0.jar"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"env"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨äºŒè¿›åˆ¶æ–‡ä»¶é…ç½®æ—¶ï¼Œå¿…é¡»è¦æ±‚ä½¿ç”¨ç»å¯¹è·¯å¾„é…ç½®ä¸” json é…ç½®è¾ƒéš¾ç†è§£ã€‚å› æ­¤ playground åœ¨é…ç½®åšäº†å¢å¼ºï¼Œå°† json è½¬ä¸ºäº†è¯­ä¹‰æ¸…æ™°çš„ yml æ–¹å¼å®šä¹‰ã€‚ç»†èŠ‚è¯·å‚è€ƒ <a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#mcp-config">MCP</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-pomxml-é…ç½®">2.2 pom.xml é…ç½®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#22-pomxml-%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="2.2 pom.xml é…ç½®çš„ç›´æ¥é“¾æ¥" title="2.2 pom.xml é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ­¤ç« èŠ‚éƒ¨åˆ†å°†ä¸»è¦ä»‹ç»æ ¸å¿ƒä¾èµ–ï¼Œå…¶ä»–ä¾èµ–è¯·å‚è€ƒï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/spring-ai-alibaba-playground/pom.xml" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/spring-ai-alibaba-playground/pom.xml</a></p>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Chat Memory åŠŸèƒ½å®ç°æ—¶éœ€è¦æ­¤ä¾èµ–é¡¹ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-data-jpa</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- playground æ–‡æœ¬æ€»ç»“åŠŸèƒ½ä¾èµ– tika å¯¹è¾“å…¥çš„å„ç±»æ–‡æœ¬è¿›è¡Œè§£æ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-tika-document-reader</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI MCP client ç›¸å…³ä¾èµ–--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-starter-mcp-client</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-autoconfigure-mcp-client</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI OpenAI Starter --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-starter-model-openai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI RAG markdown æ–‡æœ¬è¯»å…¥è§£æ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-markdown-document-reader</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI å‘é‡æ•°æ®åº“ Advisors --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-advisors-vector-store</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI Alibaba DashScope starter --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-dashscope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai-alibaba.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI Alibaba Memory å®ç° --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-memory</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai-alibaba.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI Alibaba analyticdb å‘é‡æ•°æ®åº“é›†æˆ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-store-analyticdb</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai-alibaba.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- DBï¼Œä¸º ChatMemory å’Œ playground æä¾›å­˜å‚¨æ”¯æŒ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.xerial</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">sqlite-jdbc</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${sqlite-jdbc.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.hibernate.orm</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">hibernate-community-dialects</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${hibernate.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Playground å¯è§‚æµ‹é›†æˆ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">io.micrometer</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">micrometer-tracing-bridge-brave</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${micrometr.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusions</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">slf4j-api</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.slf4j</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusions</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI å’Œ Spring AI Alibaba ä¾èµ–ç®¡ç† --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencyManagement</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-boot.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-bom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai-alibaba.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-bom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencyManagement</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-é¡¹ç›®ä»‹ç»"><span id="project">3. é¡¹ç›®ä»‹ç»</span><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#3-%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="3-é¡¹ç›®ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="3-é¡¹ç›®ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨ playground ä¸­é›†æˆäº†è¾ƒå¤šåŠŸèƒ½ï¼ŒRAGï¼ŒMCPï¼ŒFunction Call ç­‰ã€‚æ­¤ç« èŠ‚ä¸­å°†ä¸»è¦å¯¹ RAG Web Searchï¼ŒMCP è°ƒç”¨ï¼ŒFunction Call æ‹†åˆ†ä»‹ç»ã€‚ä»¥ä¾¿èƒ½å¤ŸåŸºäºæ­¤ playground æ­å»ºç¬¦åˆè‡ªå·±éœ€æ±‚çš„ AI åº”ç”¨ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="31-rag-å®ç°">3.1 RAG å®ç°<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#31-rag-%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="3.1 RAG å®ç°çš„ç›´æ¥é“¾æ¥" title="3.1 RAG å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>RAG ä»ç„¶æ˜¯å½“ä»Šæœ€æµè¡Œçš„ AI åº”ç”¨ç»“åˆç§æœ‰çŸ¥è¯†åº“çš„æ–¹å¼ã€‚é€šè¿‡ RAG èƒ½å¤Ÿæ„å»ºé—®ç­”æœºå™¨äººï¼Œä¸“ä¸šé¢†åŸŸåŠ©æ‰‹ç­‰ã€‚</p>
<p>åœ¨ playground é¡¹ç›®ä¸­ï¼Œä½¿ç”¨çš„å‘é‡æ•°æ®åº“æ˜¯ analyticdb å’ŒåŸºäºå†…å­˜çš„ SimpleVectorStoreã€‚<strong>æ‚¨å¯ä»¥æ›¿æ¢ä¸ºä»»æ„æ‚¨æƒ³ä½¿ç”¨çš„å‘é‡æ•°æ®åº“</strong>ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="311-å‘é‡æ•°æ®åº“åˆå§‹åŒ–">3.1.1 å‘é‡æ•°æ®åº“åˆå§‹åŒ–<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#311-%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%9D%E5%A7%8B%E5%8C%96" class="hash-link" aria-label="3.1.1 å‘é‡æ•°æ®åº“åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥" title="3.1.1 å‘é‡æ•°æ®åº“åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åˆå§‹åŒ–é…ç½®ä»£ç ä½äºï¼šcom/alibaba/cloud/ai/application/config/rag</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CommandLineRunner</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">ingestTermOfServiceToVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token plain"> vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> args </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> type </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getenv</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"VECTOR_STORE_TYPE"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreInitializer</span><span class="token plain"> initializer </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreInitializer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       initializer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">init</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">type</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é€šè¿‡ VECTOR_STORE_TYPE çš„æ–¹å¼æ¥é€‰æ‹©ä½¿ç”¨é‚£ç§ç±»å‹çš„å‘é‡æ•°æ®åº“ï¼ŒVectorStoreDelegate ä»£ç å¦‚ä¸‹ï¼šå…¶ä½œç”¨æ˜¯é€šè¿‡ type çš„å€¼è¿”å›å‘é‡æ•°æ®åº“çš„å®ä¾‹ beanã€‚</p>
<blockquote>
<p>PSï¼šåœ¨è¿™é‡Œæ‚¨å¯ä»¥æ›¿æ¢ä¸ºæ‚¨æ‰€ä½¿ç”¨çš„å‘é‡æ•°æ®åº“æ¥æ„å»º RAG åŠŸèƒ½ã€‚</p>
</blockquote>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> simpleVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> analyticdbVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> simpleVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> analyticdbVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">simpleVectorStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> simpleVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">analyticdbVectorStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> analyticdbVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> vectorStoreType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStoreType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"analyticdb"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> analyticdbVectorStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> analyticdbVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> simpleVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="312-rag-æ–‡æ¡£åˆå§‹åŒ–">3.1.2 RAG æ–‡æ¡£åˆå§‹åŒ–<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#312-rag-%E6%96%87%E6%A1%A3%E5%88%9D%E5%A7%8B%E5%8C%96" class="hash-link" aria-label="3.1.2 RAG æ–‡æ¡£åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥" title="3.1.2 RAG æ–‡æ¡£åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åœ¨ VectorStoreInitializer ä¸­å°† resources/rag ä¸‹çš„ md æ–‡æ¡£å‘é‡åŒ–å¹¶åŠ è½½åˆ°å‘é‡æ•°æ®åº“ä¸­ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">init</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">MarkdownDocumentReader</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> markdownDocumentReaderList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">loadMarkdownDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> size </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">markdownDocumentReaderList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">warn</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"No markdown documents found in the directory."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Start to load markdown documents into vector store......"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MarkdownDocumentReader</span><span class="token plain"> markdownDocumentReader </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> markdownDocumentReaderList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">TokenTextSplitter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">2000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1024</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">transform</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">markdownDocumentReader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        size </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ‹†åˆ† documents åˆ—è¡¨ä¸ºæœ€å¤§ 25 ä¸ªå…ƒç´ çš„å­åˆ—è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">25</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> end </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">min</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">25</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> subList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">subList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> end</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">subList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Load markdown documents into vector store successfully. Load {} documents."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="313-æ„å»º-service">3.1.3 æ„å»º Service<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#313-%E6%9E%84%E5%BB%BA-service" class="hash-link" aria-label="3.1.3 æ„å»º Serviceçš„ç›´æ¥é“¾æ¥" title="3.1.3 æ„å»º Serviceçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åœ¨ä¸šåŠ¡ä»£ç ä¸­æ³¨å…¥å‘é‡æ•°æ®åº“ beanï¼Œå³å¯å®Œæˆ RAG åŠŸèƒ½çš„å®ç°ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAARAGService</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token plain"> vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> vectorStoreType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAARAGService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token plain"> vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MessageChatMemoryAdvisor</span><span class="token plain"> messageChatMemoryAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"dashscopeChatModel"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"systemPromptTemplate"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token plain"> systemPromptTemplate</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">vectorStoreType </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getenv</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"VECTOR_STORE_TYPE"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">vectorStoreDelegate </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">client </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultSystem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   systemPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   messageChatMemoryAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   simpleLoggerAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">ragChat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> chatId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">advisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">memoryAdvisor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> memoryAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">param</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatMemory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">CONVERSATION_ID</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">advisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionAnswerAdvisor</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStoreType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">searchRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                               </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SearchRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// TODO all documents retrieved from ADB are under 0.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//                                   .similarityThreshold(0.6d)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">topK</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">6</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>RAG å®ç°æ–‡ç« å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-alibaba-rag-ollama/?spm=5176.29160081.0.0.2856aa5cenvkmu" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-alibaba-rag-ollama/?spm=5176.29160081.0.0.2856aa5cenvkmu</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="32-web-search--åŠŸèƒ½å®ç°">3.2 Web Search  åŠŸèƒ½å®ç°<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#32-web-search--%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="3.2 Web Search  åŠŸèƒ½å®ç°çš„ç›´æ¥é“¾æ¥" title="3.2 Web Search  åŠŸèƒ½å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨ Qwen æ¨¡å‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>enable_search</code> å¼€å¯æ¨¡å‹çš„è”ç½‘æœç´¢èƒ½åŠ›ã€‚åœ¨ playground é€šè¿‡ Module RAG çš„æ–¹å¼æ¥é›†æˆè”ç½‘æœç´¢åŠŸèƒ½ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="321-module-rag-ä»‹ç»">3.2.1 Module RAG ä»‹ç»<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#321-module-rag-%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="3.2.1 Module RAG ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="3.2.1 Module RAG ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<img src="https://java2ai.com/img/blog/module-rag/module-rag.png">
<p>Spring AI å®ç°äº†æ¨¡å—åŒ– RAG æ¶æ„ï¼Œæ¶æ„çš„çµæ„Ÿæ¥è‡ªäºè®ºæ–‡â€œ<a href="https://arxiv.org/abs/2407.21059" target="_blank" rel="noopener noreferrer">æ¨¡å—åŒ– RAGï¼šå°† RAG ç³»ç»Ÿè½¬å˜ä¸ºç±»ä¼¼ä¹é«˜çš„å¯é‡æ„æ¡†æ¶</a>â€ä¸­è¯¦è¿°çš„æ¨¡å—åŒ–æ¦‚å¿µã€‚å°† RAG åˆ†ä¸ºä¸‰æ­¥ï¼š</p>
<p><strong>Pre-Retrieval</strong></p>
<blockquote>
<p>å¢å¼ºå’Œè½¬æ¢ç”¨æˆ·è¾“å…¥ï¼Œä½¿å…¶æ›´æœ‰æ•ˆåœ°æ‰§è¡Œæ£€ç´¢ä»»åŠ¡ï¼Œè§£å†³æ ¼å¼ä¸æ­£ç¡®çš„æŸ¥è¯¢ã€query è¯­ä¹‰ä¸æ¸…æ™°ã€æˆ–ä¸å—æ”¯æŒçš„è¯­è¨€ç­‰ã€‚</p>
</blockquote>
<ol>
<li>QueryAugmenter æŸ¥è¯¢å¢å¼ºï¼šä½¿ç”¨é™„åŠ çš„ä¸Šä¸‹æ–‡æ•°æ®ä¿¡æ¯å¢å¼ºç”¨æˆ· queryï¼Œæä¾›å¤§æ¨¡å‹å›ç­”é—®é¢˜æ—¶çš„å¿…è¦ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼›</li>
<li>QueryTransformer æŸ¥è¯¢æ”¹å†™ï¼šå› ä¸ºç”¨æˆ·çš„è¾“å…¥é€šå¸¸æ˜¯ç‰‡é¢çš„ï¼Œå…³é”®ä¿¡æ¯è¾ƒå°‘ï¼Œä¸ä¾¿äºå¤§æ¨¡å‹ç†è§£å’Œå›ç­”é—®é¢˜ã€‚å› æ­¤éœ€è¦ä½¿ç”¨ prompt è°ƒä¼˜æ‰‹æ®µæˆ–è€…å¤§æ¨¡å‹æ”¹å†™ç”¨æˆ· queryï¼›</li>
<li>QueryExpander æŸ¥è¯¢æ‰©å±•ï¼šå°†ç”¨æˆ· query æ‰©å±•ä¸ºå¤šä¸ªè¯­ä¹‰ä¸åŒçš„å˜ä½“ä»¥è·å¾—ä¸åŒè§†è§’ï¼Œæœ‰åŠ©äºæ£€ç´¢é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å¹¶å¢åŠ æ‰¾åˆ°ç›¸å…³ç»“æœçš„æœºä¼šã€‚</li>
</ol>
<p><strong>Retrieval</strong></p>
<blockquote>
<p>è´Ÿè´£æŸ¥è¯¢å‘é‡å­˜å‚¨ç­‰æ•°æ®ç³»ç»Ÿå¹¶æ£€ç´¢å’Œç”¨æˆ· query ç›¸å…³æ€§æœ€é«˜çš„ Documentã€‚</p>
</blockquote>
<ol>
<li>DocumentRetrieverï¼šæ£€ç´¢å™¨ï¼Œæ ¹æ® QueryExpander ä½¿ç”¨ä¸åŒçš„æ•°æ®æºè¿›è¡Œæ£€ç´¢ï¼Œä¾‹å¦‚ æœç´¢å¼•æ“ã€å‘é‡å­˜å‚¨ã€æ•°æ®åº“æˆ–çŸ¥è¯†å›¾ç­‰ï¼›</li>
<li>DocumentJoinerï¼šå°†ä»å¤šä¸ª query å’Œä»å¤šä¸ªæ•°æ®æºæ£€ç´¢åˆ°çš„ Document åˆå¹¶ä¸ºä¸€ä¸ª Document é›†åˆï¼›</li>
</ol>
<p><strong>Post-Retrieval</strong></p>
<blockquote>
<p>è´Ÿè´£å¤„ç†æ£€ç´¢åˆ°çš„ Document ä»¥è·å¾—æœ€ä½³çš„è¾“å‡ºç»“æœï¼Œè§£å†³æ¨¡å‹ä¸­çš„<em>ä¸­é—´ä¸¢å¤±</em>å’Œä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶ç­‰ã€‚</p>
<p><strong>PSï¼šSpring AI åœ¨ 1.0.0 ä¸­å¼ƒç”¨äº† DocumentRankerã€‚æ‚¨å¯ä»¥å®ç° DocumentPostProcessor æ¥å£æ¥å®ç°æ­¤åŠŸèƒ½ã€‚Playground å¾…è¡¥å……ã€‚</strong></p>
</blockquote>
<p><strong>ç”Ÿæˆ</strong></p>
<p>ç”Ÿæˆç”¨æˆ· Query å¯¹åº”çš„å¤§æ¨¡å‹è¾“å‡ºã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="322-æ•°æ®æ¥æº">3.2.2 æ•°æ®æ¥æº<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#322-%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90" class="hash-link" aria-label="3.2.2 æ•°æ®æ¥æºçš„ç›´æ¥é“¾æ¥" title="3.2.2 æ•°æ®æ¥æºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>è”ç½‘æœç´¢ï¼Œé¡¾åæ€ä¹‰ã€‚å°±æ˜¯å°†ç½‘ç»œä¸Šçš„æ•°æ®é€šè¿‡å®æ—¶æœç´¢çš„æ–¹å¼è·å–åˆ°å¹¶äº¤ç»™å¤§æ¨¡å‹æ¥è·å¾—æœ€æ–°å¾—æ¶ˆæ¯å’¨è¯¢ã€‚playground é¡¹ç›®ä¸­ä½¿ç”¨äº†é˜¿é‡Œäº‘çš„ IQSï¼Œä¿¡æ¯æ£€ç´¢æœåŠ¡ä½œä¸ºè”ç½‘æœç´¢çš„æ•°æ®æºã€‚æ‚¨å¯ä»¥ä½¿ç”¨æœç´¢å¼•æ“æœåŠ¡æ›¿æ¢ IQSã€‚</p>
<p>IIQS æœç´¢å®ç°å¦‚ä¸‹ï¼šå…¶æœ¬è´¨ä¸ºè¯·æ±‚æœåŠ¡æ¥å£æˆ–è°ƒç”¨ SDKã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">search</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// String encodeQ = URLEncoder.encode(query, StandardCharsets.UTF_8);</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ResponseEntity</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> resultResponseEntity </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">genericSearchResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">resultResponseEntity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ResponseEntity</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">restClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">uri</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/search/genericSearch?query={query}&amp;timeRange={timeRange}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token constant" style="color:hsl(35, 99%, 36%)">TIME_RANGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">retrieve</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toEntity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="323-æ•°æ®åŠ å·¥">3.2.3 æ•°æ®åŠ å·¥<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#323-%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%B7%A5" class="hash-link" aria-label="3.2.3 æ•°æ®åŠ å·¥çš„ç›´æ¥é“¾æ¥" title="3.2.3 æ•°æ®åŠ å·¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œå°†æœç´¢å¼•æ“è·å–åˆ°çš„æ•°æ®è¿›è¡Œæ¸…æ´—å¹¶è½¬ä¸º Spring AI çš„ Document æ–‡æ¡£ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token plain"> respData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">URISyntaxException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> metadata </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getQueryMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">respData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ScorePageItem</span><span class="token plain"> pageItem </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> respData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getPageItems</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> pageItemMetadata </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getPageItemMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Double</span><span class="token plain"> score </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getScore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> text </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Media</span><span class="token plain"> media </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMedia</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token plain"> document </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItemMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">media</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">media</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">score</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">score</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token plain"> document </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItemMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">score</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">score</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Double</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getScore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ScorePageItem</span><span class="token plain"> pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getScore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// .... çœç•¥æ•°æ®æ¸…æ´—ä»£ç </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// é™åˆ¶è”ç½‘æœç´¢çš„æ–‡æ¡£æ•°ï¼Œæé«˜è”ç½‘æœç´¢å“åº”é€Ÿåº¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">limitResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> minResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> limit </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">min</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> minResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">subList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> limit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="324-module-rag-æµç¨‹">3.2.4 Module RAG æµç¨‹<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#324-module-rag-%E6%B5%81%E7%A8%8B" class="hash-link" aria-label="3.2.4 Module RAG æµç¨‹çš„ç›´æ¥é“¾æ¥" title="3.2.4 Module RAG æµç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æ¥ä¸‹æ¥ï¼Œä¾¿æ˜¯ä½¿ç”¨ Module RAG API å¤„ç†ç”¨æˆ· Promptã€‚ä½¿å…¶æ›´ç¬¦åˆå¤§æ¨¡å‹çš„è¾“å…¥è¾“å‡ºï¼Œè·å¾—æ›´å¥½çš„æ•ˆæœ</p>
<p>å…·ä½“ä»£ç å‚è€ƒï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground/src/main/java/com/alibaba/cloud/ai/application/rag" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground/src/main/java/com/alibaba/cloud/ai/application/rag</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="325-web-search-æœåŠ¡ç±»">3.2.5 Web Search æœåŠ¡ç±»<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#325-web-search-%E6%9C%8D%E5%8A%A1%E7%B1%BB" class="hash-link" aria-label="3.2.5 Web Search æœåŠ¡ç±»çš„ç›´æ¥é“¾æ¥" title="3.2.5 Web Search æœåŠ¡ç±»çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ol>
<li>åœ¨æ„é€ æ–¹æ³•ä¸­æ³¨å…¥ç›¸å…³ Beanï¼›</li>
<li>åœ¨ ChatClient ä¸­é€šè¿‡ RetrievalAugmentationAdvisor å¼•å…¥ advisor å®ç°æ¨¡å—åŒ– RAG çš„è”ç½‘æœç´¢åŠŸèƒ½ã€‚</li>
</ol>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAWebSearchService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DataClean</span><span class="token plain"> dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryExpander</span><span class="token plain"> queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IQSSearchEngine</span><span class="token plain"> searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryTransformer</span><span class="token plain"> queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"dashscopeChatModel"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"queryArgumentPromptTemplate"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token plain"> queryArgumentPromptTemplate</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">queryTransformer </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">queryExpander </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">queryArgumentPromptTemplate </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryArgumentPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// reasoning content for DeepSeek-r1 is integrated into the output</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">reasoningContentAdvisor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ReasoningContentAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Build chatClient</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DashScopeChatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">withModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">DEFAULT_WEB_SEARCH_MODEL</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// stream æ¨¡å¼ä¸‹æ˜¯å¦å¼€å¯å¢é‡è¾“å‡º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">withIncrementalOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ—¥å¿—</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">simpleLoggerAdvisor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">webSearchRetriever </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WebSearchRetriever</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">maxResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//Handle user input</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">advisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token function" style="color:hsl(221, 87%, 60%)">createRetrievalAugmentationAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             reasoningContentAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             simpleLoggerAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RetrievalAugmentationAdvisor</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createRetrievalAugmentationAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RetrievalAugmentationAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">documentRetriever</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">webSearchRetriever</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">queryTransformers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">queryAugmenter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomContextQueryAugmenter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      queryArgumentPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">documentJoiner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConcatenationDocumentJoiner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Web Search å®ç°æ–‡ç« å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-alibaba-module-rag/?spm=5176.29160081.0.0.2856aa5cenvkmu&amp;source=blog/" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-alibaba-module-rag/?spm=5176.29160081.0.0.2856aa5cenvkmu&amp;source=blog/</a></p>
<p>Spring AI RAGï¼š<a href="https://docs.spring.io/spring-ai/reference/api/retrieval-augmented-generation.html#_advisors" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/api/retrieval-augmented-generation.html#_advisors</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="33-mcp-é›†æˆ"><span id="mcp-config">3.3 MCP&nbsp; é›†æˆ</span><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#33-mcp-%E9%9B%86%E6%88%90" class="hash-link" aria-label="33-mcp-é›†æˆçš„ç›´æ¥é“¾æ¥" title="33-mcp-é›†æˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="331-mcp-config-å¢å¼º">3.3.1 MCP Config å¢å¼º<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#331-mcp-config-%E5%A2%9E%E5%BC%BA" class="hash-link" aria-label="3.3.1 MCP Config å¢å¼ºçš„ç›´æ¥é“¾æ¥" title="3.3.1 MCP Config å¢å¼ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>ä¸ºäº†è§£å†³ MCP Stdio json é…ç½®æ–‡ä»¶éš¾ä»¥ç†è§£å’Œæœ¬åœ° MCP Server äºŒè¿›åˆ¶æ–‡ä»¶éœ€è¦ç»å¯¹è·¯å¾„çš„é—®é¢˜ã€‚åœ¨ playground ä¸­å¯¹ MCP Stdio é…ç½®åšäº†å¢å¼ºå¤„ç†ã€‚</p>
<p>å…¶ä¸»è¦æ­¥éª¤æ˜¯å°† McpStdioClientProperties å±æ€§é…ç½®é‡å†™ï¼Œä»¥ä¾¿åœ¨åç»­ MCP Client åˆå§‹åŒ–ä½¿ç”¨å¢å¼ºçš„ MCP é…ç½®ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomMcpStdioTransportConfigurationBeanPostProcessor</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BeanPostProcessor</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomMcpStdioTransportConfigurationBeanPostProcessor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomMcpStdioTransportConfigurationBeanPostProcessor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token plain"> mcpStdioClientProperties</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">objectMapper </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">mcpStdioClientProperties </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">postProcessAfterInitialization</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token plain"> bean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> beanName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BeansException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bean </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">instanceof</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StdioTransportAutoConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¢å¼º McpStdioTransportConfiguration bean start: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> beanName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token plain"> mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				mcpServerConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Handle the jar relative path issue in the configuration file.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Entry</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token generics class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Parameters</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> entry </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">entrySet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">command</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"java"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Parameters</span><span class="token plain"> serverConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> oldMcpLibsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">serverConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> rewriteMcpLibsAbsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpLibsAbsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">serverConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">rewriteMcpLibsAbsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							serverConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">remove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">oldMcpLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							serverConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">rewriteMcpLibsAbsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> msc </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">writeValueAsString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Registry McpServer config: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> msc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// write mcp client</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setServersConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ByteArrayResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">msc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getBytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StdioTransportAutoConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> bean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stdioTransports</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAAppException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¢å¼º McpStdioTransportConfiguration bean end: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> beanName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> bean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ MCPServerUtils ä¸­è¯»å– mcp-config.yaml é…ç½®å¹¶è½¬ä¸º McpServerConfigã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> mapper </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">YAMLFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">InputStream</span><span class="token plain"> resourceAsStream </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ModelsUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getClassLoader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResourceAsStream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">MCP_CONFIG_FILE_PATH</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token plain"> mcpServerConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> mapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">readValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">resourceAsStream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> env </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nonNull</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">entrySet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"${"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">endsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> envKey </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">substring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">length</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> envValue </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getenv</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">envKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// allow env is null.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">envValue </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">envValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> envValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="332-mcp-server-å·¥å…·å›æ˜¾">3.3.2 MCP Server å·¥å…·å›æ˜¾<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#332-mcp-server-%E5%B7%A5%E5%85%B7%E5%9B%9E%E6%98%BE" class="hash-link" aria-label="3.3.2 MCP Server å·¥å…·å›æ˜¾çš„ç›´æ¥é“¾æ¥" title="3.3.2 MCP Server å·¥å…·å›æ˜¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>ä¸ºäº†ä¾¿äºå±•ç¤º MCP Client å¦‚ä½•è°ƒç”¨ MCP Server çš„ tools å’Œå±•ç¤º MCP Server ä¸­æœ‰å“ªäº› Toolsï¼Œplayground ä¸­åšäº†ç‰¹æ®Šå¤„ç†ã€‚</p>
<p>è‡ªå®šä¹‰ MCP Server å­˜æ”¾ MCP Server çš„ tools ä¿¡æ¯ç”¨äºæµè§ˆå™¨æ˜¾ç¤ºï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> desc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Tools</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> toolList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å› ä¸º Spring AI çš„ SyncMcpToolCallback ä¸­çš„ MCPClient æ²¡æœ‰å¯¹å¤–æš´éœ²è·å– MCP Server çš„ç›¸å…³å±æ€§ï¼Œåªæœ‰ Tools å®šä¹‰ã€‚playground å¯¹ SyncMcpToolCallback åšäº†åŒ…è£…å¤„ç†ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallbackWrapper</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token plain"> callback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallbackWrapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token plain"> callback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">callback </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> callback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpSyncClient</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Field</span><span class="token plain"> field </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getDeclaredField</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"mcpClient"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			field</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setAccessible</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpSyncClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> field</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">callback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">NoSuchFieldException</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IllegalAccessException</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RuntimeException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ MCPServerUtils ä¸­åšäº† MCP Server å®¹å™¨çš„åˆå§‹åŒ–æ“ä½œï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">initMcpServerContainer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallbackProvider</span><span class="token plain"> toolCallbackProvider</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token plain"> mcpServerConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> mcpServerDescMap </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">initMcpServerDescMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token generics class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Tools</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> toolsList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallback</span><span class="token plain"> toolCallback </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> toolCallbackProvider</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// todo: æ‹¿ä¸åˆ° mcp client, å…ˆç”¨åŒ…è£…å™¨æ‹¿å§</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token plain"> mcpToolCallback </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> toolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallbackWrapper</span><span class="token plain"> syncMcpToolCallbackWrapper </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallbackWrapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpToolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> currentMcpServerName </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> syncMcpToolCallbackWrapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getServerInfo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æŒ‰ç…§ mcp server name èšåˆ mcp server tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> currentMcpServerName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Tools</span><span class="token plain"> tool </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setDesc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolDefinition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">description</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolDefinition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setParams</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolDefinition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputSchema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                toolsList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerContainer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addServer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">getId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">desc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpServerDescMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toolList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolsList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>MCP Server å·¥å…·å›æ˜¾æ•ˆæœå¦‚ä¸‹ï¼šæ‚¨å¯ä»¥åœ¨ resource ä¸‹çš„ mcp-config.yaml ä¸­æ·»åŠ æ›´å¤š MCP Serverã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20250607190058038" src="https://yuluo-yx.github.io/assets/images/image-20250607190058038-9fa2436023389deebb0e3b2c939d5a65.png" width="2302" height="1245" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="333-mcp-å·¥å…·è°ƒç”¨">3.3.3 MCP å·¥å…·è°ƒç”¨<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#333-mcp-%E5%B7%A5%E5%85%B7%E8%B0%83%E7%94%A8" class="hash-link" aria-label="3.3.3 MCP å·¥å…·è°ƒç”¨çš„ç›´æ¥é“¾æ¥" title="3.3.3 MCP å·¥å…·è°ƒç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å®Œæˆä¸Šé¢ä¸€ç³»åˆ—çš„åˆå§‹åŒ–æ“ä½œä¹‹åï¼Œæ¥ä¸‹æ¥ä¾¿æ˜¯ç¼–å†™ MCP Service ç±»ï¼šä¸ºäº†èƒ½å¤Ÿè·å– MCP Server Tools çš„æ‰§è¡Œä¿¡æ¯ï¼Œè¿™é‡Œä½¿ç”¨äº† Spring AI Tools çš„ internalToolExecutionEnabled APIã€‚æ¥æ”¶é›†å¤§æ¨¡å‹çš„å·¥å…·å…¥å‚å’Œæ‰§è¡Œç»“æœç­‰ï¼Œåœ¨å‰ç«¯åšè°ƒç”¨å±•ç¤ºã€‚</p>
<p>ä¸ºäº†æ”¶é›† MCP Tools è°ƒç”¨è¿‡ç¨‹ä¸­çš„ä¿¡æ¯ã€‚Playground é¡¹ç›®ç¼–å†™äº† ToolCallResp ç±»æ¥æ”¶é›†ä¸€äº›ä¿¡æ¯ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool çš„æ‰§è¡ŒçŠ¶æ€</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token plain"> status</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool Name</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool æ‰§è¡Œå‚æ•°</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolParameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool æ‰§è¡Œç»“æœ</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œå¼€å§‹çš„æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token plain"> toolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œå®Œæˆçš„æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token plain"> toolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œçš„é”™è¯¯ä¿¡æ¯</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> errorMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œè¾“å…¥</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolInput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œè€—æ—¶</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Long</span><span class="token plain"> toolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool è®°å½•toolè¿”å›çš„ä¸­é—´ç»“æœ</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>MCP Service å®ç°ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAMcpService</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallbackProvider</span><span class="token plain"> tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingManager</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAMcpService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAMcpService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallbackProvider</span><span class="token plain"> tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingManager</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"openAiChatModel"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">objectMapper </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">mcpStdioClientProperties </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Initialize chat client with non-blocking configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						simpleLoggerAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultToolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">tools </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">toolCallingManager </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">initMcpServerContainer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// manual run tools flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatOptions</span><span class="token plain"> chatOptions </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingChatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">internalToolExecutionEnabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatResponse</span><span class="token plain"> response </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ChatResponse: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">assert</span><span class="token plain"> response </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">AssistantMessage</span><span class="token generics class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ToolCall</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> toolCalls </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ToolCalls: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> responseByLLm </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Response by LLM: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// execute tools with no chat memory messages.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">var</span><span class="token plain"> tcr </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">TCR</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startExecute</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">arguments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolParameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">arguments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Start ToolCallResp: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolExecutionResult</span><span class="token plain"> toolExecutionResult </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				toolExecutionResult </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">executeToolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">FAILURE</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setErrorMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Error ToolCallResp: {}, msg: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// throw new RuntimeException("Tool execution failed, please check the logs for details.");</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> llmCallResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nonNull</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatResponse</span><span class="token plain"> finalResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">messages</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">conversationHistory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">finalResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					llmCallResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> finalResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token plain"> sb </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">conversationHistory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">message </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> message </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">instanceof</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolResponseMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">message </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolResponseMessage</span><span class="token plain"> toolResponseMessage </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolResponseMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> message</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							toolResponseMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResponses</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tooResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">								sb</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">append</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tooResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">responseData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">sb</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">SUCCESS</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">llmCallResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"End ToolCallResp: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ToolCalls is empty, no tool execution needed."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> envs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Optional</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> runMcpServer </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerContainer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getServerById</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">runMcpServer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"McpServer not found, id: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">TCR</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> runMcpServerName </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> runMcpServer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">var</span><span class="token plain"> mcpServerConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Parameters</span><span class="token plain"> parameters </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">runMcpServerName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">command</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">runMcpServerName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				envs</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">command</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"java"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> oldMcpLibsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> rewriteMcpLibsAbsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpLibsAbsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">remove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">oldMcpLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">rewriteMcpLibsAbsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> mcpServerConfigJSON </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">writeValueAsString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setServersConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ByteArrayResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpServerConfigJSON</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getBytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Function Call å‚è€ƒï¼š<a href="https://docs.spring.io/spring-ai/reference/api/tools.html" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/api/tools.html</a></p>
<p>MCP Server æ–‡ç« å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-alibaba-mcp/?spm=5176.29160081.0.0.2856aa5cenvkmu" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-alibaba-mcp/?spm=5176.29160081.0.0.2856aa5cenvkmu</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="34-function-call-é›†æˆ">3.4 Function Call é›†æˆ<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#34-function-call-%E9%9B%86%E6%88%90" class="hash-link" aria-label="3.4 Function Call é›†æˆçš„ç›´æ¥é“¾æ¥" title="3.4 Function Call é›†æˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>playground ä¸­å®ç°äº† Function Call çš„åŠŸèƒ½ï¼Œå’Œ MCP ä¸€æ ·ï¼Œæ”¯æŒè°ƒç”¨çŠ¶æ€æ˜¾ç¤ºã€‚å·¥å…·æµè§ˆå™¨å›æ˜¾åŒç†ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="341-function-tools-åˆå§‹åŒ–">3.4.1 Function Tools åˆå§‹åŒ–<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#341-function-tools-%E5%88%9D%E5%A7%8B%E5%8C%96" class="hash-link" aria-label="3.4.1 Function Tools åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥" title="3.4.1 Function Tools åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ Spring AI Alibaba çš„æä¾›çš„ Tool Calling Starter æ¥å¼•å…¥å·¥å…·ï¼Œä¹Ÿå¯ä»¥åƒ Playground ä¸€æ ·ï¼Œé€šè¿‡ FunctionToolCallback æ¥è‡ªå®šä¹‰å·¥å…·ã€‚</p>
<p>Playground Tools: <a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground/src/main/java/com/alibaba/cloud/ai/application/tools" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground/src/main/java/com/alibaba/cloud/ai/application/tools</a></p>
<p>Tools åˆå§‹åŒ–ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ToolCallback</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">buildBaiduTranslateTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">buildBaiduMapTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallback</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">buildBaiduTranslateTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FunctionToolCallback</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"BaiduTranslateService"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaiduTranslateTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ak</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> sk</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> restClientbuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> responseErrorHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">description</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Baidu translation function for general text translation."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputSchema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">"""</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                      {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                         "type": "object",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                         "properties": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                            "Request": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "type": "object",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "properties": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  "q": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "type": "string",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "description": "Content that needs to be translated."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  "from": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "type": "string",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "description": "Source language that needs to be translated."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  "to": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "type": "string",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "description": "Target language to translate into."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "required": ["q", "from", "to"],</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "description": "Request object to translate text to a target language."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                            },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                            "Response": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "type": "object",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "properties": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  "translatedText": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "type": "string",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "description": "The translated text."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "required": ["translatedText"],</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "description": "Response object for the translation function, containing the translated text."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                         },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                         "required": ["Request", "Response"]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                      }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                      """</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaiduTranslateTools</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaiduTranslateToolRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toolMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">returnDirect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="342-function-tools-è°ƒç”¨">3.4.2 Function Tools è°ƒç”¨<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#342-function-tools-%E8%B0%83%E7%94%A8" class="hash-link" aria-label="3.4.2 Function Tools è°ƒç”¨çš„ç›´æ¥é“¾æ¥" title="3.4.2 Function Tools è°ƒç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å®Œæˆäº†å·¥å…·å¼•å…¥æˆ–å®šä¹‰ä¹‹åã€‚æ¥ä¸‹æ¥ï¼Œä¾¿å¯ä»¥åœ¨ service ä¸­ä½¿ç”¨è¿™äº› Tools æ¥å¢å¼ºå¤§æ¨¡å‹çš„èƒ½åŠ›ã€‚å·¥å…·è°ƒç”¨ä»£ç å’Œ MCP Server Tools ç±»ä¼¼ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAToolsService</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAToolsService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingManager</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolsInit</span><span class="token plain"> toolsInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAToolsService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolsInit</span><span class="token plain"> toolsInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingManager</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MessageChatMemoryAdvisor</span><span class="token plain"> messageChatMemoryAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"openAiChatModel"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">toolsInit </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolsInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">toolCallingManager </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						simpleLoggerAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//						messageChatMemoryAdvisor</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// manual run tools flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatOptions</span><span class="token plain"> chatOptions </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingChatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolsInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">internalToolExecutionEnabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token plain"> userPrompt </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatResponse</span><span class="token plain"> response </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">userPrompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ChatResponse: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">assert</span><span class="token plain"> response </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">AssistantMessage</span><span class="token generics class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ToolCall</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> toolCalls </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ToolCalls: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> responseByLLm </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Response by LLM: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// execute tools with no chat memory messages.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">var</span><span class="token plain"> tcr </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">TCR</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startExecute</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">arguments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Start ToolCallResp: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolExecutionResult</span><span class="token plain"> toolExecutionResult </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				toolExecutionResult </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">executeToolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">FAILURE</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setErrorMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Error ToolCallResp: {}, msg: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// throw new RuntimeException("Tool execution failed, please check the logs for details.");</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> llmCallResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nonNull</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//				ToolResponseMessage toolResponseMessage = (ToolResponseMessage) toolExecutionResult.conversationHistory()</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//						.get(toolExecutionResult.conversationHistory().size() - 1);</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//				llmCallResponse = toolResponseMessage.getResponses().get(0).responseData();</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatResponse</span><span class="token plain"> finalResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">messages</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">conversationHistory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				llmCallResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> finalResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">SUCCESS</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">llmCallResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"End ToolCallResp: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ToolCalls is empty, no tool execution needed."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Function Tools é›†æˆæ–‡ç« å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-toolcalling/?spm=5176.29160081.0.0.2856aa5cenvkmu" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-toolcalling/?spm=5176.29160081.0.0.2856aa5cenvkmu</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="4-æ€»ç»“">4. æ€»ç»“<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#4-%E6%80%BB%E7%BB%93" class="hash-link" aria-label="4. æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="4. æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Spring AI Alibaba å®˜æ–¹ç¤¾åŒºå¼€å‘äº†ä¸€ä¸ª<strong>åŒ…å«å®Œæ•´ <code>å‰ç«¯UI+åç«¯å®ç°</code> çš„æ™ºèƒ½ä½“ Playground ç¤ºä¾‹</strong>ã€‚æœªæ¥ç¤¾åŒºä¼šæŒç»­æ›´æ–°ç»´æŠ¤ã€‚ä»¥æ­¤æ¥æ¼”ç¤º Spring AI å’Œ Spring AI Alibaba çš„æœ€æ–°åŠŸèƒ½ã€‚</p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Spring AI Alibaba Playground" term="Spring AI Alibaba Playground"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring AI Alibaba åŠ¨æ€ Prompt æœ€ä½³å®è·µ]]></title>
        <id>https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt</id>
        <link href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt"/>
        <updated>2025-06-05T23:00:00.000Z</updated>
        <summary type="html"><![CDATA[Spring AI Alibaba ä½¿ç”¨ Nacos çš„é…ç½®ä¸­å¿ƒèƒ½åŠ›æ¥åŠ¨æ€ç®¡ç† AI åº”ç”¨çš„ Promptã€‚ä»¥æ­¤æ¥å®ç°åŠ¨æ€æ›´æ–° Prompt çš„åŠŸèƒ½ã€‚]]></summary>
        <content type="html"><![CDATA[<p>Spring AI Alibaba ä½¿ç”¨ Nacos çš„é…ç½®ä¸­å¿ƒèƒ½åŠ›æ¥åŠ¨æ€ç®¡ç† AI åº”ç”¨çš„ Promptã€‚ä»¥æ­¤æ¥å®ç°åŠ¨æ€æ›´æ–° Prompt çš„åŠŸèƒ½ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87" class="hash-link" aria-label="ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥" title="ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Nacos: å…·å¤‡é…ç½®ä¸­å¿ƒèƒ½åŠ›çš„ Nacosï¼Œæœ¬ä¾‹ä¸­ä½¿ç”¨ Nacos 2.3.0ã€‚æœ€æ–°ç‰ˆæœ¬çš„ Nacos 3.X äº¦å¯ï¼Œ</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ai-å·¥ç¨‹åˆ›å»º">AI å·¥ç¨‹åˆ›å»º<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#ai-%E5%B7%A5%E7%A8%8B%E5%88%9B%E5%BB%BA" class="hash-link" aria-label="AI å·¥ç¨‹åˆ›å»ºçš„ç›´æ¥é“¾æ¥" title="AI å·¥ç¨‹åˆ›å»ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Example å·¥ç¨‹åœ°å€ï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-nacos-prompt-example" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-nacos-prompt-example</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="pomxml">Pom.xml<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#pomxml" class="hash-link" aria-label="Pom.xmlçš„ç›´æ¥é“¾æ¥" title="Pom.xmlçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>Tips: é¡¹ç›®ä¸­å·²ç»å¼•å…¥äº† Spring AI Alibaba Bom å’Œ Spring Boot Bomã€‚å› æ­¤è¿™é‡Œçœç•¥äº†ç‰ˆæœ¬å·ã€‚æœ‰å…³ bom å®šä¹‰å‚è€ƒå¦‚ä¸Šçš„ Github ä»“åº“åœ°å€ã€‚</p>
</blockquote>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-dashscope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-nacos-prompt</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="applicationyml">Application.yml<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#applicationyml" class="hash-link" aria-label="Application.ymlçš„ç›´æ¥é“¾æ¥" title="Application.ymlçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ Nacos ç›‘å¬çš„ DataID ä»¥åŠ Nacos Server çš„ç”¨æˆ·åå’Œå¯†ç ç­‰ä¿¡æ¯ã€‚</p>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">server</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">port</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10010</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">application</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">alibaba</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">nacos</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">example</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŒ‡å®šç›‘å¬çš„ prompt é…ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">config</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">import</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"optional:nacos:prompt-config.json"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">nacos</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">username</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> nacos</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">password</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> nacos</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å¼€å¯ nacos çš„ prompt tmpl ç›‘å¬åŠŸèƒ½</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">nacos</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">template</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">enabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="controller">Controller<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#controller" class="hash-link" aria-label="Controllerçš„ç›´æ¥é“¾æ¥" title="Controllerçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/nacos"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">org</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">slf4j</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurablePromptTemplateFactory</span><span class="token plain"> promptTemplateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurablePromptTemplateFactory</span><span class="token plain"> promptTemplateFactory</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">client </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">promptTemplateFactory </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> promptTemplateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/books"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">generateJoke</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestParam</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">value </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> required </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> defaultValue </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"é²è¿…"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> authorName</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä½¿ç”¨ nacos çš„ prompt tmpl åˆ›å»º prompt</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurablePromptTemplate</span><span class="token plain"> template </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> promptTemplateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"please list the three most famous books by this {author}."</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token plain"> prompt </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> template</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> authorName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"æœ€ç»ˆæ„å»ºçš„ prompt ä¸ºï¼š{}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getContents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="nacos-é…ç½®æ·»åŠ ">Nacos é…ç½®æ·»åŠ <a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#nacos-%E9%85%8D%E7%BD%AE%E6%B7%BB%E5%8A%A0" class="hash-link" aria-label="Nacos é…ç½®æ·»åŠ çš„ç›´æ¥é“¾æ¥" title="Nacos é…ç½®æ·»åŠ çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>
<p>å¯åŠ¨ Nacos æœåŠ¡ï¼›</p>
</li>
<li>
<p>å†™å…¥é…ç½®ï¼ŒdataId ä¸ºï¼šspring.ai.alibaba.configurable.prompt</p>
</li>
<li>
<p>åœ¨é…ç½®ä¸­å†™å…¥å¦‚ä¸‹é…ç½®ï¼š</p>
<div class="language-json codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-json codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"name"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"template"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"åˆ—å‡º {author} æœ‰åçš„è‘—ä½œ"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"model"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token property" style="color:hsl(5, 74%, 59%)">"key"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä½™å"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åŠŸèƒ½æ¼”ç¤º">åŠŸèƒ½æ¼”ç¤º<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#%E5%8A%9F%E8%83%BD%E6%BC%94%E7%A4%BA" class="hash-link" aria-label="åŠŸèƒ½æ¼”ç¤ºçš„ç›´æ¥é“¾æ¥" title="åŠŸèƒ½æ¼”ç¤ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å®Œæˆä¸Šè¿°é…ç½®ä¹‹åï¼Œå¯åŠ¨é¡¹ç›®ï¼š</p>
<ol>
<li>
<p>åœ¨å¯åŠ¨æ—¥å¿—ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼Œè¡¨æ˜å·²ç»å¼€å§‹ç›‘å¬æ­¤ DataID çš„é…ç½®ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">OnPromptTemplateConfigChange,templateName:author,template:åˆ—å‡º </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">author</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> æœ‰åçš„è‘—ä½œï¼Œåªéœ€è¦ä¹¦åæ¸…å•,model:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">key</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">ä½™å</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å‘é€è¯·æ±‚æŸ¥çœ‹è¾“å‡ºï¼š</p>
<blockquote>
<p>Tips: è¿™é‡Œè¾“å‡ºäº†é²è¿…çš„ä½œå“é›†æ˜¯å› ä¸ºåœ¨ controller ä¸­è®¾ç½®äº† defaultValue ä¸ºé²è¿….</p>
</blockquote>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token constant" style="color:hsl(35, 99%, 36%)">GET</span><span class="token plain"> http</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token number" style="color:hsl(35, 99%, 36%)">127.0</span><span class="token number" style="color:hsl(35, 99%, 36%)">.0</span><span class="token number" style="color:hsl(35, 99%, 36%)">.1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token number" style="color:hsl(35, 99%, 36%)">10010</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">nacos</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">books</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">1.</span><span class="token plain"> ã€Šå‘å–Šã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">2.</span><span class="token plain"> ã€Šå½·å¾¨ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">3.</span><span class="token plain"> ã€ŠæœèŠ±å¤•æ‹¾ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">4.</span><span class="token plain"> ã€Šé˜¿</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Q</span><span class="token plain">æ­£ä¼ ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">5.</span><span class="token plain"> ã€Šé‡è‰ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">6.</span><span class="token plain"> ã€ŠåŸã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">7.</span><span class="token plain"> ã€Šçƒ­é£ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">8.</span><span class="token plain"> ã€Šåç›–é›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">9.</span><span class="token plain"> ã€Šåç›–é›†ç»­ç¼–ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">10.</span><span class="token plain"> ã€Šæ•…äº‹æ–°ç¼–ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">11.</span><span class="token plain"> ã€Šä¸‰é—²é›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">12.</span><span class="token plain"> ã€ŠäºŒå¿ƒé›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">13.</span><span class="token plain"> ã€Šå—è…”åŒ—è°ƒé›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">14.</span><span class="token plain"> ã€Šä¼ªè‡ªç”±ä¹¦ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">15.</span><span class="token plain"> ã€Šå‡†é£æœˆè°ˆã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">16.</span><span class="token plain"> ã€ŠèŠ±è¾¹æ–‡å­¦ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">17.</span><span class="token plain"> ã€Šä¸”ä»‹äº­æ‚æ–‡ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">18.</span><span class="token plain"> ã€Šä¸”ä»‹äº­æ‚æ–‡äºŒé›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">19.</span><span class="token plain"> ã€Šä¸”ä»‹äº­æ‚æ–‡æœ«ç¼–ã€‹</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">åˆ—å‡º é²è¿… æœ‰åçš„è‘—ä½œï¼Œåªéœ€è¦ä¹¦åæ¸…å•</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>åŠ¨æ€æ›´æ–° Nacos çš„ Prompt é…ç½®ï¼Œå†æ¬¡æŸ¥çœ‹è¯·æ±‚æŸ¥çœ‹æ•ˆæœ</p>
<blockquote>
<p>Tips: å› ä¸º controller ä¸­è®¾ç½®äº† defaultValue ä¸ºé²è¿…ï¼Œå› æ­¤ Prompt å˜æ›´ä»ç„¶å’Œæ–‡å­¦ä½œå®¶ç›¸å…³ã€‚</p>
</blockquote>
<p>å˜æ›´ Prompt ä¸ºï¼š</p>
<div class="language-json codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-json codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"name"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"template"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä»‹ç» {author}ï¼Œåˆ—å‡ºå…¶ç”Ÿå¹³ç»å†å’Œæ–‡å­¦æˆå°±"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"model"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token property" style="color:hsl(5, 74%, 59%)">"key"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä½™å"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ç‚¹å‡»å‘å¸ƒ</strong>ä¹‹åï¼Œçœ‹åˆ°æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼Œè¯æ˜å˜æ›´æˆåŠŸï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">OnPromptTemplateConfigChange,templateName:author,template:ä»‹ç» {author}ï¼Œåˆ—å‡ºå…¶ç”Ÿå¹³ç»å†å’Œæ–‡å­¦æˆå°±,model:{key=ä½™å</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å†æ¬¡å‘é€è¯·æ±‚ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://127.0.0.1:10010/nacos/books</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">é²è¿…ï¼ˆ1881å¹´9æœˆ25æ—¥ï¼1936å¹´10æœˆ19æ—¥ï¼‰ï¼ŒåŸåå‘¨æ ‘äººï¼Œå­—è±«æ‰ï¼Œæµ™æ±Ÿç»å…´äººï¼Œæ˜¯ä¸­å›½ç°ä»£æ–‡å­¦å²ä¸Šæœ€é‡è¦çš„ä½œå®¶ä¹‹ä¸€ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ€æƒ³å®¶ã€é©å‘½å®¶å’Œæ•™è‚²å®¶ã€‚ä»–ä»¥å…¶çŠ€åˆ©çš„ç¬”é”‹å’Œæ·±åˆ»çš„ç¤¾ä¼šæ‰¹åˆ¤ç²¾ç¥ï¼Œæˆä¸ºä¸­å›½æ–°æ–‡åŒ–è¿åŠ¨çš„æ——æ‰‹å’Œå¥ åŸºäººä¹‹ä¸€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">---</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">### **ç”Ÿå¹³ç»å†**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">. **æ—©å¹´ç”Ÿæ´»ä¸æ±‚å­¦**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1881</span><span class="token plain">å¹´å‡ºç”Ÿäºæµ™æ±Ÿç»å…´çš„ä¸€ä¸ªä¹¦é¦™é—¨ç¬¬å®¶åº­ï¼Œçˆ¶äº²å‘¨ä¼¯å®œæ˜¯ç§€æ‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - å°‘å¹´æ—¶å› å®¶åº­å˜æ•…è€Œç»å†äº†ä»å¯Œåˆ°è´«çš„ç”Ÿæ´»å˜åŒ–ï¼Œè¿™å¯¹ä»–åæ¥çš„æ€æƒ³å½¢æˆäº§ç”Ÿäº†æ·±è¿œå½±å“ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1898</span><span class="token plain">å¹´ï¼Œè€ƒå…¥å—äº¬æ°´å¸ˆå­¦å ‚ï¼Œåè½¬å…¥æ±Ÿå—é™†å¸ˆå­¦å ‚é™„è®¾çŸ¿åŠ¡é“è·¯å­¦å ‚å­¦ä¹ ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain">. **ç•™å­¦æ—¥æœ¬**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1902</span><span class="token plain">å¹´èµ´æ—¥æœ¬ç•™å­¦ï¼Œå…ˆåœ¨ä¸œäº¬å¼˜æ–‡å­¦é™¢å­¦ä¹ æ—¥è¯­ï¼Œåè¿›å…¥ä»™å°åŒ»å­¦ä¸“é—¨å­¦æ ¡ï¼ˆä»Šä¸œåŒ—å¤§å­¦åŒ»å­¦éƒ¨ï¼‰å­¦ä¹ åŒ»å­¦ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - åœ¨æ—¥æœ¬æœŸé—´ï¼Œé€æ¸è®¤è¯†åˆ°â€œåŒ»å…¶å¿ƒâ€æ¯”â€œåŒ»å…¶èº«â€æ›´é‡è¦ï¼Œå†³å®šå¼ƒåŒ»ä»æ–‡ï¼Œä»¥æ–‡å­¦å”¤é†’å›½æ°‘çš„ç²¾ç¥ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token plain">. **å›å›½ä¸æ•™ä¹¦ç”Ÿæ¶¯**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1909</span><span class="token plain">å¹´å›å›½åï¼Œå…ˆååœ¨åŒ—äº¬å¤§å­¦ã€åŒ—äº¬å¸ˆèŒƒå¤§å­¦ç­‰é«˜æ ¡ä»»æ•™ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä»äº‹æ–‡å­¦åˆ›ä½œçš„åŒæ—¶ï¼Œç§¯æå‚ä¸æ–°æ–‡åŒ–è¿åŠ¨ï¼Œæ¨åŠ¨ç™½è¯æ–‡å’Œæ–°æ–‡å­¦çš„å‘å±•ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">4</span><span class="token plain">. **åˆ›ä½œé«˜å³°**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1918</span><span class="token plain">å¹´å‘è¡¨ç¬¬ä¸€ç¯‡ç™½è¯å°è¯´ã€Šç‹‚äººæ—¥è®°ã€‹ï¼Œæ ‡å¿—ç€ä¸­å›½ç°ä»£å°è¯´çš„å¼€ç«¯ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - æ­¤åï¼Œé²è¿…çš„åˆ›ä½œè¿›å…¥é«˜å³°æœŸï¼Œå‘è¡¨äº†å¤§é‡æ‚æ–‡ã€å°è¯´ã€æ•£æ–‡ç­‰ä½œå“ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">5</span><span class="token plain">. **æ™šå¹´ç”Ÿæ´»**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1927</span><span class="token plain">å¹´åå®šå±…ä¸Šæµ·ï¼Œç»§ç»­å†™ä½œå¹¶å‚ä¸å·¦ç¿¼æ–‡åŒ–æ´»åŠ¨ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1936</span><span class="token plain">å¹´å› è‚ºç—…åœ¨ä¸Šæµ·é€ä¸–ï¼Œäº«å¹´55å²ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">---</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">### **æ–‡å­¦æˆå°±**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">é²è¿…çš„ä½œå“æ¶µç›–äº†å°è¯´ã€æ•£æ–‡ã€æ‚æ–‡ã€è¯—æ­Œç­‰å¤šä¸ªé¢†åŸŸï¼Œå…·æœ‰æé«˜çš„è‰ºæœ¯ä»·å€¼å’Œç¤¾ä¼šæ„ä¹‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#### 1. **å°è¯´**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…çš„å°è¯´ä»¥æ·±åˆ»æ­ç¤ºç¤¾ä¼šé—®é¢˜å’Œäººæ€§å¼±ç‚¹è‘—ç§°ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä»£è¡¨ä½œï¼š</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     - ã€Šå‘å–Šã€‹ï¼šåŒ…æ‹¬ã€Šç‹‚äººæ—¥è®°ã€‹ã€Šé˜¿Qæ­£ä¼ ã€‹ã€Šæ•…ä¹¡ã€‹ç­‰ï¼Œæ­éœ²å°å»ºåˆ¶åº¦å¯¹äººçš„å‹è¿«ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     - ã€Šå½·å¾¨ã€‹ï¼šåŒ…æ‹¬ã€Šç¥ç¦ã€‹ã€Šä¼¤é€ã€‹ç­‰ï¼Œæå†™çŸ¥è¯†åˆ†å­çš„è¿·èŒ«ä¸æŒ£æ‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - è¢«èª‰ä¸ºâ€œä¸­å›½ç°ä»£å°è¯´ä¹‹çˆ¶â€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#### 2. **æ•£æ–‡**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - æ•£æ–‡é›†ã€ŠæœèŠ±å¤•æ‹¾ã€‹æ˜¯é²è¿…å›å¿†ç«¥å¹´å’Œé’å°‘å¹´ç”Ÿæ´»çš„ä½œå“ï¼Œè¯­è¨€ä¼˜ç¾ï¼Œæƒ…æ„ŸçœŸæŒšã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä»£è¡¨ä½œï¼šã€Šä»ç™¾è‰å›­åˆ°ä¸‰å‘³ä¹¦å±‹ã€‹ã€Šè—¤é‡å…ˆç”Ÿã€‹ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#### 3. **æ‚æ–‡**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…çš„æ‚æ–‡ä»¥çŠ€åˆ©çš„ç¬”è§¦æ‰¹åˆ¤ç¤¾ä¼šç°å®ï¼Œè¢«èª‰ä¸ºâ€œåŒ•é¦–ä¸æŠ•æªâ€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - æ‚æ–‡é›†ï¼šã€Šçƒ­é£ã€‹ã€Šåç›–é›†ã€‹ã€ŠåŸã€‹ã€Šä¸”ä»‹äº­æ‚æ–‡ã€‹ç­‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä¸»è¦é’ˆå¯¹å°å»ºç¤¼æ•™ã€å†›é˜€ç»Ÿæ²»ã€æ–‡åŒ–ä¿å®ˆä¸»ä¹‰ç­‰è¿›è¡Œæ‰¹åˆ¤ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#### 4. **ç¿»è¯‘ä¸ç ”ç©¶**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…è¿˜ç¿»è¯‘äº†è®¸å¤šå¤–å›½æ–‡å­¦ä½œå“ï¼Œå¦‚ä¿„å›½æœæˆˆé‡Œçš„ã€Šæ­»é­‚çµã€‹ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - åŒæ—¶è‡´åŠ›äºä¸­å›½å¤ä»£æ–‡åŒ–çš„æ•´ç†ä¸ç ”ç©¶ï¼Œå‡ºç‰ˆäº†ã€Šä¸­å›½å°è¯´å²ç•¥ã€‹ã€Šæ±‰æ–‡å­¦å²çº²è¦ã€‹ç­‰å­¦æœ¯è‘—ä½œã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">---</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">### **å†å²åœ°ä½ä¸å½±å“**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">. **å¯¹ä¸­å›½æ–‡å­¦çš„è´¡çŒ®**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…å¼€åˆ›äº†ä¸­å›½ç°ä»£æ–‡å­¦çš„æ–°å±€é¢ï¼Œä»–çš„ä½œå“å¥ å®šäº†ä¸­å›½ç°ä»£æ–‡å­¦çš„åŸºç¡€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - æå€¡ç™½è¯æ–‡ï¼Œæ¨åŠ¨æ–‡å­¦è¯­è¨€çš„ç°ä»£åŒ–ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain">. **å¯¹ç¤¾ä¼šæ€æƒ³çš„å½±å“**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…çš„æ€æƒ³æ·±åˆ»å½±å“äº†å‡ ä»£ä¸­å›½äººï¼Œç‰¹åˆ«æ˜¯åœ¨åå¯¹å°å»ºç¤¼æ•™ã€å€¡å¯¼æ€æƒ³è§£æ”¾æ–¹é¢ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä»–çš„æ‚æ–‡æˆä¸ºæ‰¹è¯„ç¤¾ä¼šä¸å…¬å’Œæ­éœ²é»‘æš—çš„å…¸èŒƒã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token plain">. **å›½é™…å£°èª‰**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…çš„ä½œå“è¢«ç¿»è¯‘æˆå¤šç§è¯­è¨€ï¼Œåœ¨ä¸–ç•ŒèŒƒå›´å†…äº«æœ‰ç››èª‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - è¢«èª‰ä¸ºâ€œä¸­å›½çš„è‰¯å¿ƒâ€å’Œâ€œæ°‘æ—é­‚â€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">é²è¿…çš„ä¸€ç”Ÿï¼Œæ—¢æ˜¯å¯¹ä¼ ç»Ÿæ–‡åŒ–çš„åæ€ï¼Œä¹Ÿæ˜¯å¯¹ç°ä»£ç¤¾ä¼šçš„æ¢ç´¢ã€‚ä»–çš„ä½œå“è‡³ä»Šä»å…·æœ‰å¼ºå¤§çš„ç”Ÿå‘½åŠ›å’Œç°å®æ„ä¹‰ã€‚</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æœ€ç»ˆæ„å»ºçš„ Prompt ä¸ºï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä»‹ç» é²è¿…ï¼Œåˆ—å‡ºå…¶ç”Ÿå¹³ç»å†å’Œæ–‡å­¦æˆå°±</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Spring AI Alibaba" term="Spring AI Alibaba"/>
        <category label="Nacos" term="Nacos"/>
        <category label="Dunamic Prompt" term="Dunamic Prompt"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Opentelemetry é¡¹ç›®è§£è¯»]]></title>
        <id>https://yuluo-yx.github.io/blog/opentelemetry-project</id>
        <link href="https://yuluo-yx.github.io/blog/opentelemetry-project"/>
        <updated>2025-04-19T17:44:00.000Z</updated>
        <summary type="html"><![CDATA[1. ä»€ä¹ˆæ˜¯ Opentelmetry]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-ä»€ä¹ˆæ˜¯-opentelmetry">1. ä»€ä¹ˆæ˜¯ Opentelmetry<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#1-%E4%BB%80%E4%B9%88%E6%98%AF-opentelmetry" class="hash-link" aria-label="1. ä»€ä¹ˆæ˜¯ Opentelmetryçš„ç›´æ¥é“¾æ¥" title="1. ä»€ä¹ˆæ˜¯ Opentelmetryçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Ot ç»Ÿä¸€äº†å¯è§‚æµ‹çš„ä¸‰ä¸ªé‡è¦ç»´åº¦ï¼šåˆ†åˆ«æ˜¯ Traceï¼ŒLogï¼ŒMetricsã€‚</p>
<p>åœ¨æ²¡æœ‰ ot ä¹‹å‰ï¼Œä¸åŒç»´åº¦çš„å¯è§‚æµ‹ç»„ä»¶éƒ½æ˜¯ä¸åŒçš„ï¼š</p>
<ol>
<li>åœ¨ Trace é¢†åŸŸï¼šskywalking ä¸€ç›´å¾ˆå—æ¬¢è¿ï¼›</li>
<li>åœ¨ Metrics é¢†åŸŸï¼šä¸»è¦ä»¥ Prometheus ä¸ºä¸»ï¼ŒVictoriaMetric ä¹Ÿå¾ˆå—æ¬¢è¿ï¼Œå ç”¨èµ„æºæ›´å°‘ï¼›</li>
<li>åœ¨ Log é¢†åŸŸï¼šELK ç»ä¹…ä¸è¡°ã€‚</li>
</ol>
<p>ä¸è¿‡ä¸ºäº†è§£å†³å¯è§‚æµ‹è¿™ä¸€é—®é¢˜ï¼ŒåŒæ—¶å¼•å…¥ä¸‰ä¸ªç»„ä»¶ï¼Œå¯¼è‡´æŠ€æœ¯æ ˆä¼—å¤šï¼Œç»´æŠ¤éº»çƒ¦ã€‚ot ä¾¿æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè®©å¼€å‘è€…èƒ½èŠ±è´¹å°‘é‡ç²¾åŠ›å®Œæˆå¯è§‚æµ‹å»ºè®¾ã€‚</p>
<p>ç”±  OpenTracingï¼ŒOpenCensus åˆå¹¶å…±åŒå‘å±•è€Œæ¥ã€‚ç°åœ¨å·²ç»æ˜¯ CNCF çš„é¡¶çº§é¡¹ç›®äº†ï¼Œå¹¶ä¸”å—åˆ°äº†å¾ˆå¤šå¤§å‚çš„æ”¯æŒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="11-opentelmetry-æ¶æ„">1.1 OpenTelmetry æ¶æ„<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#11-opentelmetry-%E6%9E%B6%E6%9E%84" class="hash-link" aria-label="1.1 OpenTelmetry æ¶æ„çš„ç›´æ¥é“¾æ¥" title="1.1 OpenTelmetry æ¶æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><img decoding="async" loading="lazy" alt="ot æ¶æ„" src="https://yuluo-yx.github.io/assets/images/ot-1-9ecb5fc7630c2aa60d7aac6b90d569be.png" width="1400" height="670" class="img_c29J"></p>
<p>ä»ä¸Šå›¾ä¸­çœ‹åˆ°ï¼Œæ•´ä¸ª Oentelmetry ç³»ç»Ÿå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªç»„æˆéƒ¨åˆ†ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="111-å®¢æˆ·ç«¯">1.1.1 å®¢æˆ·ç«¯<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#111-%E5%AE%A2%E6%88%B7%E7%AB%AF" class="hash-link" aria-label="1.1.1 å®¢æˆ·ç«¯çš„ç›´æ¥é“¾æ¥" title="1.1.1 å®¢æˆ·ç«¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å®¢æˆ·ç«¯å°±æ˜¯æˆ‘ä»¬ç¼–å†™å¾—ä¸šåŠ¡ç³»ç»Ÿçš„æœåŠ¡ï¼Œç”¨ Go æˆ–è€… Java ç¼–å†™ã€‚å¦‚æœæ˜¯ Java åº”ç”¨ï¼Œåœ¨ ot ä¸­ï¼Œåªéœ€è¦æŒ‚è½½ä¸€ä¸ª agent å°±å¯ä»¥é‡‡é›†åˆ°ç³»ç»Ÿçš„æŒ‡æ ‡ï¼Œé“¾è·¯å’Œæ—¥å¿—æ•°æ®ä¸Šä¼ åˆ° Collector ä¸­ã€‚æ—¢æ¶æ„å›¾ä¸­çš„å·¦è¾¹éƒ¨åˆ†ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="112-otel-collector">1.1.2 Otel Collector<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#112-otel-collector" class="hash-link" aria-label="1.1.2 Otel Collectorçš„ç›´æ¥é“¾æ¥" title="1.1.2 Otel Collectorçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><img decoding="async" loading="lazy" alt="ot collector" src="https://yuluo-yx.github.io/assets/images/ot-2-eabbe2f740abac90c5c8e9dc18df0b14.png" width="984" height="698" class="img_c29J"></p>
<p>ot åœ¨è®¾è®¡æœ€åˆçš„ç›®çš„æ˜¯è¦åšåˆ°å‚å•†æ— å…³æ€§ï¼Œä¸å’Œä»»æ„ä¸€ä¸ªå‚å•†æˆ–è€…äº§å“ç»‘å®šã€‚å› æ­¤åœ¨ collector åšäº†æ›´é«˜å±‚çš„æŠ½è±¡è®¾è®¡ã€‚</p>
<p>å¦‚å›¾ä¸­çš„æ•°æ®æ¥å—å’Œå¯¼å‡ºç»„ä»¶ï¼ŒReceiverå’Œ Exporterã€‚éƒ½é‡‡ç”¨å¯æ’æ‹”çš„è®¾è®¡æ–¹å¼ã€‚ç¬¬ä¸‰æ–¹çš„å¼€å‘è€…å¯ä»¥åŸºäº ot çš„æ ‡å‡†åè®®å¼€å‘ä¸åŒçš„ Receiverå’Œ Exporter ç»„ä»¶æ¥å…¼å®¹ä¸åŒçš„äº§å“ï¼Œä»è€Œåšåˆ°å‚å•†æ— å…³æ€§ã€‚</p>
<p>Receiverï¼šç”¨äºæ¥å—å®¢æˆ·ç«¯ä¸ŠæŠ¥çš„æ•°æ®ï¼Œä¸æ­¢æ˜¯æ¥è‡ª agent çš„æ•°æ®ï¼Œä¹Ÿæœ‰å¯èƒ½æ¥è‡ªä¸åŒçš„æœåŠ¡äº§å“ã€‚ä¾‹å¦‚ k8sï¼Œkafka ç­‰ã€‚</p>
<p>Exporterï¼šåœ¨æ¥æ”¶åˆ° Receiverçš„æ•°æ®ï¼Œç”± collector å¤„ç†ä¹‹åå¯ä»¥å°†å…¶è¾“å‡ºåˆ°ä¸åŒçš„ç»„ä»¶ä¸­ï¼Œæ¯”å¦‚ï¼šKafkaï¼ŒJaeger ç­‰ã€‚</p>
<p>åœ¨ä½¿ç”¨ ot æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Nginx Receiveræ¥å—æ¥è‡ª nginx çš„æ•°æ®ï¼Œä½¿ç”¨ MySQL Receiveræ¥å—æ¥è‡ª MySQL çš„æ•°æ®ç­‰ã€‚é€šå¸¸ä½¿ç”¨æœ€å¤šçš„æ˜¯ otel Receiverï¼Œot å®˜æ–¹çš„ OTLP åè®®çš„æ•°æ®æ¥æ”¶å™¨ï¼Œæ¥å—æ¥è‡ª ot çš„ä¸€äº›æŒ‡æ ‡ã€‚ä¾‹å¦‚åªä½¿ç”¨äº† Java agent ä¸ŠæŠ¥å¯è§‚æµ‹æ•°æ®æ—¶ã€‚</p>
<p>Exporter ä¸»è¦è´Ÿè´£å°†ä¸åŒçš„æŒ‡æ ‡æ•°æ®å†™å…¥åˆ°ä¸åŒçš„ç»„ä»¶ä¸­ï¼Œä¾‹å¦‚å°†æŒ‡æ ‡ç›¸å…³æ•°æ®å†™å…¥åˆ° Prometheusï¼Œæ—¥å¿—å†™å…¥åˆ° es ç­‰ã€‚</p>
<p>å¯¹æ¯”ä¹‹ä¸‹ï¼Œot collector çš„ Receiver å’Œ Exporter å¯ä»¥éå¸¸çµæ´»çš„æ­é…ï¼Œæ•°æ®å­˜å‚¨çš„å˜æ›´ï¼Œä¸ä¼šç›´æ¥å½±å“åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚ä¸šåŠ¡ç³»ç»Ÿåªéœ€è¦æŒ‰ç…§ OTLP åè®®çš„æ ¼å¼ä¸ŠæŠ¥æ•°æ®å³å¯ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-opentelmetry-é¡¹ç›®">2. Opentelmetry é¡¹ç›®<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#2-opentelmetry-%E9%A1%B9%E7%9B%AE" class="hash-link" aria-label="2. Opentelmetry é¡¹ç›®çš„ç›´æ¥é“¾æ¥" title="2. Opentelmetry é¡¹ç›®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä»ä¸Šé¢çš„æ¶æ„å›¾äº†è§£åˆ°ï¼šot çš„æ•´ä¸ªé¡¹ç›®ä¸»è¦åˆ†ä¸ºå®¢æˆ·ç«¯å’Œ collector ç«¯ã€‚é™¤äº† java ä¹‹å¤–ï¼Œot è¿˜æ”¯æŒå…¶ä»–è¯­è¨€çš„å®¢æˆ·ç«¯ã€‚å¤§éƒ¨åˆ†éƒ½è¾¾åˆ°äº†ç”Ÿäº§å¯ç”¨çš„ç¨‹åº¦ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæ·±å…¥äº†è§£ä¸‹ opentelemetry-java å’Œ opentelemetry-java-instrumentationã€‚</p>
<p>åœ¨æ—¥å¸¸ä½¿ç”¨ä¸­ï¼Œç”¨åˆ°æœ€å¤šçš„é¡¹ç›®æ˜¯ï¼šopentelemetry-java-instrumentationã€‚æä¾›äº† ot çš„ java agent ã€‚</p>
<p>åœ¨å¯åŠ¨é¡¹ç›®æ—¶ï¼Œåªéœ€è¦åŠ ä¸Š java agent å°±å¯ä»¥è‡ªåŠ¨å®ç°å¯è§‚æµ‹æ•°æ®çš„ä¸ŠæŠ¥ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> -javaagent:path/to/opentelemetry-javaagent.jar </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-jar</span><span class="token plain"> myapp.jar</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-opentelemetry-java">2.1 opentelemetry-java<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#21-opentelemetry-java" class="hash-link" aria-label="2.1 opentelemetry-javaçš„ç›´æ¥é“¾æ¥" title="2.1 opentelemetry-javaçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>opentelemetry-java-instrumentation åŸºäº opentelemetry-java åˆ›å»ºã€‚æ˜¯ ot Java ç‰ˆæœ¬çš„æ ¸å¿ƒåŸºç¡€åº“ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-opentelemetry-java-instrumentation">2.2 opentelemetry-java-instrumentation<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#22-opentelemetry-java-instrumentation" class="hash-link" aria-label="2.2 opentelemetry-java-instrumentationçš„ç›´æ¥é“¾æ¥" title="2.2 opentelemetry-java-instrumentationçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>é›†æˆäº†å¸¸ç”¨çš„ Java çš„ä¸åŒæ¡†æ¶ï¼Œåº“çš„å¯è§‚æµ‹æ•°æ®ã€‚</p>
<p>å…¶ä»–é¡¹ç›®å¤§è‡´ç»“æ„ç±»ä¼¼ã€‚ä¾‹å¦‚ collector åˆ†ä¸ºï¼š<strong>OpenTelemetry Collector</strong> å’Œ <strong>OpenTelemetry Collector Contrib</strong></p>
<p>opentelemetry-collectorï¼šç”± ot å®˜æ–¹ç»´æŠ¤ï¼Œæä¾›æœ€åŸºç¡€çš„æ ¸å¿ƒèƒ½åŠ›ï¼›æ¯”å¦‚åªåŒ…å«äº†æœ€åŸºæœ¬çš„ otlp çš„ receiver å’Œ exporterã€‚</p>
<p>opentelemetry-collector-contribï¼šåŒ…å«äº†å®˜æ–¹çš„ collectorï¼ŒåŒæ—¶ç»´æŠ¤äº†ç¤¾åŒºæä¾›çš„å„ç§ receiver å’Œ exporterï¼›å°±å¦‚ä¸Šæ–‡æåˆ°çš„ï¼Œä¸€äº›ç¤¾åŒºç»„ä»¶ï¼ˆpulsarã€MySQLã€Kafkaï¼‰ç­‰éƒ½ç»´æŠ¤åœ¨è¿™ä¸ªä»“åº“ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-æ€»ç»“">3. æ€»ç»“<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#3-%E6%80%BB%E7%BB%93" class="hash-link" aria-label="3. æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="3. æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>OpenTelemetry æƒ³è¦è§£å†³çš„æ˜¯æ•´ä¸ªå¯è§‚æµ‹é¢†åŸŸçš„æ‰€æœ‰éœ€æ±‚ï¼Œåšåˆ°çœŸæ­£çš„å‚å•†æ— å…³æ€§ï¼Œå› æ­¤è‡ªèº«æœ‰éå¸¸å¤šçš„ Receiver å’Œ Exporterã€‚</p>
<p>ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œå°†ä¼šä»‹ç»å¦‚ä½•åœ¨ opentelemetry-java-instrumentation ä»“åº“ä¸­ä¸º Java åº“å’Œæ¡†æ¶æä¾›å¯è§‚æµ‹æ”¯æŒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="31-å‚è€ƒé“¾æ¥">3.1 å‚è€ƒé“¾æ¥ï¼š<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#31-%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5" class="hash-link" aria-label="3.1 å‚è€ƒé“¾æ¥ï¼šçš„ç›´æ¥é“¾æ¥" title="3.1 å‚è€ƒé“¾æ¥ï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><a href="https://juejin.cn/post/7358450927110357026?from=search-suggest" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7358450927110357026?from=search-suggest</a></p>
<p><a href="https://opentelemetry.io/ecosystem/registry/" target="_blank" rel="noopener noreferrer">https://opentelemetry.io/ecosystem/registry/</a></p>
<p><a href="https://github.com/open-telemetry/opentelemetry-java-instrumentation" target="_blank" rel="noopener noreferrer">open-telemetry/opentelemetry-java-instrumentation: OpenTelemetry auto-instrumentation and instrumentation libraries for Java</a></p>
<p><a href="https://github.com/open-telemetry/opentelemetry-java-instrumentation/blob/main/docs/supported-libraries.md#libraries--frameworks" target="_blank" rel="noopener noreferrer">https://github.com/open-telemetry/opentelemetry-java-instrumentation/blob/main/docs/supported-libraries.md#libraries--frameworks</a></p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Opentelemetry-java-instrumentation" term="Opentelemetry-java-instrumentation"/>
        <category label="OT" term="OT"/>
        <category label="Java" term="Java"/>
        <category label="OTEL" term="OTEL"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring AI å¯è§‚æµ‹æ€§]]></title>
        <id>https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations</id>
        <link href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations"/>
        <updated>2025-03-30T13:07:00.000Z</updated>
        <summary type="html"><![CDATA[ä»¥ä¸‹æœ€ä½³å®è·µåŸºäº Spring AI 1.0.0 å’Œ Spring AI Alibaba 1.0.0.2 ç‰ˆæœ¬ã€‚]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>ä»¥ä¸‹æœ€ä½³å®è·µåŸºäº Spring AI 1.0.0 å’Œ Spring AI Alibaba 1.0.0.2 ç‰ˆæœ¬ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¯è§‚æµ‹èƒŒæ™¯">å¯è§‚æµ‹èƒŒæ™¯<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#%E5%8F%AF%E8%A7%82%E6%B5%8B%E8%83%8C%E6%99%AF" class="hash-link" aria-label="å¯è§‚æµ‹èƒŒæ™¯çš„ç›´æ¥é“¾æ¥" title="å¯è§‚æµ‹èƒŒæ™¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>è½¯ä»¶çš„å¯è§‚æµ‹æ€§ï¼ˆObservabilityï¼‰æ˜¯æŒ‡é€šè¿‡ç³»ç»Ÿè¾“å‡ºï¼ˆå¦‚æ—¥å¿—ã€æŒ‡æ ‡ã€è·Ÿè¸ªç­‰ï¼‰æ¥æ¨æ–­å…¶å†…éƒ¨çŠ¶æ€çš„èƒ½åŠ›ã€‚åœ¨ Spring AI ä¸­åŸºäº Spring ç”Ÿæ€é›†æˆå¯è§‚æµ‹æ€§åŠŸèƒ½ã€‚åŒ…æ‹¬ <code>ChatClientï¼ˆåŒ…å« ChatModel å’Œ Advisorï¼ŒToolCall ç­‰ï¼‰</code> ã€<code>EmbeddingModel</code>ã€<code>ImageModel</code> å’Œ VectorStore ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="spring-ai-alibaba-å¯è§‚æµ‹æ€§">Spring AI Alibaba å¯è§‚æµ‹æ€§<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#spring-ai-alibaba-%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7" class="hash-link" aria-label="Spring AI Alibaba å¯è§‚æµ‹æ€§çš„ç›´æ¥é“¾æ¥" title="Spring AI Alibaba å¯è§‚æµ‹æ€§çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>Tips: Spring AI ä¸€äº›è¾“å‡ºå†…å®¹è¾ƒå¤§ä¸”ä¸ºäº†æ•°æ®å®‰å…¨ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹æ²¡æœ‰å¼€å¯æ‰“å°å¼€å…³ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯ã€‚</p>
<p>å‚è€ƒï¼š<a href="https://docs.spring.io/spring-ai/reference/observability/index.html#_prompt_content" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/observability/index.html#_prompt_content</a></p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åˆ›å»º-spring-ai-alibaba-é¡¹ç›®">åˆ›å»º Spring AI Alibaba é¡¹ç›®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#%E5%88%9B%E5%BB%BA-spring-ai-alibaba-%E9%A1%B9%E7%9B%AE" class="hash-link" aria-label="åˆ›å»º Spring AI Alibaba é¡¹ç›®çš„ç›´æ¥é“¾æ¥" title="åˆ›å»º Spring AI Alibaba é¡¹ç›®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¸‹æ–‡ä¸­çš„æ‰€æœ‰é¡¹ç›®ä»£ç éƒ½åœ¨ï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-observability-example/observability-example" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-observability-example/observability-example</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¼•å…¥ä¾èµ–">å¼•å…¥ä¾èµ–<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96" class="hash-link" aria-label="å¼•å…¥ä¾èµ–çš„ç›´æ¥é“¾æ¥" title="å¼•å…¥ä¾èµ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>é¡¹ç›®ä¸­åœ¨è·Ÿ pom ä¸­æå‰å¼•å…¥äº† <code>spring-ai-alibaba-bom</code>ï¼Œä¸‹æ–‡ä¸­æ²¡æœ‰åˆ—å‡ºã€‚</p>
<ol>
<li>spring-ai-alibaba-starter-dashscopeï¼š dashscope starter</li>
<li>spring-ai-alibaba-starter-tool-calling-weatherï¼šspring ai alibaba å·¥å…· starter</li>
<li>micrometer-tracing-bridge-brave zipkin-reporter-braveï¼šè§‚æµ‹ä¾èµ–</li>
</ol>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-dashscope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-tool-calling-weather</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">io.micrometer</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">micrometer-tracing-bridge-brave</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.5.0-M2</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusions</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">slf4j-api</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.slf4j</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusions</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">io.zipkin.reporter2</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">zipkin-reporter-brave</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">3.4.3</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="applicationyml-é…ç½®">application.yml é…ç½®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#applicationyml-%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="application.yml é…ç½®çš„ç›´æ¥é“¾æ¥" title="application.yml é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ol>
<li>å¼€å¯ spring ai çš„è§‚æµ‹æ€§åŠŸèƒ½</li>
<li>å¼€å¯ spring ai alibaba weather tool åŠŸèƒ½</li>
</ol>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">application</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> observability</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">models</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">dashscope</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">dashscope</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">api-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">AI_DASHSCOPE_API_KEY</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">observations</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">log-completion</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">log-prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># spring ai alibaba weather tool calling config</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">alibaba</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">toolcalling</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">weather</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">api-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">WEATHER_API_KEY</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">enabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Chat config items</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">observations</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># default value is false.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">log-prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">log-completion</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">include-error-logging</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># tools config items</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">observability</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># default value is false.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">include-content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Image observation is only support openai for spring ai.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># image:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">#   observations:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">#     log-prompt: true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">read-timeout</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> 60s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">management</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">endpoints</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">web</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">exposure</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">include</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">endpoint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">health</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># åº”ç”¨å¥åº·çŠ¶æ€æ£€æŸ¥ï¼Œæºå¸¦è¯¦ç»†æ–°å­¦å¹´</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">show-details</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> always</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">tracing</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">sampling</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># trace é‡‡æ ·ä¿¡æ¯ï¼Œè®°å½•æ¯ä¸ªè¯·æ±‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">probability</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1.0</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="controller">Controller<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#controller" class="hash-link" aria-label="Controllerçš„ç›´æ¥é“¾æ¥" title="Controllerçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æ­¤éƒ¨åˆ†ä¸º ai æœåŠ¡çš„å…·ä½“å®ç°ï¼Œä»¥ ChatClient ä¸ºä¾‹ï¼ŒEmbedding å’Œ Image ç±»ä¼¼ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/observability/chat"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModelController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModelController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token plain"> builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestParam</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">defaultValue </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"hi"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¯åŠ¨ä¾èµ–é¡¹">å¯åŠ¨ä¾èµ–é¡¹<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#%E5%90%AF%E5%8A%A8%E4%BE%9D%E8%B5%96%E9%A1%B9" class="hash-link" aria-label="å¯åŠ¨ä¾èµ–é¡¹çš„ç›´æ¥é“¾æ¥" title="å¯åŠ¨ä¾èµ–é¡¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ­¤ demo ä¸­å°†æ•°æ®å¯¼å…¥åˆ° zipkin å±•ç¤ºï¼Œå› æ­¤éœ€è¦å¯åŠ¨ä¸€ä¸ª zipkinï¼š</p>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">services</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">zipkin</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">image</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'openzipkin/zipkin:latest'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ports</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'9411:9411'</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¯è§‚æµ‹è¾“å‡º">å¯è§‚æµ‹è¾“å‡º<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#%E5%8F%AF%E8%A7%82%E6%B5%8B%E8%BE%93%E5%87%BA" class="hash-link" aria-label="å¯è§‚æµ‹è¾“å‡ºçš„ç›´æ¥é“¾æ¥" title="å¯è§‚æµ‹è¾“å‡ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="chatclient">ChatClient<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#chatclient" class="hash-link" aria-label="ChatClientçš„ç›´æ¥é“¾æ¥" title="ChatClientçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æŒ‡æ ‡ä»‹ç»ï¼š<a href="https://docs.spring.io/spring-ai/reference/observability/index.html#_chat_client" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/observability/index.html#_chat_client</a></p>
<p>åœ¨ä¸‹æ–‡ä¸­å³å¯çœ‹åˆ° chatClient ç›¸å…³çš„ä¿¡æ¯ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250604212605930" src="https://yuluo-yx.github.io/assets/images/image-20250604212605930-7e9ab8314c731b045008a9174b0452df.png" width="2555" height="679" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="toolcalling">ToolCalling<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#toolcalling" class="hash-link" aria-label="ToolCallingçš„ç›´æ¥é“¾æ¥" title="ToolCallingçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æŒ‡æ ‡ä»‹ç»ï¼š<a href="https://docs.spring.io/spring-ai/reference/observability/index.html#_tool_calling" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/observability/index.html#_tool_calling</a></p>
<p><img decoding="async" loading="lazy" alt="image-20250604212858047" src="https://yuluo-yx.github.io/assets/images/image-20250604212858047-16f24074a3e00ad0728e5b074e6d5b78.png" width="1449" height="515" class="img_c29J"></p>
<p>åœ¨ä¸‹é¢çš„ tool æ¨¡å—å¯ä»¥çœ‹åˆ° tools çš„å…¥å‚å’Œå‡ºå‚ä¿¡æ¯ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250604213730393" src="https://yuluo-yx.github.io/assets/images/image-20250604213730393-e46739a5c478fcd7ffe4f2859a53cf69.png" width="2510" height="965" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="embedding-client">Embedding Client<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#embedding-client" class="hash-link" aria-label="Embedding Clientçš„ç›´æ¥é“¾æ¥" title="Embedding Clientçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æŒ‡æ ‡å‚è€ƒï¼š<a href="https://docs.spring.io/spring-ai/reference/observability/index.html#_embeddingmodel" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/observability/index.html#_embeddingmodel</a></p>
<p><img decoding="async" loading="lazy" alt="image-20250604213822311" src="https://yuluo-yx.github.io/assets/images/image-20250604213822311-c8981158d51aec1b13da82b60e68cd22.png" width="2537" height="886" class="img_c29J"></p>
<p><img decoding="async" loading="lazy" alt="image-20250604213913992" src="https://yuluo-yx.github.io/assets/images/image-20250604213913992-1c124481f4f08d4e1e9c43ef0d796ea4.png" width="2512" height="546" class="img_c29J"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ‰©å±•-spring-ai-æŒ‡æ ‡">æ‰©å±• Spring AI æŒ‡æ ‡<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#%E6%89%A9%E5%B1%95-spring-ai-%E6%8C%87%E6%A0%87" class="hash-link" aria-label="æ‰©å±• Spring AI æŒ‡æ ‡çš„ç›´æ¥é“¾æ¥" title="æ‰©å±• Spring AI æŒ‡æ ‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Spring AI æä¾›äº† <code>ObservationHandler&lt;ChatModelObservationContext&gt;</code> æœºåˆ¶æ¥æ‰©å±•å¯è§‚æµ‹ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥åŠ å…¥æˆ–è€…æ”¹å˜è§‚æµ‹æ•°æ®ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="pom">pom<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#pom" class="hash-link" aria-label="pomçš„ç›´æ¥é“¾æ¥" title="pomçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>pom ä¸­åªéœ€å¼•å…¥å¯¹åº”çš„ starter å³å¯ã€‚</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-dashscope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="applicationyml">application.yml<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#applicationyml" class="hash-link" aria-label="application.ymlçš„ç›´æ¥é“¾æ¥" title="application.ymlçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">application</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> observationhandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">example</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="customerobservationhandler">CustomerObservationHandler<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#customerobservationhandler" class="hash-link" aria-label="CustomerObservationHandlerçš„ç›´æ¥é“¾æ¥" title="CustomerObservationHandlerçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æ‰©å±•å®ç°</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomerObservationHandler</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObservationHandler</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ChatModelObservationContext</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">onStart</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModelObservationContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"exec CustomerObservationHandler onStart function! ChatModelObservationContext: "</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">onStop</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModelObservationContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"exec CustomerObservationHandler onStop function! ChatModelObservationContext: "</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">boolean</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">supportsContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Observation</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Context</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="chat-controller">Chat Controller<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#chat-controller" class="hash-link" aria-label="Chat Controllerçš„ç›´æ¥é“¾æ¥" title="Chat Controllerçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/custom/observation/chat"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModelController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestParam</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">defaultValue </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"hi"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> message</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObservationRegistry</span><span class="token plain"> registry </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObservationRegistry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       registry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">observationConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">observationHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomerObservationHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Need to set the API key in the environment variable "AI_DASHSCOPE_API_KEY"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Spring Boot Autoconfiguration is injected use ChatClient.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DashScopeChatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">dashScopeApi</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DashScopeApi</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">apiKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getenv</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"AI_DASHSCOPE_API_KEY"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">observationRegistry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">registry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“åœ¨è¯·æ±‚ chat æ¥å£æ—¶ï¼Œä¼šæ‰§è¡Œ custom handler ä¸­çš„ä»£ç è¯­å¥ï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">exec CustomerObservationHandler onStart function! ChatModelObservationContext: name='gen_ai.client.operation', contextualName='null', error='null', lowCardinalityKeyValues=[gen_ai.operation.name='chat', gen_ai.request.model='qwen-plus', gen_ai.response.model='none', gen_ai.system='dashscope'], highCardinalityKeyValues=[gen_ai.request.temperature='0.7'], map=[], parentObservation=null</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">exec CustomerObservationHandler onStop function! ChatModelObservationContext: name='gen_ai.client.operation', contextualName='chat qwen-plus', error='null', lowCardinalityKeyValues=[gen_ai.operation.name='chat', gen_ai.request.model='qwen-plus', gen_ai.response.model='none', gen_ai.system='dashscope'], highCardinalityKeyValues=[gen_ai.request.temperature='0.7', gen_ai.response.finish_reasons='["STOP"]', gen_ai.response.id='9582b50a-4056-9b7e-b2ca-e52368406b5e', gen_ai.usage.input_tokens='9', gen_ai.usage.output_tokens='7', gen_ai.usage.total_tokens='16'], map=[], parentObservation=null</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-observations#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3" class="hash-link" aria-label="å‚è€ƒæ–‡æ¡£çš„ç›´æ¥é“¾æ¥" title="å‚è€ƒæ–‡æ¡£çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ul>
<li><a href="https://docs.spring.io/spring-ai/reference/observability/index.html" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/observability/index.html</a></li>
</ul>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Spring AI observations" term="Spring AI observations"/>
        <category label="ZipKin" term="ZipKin"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[MCP ä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨]]></title>
        <id>https://yuluo-yx.github.io/blog/mcp</id>
        <link href="https://yuluo-yx.github.io/blog/mcp"/>
        <updated>2025-03-11T21:01:08.000Z</updated>
        <summary type="html"><![CDATA[å¤§æ¨¡å‹ä¸“æ  -- MCPï¼ˆModel Context Protocolï¼‰]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¤§æ¨¡å‹ä¸“æ ----mcpmodel-context-protocol">å¤§æ¨¡å‹ä¸“æ  -- MCPï¼ˆModel Context Protocolï¼‰<a href="https://yuluo-yx.github.io/blog/mcp#%E5%A4%A7%E6%A8%A1%E5%9E%8B%E4%B8%93%E6%A0%8F----mcpmodel-context-protocol" class="hash-link" aria-label="å¤§æ¨¡å‹ä¸“æ  -- MCPï¼ˆModel Context Protocolï¼‰çš„ç›´æ¥é“¾æ¥" title="å¤§æ¨¡å‹ä¸“æ  -- MCPï¼ˆModel Context Protocolï¼‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æœ¬æ–‡ç« ä¸­ï¼Œå°†ä»‹ç»ä»€ä¹ˆæ˜¯å¤§æ¨¡å‹çš„ MCPï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ MCPã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-mcp-ä»‹ç»">1. MCP ä»‹ç»<a href="https://yuluo-yx.github.io/blog/mcp#1-mcp-%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="1. MCP ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="1. MCP ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="11-ä»€ä¹ˆæ˜¯-mcp">1.1 ä»€ä¹ˆæ˜¯ MCP<a href="https://yuluo-yx.github.io/blog/mcp#11-%E4%BB%80%E4%B9%88%E6%98%AF-mcp" class="hash-link" aria-label="1.1 ä»€ä¹ˆæ˜¯ MCPçš„ç›´æ¥é“¾æ¥" title="1.1 ä»€ä¹ˆæ˜¯ MCPçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>MCPï¼ˆModel Context Protocolï¼šæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰ æ˜¯ä¸€ç§å¼€æ”¾åè®®ï¼Œåˆ¶å®šäº†åº”ç”¨ç¨‹åºå‘ LLM æä¾›ä¸Šä¸‹æ–‡çš„æ ‡å‡†ã€‚å¯ä»¥å°† MCP è§†ä¸º AI åº”ç”¨ç¨‹åºçš„ USB-C ç«¯å£ã€‚æ­£å¦‚ USB-C æä¾›äº†ä¸€ç§å°†è®¾å¤‡è¿æ¥åˆ°å„ç§å¤–å›´è®¾å¤‡å’Œé…ä»¶çš„æ ‡å‡†åŒ–æ–¹å¼ä¸€æ ·ï¼ŒMCP æä¾›äº†ä¸€ç§å°† AI æ¨¡å‹è¿æ¥åˆ°ä¸åŒæ•°æ®æºå’Œå·¥å…·çš„æ ‡å‡†åŒ–æ–¹å¼ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="12-mcp-ç»„æˆ">1.2 MCP ç»„æˆ<a href="https://yuluo-yx.github.io/blog/mcp#12-mcp-%E7%BB%84%E6%88%90" class="hash-link" aria-label="1.2 MCP ç»„æˆçš„ç›´æ¥é“¾æ¥" title="1.2 MCP ç»„æˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>MCP çš„æ ¸å¿ƒæ˜¯å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„ï¼Œå…¶ä¸­ä¸»æœºåº”ç”¨ç¨‹åºå¯ä»¥è¿æ¥åˆ°å¤šä¸ªæœåŠ¡å™¨ï¼š</p>
<p><img decoding="async" loading="lazy" alt="MCP æ¶æ„å›¾" src="https://yuluo-yx.github.io/assets/images/img-f60f77238e85c577be6c5335e5ebc55a.png" width="881" height="612" class="img_c29J"></p>
<ul>
<li><strong>MCP ä¸»æœº</strong>ï¼šå¸Œæœ›é€šè¿‡ MCP è®¿é—®æ•°æ®çš„ç¨‹åºï¼Œä¾‹å¦‚ Claude Desktopã€IDE æˆ– AI å·¥å…·</li>
<li><strong>MCP å®¢æˆ·ç«¯</strong>ï¼šä¸æœåŠ¡å™¨ä¿æŒ 1:1 è¿æ¥çš„åè®®å®¢æˆ·ç«¯</li>
<li><strong>MCP æœåŠ¡å™¨</strong>ï¼šè½»é‡çº§ç¨‹åºï¼Œæ¯ä¸ªç¨‹åºéƒ½é€šè¿‡æ ‡å‡†åŒ–æ¨¡å‹ä¸Šä¸‹æ–‡åè®®å…¬å¼€ç‰¹å®šåŠŸèƒ½</li>
<li><strong>æœ¬åœ°æ•°æ®æº</strong>ï¼šMCP æœåŠ¡å™¨å¯ä»¥å®‰å…¨è®¿é—®çš„æ‚¨çš„è®¡ç®—æœºæ–‡ä»¶ã€æ•°æ®åº“å’ŒæœåŠ¡</li>
<li><strong>è¿œç¨‹æœåŠ¡</strong>ï¼šMCP æœåŠ¡å™¨å¯é€šè¿‡äº’è”ç½‘ï¼ˆä¾‹å¦‚é€šè¿‡ APIï¼‰è¿æ¥åˆ°çš„å¤–éƒ¨ç³»ç»Ÿ</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="13-mcp-è§£å†³äº†ä»€ä¹ˆé—®é¢˜">1.3 MCP è§£å†³äº†ä»€ä¹ˆé—®é¢˜<a href="https://yuluo-yx.github.io/blog/mcp#13-mcp-%E8%A7%A3%E5%86%B3%E4%BA%86%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98" class="hash-link" aria-label="1.3 MCP è§£å†³äº†ä»€ä¹ˆé—®é¢˜çš„ç›´æ¥é“¾æ¥" title="1.3 MCP è§£å†³äº†ä»€ä¹ˆé—®é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¤§æ¨¡å‹å¾€å¾€ä½œä¸ºä¸€ä¸ªç‹¬ç«‹ä¸ªä½“è¿è¡Œï¼Œéš¾ä»¥ç›´æ¥è®¿é—®å®æ—¶æ•°æ®æºï¼ˆå¦‚ä¼ä¸šå†…éƒ¨æ•°æ®åº“ã€å®æ—¶æ–‡æ¡£ã€åœ¨çº¿æœåŠ¡ç­‰ï¼‰ã€‚</p>
<p>å¼€å‘è€…é€šå¸¸éœ€è¦ä¸ºæ¯ä¸ªåº”ç”¨åœºæ™¯å®šåˆ¶ä¸“ç”¨çš„é€‚é…å™¨æˆ–æ’ä»¶ï¼Œè¿™æ—¢è€—æ—¶è´¹åŠ›ï¼Œåˆç¼ºä¹å¯æ‰©å±•æ€§ã€‚MCP æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€ç—›ç‚¹ã€‚é€šè¿‡å®šä¹‰ä¸€ä¸ªæ ‡å‡†åŒ–çš„åè®®ï¼Œå®ƒå…è®¸å¼€å‘è€…åœ¨æ— éœ€é‡å¤å¼€å‘çš„æƒ…å†µä¸‹å¿«é€Ÿè¿æ¥æ¨¡å‹ä¸æ•°æ®æºï¼Œæå‡æ¨¡å‹çš„é€šç”¨æ€§å’Œè½åœ°æ•ˆç‡ã€‚ä¸°å¯Œå¤§æ¨¡å‹çŸ¥è¯†ï¼Œæä¾›æ›´ä¸“ä¸šæœ‰æ•ˆçš„å›ç­”ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-mcp-å¼€å‘">2. MCP å¼€å‘<a href="https://yuluo-yx.github.io/blog/mcp#2-mcp-%E5%BC%80%E5%8F%91" class="hash-link" aria-label="2. MCP å¼€å‘çš„ç›´æ¥é“¾æ¥" title="2. MCP å¼€å‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä»‹ç»å®Œäº† MCP ä¹‹åï¼Œç°åœ¨æ¥ä½¿ç”¨ MCP çš„ java SDK å’Œ Spring AI Alibaba å¼€å‘ä¸€ä¸ª MCP æœåŠ¡ç¤ºä¾‹ï¼Œä½¿ç”¨ mcp çš„ STDIO æ–¹å¼ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-ç¯å¢ƒå‡†å¤‡">2.1 ç¯å¢ƒå‡†å¤‡<a href="https://yuluo-yx.github.io/blog/mcp#21-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87" class="hash-link" aria-label="2.1 ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥" title="2.1 ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>MCP Java SDK repoï¼š<a href="https://github.com/modelcontextprotocol/java-sdk" target="_blank" rel="noopener noreferrer">https://github.com/modelcontextprotocol/java-sdk</a></p>
<p>MCP Java SDK Docsï¼š<a href="https://modelcontextprotocol.io/sdk/java/mcp-overview" target="_blank" rel="noopener noreferrer">https://modelcontextprotocol.io/sdk/java/mcp-overview</a></p>
<p>Spring AI MCP Integrationï¼š<a href="https://docs.spring.io/spring-ai/reference/api/mcp/mcp-client-boot-starter-docs.html" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/api/mcp/mcp-client-boot-starter-docs.html</a></p>
<p>Spring AI Alibabaï¼š<a href="https://github.com/alibaba/spring-ai-alibaba" target="_blank" rel="noopener noreferrer">alibaba/spring-ai-alibaba: An Application Framework for Java Developers</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-ä»£ç å¼€å‘">2.2 ä»£ç å¼€å‘<a href="https://yuluo-yx.github.io/blog/mcp#22-%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91" class="hash-link" aria-label="2.2 ä»£ç å¼€å‘çš„ç›´æ¥é“¾æ¥" title="2.2 ä»£ç å¼€å‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>è¿™é‡Œä½¿ç”¨ spring ai é›†æˆçš„ MCP starterã€‚</p>
<p>serverï¼š<code>spring-ai-mcp-server-spring-boot-starter</code></p>
<p>clientï¼š<code>spring-ai-mcp-client-spring-boot-starter</code></p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="221-mcp-æœåŠ¡ç«¯å¼€å‘">2.2.1 MCP æœåŠ¡ç«¯å¼€å‘<a href="https://yuluo-yx.github.io/blog/mcp#221-mcp-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%BC%80%E5%8F%91" class="hash-link" aria-label="2.2.1 MCP æœåŠ¡ç«¯å¼€å‘çš„ç›´æ¥é“¾æ¥" title="2.2.1 MCP æœåŠ¡ç«¯å¼€å‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>application.yml æ–‡ä»¶å®šä¹‰</p>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">web-application-type</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> none</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">banner-mode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> off</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># mcp é…ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">mcp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">server</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">mcp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">example</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">server</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">version</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> 0.0.1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ä¸šåŠ¡æ•°æ®åº“ç³»ç»Ÿé…ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">datasource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">driver-class-name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> com.mysql.cj.jdbc.Driver</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">url</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> jdbc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">mysql</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">3306/data</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">?</span><span class="token plain">useSSL=false</span><span class="token important" style="color:hsl(230, 8%, 24%);font-weight:bold">&amp;serverTimezone=UTC</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">username</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> root</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">password</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> root</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">logging</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">pattern</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å…³é—­ mybatis-plus çš„ banner è¾“å‡º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">mybatis-plus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">global-config</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">banner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> off</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>pom.xml</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">3.4.2</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-mcp-server-spring-boot-starter</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.mysql</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">mysql-connector-j</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">8.0.33</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.baomidou</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">mybatis-plus-spring-boot3-starter</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">3.5.10.1</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.google.code.gson</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">gson</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">2.12.1</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- spring boot å·¥ç¨‹å¿…é¡»è¦ï¼Œä¸ç„¶ mcp-serve æ— æ³•å¯åŠ¨ jar åŒ…ï¼Œä¼šå¤±è´¥ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">build</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">plugins</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">plugin</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-maven-plugin</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">executions</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">execution</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">goals</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">goal</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">repackage</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">goal</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">goals</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">execution</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">executions</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">plugin</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">plugins</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">build</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Spring Boot å¯åŠ¨ç±»ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@SpringBootApplication</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@MapperScan</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"indi.yuluo.repository"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MCPServerApplication</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringApplication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MCPServerApplication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// mcp Tool å®šä¹‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallbackProvider</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">dataTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolsDefinitionService</span><span class="token plain"> dataService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MethodToolCallbackProvider</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toolObjects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dataService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">	 * è¾“å‡ºæ•°æ®åº“æŸ¥è¯¢ç¡®è®¤æœåŠ¡ç«¯å¯åŠ¨æˆåŠŸ</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">	 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// @Resource</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// private MySQLDataService mySQLDataServiceImpl;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// @Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// public Void run() {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 	System.out.println(mySQLDataServiceImpl.getContextData("zhangsan"));</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 	return null;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// }</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ToolsDefinitionService.java</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// å®šä¹‰ tool service åœ¨å¯åŠ¨ç±»ä¸­æ³¨å…¥ bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolsDefinitionService</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¸€ä¸ªæ™®é€šçš„ mysql æ•°æ®åº“æœåŠ¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Resource</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MySQLDataService</span><span class="token plain"> dataService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">description </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"è°ƒç”¨æ­¤å·¥å…·å‡½æ•°ï¼Œå°†å‚æ•°è½¬ä¸ºå…¨å¤§å†™å¹¶è¿”å›"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">test</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> test</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> test</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toLowerCase</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">description </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"è°ƒç”¨æ­¤å·¥å…·å‡½æ•°ï¼Œä» mysql æ•°æ®æŸ¥è¯¢æŒ‡å®šå§“åçš„è”ç³»äººä¿¡æ¯"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">queryContact</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> dataService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getContextData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è‡³æ­¤ï¼ŒMCP server å¼€å‘å®Œæˆã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="222-mcp-å®¢æˆ·ç«¯å¼€å‘">2.2.2 MCP å®¢æˆ·ç«¯å¼€å‘<a href="https://yuluo-yx.github.io/blog/mcp#222-mcp-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BC%80%E5%8F%91" class="hash-link" aria-label="2.2.2 MCP å®¢æˆ·ç«¯å¼€å‘çš„ç›´æ¥é“¾æ¥" title="2.2.2 MCP å®¢æˆ·ç«¯å¼€å‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>ç°åœ¨ï¼Œæ„å»º MCP client ç«¯ï¼Œè°ƒç”¨ server ç«¯ MCP Toolã€‚</p>
<blockquote>
<p>æ­¤ä¾‹ä¸­ä½¿ç”¨ web api çš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ CommandLineRunner çš„æ–¹å¼ã€‚</p>
</blockquote>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">application</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> mcp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">example</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">mandatory-file-encoding</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> UTF</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">dashscope</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">api-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">AI_DASHSCOPE_API_KEY</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">mcp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">stdio</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">servers-configuration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> classpath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">mcp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">servers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">config.json</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">server</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">servlet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">encoding</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">charset</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> UTF</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">enabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">force</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">logging</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">charset</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">file</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> UTF</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æ‰“å° mcp æ—¥å¿—ä¿¡æ¯ï¼Œæ–¹ä¾¿æŸ¥çœ‹ MCP Serve çš„æ—¥å¿—ä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">level</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">io.modelcontextprotocol.client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> debug</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">io.modelcontextprotocol.spec</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> debug</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">org.springframework.ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> debug</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>mcp-servers-config.json</p>
<blockquote>
<p>MCP Server çš„é…ç½®æ–‡ä»¶ï¼Œæ”¾åœ¨ resources ç›®å½•ä¸‹ã€‚</p>
</blockquote>
<div class="language-json codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-json codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token property" style="color:hsl(5, 74%, 59%)">"mcpServers"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"my-mcp-example-server"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token property" style="color:hsl(5, 74%, 59%)">"command"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"java"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token property" style="color:hsl(5, 74%, 59%)">"args"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-jar"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.ai.mcp.server.stdio=true"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.main.web-application-type=none"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dlogging.pattern.console="</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.datasource.url=jdbc:mysql://localhost:3306/data?useSSL=false&amp;serverTimezone=UTC"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.datasource.username=root"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.datasource.password=root"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"D:\\AI\\examples\\mcp-example\\mcp-server-example\\target\\mcp-server-example-1.0-SNAPSHOT.jar"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token property" style="color:hsl(5, 74%, 59%)">"env"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¯åŠ¨ç±»ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@SpringBootApplication</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MCPClientApplication</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringApplication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MCPClientApplication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// @Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// public CommandLineRunner predefinedQuestions(ChatClient.Builder chatClientBuilder, ToolCallbackProvider tools,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 		ConfigurableApplicationContext context) {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 	return args -&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 		var chatClient = chatClientBuilder</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 				.defaultTools(tools)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 				.build();</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 		System.out.println("\n&gt;&gt;&gt; QUESTION: " + "å¸®æˆ‘æŸ¥è¯¢ä¸€ä¸‹ wangwu çš„ä¿¡æ¯");</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 		System.out.println("\n&gt;&gt;&gt; ASSISTANT: " + chatClient.prompt("å¸®æˆ‘æŸ¥è¯¢ä¸€ä¸‹ wangwu çš„ä¿¡æ¯").call().content());</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 		context.close();</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 	};</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// }</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>controller</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/mcp"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MCPClientController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MCPClientController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallbackProvider</span><span class="token plain"> tools</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¾“å‡º MCP server çš„ä¸¤ä¸ª tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Arrays</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FunctionCallback</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">getName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">client </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/chat"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestParam</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"prompt"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HttpServletResponse</span><span class="token plain"> response</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setCharacterEncoding</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"UTF-8"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¾“å‡ºå“åº”</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="23-è¯·æ±‚æµ‹è¯•">2.3 è¯·æ±‚æµ‹è¯•<a href="https://yuluo-yx.github.io/blog/mcp#23-%E8%AF%B7%E6%B1%82%E6%B5%8B%E8%AF%95" class="hash-link" aria-label="2.3 è¯·æ±‚æµ‹è¯•çš„ç›´æ¥é“¾æ¥" title="2.3 è¯·æ±‚æµ‹è¯•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-http codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-http codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">### Test API</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://127.0.0.1:8080/mcp/chat?prompt="å°† user è½¬ä¸ºå¤§å†™"</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">è½¬ä¸ºå¤§å†™çš„ç»“æœæ˜¯ï¼šUSER</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">### MySQL API</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://127.0.0.1:8080/mcp/chat?prompt="å¸®æˆ‘ä»æ•°æ®åº“æŸ¥è¯¢ä¸€ä¸‹ wangwu çš„è”ç³»ä¿¡æ¯"</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æŸ¥è¯¢ç»“æœæ˜¾ç¤ºï¼Œè”ç³»äºº wangwu çš„ä¿¡æ¯å¦‚ä¸‹ï¼š</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">- ID: 3</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">- å¹´é¾„: 24</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">- ç”µå­é‚®ä»¶: 789@gmail.com</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">è¿™æ˜¯å…³äº wangwu çš„è¯¦ç»†è”ç³»ä¿¡æ¯ã€‚</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-æ€»ç»“">3. æ€»ç»“<a href="https://yuluo-yx.github.io/blog/mcp#3-%E6%80%BB%E7%BB%93" class="hash-link" aria-label="3. æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="3. æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Example Codeï¼š<a href="https://github.com/deigmata-paideias/deigmata-paideias/tree/main/ai/mcp-example" target="_blank" rel="noopener noreferrer">https://github.com/deigmata-paideias/deigmata-paideias/tree/main/ai/mcp-example</a></p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œä»‹ç»äº†ä»€ä¹ˆæ˜¯ MCP ä»¥åŠ MCP çš„ä½œç”¨å’Œè§£å†³çš„é—®é¢˜ã€‚ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ä½“éªŒ MCP çš„èƒ½åŠ›ã€‚</p>
<p>åœ¨ MCP ä¸­ï¼Œé™¤äº† STDIO çš„æ–¹å¼ä¹‹å¤–ï¼Œè¿˜æ”¯æŒ SSE çš„æ–¹å¼ã€‚æ›´å¥½çš„æ»¡è¶³ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ã€‚</p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="AI" term="AI"/>
        <category label="Spring AI Alibaba" term="Spring AI Alibaba"/>
        <category label="MCP" term="MCP"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨ Spring AI Aliabab Module RAG æ„å»º Web Search åº”ç”¨]]></title>
        <id>https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag</id>
        <link href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag"/>
        <updated>2025-03-11T21:01:08.000Z</updated>
        <summary type="html"><![CDATA[æœ¬æ–‡åŒæ­¥å‘å¸ƒåœ¨ spring ai alibaba blog å’Œé˜¿é‡Œäº‘å…¬ä¼—å·]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>æœ¬æ–‡åŒæ­¥å‘å¸ƒåœ¨ spring ai alibaba blog å’Œé˜¿é‡Œäº‘å…¬ä¼—å·</p>
</blockquote>
<p>Spring AI å®ç°äº†æ¨¡å—åŒ– RAG æ¶æ„ï¼Œæ¶æ„çš„çµæ„Ÿæ¥è‡ªäºè®ºæ–‡â€œ<a href="https://arxiv.org/abs/2407.21059" target="_blank" rel="noopener noreferrer">æ¨¡å—åŒ– RAGï¼šå°† RAG ç³»ç»Ÿè½¬å˜ä¸ºç±»ä¼¼ä¹é«˜çš„å¯é‡æ„æ¡†æ¶</a>â€ä¸­è¯¦è¿°çš„æ¨¡å—åŒ–æ¦‚å¿µã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="spring-ai-æ¨¡å—åŒ–-rag-ä½“ç³»">Spring AI æ¨¡å—åŒ– RAG ä½“ç³»<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#spring-ai-%E6%A8%A1%E5%9D%97%E5%8C%96-rag-%E4%BD%93%E7%B3%BB" class="hash-link" aria-label="Spring AI æ¨¡å—åŒ– RAG ä½“ç³»çš„ç›´æ¥é“¾æ¥" title="Spring AI æ¨¡å—åŒ– RAG ä½“ç³»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><img decoding="async" loading="lazy" alt="module-rag" src="https://yuluo-yx.github.io/assets/images/module-rag-2be363966d8119f3cc4b9fb1dcf2fc34.png" width="3114" height="4864" class="img_c29J"></p>
<p>æ€»ä½“ä¸Šåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="pre-retrieval">Pre-Retrieval<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#pre-retrieval" class="hash-link" aria-label="Pre-Retrievalçš„ç›´æ¥é“¾æ¥" title="Pre-Retrievalçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>å¢å¼ºå’Œè½¬æ¢ç”¨æˆ·è¾“å…¥ï¼Œä½¿å…¶æ›´æœ‰æ•ˆåœ°æ‰§è¡Œæ£€ç´¢ä»»åŠ¡ï¼Œè§£å†³æ ¼å¼ä¸æ­£ç¡®çš„æŸ¥è¯¢ã€query è¯­ä¹‰ä¸æ¸…æ™°ã€æˆ–ä¸å—æ”¯æŒçš„è¯­è¨€ç­‰ã€‚</p>
</blockquote>
<ol>
<li>QueryAugmenter æŸ¥è¯¢å¢å¼ºï¼šä½¿ç”¨é™„åŠ çš„ä¸Šä¸‹æ–‡æ•°æ®ä¿¡æ¯å¢å¼ºç”¨æˆ· queryï¼Œæä¾›å¤§æ¨¡å‹å›ç­”é—®é¢˜æ—¶çš„å¿…è¦ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼›</li>
<li>QueryTransformer æŸ¥è¯¢æ”¹å†™ï¼šå› ä¸ºç”¨æˆ·çš„è¾“å…¥é€šå¸¸æ˜¯ç‰‡é¢çš„ï¼Œå…³é”®ä¿¡æ¯è¾ƒå°‘ï¼Œä¸ä¾¿äºå¤§æ¨¡å‹ç†è§£å’Œå›ç­”é—®é¢˜ã€‚å› æ­¤éœ€è¦ä½¿ç”¨ prompt è°ƒä¼˜æ‰‹æ®µæˆ–è€…å¤§æ¨¡å‹æ”¹å†™ç”¨æˆ· queryï¼›</li>
<li>QueryExpander æŸ¥è¯¢æ‰©å±•ï¼šå°†ç”¨æˆ· query æ‰©å±•ä¸ºå¤šä¸ªè¯­ä¹‰ä¸åŒçš„å˜ä½“ä»¥è·å¾—ä¸åŒè§†è§’ï¼Œæœ‰åŠ©äºæ£€ç´¢é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å¹¶å¢åŠ æ‰¾åˆ°ç›¸å…³ç»“æœçš„æœºä¼šã€‚</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="retrieval">Retrieval<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#retrieval" class="hash-link" aria-label="Retrievalçš„ç›´æ¥é“¾æ¥" title="Retrievalçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>è´Ÿè´£æŸ¥è¯¢å‘é‡å­˜å‚¨ç­‰æ•°æ®ç³»ç»Ÿå¹¶æ£€ç´¢å’Œç”¨æˆ· query ç›¸å…³æ€§æœ€é«˜çš„ Documentã€‚</p>
</blockquote>
<ol>
<li>DocumentRetrieverï¼šæ£€ç´¢å™¨ï¼Œæ ¹æ® QueryExpander ä½¿ç”¨ä¸åŒçš„æ•°æ®æºè¿›è¡Œæ£€ç´¢ï¼Œä¾‹å¦‚ æœç´¢å¼•æ“ã€å‘é‡å­˜å‚¨ã€æ•°æ®åº“æˆ–çŸ¥è¯†å›¾ç­‰ï¼›</li>
<li>DocumentJoinerï¼šå°†ä»å¤šä¸ª query å’Œä»å¤šä¸ªæ•°æ®æºæ£€ç´¢åˆ°çš„ Document åˆå¹¶ä¸ºä¸€ä¸ª Document é›†åˆï¼›</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="post-retrieval">Post-Retrieval<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#post-retrieval" class="hash-link" aria-label="Post-Retrievalçš„ç›´æ¥é“¾æ¥" title="Post-Retrievalçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>è´Ÿè´£å¤„ç†æ£€ç´¢åˆ°çš„ Document ä»¥è·å¾—æœ€ä½³çš„è¾“å‡ºç»“æœï¼Œè§£å†³æ¨¡å‹ä¸­çš„<em>ä¸­é—´ä¸¢å¤±</em>å’Œä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶ç­‰ã€‚</p>
</blockquote>
<ol>
<li>DocumentRankerï¼šæ ¹æ® Document å’Œç”¨æˆ· query çš„ç›¸å…³æ€§å¯¹ Document è¿›è¡Œæ’åºå’Œæ’åï¼›</li>
<li>DocumentSelectorï¼šç”¨äºä»æ£€ç´¢åˆ°çš„ Document åˆ—è¡¨ä¸­åˆ é™¤ä¸ç›¸å…³æˆ–å†—ä½™æ–‡æ¡£ï¼›</li>
<li>DocumentCompressorï¼šç”¨äºå‹ç¼©æ¯ä¸ª Documentï¼Œå‡å°‘æ£€ç´¢åˆ°çš„ä¿¡æ¯ä¸­çš„å™ªéŸ³å’Œå†—ä½™ã€‚</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç”Ÿæˆ">ç”Ÿæˆ<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#%E7%94%9F%E6%88%90" class="hash-link" aria-label="ç”Ÿæˆçš„ç›´æ¥é“¾æ¥" title="ç”Ÿæˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç”Ÿæˆç”¨æˆ· Query å¯¹åº”çš„å¤§æ¨¡å‹è¾“å‡ºã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="web-search-å®è·µ">Web Search å®è·µ<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#web-search-%E5%AE%9E%E8%B7%B5" class="hash-link" aria-label="Web Search å®è·µçš„ç›´æ¥é“¾æ¥" title="Web Search å®è·µçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æ¥ä¸‹æ¥ï¼Œå°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ Spring AI Alibaba å’Œé˜¿é‡Œäº‘ IQS æœåŠ¡æ­å»ºè”ç½‘æœç´¢ RAG çš„å®ç°ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="èµ„æºå‡†å¤‡">èµ„æºå‡†å¤‡<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#%E8%B5%84%E6%BA%90%E5%87%86%E5%A4%87" class="hash-link" aria-label="èµ„æºå‡†å¤‡çš„ç›´æ¥é“¾æ¥" title="èµ„æºå‡†å¤‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>DashScope apiKeyï¼š<a href="https://help.aliyun.com/zh/model-studio/developer-reference/get-api-key" target="_blank" rel="noopener noreferrer">https://help.aliyun.com/zh/model-studio/developer-reference/get-api-key</a></p>
<p>é˜¿é‡Œäº‘ IQS æœåŠ¡ apiKeyï¼š<a href="https://help.aliyun.com/product/2837261.html" target="_blank" rel="noopener noreferrer">https://help.aliyun.com/product/2837261.html</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="pre-retrieval-1">Pre-Retrieval<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#pre-retrieval-1" class="hash-link" aria-label="Pre-Retrievalçš„ç›´æ¥é“¾æ¥" title="Pre-Retrievalçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>å°†ç”¨æˆ· Query ä½¿ç”¨  qwen-plus å¤§æ¨¡å‹è¿›è¡Œå¢å¼ºæ”¹å†™ã€‚</p>
</blockquote>
<p>CustomContextQueryAugmenter.java</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomContextQueryAugmenter</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryAugmenter</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å®šä¹‰ prompt tmplã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">DEFAULT_PROMPT_TEMPLATE</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ......</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">DEFAULT_EMPTY_PROMPT_TEMPLATE</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">augment</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Nullable</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Nullable</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 1. collect content from documents.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">AtomicInteger</span><span class="token plain"> idCounter </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">AtomicInteger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> documentContext </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">document </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> text </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"[["</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">idCounter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getAndIncrement</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"]]"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">collect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Collectors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">joining</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\n-----------------------------------------------\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 2. Define prompt parameters.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> promptParameters </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token string" style="color:hsl(119, 34%, 47%)">"query"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token string" style="color:hsl(119, 34%, 47%)">"context"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> documentContext</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 3. Augment user prompt with document context.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">promptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">render</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">promptParameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å½“ä¸Šä¸‹æ–‡ä¸ºç©ºæ—¶ï¼Œè¿”å› DEFAULT_EMPTY_PROMPT_TEMPLATE</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">augmentQueryWhenEmptyContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">allowEmptyContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Empty context is allowed. Returning the original query."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Empty context is not allowed. Returning a specific query for empty context."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">emptyPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">render</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ......</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>QueryTransformer é…ç½® beanï¼Œç”¨äº rewrite ç”¨æˆ· queryï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryTransformer</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token plain"> chatClientBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"transformerPromptTemplate"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token plain"> transformerPromptTemplate</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClientBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DashScopeChatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">withModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"qwen-plus"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RewriteQueryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatClientBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">mutate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">promptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">transformerPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">targetSearchSystem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"è”ç½‘æœç´¢"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>QueryExpander.java æŸ¥è¯¢å˜ä½“</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MultiQueryExpander</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryExpander</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MultiQueryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">DEFAULT_PROMPT_TEMPLATE</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">expand</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Nullable</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> resp </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">user </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">promptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">param</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"number"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">numberOfQueries</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">param</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"query"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> queryVariants </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Arrays</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">resp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">split</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringUtils</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">hasText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CollectionUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">queryVariants</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">||</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">numberOfQueries </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> queryVariants</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> queries </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryVariants</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringUtils</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">hasText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">queryText </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">mutate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">queryText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">collect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Collectors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ˜¯å¦å¼•å…¥åŸæŸ¥è¯¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">includeOriginal</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Including original query in the expanded queries for query: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          queries</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> queries</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ......</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="retrieval-1">Retrieval<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#retrieval-1" class="hash-link" aria-label="Retrievalçš„ç›´æ¥é“¾æ¥" title="Retrievalçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>ä»ä¸åŒæ•°æ®æºæŸ¥è¯¢å’Œç”¨æˆ· query ç›¸ä¼¼åº¦æœ€é«˜çš„æ•°æ®ã€‚ï¼ˆè¿™é‡Œä½¿ç”¨ Web Searchï¼‰</p>
</blockquote>
<p>WebSearchRetriever.java</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WebSearchRetriever</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DocumentRetriever</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ³¨å…¥ IQS æœç´¢å¼•æ“</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IQSSearchEngine</span><span class="token plain"> searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">retrieve</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Nullable</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token plain"> query</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æœç´¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token plain"> searchResp </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">search</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ¸…æ´—æ•°æ®ï¼Œå°†æ•°æ®è½¬æ¢ä¸º Spring AI çš„ Document å¯¹è±¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> cleanerData </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">searchResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"cleaner data: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> cleanerData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¿”å›ç»“æœ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">limitResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">cleanerData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> maxResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"WebSearchRetriever#retrieve() document size: {}, raw documents: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">getId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toArray</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> enableRanker </span><span class="token operator" style="color:hsl(221, 87%, 60%)">?</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">ranking</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">ranking</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åªæœ‰ä¸€ä¸ªæ—¶ï¼Œä¸éœ€è¦ rank</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> rankedDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> documentRanker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">rank</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"WebSearchRetriever#ranking() Ranked documents: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> rankedDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">getId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toArray</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> rankedDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// é™çº§è¿”å›åŸå§‹ç»“æœ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ranking error"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>DocumentJoiner.java åˆå¹¶ Document</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConcatenationDocumentJoiner</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DocumentJoiner</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">join</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Nullable</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documentsForQuery</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> selectDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">selectDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documentsForQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Set</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> seen </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashSet</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> selectDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">values</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Flatten List&lt;List&lt;Documents&gt;&gt; to Stream&lt;List&lt;Documents&gt;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">flatMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Flatten Stream&lt;List&lt;Documents&gt; to Stream&lt;Documents&gt;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">flatMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">doc </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> keys </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">extractKeys</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> key </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> keys</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">seen</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Duplicate document metadata: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain">doc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Duplicate keys found.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// All keys are unique.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">collect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Collectors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">selectDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documentsForQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> totalDocuments</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> selectDocumentsForQuery </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> numberOfQueries </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> documentsForQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> numberOfQueries</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> selectDocumentsForQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> baseCount </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> totalDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> numberOfQueries</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> remainder </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> totalDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">%</span><span class="token plain"> numberOfQueries</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// To ensure consistent distribution. sort the keys (optional)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> sortedQueries </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documentsForQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">keySet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Other sort</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// sortedQueries.sort(Comparator.comparing(Query::getSomeProperty));</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Iterator</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> iterator </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> sortedQueries</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">iterator</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain"> numberOfQueries</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">++</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token plain"> query </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> sortedQueries</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> documentToSelect </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> baseCount </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain"> remainder </span><span class="token operator" style="color:hsl(221, 87%, 60%)">?</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> originalDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> documentsForQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> selectedNestLists </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">           </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> remainingDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> documentToSelect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documentList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> originalDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">remainingDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> selectSubList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token plain"> docs </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> documentList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">remainingDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                selectSubList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">docs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                remainingDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">--</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">selectSubList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                selectedNestLists</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">selectSubList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          selectDocumentsForQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> selectedNestLists</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> selectDocumentsForQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">extractKeys</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token plain"> document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æå– key</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> keys</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="post-retrieval-1">Post-Retrieval<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#post-retrieval-1" class="hash-link" aria-label="Post-Retrievalçš„ç›´æ¥é“¾æ¥" title="Post-Retrievalçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>å¤„ç†ä»è”ç½‘æœç´¢ç§è·å¾—çš„ Documentï¼Œä»¥è·å¾—æœ€ä½³è¾“å‡ºã€‚</p>
</blockquote>
<p>DashScopeDocumentRanker.java</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DashScopeDocumentRanker</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DocumentRanker</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">rank</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Nullable</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Query</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Nullable</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> reorderDocs </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç”±è°ƒç”¨è€…æ§åˆ¶æ–‡æ¡£æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DashScopeRerankOptions</span><span class="token plain"> rerankOptions </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DashScopeRerankOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">withTopN</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nonNull</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">hasText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç»„è£…å‚æ•°è°ƒç”¨ rankModel</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RerankRequest</span><span class="token plain"> rerankRequest </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RerankRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   rerankOptions</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RerankResponse</span><span class="token plain"> rerankResp </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> rerankModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">rerankRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             rerankResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">res </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token plain"> outputDocs </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æŸ¥æ‰¾å¹¶æ·»åŠ åˆ°æ–°çš„ list ä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Optional</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> foundDocsOptional </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">doc </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// debug rerank output.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"DashScopeDocumentRanker#rank() doc id: {}, outputDocs id: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> doc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> outputDocs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> outputDocs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">findFirst</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                foundDocsOptional</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">ifPresent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">reorderDocs</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> reorderDocs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ ¹æ®å¼‚å¸¸ç±»å‹åšè¿›ä¸€æ­¥å¤„ç†</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAAppException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¤§æ¨¡å‹è¾“å‡º">å¤§æ¨¡å‹è¾“å‡º<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#%E5%A4%A7%E6%A8%A1%E5%9E%8B%E8%BE%93%E5%87%BA" class="hash-link" aria-label="å¤§æ¨¡å‹è¾“å‡ºçš„ç›´æ¥é“¾æ¥" title="å¤§æ¨¡å‹è¾“å‡ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>WebSearchService.java</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAWebSearchService</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">DEFAULT_WEB_SEARCH_MODEL</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"deepseek-r1"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAWebSearchService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token plain"> chatClientBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryTransformer</span><span class="token plain"> queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryExpander</span><span class="token plain"> queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IQSSearchEngine</span><span class="token plain"> searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DataClean</span><span class="token plain"> dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DocumentRanker</span><span class="token plain"> documentRanker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"queryArgumentPromptTemplate"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token plain"> queryArgumentPromptTemplate</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">queryTransformer </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">queryExpander </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">queryArgumentPromptTemplate </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryArgumentPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç”¨äº DeepSeek-r1 çš„ reasoning content æ•´åˆåˆ°è¾“å‡ºä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">reasoningContentAdvisor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ReasoningContentAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ„å»º chatClient</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClientBuilder</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DashScopeChatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">withModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">DEFAULT_WEB_SEARCH_MODEL</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// stream æ¨¡å¼ä¸‹æ˜¯å¦å¼€å¯å¢é‡è¾“å‡º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">withIncrementalOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ—¥å¿—</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">simpleLoggerAdvisor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">100</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">webSearchRetriever </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WebSearchRetriever</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">maxResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">enableRanker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">documentRanker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documentRanker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¤„ç†ç”¨æˆ·è¾“å…¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">advisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token function" style="color:hsl(221, 87%, 60%)">createRetrievalAugmentationAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ•´åˆåˆ° reasoning content è¾“å‡ºä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   reasoningContentAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   simpleLoggerAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åˆ›å»º advisor</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RetrievalAugmentationAdvisor</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createRetrievalAugmentationAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RetrievalAugmentationAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">documentRetriever</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">webSearchRetriever</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">queryTransformers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">queryAugmenter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomContextQueryAugmenter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         queryArgumentPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">documentJoiner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConcatenationDocumentJoiner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¼”ç¤º">æ¼”ç¤º<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#%E6%BC%94%E7%A4%BA" class="hash-link" aria-label="æ¼”ç¤ºçš„ç›´æ¥é“¾æ¥" title="æ¼”ç¤ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä½¿ç”¨é—®é¢˜ <code>æ­å·æœ‰ä»€ä¹ˆæ¨èæ—…æ¸¸çš„åœ°æ–¹å—</code> ä¸ºä¾‹ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ™®é€šè¾“å‡º">æ™®é€šè¾“å‡º<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#%E6%99%AE%E9%80%9A%E8%BE%93%E5%87%BA" class="hash-link" aria-label="æ™®é€šè¾“å‡ºçš„ç›´æ¥é“¾æ¥" title="æ™®é€šè¾“å‡ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">###</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> å¿…æ¸¸æ™¯ç‚¹  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">1.</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">è¥¿æ¹–</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">æ ¸å¿ƒç‰¹è‰²</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šæ­å·çš„æ ‡å¿—æ€§æ™¯ç‚¹ï¼ŒåŒ…å«â€œè¥¿æ¹–åæ™¯â€ï¼ˆå¦‚è‹å ¤æ˜¥æ™“ã€æ–­æ¡¥æ®‹é›ªã€ä¸‰æ½­å°æœˆç­‰ï¼‰ï¼Œå¯æ³›èˆŸæ¹–ä¸Šæˆ–æ²¿æ¹–éª‘è¡Œã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">æ¨èæ´»åŠ¨</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šå¤œæ¸¸è¥¿æ¹–ç¯å…‰ç§€ã€æ¼«æ­¥ç™½å ¤/è‹å ¤ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">2.</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">çµéšå¯ºä¸é£æ¥å³°</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">æ–‡åŒ–ä»·å€¼</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šåƒå¹´å¤åˆ¹çµéšå¯ºè¢«èª‰ä¸ºâ€œä¸œå—ä½›å›½â€ï¼Œé£æ¥å³°çš„æ‘©å´–çŸ³åˆ»ä¸ºå®‹ä»£ä½›æ•™è‰ºæœ¯ç‘°å®ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token hr punctuation" style="color:hsl(119, 34%, 47%)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">###</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> è‡ªç„¶ä¸ç”Ÿæ€  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">1.</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">è¥¿æºªå›½å®¶æ¹¿åœ°å…¬å›­</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">äº®ç‚¹</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šå›½å†…é¦–ä¸ªå›½å®¶æ¹¿åœ°å…¬å›­ï¼Œå¯ä¹˜æ‘‡æ©¹èˆ¹æ¸¸è§ˆï¼Œæ˜¥ç§‹å­£è§‚èŠ¦è‹‡ã€èµæ¢…èŠ±ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">2.</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">ä¹æºªåå…«æ¶§</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">ç‰¹è‰²</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šèŒ¶å›­ã€æºªæµã€å¤æ ‘æ„æˆçš„å¾’æ­¥è·¯çº¿ï¼Œé€‚åˆå¤å­£é¿æš‘ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token hr punctuation" style="color:hsl(119, 34%, 47%)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">###</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> æ–‡åŒ–ä½“éªŒ  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">1.</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">å®‹åŸæ™¯åŒº</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">å¿…çœ‹æ¼”å‡º</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šã€Šå®‹åŸåƒå¤æƒ…ã€‹é€šè¿‡æ­Œèˆæ¼”ç»æ­å·å†å²ï¼Œæ²‰æµ¸å¼ä½“éªŒå—å®‹æ–‡åŒ–ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">2.</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">ä¸­å›½èŒ¶å¶åšç‰©é¦†ï¼ˆé¾™äº•é¦†ï¼‰</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">ä½“éªŒ</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šäº†è§£é¾™äº•èŒ¶æ–‡åŒ–ï¼Œå‚ä¸é‡‡èŒ¶ã€åˆ¶èŒ¶æ´»åŠ¨ï¼Œå“é‰´æ­£å®—è¥¿æ¹–é¾™äº•ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token hr punctuation" style="color:hsl(119, 34%, 47%)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">###</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> ç¾é£Ÿè¡—åŒº  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">1.</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">æ²³åŠè¡—</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">æ¨èå°åƒ</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šè‘±åŒ…æ¡§ã€å®šèƒœç³•ã€è¥¿æ¹–é†‹é±¼ã€ä¸œå¡è‚‰ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">2.</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">æ­¦æ—å¤œå¸‚</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">ç‰¹è‰²</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šæœ¬åœ°äººå¸¸å»çš„å¤œå®µèšé›†åœ°ï¼Œæ±‡èšæµ™æ±Ÿé£å‘³ä¸ç½‘çº¢ç¾é£Ÿã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token hr punctuation" style="color:hsl(119, 34%, 47%)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">###</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> æ¸©é¦¨æç¤º  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">æœ€ä½³å­£èŠ‚</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šæ˜¥å­£ï¼ˆ3-5æœˆï¼‰èµæ¡ƒæŸ³ï¼Œç§‹å­£ï¼ˆ9-11æœˆï¼‰è§‚æ¡‚èŠ±ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">äº¤é€šå»ºè®®</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šè¥¿æ¹–å‘¨è¾¹æ™¯ç‚¹é›†ä¸­ï¼Œå»ºè®®éª‘è¡Œæˆ–æ­¥è¡Œï¼›åœ°é“1å·çº¿è¦†ç›–ä¸»åŸåŒºã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">å¦‚éœ€æ›´è¯¦ç»†çš„è¡Œç¨‹è§„åˆ’ï¼Œå¯è¡¥å……å…·ä½“éœ€æ±‚ï¼ˆå¦‚äº²å­æ¸¸ã€æ‘„å½±ä¸»é¢˜ç­‰ï¼‰ã€‚</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="è”ç½‘æœç´¢è¾“å‡º">è”ç½‘æœç´¢è¾“å‡º<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#%E8%81%94%E7%BD%91%E6%90%9C%E7%B4%A2%E8%BE%93%E5%87%BA" class="hash-link" aria-label="è”ç½‘æœç´¢è¾“å‡ºçš„ç›´æ¥é“¾æ¥" title="è”ç½‘æœç´¢è¾“å‡ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">###</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> æ­å·æ—…æ¸¸æ¨è</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 1. è¥¿æ¹–é£æ™¯åŒº  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æ­å·çš„æ ¸å¿ƒæ™¯ç‚¹ï¼ŒåŒ…å«æ–­æ¡¥æ®‹é›ªã€è‹å ¤æ˜¥æ™“ç­‰ç»å…¸æ™¯è§‚ï¼Œå››å­£æ™¯è‰²å„å¼‚ï¼Œé€‚åˆæ¼«æ­¥æˆ–ä¹˜èˆ¹æ¸¸è§ˆã€‚æ¸…æ™¨å’Œå‚æ™šçš„å…‰çº¿æœ€ä½³ï¼Œæ¹–å…‰å±±è‰²ä¸äººæ–‡é—è¿¹äº¤èï¼Œæ˜¯æ‘„å½±å’Œä¼‘é—²çš„é¦–é€‰ </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">2</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">3</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">[6]ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 2. çµéšå¯º  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">åƒå¹´å¤åˆ¹éšäºå±±æ—ï¼Œå¤æœ¨å‚å¤©ï¼Œä½›æ•™æ°›å›´æµ“åšã€‚å¯ºå†…ç´ æ–‹ä½“éªŒå’Œç¥ˆç¦æ´»åŠ¨å€¼å¾—å°è¯•ï¼Œé€‚åˆå¯»æ±‚å®é™çš„æ¸¸å®¢ </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">2</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">5</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">[6]ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 3. è¥¿æºªå›½å®¶æ¹¿åœ°å…¬å›­  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">åŸå¸‚å†…çš„ç”Ÿæ€ç»¿è‚ºï¼Œæ²³é“çºµæ¨ªï¼Œå¯ä¹˜èˆ¹è§‚èµæ¹¿åœ°é£å…‰ï¼Œå¶é‡ç™½é¹­ç­‰æ°´é¸Ÿã€‚æ˜¥å­£è¸é’ã€ç§‹å­£èµèŠ¦çš„ç»ä½³åœ° </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">2</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">3</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">[6]ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 4. å¤©ç«ºä¸‰å¯º  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä½äºè¥¿æ¹–åŒºçµéšå¯ºé™„è¿‘ï¼Œç”±ä¸‰åº§å†å²æ‚ ä¹…çš„å¯ºåº™ç»„æˆï¼Œå»ºç­‘é£æ ¼ç‹¬ç‰¹ï¼Œç¯å¢ƒæ¸…å¹½ï¼Œé€‚åˆæ–‡åŒ–æ¢è®¿å’Œç§‹æ—¥æ¸¸è§ˆ [1]ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 5. æ­å·å®‹åŸ  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä»¥å®‹ä»£é£è²Œä¸ºä¸»é¢˜çš„æ™¯åŒºï¼Œå¯æ¢å¤è£…æ²‰æµ¸å¼ä½“éªŒå¸‚äº•ç”Ÿæ´»ï¼Œå¤§å‹æ¼”å‡ºã€Šå®‹åŸåƒå¤æƒ…ã€‹èåˆå†å²ä¸è‰ºæœ¯ï¼Œè§†è§‰éœ‡æ’¼ </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">2</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">5</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 6. æ²³åŠè¡—  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">å¤è‰²å¤é¦™çš„å•†ä¸šè¡—ï¼Œèšé›†ä¼ ç»Ÿå°åƒã€æ‰‹å·¥è‰ºå“åº—ï¼Œå¯å“å°è‘±åŒ…æ¡§ã€å®šèƒœç³•ç­‰ç¾é£Ÿï¼Œé€‚åˆæ‹æ‘„äººæ–‡é¢˜æç…§ç‰‡ </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">2</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">3</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">[5]ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 7. åƒå²›æ¹–é£æ™¯åŒº  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä»¥1078åº§å²›å±¿é—»åï¼Œæ¢…å³°å²›è§‚æ™¯å°å¯ä¿¯ç°å…¨æ™¯ï¼Œæ¹–å…‰å±±è‰²å¦‚ç”»å·ã€‚é€‚åˆè‡ªé©¾æ¸¸å’Œå±±æ°´æ‘„å½± </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">3</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">6</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 8. èŒ…å®¶åŸ æ™¯åŒº  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">è¥¿æ¹–è¾¹çš„éšé€¸ä¹‹åœ°ï¼Œæ˜¥å­£æ¨±èŠ±ä¸æ¹–æŸ³ç›¸æ˜ ï¼Œç§‹å­£èŠ¦è‹‡æ‘‡æ›³ï¼Œäººå°‘æ™¯ç¾ï¼Œé€‚åˆå¾’æ­¥å’Œè‡ªç„¶æ‘„å½± </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">1</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">3</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 9. ä¹æºªçƒŸæ ‘ï¼ˆä¹æºªåå…«æ¶§ï¼‰  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">å±±æ¶§ã€èŒ¶å›­ä¸æ«å¶äº¤ç»‡çš„å¾’æ­¥è·¯çº¿ï¼Œç§‹å­£çº¢å¶ä¼¼ç«ï¼Œæºªæ°´æ½ºæ½ºï¼Œå……æ»¡è¯—æ„ </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">2</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">6</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">####</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> 10. å¤ªå­æ¹¾å…¬å›­  </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æ˜¥å­£éƒé‡‘é¦™ã€æ¨±èŠ±ç››å¼€ï¼Œè‰²å½©æ–‘æ–“ï¼Œæ˜¯çƒ­é—¨æ‰“å¡åœ°ã€‚é€‚åˆå®¶åº­æ¸¸å’ŒèŠ±å‰æ‘„å½± </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">2</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">3</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token hr punctuation" style="color:hsl(119, 34%, 47%)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">å…¶ä»–æ¨è</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">æµ™è¥¿å¤§é¾™æ¹¾</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šè‡ªç„¶å³¡è°·ä¸ç€‘å¸ƒç¾¤ï¼Œå¤å­£æ¼‚æµé¡¹ç›®åˆºæ¿€ [1]ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">ä¸­å›½å°å­¦åšç‰©é¦†</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šå±•ç¤ºå°ç« æ–‡åŒ–ä¸å†å²ï¼Œé€‚åˆæ–‡åŒ–çˆ±å¥½è€… [1]ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">å¡˜æ –å¤é•‡</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">ï¼šè¿æ²³ç•”çš„æ±Ÿå—æ°´ä¹¡ï¼Œä¿ç•™æ˜æ¸…å»ºç­‘ä¸æ°‘ä¿—é£æƒ… </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">3</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">6</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token bold content" style="font-weight:bold">æ—…è¡Œæç¤º</span><span class="token bold punctuation" style="font-weight:bold;color:hsl(119, 34%, 47%)">**</span><span class="token plain">  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> è¥¿æ¹–ã€çµéšå¯ºç­‰çƒ­é—¨æ™¯ç‚¹å»ºè®®æå‰é¢„çº¦é—¨ç¥¨ [5]ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token list punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> æ˜¥å­£å¤šé›¨ï¼Œéœ€æºå¸¦é›¨å…·ï¼›ç§‹å­£é€‚åˆæˆ·å¤–æ´»åŠ¨ </span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">2</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">5</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">ã€‚  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ï¼ˆå‚è€ƒæ–‡æ¡£ï¼š</span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">1</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">2</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">[3]</span><span class="token url" style="color:hsl(198, 99%, 37%)">[</span><span class="token url content" style="color:hsl(198, 99%, 37%)">5</span><span class="token url" style="color:hsl(198, 99%, 37%)">][</span><span class="token url variable" style="color:hsl(221, 87%, 60%)">6</span><span class="token url" style="color:hsl(198, 99%, 37%)">]</span><span class="token plain">ï¼‰</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£<a href="https://yuluo-yx.github.io/blog/spring-cloud-alibaba-module-rag#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3" class="hash-link" aria-label="å‚è€ƒæ–‡æ¡£çš„ç›´æ¥é“¾æ¥" title="å‚è€ƒæ–‡æ¡£çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>Spring AI RAGï¼š<a href="https://docs.spring.io/spring-ai/reference/api/retrieval-augmented-generation.html" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/api/retrieval-augmented-generation.html</a></li>
<li>é˜¿é‡Œäº‘ IQSï¼š<a href="https://help.aliyun.com/product/2837261.html" target="_blank" rel="noopener noreferrer">https://help.aliyun.com/product/2837261.html</a></li>
</ol>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="AI" term="AI"/>
        <category label="Spring AI Alibaba" term="Spring AI Alibaba"/>
        <category label="Module RAG" term="Module RAG"/>
        <category label="DeepSeek" term="DeepSeek"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä¼˜é›…ä»£ç å®ç°ï¼šSpring Boot çš„ 7 ä¸ªæ‰©å±•æ¥å£]]></title>
        <id>https://yuluo-yx.github.io/blog/spring-boot-extension-interface.md</id>
        <link href="https://yuluo-yx.github.io/blog/spring-boot-extension-interface.md"/>
        <updated>2025-03-10T22:20:00.000Z</updated>
        <summary type="html"><![CDATA[åœ¨ä½¿ç”¨ Spring Boot æ„å»º Web åº”ç”¨ç¨‹åºæ—¶ï¼Œéœ€è¦åœ¨ web å®¹å™¨çš„ä¸åŒç”Ÿå‘½æ—¶æœŸï¼Œæ‰§è¡Œä¸åŒçš„ä»£ç é€»è¾‘ã€‚Spring Boot æ¡†æ¶æä¾›äº†è®¸å¤šæ‰©å±•ç‚¹ï¼Œèƒ½å¤Ÿè®©å¼€å‘è€…ä¼˜é›…åœ°å®šåˆ¶å’Œå¢å¼ºåº”ç”¨ã€‚è¿™äº›æ‰©å±•æ¥å£ä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬è§£å†³å¸¸è§é—®é¢˜ï¼Œè¿˜èƒ½è®©ä»£ç æ›´åŠ ä¼˜é›…ã€çµæ´»ã€‚]]></summary>
        <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨ Spring Boot æ„å»º Web åº”ç”¨ç¨‹åºæ—¶ï¼Œéœ€è¦åœ¨ web å®¹å™¨çš„ä¸åŒç”Ÿå‘½æ—¶æœŸï¼Œæ‰§è¡Œä¸åŒçš„ä»£ç é€»è¾‘ã€‚Spring Boot æ¡†æ¶æä¾›äº†è®¸å¤šæ‰©å±•ç‚¹ï¼Œèƒ½å¤Ÿè®©å¼€å‘è€…ä¼˜é›…åœ°å®šåˆ¶å’Œå¢å¼ºåº”ç”¨ã€‚è¿™äº›æ‰©å±•æ¥å£ä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬è§£å†³å¸¸è§é—®é¢˜ï¼Œè¿˜èƒ½è®©ä»£ç æ›´åŠ ä¼˜é›…ã€çµæ´»ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-applicationrunnerå¯åŠ¨ä»»åŠ¡ä¼˜é›…æ‰§è¡Œ">1. ApplicationRunnerï¼šå¯åŠ¨ä»»åŠ¡ä¼˜é›…æ‰§è¡Œ<a href="https://yuluo-yx.github.io/blog/spring-boot-extension-interface.md#1-applicationrunner%E5%90%AF%E5%8A%A8%E4%BB%BB%E5%8A%A1%E4%BC%98%E9%9B%85%E6%89%A7%E8%A1%8C" class="hash-link" aria-label="1. ApplicationRunnerï¼šå¯åŠ¨ä»»åŠ¡ä¼˜é›…æ‰§è¡Œçš„ç›´æ¥é“¾æ¥" title="1. ApplicationRunnerï¼šå¯åŠ¨ä»»åŠ¡ä¼˜é›…æ‰§è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å½“ Spring Boot åº”ç”¨å¯åŠ¨å®Œæˆåï¼Œæœ‰æ—¶éœ€è¦æ‰§è¡Œä¸€äº›åˆå§‹åŒ–ä»»åŠ¡ã€‚ä¾‹å¦‚ Spring AI Alibaba ä¸­çš„å‘é‡æ•°æ®åˆå§‹åŒ–ï¼Œä¸´æ—¶ç›®å½•æ–‡ä»¶åˆ›å»ºç­‰ã€‚åœ¨ Spring Boot æ¡†æ¶ä¸­æä¾›äº† ApplicationRunner æ¥å£ä»¥ä¼˜é›…çš„æ–¹å¼æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p>
<blockquote>
<p>ä¾‹å¦‚åœ¨å¦‚ä¸‹ä»£ç ä¸­ï¼Œå®Œæˆä¸¤ä¸ªä¸´æ—¶ç›®å½•çš„åˆ›å»ºï¼Œå¹¶åœ¨ web å®¹å™¨åœæ­¢æ—¶ï¼Œä½¿ç”¨ <code>@PreDestroy</code> åˆ é™¤ä¸´æ—¶æ–‡ä»¶ç›®å½•ã€‚</p>
</blockquote>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">TmpFolderConfig</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationRunner</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ImageTmpFolder</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"tmp/image"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">AudioTmpFolder</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"tmp/audio"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationArguments</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Init tmp folder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FilesUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">initTmpFolder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"user.dir"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ImageTmpFolder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FilesUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">initTmpFolder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"user.dir"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">AudioTmpFolder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Init tmp folder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@PreDestroy</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">destroy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FilesUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">deleteDirectory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">File</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"user.dir"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ImageTmpFolder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FilesUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">deleteDirectory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">File</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"user.dir"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">AudioTmpFolder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FilesUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">deleteDirectory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">File</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"user.dir"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token string" style="color:hsl(119, 34%, 47%)">"tmp"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Delete tmp folder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-commandlinerunnerå‘½ä»¤è¡Œä»»åŠ¡æ‰§è¡Œåˆ©å™¨">2. CommandLineRunnerï¼šå‘½ä»¤è¡Œä»»åŠ¡æ‰§è¡Œåˆ©å™¨<a href="https://yuluo-yx.github.io/blog/spring-boot-extension-interface.md#2-commandlinerunner%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E5%88%A9%E5%99%A8" class="hash-link" aria-label="2. CommandLineRunnerï¼šå‘½ä»¤è¡Œä»»åŠ¡æ‰§è¡Œåˆ©å™¨çš„ç›´æ¥é“¾æ¥" title="2. CommandLineRunnerï¼šå‘½ä»¤è¡Œä»»åŠ¡æ‰§è¡Œåˆ©å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å’Œ ApplicationRunner ç±»ä¼¼ï¼ŒCommandLineRunner ä¹Ÿç”¨äºåº”ç”¨å¯åŠ¨åæ‰§è¡Œåˆå§‹åŒ–ä»»åŠ¡ï¼Œä½†å®ƒç›´æ¥æ¥æ”¶å¯åŠ¨å‚æ•°ä¸ºå­—ç¬¦ä¸²æ•°ç»„ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Order</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain">&nbsp;</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æŒ‡å®šæ‰§è¡Œé¡ºåºï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringBootRuntime</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CommandLineRunner</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">boolean</span><span class="token plain"> flag </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Arrays</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">asList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">contains</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"flag"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"flag is true. to do something"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"flag is false..."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-applicationcontextinitializerä¸Šä¸‹æ–‡åˆå§‹åŒ–å¥½å¸®æ‰‹">3. ApplicationContextInitializerï¼šä¸Šä¸‹æ–‡åˆå§‹åŒ–å¥½å¸®æ‰‹<a href="https://yuluo-yx.github.io/blog/spring-boot-extension-interface.md#3-applicationcontextinitializer%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%9D%E5%A7%8B%E5%8C%96%E5%A5%BD%E5%B8%AE%E6%89%8B" class="hash-link" aria-label="3. ApplicationContextInitializerï¼šä¸Šä¸‹æ–‡åˆå§‹åŒ–å¥½å¸®æ‰‹çš„ç›´æ¥é“¾æ¥" title="3. ApplicationContextInitializerï¼šä¸Šä¸‹æ–‡åˆå§‹åŒ–å¥½å¸®æ‰‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ApplicationContextInitializer å¯ä»¥åœ¨ Spring åº”ç”¨ä¸Šä¸‹æ–‡åˆ·æ–°ä¹‹å‰æ‰§è¡Œä¸€äº›å®šåˆ¶åŒ–æ“ä½œï¼Œç‰¹åˆ«é€‚åˆè¿›è¡Œç¯å¢ƒç›¸å…³çš„é…ç½®ä¿®æ”¹ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringBootRuntime</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationContextInitializer</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ConfigurableApplicationContext</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">initialize</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurableApplicationContext</span><span class="token plain"> applicationContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åœ¨ Spring ä¸Šä¸‹æ–‡åˆ·æ–°å‰æ‰§è¡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¯ä»¥ä¿®æ”¹æˆ–å¢å¼º Spring ä¸Šä¸‹æ–‡çš„é…ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurableEnvironment</span><span class="token plain"> environment </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> applicationContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getEnvironment</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¾‹å¦‚ï¼Œæ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„å±æ€§æº</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		environment</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getPropertySources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addFirst</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MapPropertySource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token string" style="color:hsl(119, 34%, 47%)">"CustomProperties"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Collections</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">singletonMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"indi.yuluo.app.data.init.enabled"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"true"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"åº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹åŒ–å™¨æ·»åŠ äº†è‡ªå®šä¹‰å±æ€§æº"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¹‹åé€šè¿‡ <code>META-INF/spring.factories</code> ä¸­æ³¨å†Œæˆ–è€…åœ¨åº”ç”¨å¯åŠ¨æ—¶æ³¨å†Œï¼š</p>
<ol>
<li>
<p>åœ¨ spring.factories ä¸­æ³¨å†Œ</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">org</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">springframework</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">context</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationContextInitializer</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">com</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">example</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringBootRuntime</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>åœ¨åº”ç”¨å¯åŠ¨æ—¶æ³¨å†Œ</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@SpringBootApplication</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Main</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringApplication</span><span class="token plain"> app </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringApplication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ‰‹åŠ¨æ·»åŠ  ApplicationContextInitializer</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		app</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addInitializers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationContextInitializer</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ConfigurableApplicationContext</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> applicationContext </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringBootRuntime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">initialize</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">applicationContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		app</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å¯åŠ¨æ—¶è¾“å‡º</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> :: Spring Boot ::                (v3.2.3)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">åº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹åŒ–å™¨æ·»åŠ äº†è‡ªå®šä¹‰å±æ€§æº</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">2025-03-10T21:52:44.799+08:00  INFO 11596 --- [           main] indi.yuluo.Main  </span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="4-beanpostprocessorbeanå¯¹è±¡å¢å¼ºå¤„ç†å™¨">4. BeanPostProcessorï¼šBeanå¯¹è±¡å¢å¼ºå¤„ç†å™¨<a href="https://yuluo-yx.github.io/blog/spring-boot-extension-interface.md#4-beanpostprocessorbean%E5%AF%B9%E8%B1%A1%E5%A2%9E%E5%BC%BA%E5%A4%84%E7%90%86%E5%99%A8" class="hash-link" aria-label="4. BeanPostProcessorï¼šBeanå¯¹è±¡å¢å¼ºå¤„ç†å™¨çš„ç›´æ¥é“¾æ¥" title="4. BeanPostProcessorï¼šBeanå¯¹è±¡å¢å¼ºå¤„ç†å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>BeanPostProcessor å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ Bean åˆå§‹åŒ–å‰åå¯¹ Bean è¿›è¡Œä¿®æ”¹æˆ–å¢å¼ºï¼Œæ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹çš„é‡è¦å·¥å…·ã€‚åœ¨ä¸€äº›æ¡†æ¶ä¸­å¾ˆå¸¸è§ï¼Œä¸å¦‚ spring cloud alibaba ä¸­</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">NacosAnnotationProcessor</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BeanPostProcessor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PriorityOrdered</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationContextAware</span><span class="token plain"> </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ......</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="5-environmentpostprocessorç¯å¢ƒé…ç½®åå¤„ç†å™¨">5. EnvironmentPostProcessorï¼šç¯å¢ƒé…ç½®åå¤„ç†å™¨<a href="https://yuluo-yx.github.io/blog/spring-boot-extension-interface.md#5-environmentpostprocessor%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%90%8E%E5%A4%84%E7%90%86%E5%99%A8" class="hash-link" aria-label="5. EnvironmentPostProcessorï¼šç¯å¢ƒé…ç½®åå¤„ç†å™¨çš„ç›´æ¥é“¾æ¥" title="5. EnvironmentPostProcessorï¼šç¯å¢ƒé…ç½®åå¤„ç†å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><code>EnvironmentPostProcessor</code> æ˜¯ Spring Framework ä¸­çš„ä¸€ä¸ªæ¥å£ï¼Œå…è®¸å¼€å‘è€…åœ¨ Spring åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„ç¯å¢ƒï¼ˆ<code>Environment</code>ï¼‰å‡†å¤‡å¥½ä¹‹åä½†åœ¨ä¸Šä¸‹æ–‡åˆ·æ–°ä¹‹å‰è¿›è¡Œè‡ªå®šä¹‰å¤„ç†ã€‚ä¸»è¦ç”¨äºåœ¨ Spring Boot åº”ç”¨çš„å¯åŠ¨è¿‡ç¨‹ä¸­å¯¹ç¯å¢ƒè¿›è¡Œä¿®æ”¹å’Œå¢å¼ºã€‚</p>
<p>ç›¸æ¯”äº<strong>ApplicationContextInitializer</strong> ï¼Œ<strong>EnvironmentPostProcessor</strong> æ›´åŠ ä¸“æ³¨äº <code>Environment</code> çš„å¤„ç†ï¼Œé€‚ç”¨äºé…ç½®å’Œå±æ€§ç®¡ç†ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain">&nbsp;</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PropertyFileEnvironmentPostProcessor</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain">&nbsp;</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">EnvironmentPostProcessor</span><span class="token plain">&nbsp;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain">&nbsp;</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">YamlPropertySourceLoader</span><span class="token plain"> loader </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain">&nbsp;</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">YamlPropertySourceLoader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain">&nbsp;</span><span class="token function" style="color:hsl(221, 87%, 60%)">postProcessEnvironment</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurableEnvironment</span><span class="token plain"> environment</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringApplication</span><span class="token plain"> application</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain">&nbsp;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è‡ªå®šä¹‰ç¯å¢ƒå˜é‡å¤„ç†é€»è¾‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¾‹å¦‚ï¼Œæ ¹æ®ç¯å¢ƒåŠ è½½ä¸åŒçš„é…ç½®æ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> env </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> environment</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"spring.profiles.active"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain">&nbsp;</span><span class="token string" style="color:hsl(119, 34%, 47%)">"default"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token plain"> resource </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain">&nbsp;</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ClassPathResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">format</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"config/%s-config.yml"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain">&nbsp;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åŠ è½½ç‰¹å®šç¯å¢ƒçš„é…ç½®æ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PropertySource</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics operator" style="color:hsl(221, 87%, 60%)">?</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> propertySource </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">loader</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">load</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"environmentSpecificConfig"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> resource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; environment</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getPropertySources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addLast</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">propertySource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å·²åŠ è½½ç¯å¢ƒç‰¹å®šé…ç½®ï¼š{}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> resource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getFilename</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain">&nbsp;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">warn</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"æ— æ³•åŠ è½½ç¯å¢ƒç‰¹å®šé…ç½®æ–‡ä»¶"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é€šè¿‡åœ¨ <code>META-INF/spring.factories</code>æ³¨å†Œè¿›è¡Œä½¿ç”¨ï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">org.springframework.boot.env.EnvironmentPostProcessor=\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">com.example.PropertyFileEnvironmentPostProcessor</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="6-applicationlisteneråº”ç”¨äº‹ä»¶ç›‘å¬å™¨">6. ApplicationListenerï¼šåº”ç”¨äº‹ä»¶ç›‘å¬å™¨<a href="https://yuluo-yx.github.io/blog/spring-boot-extension-interface.md#6-applicationlistener%E5%BA%94%E7%94%A8%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E5%99%A8" class="hash-link" aria-label="6. ApplicationListenerï¼šåº”ç”¨äº‹ä»¶ç›‘å¬å™¨çš„ç›´æ¥é“¾æ¥" title="6. ApplicationListenerï¼šåº”ç”¨äº‹ä»¶ç›‘å¬å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><code>ApplicationListener</code> æ˜¯ Spring Framework ä¸­çš„ä¸€ä¸ªæ¥å£ï¼Œç”¨äºç›‘å¬ Spring åº”ç”¨ä¸Šä¸‹æ–‡ä¸­çš„äº‹ä»¶ã€‚é€šè¿‡å®ç° <code>ApplicationListener</code> æ¥å£ï¼Œä½ å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­å¤„ç†å„ç§äº‹ä»¶ï¼Œä¾‹å¦‚ä¸Šä¸‹æ–‡åˆ·æ–°ã€åº”ç”¨å¯åŠ¨ã€Bean æ³¨å†Œç­‰ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain">&nbsp;</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationStartupListener</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain">&nbsp;</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationListener</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ApplicationStartedEvent</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">&nbsp;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain">&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain">&nbsp;</span><span class="token function" style="color:hsl(221, 87%, 60%)">onApplicationEvent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationStartedEvent</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain">&nbsp;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å“åº”åº”ç”¨å¯åŠ¨äº‹ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ApplicationStartedEventåœ¨åº”ç”¨ä¸Šä¸‹æ–‡åˆ·æ–°åã€CommandLineRunneræ‰§è¡Œå‰è§¦å‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token plain">&nbsp;startupTime </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getTimestamp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token plain">&nbsp;uptime </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">currentTimeMillis</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> startupTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp; log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"åº”ç”¨å¯åŠ¨å®Œæˆï¼ŒèŠ±è´¹æ—¶é—´: {}ms"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> uptime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œå…¶ä»–éœ€è¦åº”ç”¨å®Œå…¨å¯åŠ¨åçš„é€»è¾‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¦‚åˆå§‹åŒ–ç¼“å­˜ã€å»ºç«‹ç›‘æ§ç­‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="7-beanfactorypostprocessorbean-ä¿®æ”¹å™¨">7. BeanFactoryPostProcessorï¼šBean ä¿®æ”¹å™¨<a href="https://yuluo-yx.github.io/blog/spring-boot-extension-interface.md#7-beanfactorypostprocessorbean-%E4%BF%AE%E6%94%B9%E5%99%A8" class="hash-link" aria-label="7. BeanFactoryPostProcessorï¼šBean ä¿®æ”¹å™¨çš„ç›´æ¥é“¾æ¥" title="7. BeanFactoryPostProcessorï¼šBean ä¿®æ”¹å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><code>BeanFactoryPostProcessor</code> æ˜¯ Spring Framework ä¸­çš„ä¸€ä¸ªæ¥å£ï¼Œç”¨äºåœ¨ Spring å®¹å™¨çš„ <code>BeanFactory</code> æ ‡å‡†åˆå§‹åŒ–ä¹‹åã€Bean å®ä¾‹åŒ–ä¹‹å‰å¯¹ Bean å®šä¹‰è¿›è¡Œä¿®æ”¹ã€‚è¿™ä¸ªæ¥å£å…è®¸å¼€å‘è€…åœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­è‡ªå®šä¹‰å’Œä¿®æ”¹ Bean çš„å®šä¹‰ï¼Œæä¾›äº†å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomBeanFactoryPostProcessor</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BeanFactoryPostProcessor</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">postProcessBeanFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurableListableBeanFactory</span><span class="token plain"> beanFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¿®æ”¹ç‰¹å®š Bean çš„å±æ€§</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BeanDefinition</span><span class="token plain"> beanDefinition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> beanFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getBeanDefinition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"myBean"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        beanDefinition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getPropertyValues</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"propertyName"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"newValue"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"BeanFactoryPostProcessor å·²æ‰§è¡Œï¼Œä¿®æ”¹äº† Bean çš„å±æ€§"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// bean å®šä¹‰å¦‚ä¸‹ï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MyBean</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> propertyName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setPropertyName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> propertyName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">propertyName </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> propertyName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getPropertyName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> propertyName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¹‹åå¯ä»¥åœ¨ spring å®¹å™¨çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MyCommandLineRunner</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CommandLineRunner</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Autowired</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MyBean</span><span class="token plain"> myBean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä¿®æ”¹åçš„å±æ€§å€¼: "</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> myBean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getPropertyName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Spring Boot" term="Spring Boot"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨ Ollama æ¨¡å‹ + Spring AI æ­å»º RAG åº”ç”¨]]></title>
        <id>https://yuluo-yx.github.io/blog/use-spring-ai-and-ollama-build-rag-app</id>
        <link href="https://yuluo-yx.github.io/blog/use-spring-ai-and-ollama-build-rag-app"/>
        <updated>2025-02-23T18:35:06.000Z</updated>
        <summary type="html"><![CDATA[ä½¿ç”¨ Ollama + Spring AI æ­å»º RAG åº”ç”¨]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ä½¿ç”¨-ollama--spring-ai-æ­å»º-rag-åº”ç”¨">ä½¿ç”¨ Ollama + Spring AI æ­å»º RAG åº”ç”¨<a href="https://yuluo-yx.github.io/blog/use-spring-ai-and-ollama-build-rag-app#%E4%BD%BF%E7%94%A8-ollama--spring-ai-%E6%90%AD%E5%BB%BA-rag-%E5%BA%94%E7%94%A8" class="hash-link" aria-label="ä½¿ç”¨ Ollama + Spring AI æ­å»º RAG åº”ç”¨çš„ç›´æ¥é“¾æ¥" title="ä½¿ç”¨ Ollama + Spring AI æ­å»º RAG åº”ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä»£ç åœ°å€ï¼š<a href="https://github.com/deigmata-paideias/deigmata-paideias/tree/main/ai/ollama-rag" target="_blank" rel="noopener noreferrer">https://github.com/deigmata-paideias/deigmata-paideias/tree/main/ai/ollama-rag</a></p>
<p>æ¨¡å‹ï¼š</p>
<ol>
<li>Embedding æ¨¡å‹ï¼šnomic-embed-text<!-- -->:latest</li>
<li>Dashscope æ¨¡å‹ï¼šdeepseek-r1</li>
<li>Ollama Chat æ¨¡å‹ï¼šdeepseek-r1:8b</li>
</ol>
<p>Ollama å’Œæ¨¡å‹ä¸‹è½½ï¼š<a href="https://yuluo-yx.github.io/blog/windows-deploy-ollama3-install-llama3/" target="_blank" rel="noopener noreferrer">https://yuluo-yx.github.io/blog/windows-deploy-ollama3-install-llama3/</a>
Docker éƒ¨ç½² ESï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/docker-compose/es" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/docker-compose/es</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ä½¿ç”¨-spring-ai">ä½¿ç”¨ Spring AI<a href="https://yuluo-yx.github.io/blog/use-spring-ai-and-ollama-build-rag-app#%E4%BD%BF%E7%94%A8-spring-ai" class="hash-link" aria-label="ä½¿ç”¨ Spring AIçš„ç›´æ¥é“¾æ¥" title="ä½¿ç”¨ Spring AIçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æ ¸å¿ƒä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="applicationinit">ApplicationInit<a href="https://yuluo-yx.github.io/blog/use-spring-ai-and-ollama-build-rag-app#applicationinit" class="hash-link" aria-label="ApplicationInitçš„ç›´æ¥é“¾æ¥" title="ApplicationInitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œä¸»è¦åšçš„äº‹æƒ…æ˜¯ï¼š</p>
<ol>
<li>ä» <code>resources/data</code> ç›®å½•åŠ è½½ pdf æ–‡ä»¶ï¼Œè½¬ä¸º Resource èµ„æºå¯¹è±¡ï¼›</li>
<li>å°† Resource èµ„æºå¯¹è±¡è½¬åŒ–ä¸º Spring AI çš„ Document å¯¹è±¡ï¼›</li>
<li>è°ƒç”¨ Ollama çš„ embedding æ¨¡å‹ï¼Œè½¬ä¸ºå‘é‡å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­ã€‚</li>
</ol>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationInit</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationRunner</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ResourceLoader</span><span class="token plain"> resourceLoader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ElasticsearchClient</span><span class="token plain"> elasticsearchClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ElasticsearchVectorStoreProperties</span><span class="token plain"> options</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> textField </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"content"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> vectorField </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"embedding"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ResourceLoader</span><span class="token plain"> resourceLoader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ElasticsearchClient</span><span class="token plain"> elasticsearchClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ElasticsearchVectorStoreProperties</span><span class="token plain"> options</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">resourceLoader </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> resourceLoader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">vectorStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">elasticsearchClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> elasticsearchClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">options </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ApplicationArguments</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 1. load pdf resources.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> pdfResources </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">loadPdfResources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 2. parse pdf resources to Documents.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">parsePdfResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pdfResources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 3. import to ES.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token function" style="color:hsl(221, 87%, 60%)">importToES</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"RAG application init finished"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">loadPdfResources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> pdfResources </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"åŠ è½½ PDF èµ„æº================================="</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ResourcePatternResolver</span><span class="token plain"> resolver </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ResourcePatternResolver</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> resourceLoader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> resources </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> resolver</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classpath:data"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/*.pdf"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token plain"> resource </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> resources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">resource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">exists</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					pdfResources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">resource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"åŠ è½½ PDF èµ„æºå®Œæˆ================================="</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RuntimeException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Failed to load PDF resources"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> pdfResources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">parsePdfResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> pdfResources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> resList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¼€å§‹è§£æ PDF èµ„æº================================="</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token plain"> springAiResource </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> pdfResources</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 1. parse document</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DocumentReader</span><span class="token plain"> reader </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PagePdfDocumentReader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">springAiResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> reader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"{} documents loaded"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 2. split trunks</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> splitDocuments </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">TokenTextSplitter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">apply</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"{} documents split"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> splitDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 3. add res list</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			resList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addAll</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">splitDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"è§£æ PDF èµ„æºå®Œæˆ================================="</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> resList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">importToES</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¼€å§‹å¯¼å…¥æ•°æ®åˆ° ES ================================="</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"create embedding and save to vector store"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token function" style="color:hsl(221, 87%, 60%)">createIndexIfNotExists</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¯¼å…¥æ•°æ®åˆ° ES å®Œæˆ================================="</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createIndexIfNotExists</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> indexName </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getIndexName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Integer</span><span class="token plain"> dimsLength </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getDimensions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">hasText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">indexName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IllegalArgumentException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Elastic search index name must be provided"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">boolean</span><span class="token plain"> exists </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> elasticsearchClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">indices</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">exists</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">idx </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> idx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">indexName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">exists</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Index {} already exists. Skipping creation."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> indexName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> similarityAlgo </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getSimilarity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IndexSettings</span><span class="token plain"> indexSettings </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IndexSettings</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">settings </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> settings</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">numberOfShards</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">valueOf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">numberOfReplicas</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">valueOf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Property</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> properties </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			properties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorField</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Property</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">property </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> property</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">denseVector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DenseVectorProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dense </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> dense</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">dims</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dimsLength</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">similarity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">similarityAlgo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			properties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">textField</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Property</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">property </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> property</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">TextProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">t </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> t</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Property</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> metadata </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ref_doc_id"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Property</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">property </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> property</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">keyword</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">KeywordProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">k </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> k</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			properties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"metadata"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Property</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">property </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> property</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">object</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">op </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> op</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">properties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CreateIndexResponse</span><span class="token plain"> indexResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> elasticsearchClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">indices</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">createIndexBuilder </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> createIndexBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">indexName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">settings</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">indexSettings</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">mappings</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">TypeMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mappings </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> mappings</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">properties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">properties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">indexResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">acknowledged</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RuntimeException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"failed to create index"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"create elasticsearch index {} successfully"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> indexName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"failed to create index"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RuntimeException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="airagservice">AIRagService<a href="https://yuluo-yx.github.io/blog/use-spring-ai-and-ollama-build-rag-app#airagservice" class="hash-link" aria-label="AIRagServiceçš„ç›´æ¥é“¾æ¥" title="AIRagServiceçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨æ­¤æ–‡ä»¶ä¸­ï¼Œæ‰§è¡Œç”¨æˆ·é—®é¢˜çš„æŸ¥è¯¢ã€‚ä¸»è¦çš„ä»»åŠ¡æ˜¯ï¼š</p>
<ol>
<li>åŠ è½½ prompt æ¨¡æ¿ï¼Œæ¥å—ç”¨æˆ·çš„ promptï¼›</li>
<li>æ‰§è¡Œå‘é‡ç›¸ä¼¼æ€§æ£€ç´¢ï¼Œè·å¾—å‘é‡ä¸Šä¸‹æ–‡ï¼›</li>
<li>è°ƒç”¨æ¨¡å‹ï¼Œè·å¾—è¾“å‡ºã€‚ï¼ˆdeepseek-r1 æœ‰  thinking è¿‡ç¨‹ï¼Œæ—¢ Ressoning Contentï¼‰</li>
</ol>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">AIRagService</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">AIRagService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classpath:/prompts/system-qa.st"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token plain"> systemResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> ragChatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> ragClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> textField </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"content"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">AIRagService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä½¿ç”¨ DashScope ChatModel</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// @Qualifier("dashscopeChatModel") ChatModel chatModel,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> vectorStore</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">ragChatModel </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">vectorStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">ragClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ragChatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionAnswerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">retrieve</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Get the vector store prompt tmpl.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> promptTemplate </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">systemResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Enable hybrid search, both embedding and full text search</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SearchRequest</span><span class="token plain"> searchRequest </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SearchRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token function" style="color:hsl(221, 87%, 60%)">topK</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">4</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">similarityThresholdAll</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filterExpression</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FilterExpressionBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">								</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">eq</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">textField</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Build ChatClient with retrieval rerank advisor:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ChatClient runtimeChatClient = ChatClient.builder(chatModel)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//		.defaultAdvisors(new RetrievalRerankAdvisor(vectorStore, rerankModel, searchRequest, promptTemplate, 0.1))</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//		.build();</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Spring AI RetrievalAugmentationAdvisor</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Advisor retrievalAugmentationAdvisor = RetrievalAugmentationAdvisor.builder()</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//		.queryTransformers(RewriteQueryTransformer.builder()</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//				.chatClientBuilder(ChatClient.builder(ragChatModel).build().mutate())</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//				.build())</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//		.documentRetriever(VectorStoreDocumentRetriever.builder()</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//				.similarityThreshold(0.50)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//				.vectorStore(vectorStore)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//				.build())</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//		.build();</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Retrieve and llm generate</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// return ragClient.prompt()</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//		.advisors(retrievalAugmentationAdvisor)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//		.user(prompt)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//		.stream()</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">//		.content();</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ragChatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">advisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionAnswerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> searchRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> promptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Resource</span><span class="token plain"> systemResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Loading system resource: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> systemResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getURI</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> systemResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getContentAsString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StandardCharsets</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">UTF_8</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RuntimeException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŒæ—¶ï¼Œæ ¹æ®ä»£ç ä¸­çš„æ³¨é‡Šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Spring AI Alibaba æä¾›çš„ Rerank é‡æ’åºå®ç°ï¼Œæé«˜æ£€ç´¢ç²¾åº¦ã€‚</p>
<p>è°ƒç”¨æ•ˆæœå¦‚ä¸‹ï¼šï¼ˆç”»çº¿ä¹‹å‰ä¸º deepseek çš„æ€è€ƒè¿‡ç¨‹ï¼‰</p>
<p><img decoding="async" loading="lazy" alt="call" src="https://yuluo-yx.github.io/assets/images/img_1-bdb816b890324d6922cbc99b68d481ba.png" width="1915" height="582" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é€‚é…-spring-ai-alibaba-dashscope">é€‚é… Spring AI Alibaba DashScope<a href="https://yuluo-yx.github.io/blog/use-spring-ai-and-ollama-build-rag-app#%E9%80%82%E9%85%8D-spring-ai-alibaba-dashscope" class="hash-link" aria-label="é€‚é… Spring AI Alibaba DashScopeçš„ç›´æ¥é“¾æ¥" title="é€‚é… Spring AI Alibaba DashScopeçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¼•å…¥ spring-ai-alibaba-starter</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI Alibaba DashScope --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.0.0-M5.1</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ï¼šï¼ˆç¡®ä¿åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªæ¨¡å‹æ³¨å…¥åˆ° IOC å®¹å™¨ä¸­ï¼Œéœ€è¦å…³é—­å…¶ä»– chat å’Œ embedding æ¨¡å‹çš„æ³¨å…¥ï¼‰</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">application</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ollama</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">rag</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">dashscope</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">api-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">AI_DASHSCOPE_API_KEY</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">options</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">r1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">embedding</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">enabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ollama</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">base-url</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">//127.0.0.1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token number" style="color:hsl(35, 99%, 36%)">11434</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">r1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">8b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">enabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">embedding</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> nomic</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">embed</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">vectorstore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">elasticsearch</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">index-name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ollama</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">rag</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">embedding</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">index</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">similarity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> cosine</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">dimensions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">768</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">elasticsearch</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">uris</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">//127.0.0.1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token number" style="color:hsl(35, 99%, 36%)">9200</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ service ä¸­æ³¨å…¥ DashScopeChatModel</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">AIRagService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ChatModel chatModel,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä½¿ç”¨ DashScope ChatModel</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"dashscopeChatModel"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> vectorStore</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">ragChatModel </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">vectorStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">ragClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ragChatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionAnswerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è°ƒç”¨æ•ˆæœå¦‚ä¸‹ï¼šï¼ˆSpring AI Alibaba 1.0.0-M5.1 ä¸æ”¯æŒ reasoning content é€å‡ºï¼Œåœ¨ M6 ä¸­æ”¯æŒï¼‰</p>
<p><img decoding="async" loading="lazy" alt="DashScope Call" src="https://yuluo-yx.github.io/assets/images/img-c7761ae79437527afe0f3e5eb22200ac.png" width="1744" height="262" class="img_c29J"></p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="DeepSeel" term="DeepSeel"/>
        <category label="Ollama" term="Ollama"/>
        <category label="Spring AI" term="Spring AI"/>
        <category label="RAG" term="RAG"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨ Ollama éƒ¨ç½² DeepSeek å¹¶ä½¿ç”¨ Spring AI Alibaba è°ƒç”¨]]></title>
        <id>https://yuluo-yx.github.io/blog/ä½¿ç”¨-Ollama-éƒ¨ç½²-DeepSeek-å¹¶ä½¿ç”¨-Spring-AI-Alibaba-è°ƒç”¨</id>
        <link href="https://yuluo-yx.github.io/blog/ä½¿ç”¨-Ollama-éƒ¨ç½²-DeepSeek-å¹¶ä½¿ç”¨-Spring-AI-Alibaba-è°ƒç”¨"/>
        <updated>2025-02-16T20:26:55.000Z</updated>
        <summary type="html"><![CDATA[Ollama éƒ¨ç½² Deepseek R1]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ollama-éƒ¨ç½²-deepseek-r1">Ollama éƒ¨ç½² Deepseek R1<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#ollama-%E9%83%A8%E7%BD%B2-deepseek-r1" class="hash-link" aria-label="Ollama éƒ¨ç½² Deepseek R1çš„ç›´æ¥é“¾æ¥" title="Ollama éƒ¨ç½² Deepseek R1çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å®˜ç½‘ï¼š<a href="https://www.deepseek.com/" target="_blank" rel="noopener noreferrer">https://www.deepseek.com/</a></p>
<p>Githubï¼š<a href="https://github.com/deepseek-ai" target="_blank" rel="noopener noreferrer">https://github.com/deepseek-ai</a></p>
<p>Ollamaï¼š<a href="https://ollama.com/" target="_blank" rel="noopener noreferrer">https://ollama.com/</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="docker-compose">Docker Compose<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#docker-compose" class="hash-link" aria-label="Docker Composeçš„ç›´æ¥é“¾æ¥" title="Docker Composeçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>éƒ¨ç½²ä¸€ä¸ª Ollama å’Œ open-webui æœåŠ¡ï¼š</p>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">services</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ollama</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">volumes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> ./models</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">/root/.ollama  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å°†æœ¬åœ°æ–‡ä»¶å¤¹æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„ /root/.ollama ç›®å½• ï¼ˆæ¨¡å‹ä¸‹è½½ä½ç½®ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">container_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ollama</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">pull_policy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> always</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">tty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">restart</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> unless</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">stopped</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">image</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ollama/ollama</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ports</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> 11434</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token number" style="color:hsl(35, 99%, 36%)">11434</span><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Ollama API ç«¯å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">open-webui</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> .</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">         </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">OLLAMA_BASE_URL</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'/ollama'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">dockerfile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Dockerfile</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">image</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ghcr.io/open</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">webui/open</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">webui</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">main</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">container_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> open</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">webui</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">volumes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> ./open</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">webui</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">/app/backend/data  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å‰ç«¯é¡µé¢æ•°æ®æŒ‚è½½ä½ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">depends_on</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> ollama</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ports</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">OPEN_WEBUI_PORT</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">3005</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token number" style="color:hsl(35, 99%, 36%)">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">environment</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'OLLAMA_BASE_URL=http://ollama:11434'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'WEBUI_SECRET_KEY='</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">extra_hosts</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> host.docker.internal</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">host</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">gateway</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">restart</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> unless</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">stopped</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å®‰è£…-deepseek-r1">å®‰è£… DeepSeek-R1<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#%E5%AE%89%E8%A3%85-deepseek-r1" class="hash-link" aria-label="å®‰è£… DeepSeek-R1çš„ç›´æ¥é“¾æ¥" title="å®‰è£… DeepSeek-R1çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>è¿›å…¥ docker ollama å®¹å™¨ä¸‹è½½ deepseek-r1 æ¨¡å‹</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># è¿›å…¥å®¹å™¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ </span><span class="token function" style="color:hsl(221, 87%, 60%)">docker</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-it</span><span class="token plain"> ollama </span><span class="token function" style="color:hsl(221, 87%, 60%)">bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŸ¥çœ‹ ollama å·²æœ‰çš„æ¨¡å‹ï¼ˆç¬¬ä¸€æ¬¡ä¸‹è½½æ²¡æœ‰æ­£å¸¸ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ root@c5e5ff20a533:/</span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ollama list</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">NAME            ID              SIZE    MODIFIED</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">llama3:latest   365c0bd3c000    </span><span class="token number" style="color:hsl(35, 99%, 36%)">4.7</span><span class="token plain"> GB  </span><span class="token number" style="color:hsl(35, 99%, 36%)">7</span><span class="token plain"> months ago</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">qwen:4b         d53d04290064    </span><span class="token number" style="color:hsl(35, 99%, 36%)">2.3</span><span class="token plain"> GB  </span><span class="token number" style="color:hsl(35, 99%, 36%)">7</span><span class="token plain"> months ago</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># é€‰æ‹©ä¸‹è½½ 8bï¼ˆå¯ä»¥æ ¹æ®æœºå™¨ç¯å¢ƒé€‰æ‹©ä¸åŒçš„æ¨¡å‹ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ollama run deepseek-r1:8b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ä¸‹è½½æˆåŠŸå¦‚ä¸‹æ‰€ç¤º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="open-webui-ä½¿ç”¨">open-webui ä½¿ç”¨<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#open-webui-%E4%BD%BF%E7%94%A8" class="hash-link" aria-label="open-webui ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="open-webui ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p><strong>å¦‚æœå‡ºç°æ¨¡å‹å¤±è´¥çš„é”™è¯¯ï¼Œå°è¯•æ›´æ–°å…ˆ ollama ç‰ˆæœ¬ä¹‹åé‡è¯•ï¼</strong></p>
</blockquote>
<p>åœ¨å³ä¸Šè§’é€‰æ‹©æ¨¡å‹ï¼š</p>
<p><img decoding="async" loading="lazy" alt="Open WebUI é€‰æ‹©æ¨¡å‹" src="https://yuluo-yx.github.io/assets/images/image-4-71924b5a7bbd4ec273a383f5b6377278.png" width="621" height="417" class="img_c29J"></p>
<p>ä½¿ç”¨æ¼”ç¤º:</p>
<p><img decoding="async" loading="lazy" alt="Open WebUI è°ƒç”¨" src="https://yuluo-yx.github.io/assets/images/image-1-e1bd33dcc9bd97bfe17afccdd6a243a5.png" width="1616" height="1998" class="img_c29J"></p>
<p>çœ‹èµ·æ¥æ•ˆæœä¸é”™ï¼Œæ­ªç‘å¤å¾·ï¼</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="spring-ai-alibaba-è°ƒç”¨">Spring AI Alibaba è°ƒç”¨<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#spring-ai-alibaba-%E8%B0%83%E7%94%A8" class="hash-link" aria-label="Spring AI Alibaba è°ƒç”¨çš„ç›´æ¥é“¾æ¥" title="Spring AI Alibaba è°ƒç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æ¥ä¸‹æ¥æ¼”ç¤ºå¦‚ä½• Spring AI Alibaba å®Œæˆä¸€ä¸ªç®€å•çš„ Chat åº”ç”¨ã€‚</p>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="pomxml">pom.xml<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#pomxml" class="hash-link" aria-label="pom.xmlçš„ç›´æ¥é“¾æ¥" title="pom.xmlçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ ollama éƒ¨ç½² deepseek r1ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨ ollama starterã€‚</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token prolog" style="color:hsl(230, 4%, 64%)">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">project</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">http://maven.apache.org/POM/4.0.0</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">		 </span><span class="token tag attr-name namespace" style="color:hsl(35, 99%, 36%)">xmlns:</span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">		 </span><span class="token tag attr-name namespace" style="color:hsl(35, 99%, 36%)">xsi:</span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">modelVersion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">4.0.0</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">modelVersion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">parent</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">indi.yuluo</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">examples</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.0-SNAPSHOT</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">parent</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">indi.yuluo.deepseek</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">deepseek-r1-saa</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">3.3.4</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-ollama-spring-boot-starter</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.0.0-M6</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">repositories</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">repository</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">id</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-milestones</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">id</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">name</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">Spring Milestones</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">name</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">url</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">https://repo.spring.io/milestone</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">url</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">snapshots</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">enabled</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">false</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">enabled</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">snapshots</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">repository</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">repositories</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">project</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="applicationyml">application.yml<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#applicationyml" class="hash-link" aria-label="application.ymlçš„ç›´æ¥é“¾æ¥" title="application.ymlçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">server</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">port</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">application</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">r1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">saa</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ollama</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">base-url</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token number" style="color:hsl(35, 99%, 36%)">11434</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">r1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">8b</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¯åŠ¨ç±»">å¯åŠ¨ç±»<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#%E5%90%AF%E5%8A%A8%E7%B1%BB" class="hash-link" aria-label="å¯åŠ¨ç±»çš„ç›´æ¥é“¾æ¥" title="å¯åŠ¨ç±»çš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> </span><span class="token namespace">indi</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">yuluo</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">boot</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">SpringApplication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">boot</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">autoconfigure</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">SpringBootApplication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author yuluo</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author &lt;a href="mailto:yuluo08290126@gmail.com"&gt;yuluo&lt;/a&gt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@SpringBootApplication</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DeepSeekChatApplication</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpringApplication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DeepSeekChatApplication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="controller">controller<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#controller" class="hash-link" aria-label="controllerçš„ç›´æ¥é“¾æ¥" title="controllerçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> </span><span class="token namespace">indi</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">yuluo</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">deepseek</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">controller</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">jakarta</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">servlet</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">http</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">HttpServletResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">reactor</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">core</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">publisher</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">chat</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">client</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">chat</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">prompt</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ollama</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">OllamaChatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">web</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">bind</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">web</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">bind</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">PathVariable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">web</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">bind</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">web</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">bind</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">RestController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author yuluo</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author &lt;a href="mailto:yuluo08290126@gmail.com"&gt;yuluo&lt;/a&gt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/deepseek/chat"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DeepSeekController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DeepSeekController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OllamaChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/{prompt}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@PathVariable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">value </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"prompt"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HttpServletResponse</span><span class="token plain"> response</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setCharacterEncoding</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"UTF-8"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æµè§ˆå™¨è¯·æ±‚æµ‹è¯•">æµè§ˆå™¨è¯·æ±‚æµ‹è¯•<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AF%B7%E6%B1%82%E6%B5%8B%E8%AF%95" class="hash-link" aria-label="æµè§ˆå™¨è¯·æ±‚æµ‹è¯•çš„ç›´æ¥é“¾æ¥" title="æµè§ˆå™¨è¯·æ±‚æµ‹è¯•çš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<p><img decoding="async" loading="lazy" alt="Spring AI Alibaba Call" src="https://yuluo-yx.github.io/assets/images/image-3-a87e2351a92c304c49a010ffc621d5f4.png" width="647" height="236" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="deepseek4j-è°ƒç”¨">DeepSeek4j è°ƒç”¨<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#deepseek4j-%E8%B0%83%E7%94%A8" class="hash-link" aria-label="DeepSeek4j è°ƒç”¨çš„ç›´æ¥é“¾æ¥" title="DeepSeek4j è°ƒç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="pomxml-1">pom.xml<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#pomxml-1" class="hash-link" aria-label="pom.xmlçš„ç›´æ¥é“¾æ¥" title="pom.xmlçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token prolog" style="color:hsl(230, 4%, 64%)">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">project</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">http://maven.apache.org/POM/4.0.0</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">        </span><span class="token tag attr-name namespace" style="color:hsl(35, 99%, 36%)">xmlns:</span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">        </span><span class="token tag attr-name namespace" style="color:hsl(35, 99%, 36%)">xsi:</span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">modelVersion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">4.0.0</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">modelVersion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">parent</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">indi.yuluo</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">examples</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.0-SNAPSHOT</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">parent</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">indi.yuluo.deepseek</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">deepseek4j</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">3.3.4</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">io.github.pig-mesh.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">deepseek-spring-boot-starter</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.4.1</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">project</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="applicationyml-é…ç½®">application.yml é…ç½®<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#applicationyml-%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="application.yml é…ç½®çš„ç›´æ¥é“¾æ¥" title="application.yml é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">base-url</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">//127.0.0.1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">11434/v1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">r1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">8b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">api-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">default-system-prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">server</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">port</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">8080</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="controller-1">controller<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#controller-1" class="hash-link" aria-label="controllerçš„ç›´æ¥é“¾æ¥" title="controllerçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> </span><span class="token namespace">indi</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">yuluo</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">deepseek</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">controller</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">io</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">github</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">pigmesh</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">deepseek</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">core</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">DeepSeekClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">jakarta</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">servlet</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">http</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">HttpServletResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">reactor</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">core</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">publisher</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">beans</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">factory</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Autowired</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">web</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">bind</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">web</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">bind</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">PathVariable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">web</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">bind</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">web</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">bind</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">RestController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author yuluo</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author &lt;a href="mailto:yuluo08290126@gmail.com"&gt;yuluo&lt;/a&gt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/deepseek4j"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DeepSeek4JController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Autowired</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DeepSeekClient</span><span class="token plain"> deepSeekClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">value </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/chat/{prompt}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@PathVariable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">value </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"prompt"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HttpServletResponse</span><span class="token plain"> response</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setCharacterEncoding</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"UTF-8"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> deepSeekClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatFluxCompletion</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             chatCompletionResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatCompletionResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">choices</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">delta</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> chatCompletionResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">choices</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">delta</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="deepseek4j-é€å‡º-reasoning-content">DeepSeek4j é€å‡º reasoning content<a href="https://yuluo-yx.github.io/blog/%E4%BD%BF%E7%94%A8-Ollama-%E9%83%A8%E7%BD%B2-DeepSeek-%E5%B9%B6%E4%BD%BF%E7%94%A8-Spring-AI-Alibaba-%E8%B0%83%E7%94%A8#deepseek4j-%E9%80%8F%E5%87%BA-reasoning-content" class="hash-link" aria-label="DeepSeek4j é€å‡º reasoning contentçš„ç›´æ¥é“¾æ¥" title="DeepSeek4j é€å‡º reasoning contentçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å½“ <code>default-system-prompt</code> ä¸º false æ—¶</p>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">base-url</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">//127.0.0.1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">11434/v1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">r1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">8b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">api-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">default-system-prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">false</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¾“å‡ºä¸ºï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä½ å¥½ï¼å¾ˆé«˜å…´è§åˆ°ä½ ï¼Œæœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®å¿™çš„å—ï¼Ÿæ— è®ºæ˜¯é—®é¢˜ã€å»ºè®®è¿˜æ˜¯é—²èŠï¼Œæˆ‘éƒ½åœ¨è¿™å„¿ä¸ºä½ æœåŠ¡ã€‚ğŸ˜Š</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“ <code>default-system-prompt</code> ä¸º true æ—¶</p>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">base-url</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">//127.0.0.1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">11434/v1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">r1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">8b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">api-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> deepseek</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">default-system-prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¾“å‡ºä¸ºï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ç”¨æˆ·è¯´â€œä½ å¥½â€ï¼Œè¿™æ˜¯ä¸ªå¸¸è§çš„é—®å€™ï¼Œæˆ‘åº”è¯¥ç”¨ä¸­æ–‡å›ç­”ï¼Œä¿æŒäº²åˆ‡ã€‚ æˆ‘æ˜¯DeepSeek-R1ï¼Œç”±ä¸­å›½å…¬å¸DeepSeekå¼€å‘çš„AIåŠ©æ‰‹ï¼Œå¯ä»¥å¤„ç†ä¸­æ–‡å’Œè‹±æ–‡æŸ¥è¯¢ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šè¯¦ç»†ä»‹ç»ä¸€ä¸‹DeepSeek-R1çš„åŠŸèƒ½å’Œç‰¹ç‚¹ï¼Œè®©ç”¨æˆ·æœ‰æ›´å…¨é¢çš„äº†è§£ã€‚ ä½ å¥½ï¼æˆ‘æ˜¯ç”±ä¸­å›½å…¬å¸æ·±åº¦æ±‚ç´¢ï¼ˆDeepSeekï¼‰å¼€å‘çš„æ™ºèƒ½åŠ©æ‰‹DeepSeek-R1ã€‚æˆ‘æ“…é•¿é€šè¿‡æ–‡æœ¬å¯¹è¯æ–¹å¼ä¸ºæ‚¨æä¾›ä¿¡æ¯ï¼Œè§£ç­”é—®é¢˜å¹¶è¿›è¡Œäº¤æµã€‚å¦‚æœ‰ä»»ä½•éœ€è¦ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©æ‚¨ï¼ŒåŒæ—¶ç¡®ä¿å›ç­”å‡†ç¡®ã€æœ‰æ¡ç†åœ°å‘ˆç°ç»™æ‚¨ã€‚å¦‚æœä½ æœ‰ä»»ä½•å…·ä½“çš„éœ€æ±‚æˆ–ç–‘é—®ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>ç”±æ­¤å¯è§ï¼Œä¼¼ä¹æ˜¯ç”± prompt æ§åˆ¶çš„ï¼Ÿ</p>
</blockquote>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Ollama" term="Ollama"/>
        <category label="DeepSeek" term="DeepSeek"/>
        <category label="Spring AI Alibaba" term="Spring AI Alibaba"/>
        <category label="AI" term="AI"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[æœ¬åœ°éƒ¨ç½²å’Œä½¿ç”¨ Dubbo-Kubernetes]]></title>
        <id>https://yuluo-yx.github.io/blog/dubbo-kubernetes-local-run</id>
        <link href="https://yuluo-yx.github.io/blog/dubbo-kubernetes-local-run"/>
        <updated>2025-02-09T14:26:00.000Z</updated>
        <summary type="html"><![CDATA[Dubbo Mesh]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="dubbo-mesh">Dubbo Mesh<a href="https://yuluo-yx.github.io/blog/dubbo-kubernetes-local-run#dubbo-mesh" class="hash-link" aria-label="Dubbo Meshçš„ç›´æ¥é“¾æ¥" title="Dubbo Meshçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Dubbo Mesh æ˜¯ Dubbo åœ¨äº‘åŸç”ŸèƒŒæ™¯çš„å¾®æœåŠ¡æ•´ä½“è§£å†³æ–¹æ¡ˆï¼Œå®ƒå¸®åŠ©å¼€å‘è€…å®ç° Dubbo æœåŠ¡ä¸æ ‡å‡†çš„ Kubernetes Native Service ä½“ç³»çš„æ‰“é€šï¼Œè®© Dubbo åº”ç”¨èƒ½å¤Ÿæ— ç¼æ¥å…¥ Istio ç­‰ä¸šç•Œä¸»æµæœåŠ¡ç½‘æ ¼äº§å“ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="dubbo-kubernetes">Dubbo Kubernetes<a href="https://yuluo-yx.github.io/blog/dubbo-kubernetes-local-run#dubbo-kubernetes" class="hash-link" aria-label="Dubbo Kubernetesçš„ç›´æ¥é“¾æ¥" title="Dubbo Kubernetesçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥<a href="https://yuluo-yx.github.io/blog/dubbo-kubernetes-local-run#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5" class="hash-link" aria-label="å‚è€ƒé“¾æ¥çš„ç›´æ¥é“¾æ¥" title="å‚è€ƒé“¾æ¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>Dubbo Meshï¼š<a href="https://cn.dubbo.apache.org/zh-cn/overview/what/core-features/service-mesh/#dubbo-mesh" target="_blank" rel="noopener noreferrer">https://cn.dubbo.apache.org/zh-cn/overview/what/core-features/service-mesh/#dubbo-mesh</a></li>
<li>Dubbo-Kubernetesï¼š<a href="https://github.com/apache/dubbo-kubernetes" target="_blank" rel="noopener noreferrer">https://github.com/apache/dubbo-kubernetes</a></li>
<li></li>
</ol>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Cloud Native" term="Cloud Native"/>
        <category label="Dubbo" term="Dubbo"/>
        <category label="Kuberneters" term="Kuberneters"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨ Kind æ¨¡æ‹Ÿ k8s é›†ç¾¤]]></title>
        <id>https://yuluo-yx.github.io/blog/use-kind-build-k8s-cluster</id>
        <link href="https://yuluo-yx.github.io/blog/use-kind-build-k8s-cluster"/>
        <updated>2025-02-09T14:26:00.000Z</updated>
        <summary type="html"><![CDATA[å®‰è£… Docker]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å®‰è£…-docker">å®‰è£… Docker<a href="https://yuluo-yx.github.io/blog/use-kind-build-k8s-cluster#%E5%AE%89%E8%A3%85-docker" class="hash-link" aria-label="å®‰è£… Dockerçš„ç›´æ¥é“¾æ¥" title="å®‰è£… Dockerçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Docker Desktopï¼š<a href="https://docs.docker.com/desktop/setup/install/mac-install/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/desktop/setup/install/mac-install/</a></p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ </span><span class="token function" style="color:hsl(221, 87%, 60%)">docker</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--version</span><span class="token plain"> </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Docker version </span><span class="token number" style="color:hsl(35, 99%, 36%)">27.4</span><span class="token plain">.0, build bde2b89</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å®‰è£…-kind">å®‰è£… Kind<a href="https://yuluo-yx.github.io/blog/use-kind-build-k8s-cluster#%E5%AE%89%E8%A3%85-kind" class="hash-link" aria-label="å®‰è£… Kindçš„ç›´æ¥é“¾æ¥" title="å®‰è£… Kindçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä½¿ç”¨ kind æ¨¡æ‹Ÿ K8s é›†ç¾¤ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># ç›´æ¥ä½¿ç”¨ brew å®‰è£…</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">brew </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> kind</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŸ¥çœ‹ç‰ˆæœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ kind </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--version</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kind version </span><span class="token number" style="color:hsl(35, 99%, 36%)">0.26</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># kubectl ç‰ˆæœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ kubectl version  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Client Version: v1.30.5</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Kustomize Version: v5.0.4-0.20230601165947-6ce0bf390ce3</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¯åŠ¨-k8s-é›†ç¾¤">å¯åŠ¨ k8s é›†ç¾¤<a href="https://yuluo-yx.github.io/blog/use-kind-build-k8s-cluster#%E5%90%AF%E5%8A%A8-k8s-%E9%9B%86%E7%BE%A4" class="hash-link" aria-label="å¯åŠ¨ k8s é›†ç¾¤çš„ç›´æ¥é“¾æ¥" title="å¯åŠ¨ k8s é›†ç¾¤çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ kind create cluster </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--name</span><span class="token plain"> istio-k8s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Creating cluster </span><span class="token string" style="color:hsl(119, 34%, 47%)">"istio-k8s"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> âœ“ Ensuring </span><span class="token function" style="color:hsl(221, 87%, 60%)">node</span><span class="token plain"> image </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">kindest/node:v1.32.0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> ğŸ–¼ </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> âœ“ Preparing nodes ğŸ“¦  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> âœ“ Writing configuration ğŸ“œ </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> âœ“ Starting control-plane ğŸ•¹ï¸ </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> âœ“ Installing CNI ğŸ”Œ </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> âœ“ Installing StorageClass ğŸ’¾ </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Set kubectl context to </span><span class="token string" style="color:hsl(119, 34%, 47%)">"kind-istio-k8s"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">You can now use your cluster with:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kubectl cluster-info </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--context</span><span class="token plain"> kind-istio-k8s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Have a question, bug, or feature request? Let us know</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain"> https://kind.sigs.k8s.io/</span><span class="token comment" style="color:hsl(230, 4%, 64%)">#community ğŸ™‚</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æŸ¥çœ‹é›†ç¾¤èµ„æº">æŸ¥çœ‹é›†ç¾¤èµ„æº<a href="https://yuluo-yx.github.io/blog/use-kind-build-k8s-cluster#%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90" class="hash-link" aria-label="æŸ¥çœ‹é›†ç¾¤èµ„æºçš„ç›´æ¥é“¾æ¥" title="æŸ¥çœ‹é›†ç¾¤èµ„æºçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ kgpa</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">NAMESPACE            NAME                                              READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kube-system          coredns-668d6bf9bc-62mtm                          </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">          62s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kube-system          coredns-668d6bf9bc-7vd5d                          </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">          62s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kube-system          etcd-istio-k8s-control-plane                      </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">          70s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kube-system          kindnet-94phb                                     </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">          62s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kube-system          kube-apiserver-istio-k8s-control-plane            </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">          70s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kube-system          kube-controller-manager-istio-k8s-control-plane   </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">          69s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kube-system          kube-proxy-6kz4m                                  </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">          62s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kube-system          kube-scheduler-istio-k8s-control-plane            </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">          69s</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">local-path-storage   local-path-provisioner-58cc7856b6-q6rvb           </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">          62s</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="docker-container-æŸ¥çœ‹">Docker container æŸ¥çœ‹<a href="https://yuluo-yx.github.io/blog/use-kind-build-k8s-cluster#docker-container-%E6%9F%A5%E7%9C%8B" class="hash-link" aria-label="Docker container æŸ¥çœ‹çš„ç›´æ¥é“¾æ¥" title="Docker container æŸ¥çœ‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ </span><span class="token function" style="color:hsl(221, 87%, 60%)">docker</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">ps</span><span class="token plain">                       </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">CONTAINER ID   IMAGE                  COMMAND                   CREATED         STATUS              PORTS                       NAMES</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">17df49a0e07c   kindest/node:v1.32.0   </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/usr/local/bin/entrâ€¦"</span><span class="token plain">   </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> minutes ago   Up About a minute   </span><span class="token number" style="color:hsl(35, 99%, 36%)">127.0</span><span class="token plain">.0.1:62209-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token number" style="color:hsl(35, 99%, 36%)">6443</span><span class="token plain">/tcp   istio-k8s-control-plane</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¸¸ç”¨çš„-kind-å‘½ä»¤">å¸¸ç”¨çš„ kind å‘½ä»¤<a href="https://yuluo-yx.github.io/blog/use-kind-build-k8s-cluster#%E5%B8%B8%E7%94%A8%E7%9A%84-kind-%E5%91%BD%E4%BB%A4" class="hash-link" aria-label="å¸¸ç”¨çš„ kind å‘½ä»¤çš„ç›´æ¥é“¾æ¥" title="å¸¸ç”¨çš„ kind å‘½ä»¤çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># è·å–å½“å‰çš„é›†ç¾¤åˆ—è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kind get clusters</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŒ‡å®š kubectl ä½¿ç”¨çš„ kind é›†ç¾¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kubectl cluster-info </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--context</span><span class="token plain"> é›†ç¾¤åå­—</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŸ¥çœ‹æŸä¸ªé›†ç¾¤çš„é…ç½®ä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kind get kubeconfig </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--name</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">kind</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># åˆ é™¤å‡ åœˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">kind delete cluster kind</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="kind-k8s-é›†ç¾¤çš„åœæ­¢å’Œé‡å¯">kind K8s é›†ç¾¤çš„åœæ­¢å’Œé‡å¯<a href="https://yuluo-yx.github.io/blog/use-kind-build-k8s-cluster#kind-k8s-%E9%9B%86%E7%BE%A4%E7%9A%84%E5%81%9C%E6%AD%A2%E5%92%8C%E9%87%8D%E5%90%AF" class="hash-link" aria-label="kind K8s é›†ç¾¤çš„åœæ­¢å’Œé‡å¯çš„ç›´æ¥é“¾æ¥" title="kind K8s é›†ç¾¤çš„åœæ­¢å’Œé‡å¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># å¯ä»¥ç›´æ¥ä½¿ç”¨ docker æ§åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ </span><span class="token function" style="color:hsl(221, 87%, 60%)">docker</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">ps</span><span class="token plain"> </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">CONTAINER ID   IMAGE                  COMMAND                   CREATED         STATUS         PORTS                       NAMES</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">17df49a0e07c   kindest/node:v1.32.0   </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/usr/local/bin/entrâ€¦"</span><span class="token plain">   </span><span class="token number" style="color:hsl(35, 99%, 36%)">7</span><span class="token plain"> minutes ago   Up </span><span class="token number" style="color:hsl(35, 99%, 36%)">7</span><span class="token plain"> minutes   </span><span class="token number" style="color:hsl(35, 99%, 36%)">127.0</span><span class="token plain">.0.1:62209-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token number" style="color:hsl(35, 99%, 36%)">6443</span><span class="token plain">/tcp   istio-k8s-control-plane</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># kind é›†ç¾¤çš„ container ä¸º 17df49a0e07c</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># åœæ­¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">docker</span><span class="token plain"> stop 17df49a0e07c</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ä½¿ç”¨ kgpa éªŒè¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ kgpa</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">The connection to the server </span><span class="token number" style="color:hsl(35, 99%, 36%)">127.0</span><span class="token plain">.0.1:62209 was refused - did you specify the right </span><span class="token function" style="color:hsl(221, 87%, 60%)">host</span><span class="token plain"> or port?</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># kind é›†ç¾¤å·²ç»æˆåŠŸåœæ­¢</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Cloud Native" term="Cloud Native"/>
        <category label="Kind" term="Kind"/>
        <category label="Kuberneters" term="Kuberneters"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨ docusaurus æ›´æ–° Blog]]></title>
        <id>https://yuluo-yx.github.io/blog/blog-update</id>
        <link href="https://yuluo-yx.github.io/blog/blog-update"/>
        <updated>2025-02-03T22:25:06.000Z</updated>
        <summary type="html"><![CDATA[èƒŒæ™¯]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="èƒŒæ™¯">èƒŒæ™¯<a href="https://yuluo-yx.github.io/blog/blog-update#%E8%83%8C%E6%99%AF" class="hash-link" aria-label="èƒŒæ™¯çš„ç›´æ¥é“¾æ¥" title="èƒŒæ™¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä¹‹å‰çš„ Blog ç”¨çš„æ˜¯ Hexo + Fluid æ­å»ºçš„ï¼Œä¸ªäººæ„Ÿè§‰ä¸å¤ªå¥½çœ‹ï¼Œè€Œä¸”å¯¹ Markdown å…¬å¼æ”¯æŒçš„ä¸å‹å¥½ã€‚æ‰€ä»¥è¶ç€ç©ºé—²æ—¶é—´èŒç”Ÿäº†æ¢ä¸€ä¸ªçš„æƒ³æ³•ã€‚ç½‘ä¸Šä¸€é¡¿æœç´¢ä¹‹åï¼Œçœ‹åˆ°äº† docusaurusã€‚ä¹‹å‰ä¹Ÿæœ‰ä½¿ç”¨è¿‡ï¼Œæ‰€ä»¥å°±å†³å®šä»¥è¿™ä¸ªä¸ºæ–‡æ¡£æ¡†æ¶ï¼Œæœ¬æ¥æƒ³è‡ªå·±æ”¹ä¸€äº›å‰ç«¯æ ·å¼ï¼Œä½†æ˜¯æƒ³æƒ³å¤ªè´¹äº‹äº†ï¼Œä¸å¦‚æ‰¾ä¸ªç°æˆçš„ï¼Œäºæ˜¯ï¼Œæ‰¾åˆ°äº† <a href="https://github.com/kuizuo" target="_blank" rel="noopener noreferrer">@Kuizuo</a> å¤§ä½¬é­”æ”¹çš„ docusaurus æ ·å¼ä¸»é¢˜ã€‚ç›´æ¥å¥—å£³ cv äº†ã€‚</p>
<p>åŸæ ·å¼å¦‚ä¸‹ï¼š</p>
<p><img decoding="async" loading="lazy" alt="kuizuo blog" src="https://yuluo-yx.github.io/assets/images/blog-e209e342b895940d73a171ae72b38c75.png" width="1400" height="800" class="img_c29J"></p>
<p>çœ‹ç€æ•ˆæœæ¯”æˆ‘ä¹‹å‰çš„å¥½å¤šäº†ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é‡æ„å‚è€ƒ">é‡æ„å‚è€ƒ<a href="https://yuluo-yx.github.io/blog/blog-update#%E9%87%8D%E6%9E%84%E5%8F%82%E8%80%83" class="hash-link" aria-label="é‡æ„å‚è€ƒçš„ç›´æ¥é“¾æ¥" title="é‡æ„å‚è€ƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¤§éƒ¨åˆ†çš„æ­¥éª¤éƒ½å¯ä»¥ kuizuo å¤§ä½¬çš„ <a href="https://kuizuo.cn/docs/docusaurus-guides" target="_blank" rel="noopener noreferrer">https://kuizuo.cn/docs/docusaurus-guides</a> æ–‡æ¡£ã€‚</p>
<p>æè¿°ä¸‹æˆ‘åšçš„ä¿®æ”¹ï¼š</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="makefile">makefile<a href="https://yuluo-yx.github.io/blog/blog-update#makefile" class="hash-link" aria-label="makefileçš„ç›´æ¥é“¾æ¥" title="makefileçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åŸé¡¹ç›®ä¸­æ˜¯æ²¡æœ‰ makefile çš„ï¼Œæˆ‘åŠ äº†ä¸€äº› makefile å‘½ä»¤ï¼Œç»™ github action ä½¿ç”¨åŒæ—¶ä¹Ÿæ–¹ä¾¿è‡ªå·±ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ </span><span class="token function" style="color:hsl(221, 87%, 60%)">make</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">help</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Usage:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">make</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">Target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Targets:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Common</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain">          Install the dependencies.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Docs</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  preview          Start the Docusaurus server </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> preview mode.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  build            Build the Docusaurus site.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  serve            Start Docusaurus site with server mode.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Linter</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  markdown         Lint Check the markdown files.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  markdown-fix     Lint Check the markdown files and fix them.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  yamllint         Lint Check the yaml files.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  codespell        Lint Check the codespell.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  checklinks       Check </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> broken links </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> the docs</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  pnpm-lint        Lint Check the </span><span class="token function" style="color:hsl(221, 87%, 60%)">pnpm</span><span class="token plain"> files.</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŠ å…¥äº†å¯¹ yaml å’Œ markdown æ ¼å¼çš„æ£€æµ‹ï¼Œç­‰ç­‰ï¼Œè™½ç„¶ docusaurus ä¹Ÿæœ‰ï¼Œä½†å¤–ç½®çš„å¯æ§æ€§æ›´é«˜ä¸€äº›ã€‚åŒæ—¶ä¹Ÿæ˜¯æˆ‘ç†Ÿæ‚‰çš„æ–¹å¼ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¯¹å…¶ä¸­ç»„ä»¶ä¿®æ”¹">å¯¹å…¶ä¸­ç»„ä»¶ä¿®æ”¹<a href="https://yuluo-yx.github.io/blog/blog-update#%E5%AF%B9%E5%85%B6%E4%B8%AD%E7%BB%84%E4%BB%B6%E4%BF%AE%E6%94%B9" class="hash-link" aria-label="å¯¹å…¶ä¸­ç»„ä»¶ä¿®æ”¹çš„ç›´æ¥é“¾æ¥" title="å¯¹å…¶ä¸­ç»„ä»¶ä¿®æ”¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¯¹ç»„ä»¶æ²¡æœ‰åšè¿‡å¤šä¿®æ”¹ï¼Œåªæ”¹äº†äº›ç»„ä»¶æ˜¾ç¤ºæ•ˆæœå’ŒåŠ äº†ä¸€äº›ç»„ä»¶ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ–‡æ¡£è¿ç§»">æ–‡æ¡£è¿ç§»<a href="https://yuluo-yx.github.io/blog/blog-update#%E6%96%87%E6%A1%A3%E8%BF%81%E7%A7%BB" class="hash-link" aria-label="æ–‡æ¡£è¿ç§»çš„ç›´æ¥é“¾æ¥" title="æ–‡æ¡£è¿ç§»çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>cv å’ŒæŒ¨ä¸ªåŠ æ ‡ç­¾ã€‚ğŸ¤£</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="github-action">Github Action<a href="https://yuluo-yx.github.io/blog/blog-update#github-action" class="hash-link" aria-label="Github Actionçš„ç›´æ¥é“¾æ¥" title="Github Actionçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åŠ äº†ä½¿ç”¨ github pages éƒ¨ç½²å’Œå¯¹é¡¹ç›®ä»£ç æ£€æµ‹çš„ workflowsã€‚yaml å¦‚ä¸‹ï¼š</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Deploy</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">on</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">pull_request</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">branches</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"main"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">push</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">branches</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"main"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">concurrency</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">group</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> github.workflow </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">$</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> github.ref </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">cancel-in-progress</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">jobs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">build-and-deploy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">runs-on</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> matrix.os </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">needs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">lint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">check</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">strategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">matrix</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">os</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">ubuntu</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">latest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">node-version</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">20.x</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">steps</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">uses</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># v4.2.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">uses</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ./tools/github</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">actions/setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">deps</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Install dependencies</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> pnpm install</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Build</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> pnpm build</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Deploy to GitHub Pages</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">uses</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> peaceiris/actions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">gh</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">pages@v3</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">with</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">github_token</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> secrets.BLOG_DEPLOY_TOKEN </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">publish_dir</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ./build</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">lint-check</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Lint</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">runs-on</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">strategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">matrix</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">node-version</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">20.x</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">steps</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">uses</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># v4.2.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">uses</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ./tools/github</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">actions/setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">deps</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">uses</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">python@v5</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Checkout LFS objects</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> git lfs checkout</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Install tools</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> make install</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">tools</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Install dependencies</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> pnpm install</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Run Pnpm Lint</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> make pnpm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">lint</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Run Markdown Lint</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> make markdown</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Run Yaml Lint</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> make yamllint</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Run CodeSpell Lint</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> make codespell</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ·»åŠ æœç´¢åŠŸèƒ½">æ·»åŠ æœç´¢åŠŸèƒ½<a href="https://yuluo-yx.github.io/blog/blog-update#%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD" class="hash-link" aria-label="æ·»åŠ æœç´¢åŠŸèƒ½çš„ç›´æ¥é“¾æ¥" title="æ·»åŠ æœç´¢åŠŸèƒ½çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å‚è€ƒï¼š<a href="https://kuizuo.cn/docs/docusaurus-search" target="_blank" rel="noopener noreferrer">https://kuizuo.cn/docs/docusaurus-search</a></p>
<ol>
<li>
<p>ç”³è¯· <a href="https://www.algolia.com/" target="_blank" rel="noopener noreferrer">https://www.algolia.com/</a> è´¦å·ï¼›</p>
</li>
<li>
<p>åœ¨å³ä¸Šè§’ç‚¹å‡»ï¼Œä½¿ç”¨ google è´¦å·ç™»é™†ä¹‹åï¼›</p>
</li>
<li>
<p>è·³è¿‡å¼•å¯¼æ­¥éª¤ï¼›</p>
</li>
<li>
<p>åˆ°è¾¾æ¬¢è¿é¡µé¢ä¹‹åï¼Œå¯ä»¥çœ‹åˆ° Application ID å’Œ Search API Keyï¼ˆä¸€å®šè¦æ˜¯ Searchï¼‰ï¼›</p>
</li>
<li>
<p>å°† id å’Œ key å¡«å…¥ docusaurus é…ç½®ä¸­ï¼›</p>
</li>
</ol>
<div class="language-ts codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-ts codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">themeConfig</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    algolia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      apiKey</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"xxxxxxxxxxx"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      appId</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"xxxxxxxxxxx"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      indexName</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"yuluo"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="6">
<li>åˆ›å»º github action æ–‡ä»¶ï¼Œåœ¨æäº¤ä»£ç æ—¶è§¦å‘çˆ¬è™«æ“ä½œï¼š</li>
</ol>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">algolia-docsearch</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">runs-on</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">needs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">lint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">check</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">and</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">steps</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">uses</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># v4.2.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Get the content of docsearch.json as config</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> algolia_config</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> echo "</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">set</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">output name=config</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">$(cat docsearch.json </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">|</span><span class="token plain"> jq </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">r tostring)"</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Run algolia/docsearch</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">scraper image</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ALGOLIA_APP_ID</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> secrets.ALGOLIA_APP_ID </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ALGOLIA_API_KEY</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> secrets.ALGOLIA_API_KEY </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">CONFIG</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> steps.algolia_config.outputs.config </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">|</span><span class="token scalar string" style="color:hsl(119, 34%, 47%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token scalar string" style="color:hsl(119, 34%, 47%)">        docker run \</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token scalar string" style="color:hsl(119, 34%, 47%)">          --env APPLICATION_ID=${ALGOLIA_APP_ID} \</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token scalar string" style="color:hsl(119, 34%, 47%)">          --env API_KEY=${ALGOLIA_API_KEY} \</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token scalar string" style="color:hsl(119, 34%, 47%)">          --env "CONFIG=${CONFIG}" \</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token scalar string" style="color:hsl(119, 34%, 47%)">          algolia/docsearch-scraper</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="7">
<li>
<p>åœ¨ github ä»“åº“è®¾ç½® action secrets å‚æ•°ï¼›æ³¨æ„æ­¤æ—¶çš„ API_KEY ä¸º Write API Keyï¼</p>
</li>
<li>
<p>æäº¤ä»£ç ï¼Œè§¦å‘çˆ¬è™« ciï¼Œç­‰å¾…æŸ¥çœ‹æ•ˆæœã€‚</p>
</li>
<li>
<p>æœç´¢éªŒè¯</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="doc search" src="https://yuluo-yx.github.io/assets/images/search-fa47d9517bd4d8fb9dc6051d16d2a91d.png" width="903" height="731" class="img_c29J"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="todo">Todo<a href="https://yuluo-yx.github.io/blog/blog-update#todo" class="hash-link" aria-label="Todoçš„ç›´æ¥é“¾æ¥" title="Todoçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ol>
<li>åŠ å…¥æ—¥æœŸæ˜¾ç¤ºçš„ html æ ·å¼ï¼›</li>
<li>ä½¿ç”¨ç»˜åˆ¶ svg å½¢å¼çš„ logoï¼›</li>
<li>å®Œå–„æœç´¢åŠŸèƒ½ï¼›</li>
</ol>
<p>æ›´å¤šåŠŸèƒ½å¼€å‘ä¸­...</p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Blog" term="Blog"/>
        <category label="Docusaurus" term="Docusaurus"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[2024 å¹´ç»ˆæ€»ç»“]]></title>
        <id>https://yuluo-yx.github.io/blog/2024-year-summary</id>
        <link href="https://yuluo-yx.github.io/blog/2024-year-summary"/>
        <updated>2025-02-03T20:12:00.000Z</updated>
        <summary type="html"><![CDATA[å°é¢æ‹æ‘„è‡ªæ­å·å¸‚ä¸´å¹³åŒº]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>å°é¢æ‹æ‘„è‡ªæ­å·å¸‚ä¸´å¹³åŒº</p>
</blockquote>
<p>ä»Šå¤©æ˜¯ 2025 å¹´ 2 æœˆ 3 å·ï¼ˆæ²¡æƒ³åˆ°éšä¾¿é€‰çš„æ—¥å­ç«Ÿç„¶å’Œ 2023 å¹´é‡åˆäº†ï¼ï¼‰ã€‚æœ‰ç‚¹æ—¶é—´å‡†å¤‡å†™ä¸€ä¸‹ 2024 å¹´çš„å¹´ç»ˆæ€»ç»“ï¼Œä¹‹å‰æƒ³å†™æ€»æ˜¯æ²¡æ—¶é—´å†™ã€‚ğŸ¤£</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2024-review">2024 review<a href="https://yuluo-yx.github.io/blog/2024-year-summary#2024-review" class="hash-link" aria-label="2024 reviewçš„ç›´æ¥é“¾æ¥" title="2024 reviewçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>2024 å¹´ 7 æœˆä»½æ¯•ä¸šï¼Œä»å­¦æ ¡è¿›å…¥å·¥ä½œå²—ä½ã€‚</p>
</blockquote>
<p>æµæ°´å¸å¼çš„å›é¡¾ä¸€ä¸‹ 2024 å¹´å‘ç”Ÿçš„äº‹æƒ…ï¼›ä» 2023 å¹´æ€»ç»“ç»“æŸä¹‹åï¼Œä¹Ÿå°±æ˜¯ 24 å¹´ 2 æœˆ 3 å·ä»¥åã€‚ä¹°äº†è½¦ç¥¨å»æ­å·çš„ä½ä»£ç åˆåˆ›å…¬å¸ï¼Œå»äº†ä¸ä¹…å°±ç¦»èŒæ’¤äº†ã€‚
ä¹‹åä¾¿å›å®¶å»å‡†å¤‡æ˜¥æ‹›å’Œæ¯•ä¸šè®ºæ–‡çš„äº‹æƒ…ã€‚åŒæ—¶ä¹Ÿåœ¨ Spring Cloud Alibaba ç¤¾åŒºå‚ä¸å‘èµ·äº† Spring Cloud Alibaba AI é¡¹ç›®ï¼Œæ­£å¼æ¥è§¦äº† AI æ¡†æ¶çš„å¼€å‘ï¼Œå¯¹ Spring AI
ä¹Ÿæœ‰äº†ä¸€äº›äº†è§£å’Œè®¤è¯†ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ¯•ä¸šè®ºæ–‡ï¼Œå¼€æºï¼ŒSCA AIï¼Œæ‰¾å·¥ä½œï¼Œä¸‰ä»¶äº‹å¹¶è¡Œï¼ˆSCA AI ä¹Ÿç®—æ˜¯å¼€æºçš„ä¸€éƒ¨åˆ†ã€‚ï¼‰</p>
<p>åŒæ—¶ï¼Œæƒ³ç€å¤šå­¦é—¨è¯­è¨€ï¼ˆæŠ€å¤šä¸å‹èº« ğŸ¤£ï¼‰ï¼Œå­¦ä¹ äº† GOï¼Œåœ¨ Github æ‰¾äº†ï¼ˆLinuxSuRen/APITestingï¼‰å¼€æºé¡¹ç›®å»å‚ä¸ï¼Œå­¦ä¹ å’Œåœ¨å¤§å‹é¡¹ç›®é‡Œä½¿ç”¨ GOã€‚åŒæ—¶ä¹Ÿå¾ˆè£å¹¸çš„è®¤è¯†äº† <a href="https://github.com/LinuxSuRen/api-testing" target="_blank" rel="noopener noreferrer">@Rick</a>ã€‚è¿™é‡Œæ„Ÿè°¢ <a href="https://github.com/LinuxSuRen/api-testing" target="_blank" rel="noopener noreferrer">@Rick</a> å¯¹æˆ‘çš„å¸®åŠ© ğŸ«¡ã€‚åœ¨å…­æœˆä»½çš„æ—¶å€™ï¼Œæåäº† APITesting é¡¹ç›®çš„ Committerã€‚ä¹Ÿæ˜¯å¼€æºç»å†ä¸­çš„ç¬¬äºŒä¸ª Committer èº«ä»½ã€‚ğŸ˜†</p>
<p>å…­æœˆä»½é¡ºåˆ©å®Œæˆäº†æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šè®ºæ–‡ï¼ŒåŒæ—¶ä¹Ÿæ‰¾åˆ°äº†ä¸€ä»½å·¥ä½œã€‚7 æœˆä¸­æ—¬å­¦æ ¡äº‹æƒ…å¿™å®Œäº†ã€‚ä¾¿æ”¶æ‹¾ä¸œè¥¿å»äº†æ­å·ã€‚ä¹‹åå› ä¸ºä¸€äº›åŸå› ï¼Œç­ä¹Ÿæ²¡ä¸Šæˆï¼Œè‰è‰ç»“æŸäº†æ­å·çš„å·¥ä½œã€‚</p>
<p>åœ¨æ­å·å¾…çš„ä¸€æ®µæ—¶é—´ï¼Œç»™è‡ªå·±æäº†ä¸€ä¸ªçŸ­æœŸç›®æ ‡ï¼šæˆä¸º Apache çš„ Committerã€‚ä¹‹åçš„ä¸€ä¸¤ä¸ªæœˆæ—¶é—´éƒ½åœ¨ä¸ºæ­¤åŠªåŠ›ï¼Œæœ‰æ—¶é—´å°±ç»™ Apache/Hertbeat é¡¹ç›®æäº¤ä»£ç ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„è¶…é«˜æäº¤ä¹‹åï¼Œé¡ºåˆ©è¾¾æˆäº†ç›®æ ‡ï¼Œè¿›å…¥äº† Apache orgï¼Œæ‹¿åˆ°äº† Committer çš„æåã€‚</p>
<p><img decoding="async" loading="lazy" alt="Apache Org" src="https://yuluo-yx.github.io/assets/images/2024-summary-1-caa16463b17fbbe53fc77fad82353e55.jpg" width="1048" height="321" class="img_c29J"></p>
<p>æœŸé—´ä¹Ÿæ°é€¢ CocA 2024 åœ¨æ­å·å¬å¼€ï¼Œå¹¸è¿çš„è®¤è¯†äº† <a href="https://github.com/Pil0tXia" target="_blank" rel="noopener noreferrer">@Pil0tXia</a>ã€‚ä¹Ÿè§åˆ°äº†è®¸å¤šä¼˜ç§€å¼€æºé¡¹ç›®çš„ç»„ç»‡è€…å’Œå¸ƒé“å¸ˆã€‚</p>
<p>ä¹‹åç»è¿‡å¾ˆé•¿ä¸€ä¸€æ®µæ—¶é—´çš„ gapï¼Œåœ¨ 11 æœˆåˆæ¥åˆ°äº†éƒ‘å·ã€‚å¼€å§‹äº†çœŸæ­£æ„ä¹‰ä¸Šçš„å·¥ä½œã€‚å¸Œæœ›èƒ½åœ¨éƒ‘å·å­¦ä¹ åˆ°æ›´å¤šä¸œè¥¿ï¼Œè·å¾—æ›´å¤šçš„æˆé•¿ï¼ğŸ«¡</p>
<p>åœ¨éƒ‘å·ä¸Šç­ï¼Œä¹Ÿæ²¡æœ‰è½ä¸‹å¼€æºï¼Œä» Spring Cloud Alibaba AI é¡¹ç›®çš„å‘èµ·ä¹‹åï¼Œä¸€ç›´å‚ä¸ç¤¾åŒºç»´æŠ¤ï¼Œé¡¹ç›®ä¹Ÿä»ä¹‹å‰çš„ Spring Cloud Alibaba çš„ä¸€ä¸ª Starter å­µåŒ–æˆäº†ä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›® â€”â€”â€”â€” alibaba/spring-ai-alibabaã€‚ä¹Ÿå¾ˆè£å¹¸ï¼Œåœ¨ 2024 å¹´ 12 æœˆä»½è·å¾—äº† spring-ai-alibaba é¡¹ç›®çš„æåã€‚æ˜¯å¼€æºç»å†ä¸­çš„ç¬¬å››ä¸ª Committerã€‚ğŸ‰</p>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œ2024 å¹´çš„ç”Ÿæ´»ç»å†ä¹Ÿå°±ç»“æŸäº†ã€‚æœŸé—´ç»å†äº†è®¸å¤šï¼Œä¹Ÿæˆé•¿äº†è®¸å¤šã€‚çœ‹åˆ°äº†ä¸€äº›ç¤¾ä¼šç”Ÿæ´»çš„ç™¾æ€ï¼Œä½“ä¼šäº†ä¸åŒçš„äººç”Ÿå†ç¨‹ã€‚æ€»ç»“ä¸‹ 2024 çš„ç”Ÿæ´»ï¼Œå¾—åˆ°çš„ç”Ÿæ´»ç»éªŒå°±æ˜¯ï¼š</p>
<div class="theme-admonition theme-admonition-warning admonition_lhEC alert alert--warning"><div class="admonitionHeading_O9Fl"><span class="admonitionIcon_evF6"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>æ³¨æ„</div><div class="admonitionContent_h773"><p>è°¨æ€ï¼è°¨è¨€ï¼è°¨è¡Œï¼</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2025-feature">2025 Feature<a href="https://yuluo-yx.github.io/blog/2024-year-summary#2025-feature" class="hash-link" aria-label="2025 Featureçš„ç›´æ¥é“¾æ¥" title="2025 Featureçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å›é¡¾äº†ä¸‹ 2024 çš„ç”Ÿæ´»ç»å†ã€‚åœ¨ 2025 å¹´é‡Œï¼Œå¸Œæœ›èƒ½å®Œæˆä¸‹é¢çš„äº‹æƒ…ï¼š</p>
<ol>
<li>æˆä¸ºäº‘åŸç”Ÿé¡¹ç›®çš„è´¡çŒ®è€…ï¼›</li>
<li>å­¦ä¹ è‹±è¯­ï¼Œèƒ½å¬æ‡‚å¹¶è¯´å‡ºæ¥ï¼›ï¼ˆè¿™æ˜¯ä¸ªæ°¸æ’çš„è¯é¢˜ï¼Œå­¦æ— æ­¢å°½ ğŸ¤”</li>
<li>è®¤çœŸå·¥ä½œï¼Œäº‰å–åœ¨å·¥ä½œä¸Šäº†åšå‡ºä¸€äº›æˆç»©ï¼›</li>
<li>å­¦ä¼šå¹ç¬›å­ï¼ŒåŸ¹å…»ä¸‹é™¤äº†æ•²ä»£ç ï¼Œæ‰“ç¯®çƒå’Œä¹’ä¹“çƒä¹‹å¤–çš„ä¸šä½™çˆ±å¥½ã€‚</li>
</ol>
<p>å¥½äº†ï¼Œ2024 å¹´çš„å›é¡¾å°±åˆ°è¿™é‡Œï¼ŒæœŸå¾… 2025 ï¼ğŸ‰</p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="å¹´ç»ˆæ€»ç»“" term="å¹´ç»ˆæ€»ç»“"/>
        <category label="2024" term="2024"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ·±åº¦å­¦ä¹ åˆæ¢]]></title>
        <id>https://yuluo-yx.github.io/blog/deep-learn-init</id>
        <link href="https://yuluo-yx.github.io/blog/deep-learn-init"/>
        <updated>2025-01-01T15:45:35.000Z</updated>
        <summary type="html"><![CDATA[å°è¯•ç†è§£ç¥ç»ç½‘ç»œçš„å·¥ä½œåŸç†ï¼æ—§æ–‡æ–°å‘ã€‚]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>å°è¯•ç†è§£ç¥ç»ç½‘ç»œçš„å·¥ä½œåŸç†ï¼æ—§æ–‡æ–°å‘ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åˆ†ç±»é—®é¢˜å¼•å…¥">åˆ†ç±»é—®é¢˜å¼•å…¥<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98%E5%BC%95%E5%85%A5" class="hash-link" aria-label="åˆ†ç±»é—®é¢˜å¼•å…¥çš„ç›´æ¥é“¾æ¥" title="åˆ†ç±»é—®é¢˜å¼•å…¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å°‘ç»´åº¦åˆ†ç±»">å°‘ç»´åº¦åˆ†ç±»<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%B0%91%E7%BB%B4%E5%BA%A6%E5%88%86%E7%B1%BB" class="hash-link" aria-label="å°‘ç»´åº¦åˆ†ç±»çš„ç›´æ¥é“¾æ¥" title="å°‘ç»´åº¦åˆ†ç±»çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¦‚ä¸‹å›¾æ˜¯ä¸€ä¸ªåŒ—äº¬å’Œé•¿æ²»çš„æˆ¿ä»·å¯¹æ¯”å›¾ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240304220239621" src="https://yuluo-yx.github.io/assets/images/image-20240304220239621-5e1e405788d201d58d87b79128d883c3.png" width="712" height="445" class="img_c29J"></p>
<p>å¦‚ä¸Šä½¿ç”¨è¡¨æ ¼çš„å½¢å¼è¡¨ç¤ºï¼Œå¯èƒ½ä¸æ˜¯å¾ˆç›´è§‚ã€‚æ¢æˆå¦‚ä¸‹çš„åæ ‡ç³»å°±èƒ½å¾ˆæ¸…æ¥šçš„çœ‹å‡ºæ¥åŒºåˆ«ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240304221939557" src="https://yuluo-yx.github.io/assets/images/image-20240304221939557-0546a4abfa3459685a0d63ccc3df75d0.png" width="746" height="456" class="img_c29J"></p>
<p>å›¾ä¸­æ ‡æ³¨ä¸€æ¡é»„è‰²çš„æ•°æ®çº¿ï¼Œå¯ä»¥çœ‹å‡ºï¼Œé»„çº¿å·¦è¾¹çš„å±äºåŒ—äº¬ï¼Œå³è¾¹çš„å±äºé•¿æ²»ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å°†é—®é¢˜è¿›ä¸€æ­¥åˆ†æï¼Œä½¿å…¶å˜å¾—æ›´ç®€å•ï¼šåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæ ¹æ®æˆ‘ä»¬çš„ç»éªŒçŸ¥é“ï¼Œå†³å®šæˆ¿å­ä»·æ ¼çš„å› ç´ å…¶å®æ˜¯</p>
<p>ä»·æ ¼/é¢ç§¯ = å¹³æ–¹ä»·</p>
<p><img decoding="async" loading="lazy" alt="image-20240304222249022" src="https://yuluo-yx.github.io/assets/images/image-20240304222249022-49f1cac89ef2439566837be197137ef6.png" width="513" height="327" class="img_c29J"></p>
<p>é«˜è€…å±äºåŒ—äº¬ï¼Œä½çš„åˆ™æ˜¯é•¿æ²»ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªé˜ˆå€¼ï¼Œå°†å…¶è¿›è¡Œåˆ’åˆ†ã€‚</p>
<blockquote>
<p><strong>ä¸Šè¿°å°±æ˜¯æœ€ç®€å•çš„åˆ†ç±»é—®é¢˜ï¼Œåªæœ‰ä»·æ ¼å’Œé¢ç§¯ä¸¤ä¸ªç»´åº¦ã€‚</strong></p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¤šç»´åº¦åˆ†ç±»">å¤šç»´åº¦åˆ†ç±»<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%A4%9A%E7%BB%B4%E5%BA%A6%E5%88%86%E7%B1%BB" class="hash-link" aria-label="å¤šç»´åº¦åˆ†ç±»çš„ç›´æ¥é“¾æ¥" title="å¤šç»´åº¦åˆ†ç±»çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œåˆ¤æ–­æˆ¿å­å€¼ä¸å€¼å¾—è´­ä¹°ã€‚ä¸å¯èƒ½åªæœ‰ <strong>æˆ¿ä»· &amp; é¢ç§¯</strong> ä¸¤ä¸ªå› ç´ ï¼Œå¯èƒ½è¿˜æœ‰ <strong>æ¥¼å±‚ã€é€šå‹¤ã€å¹´é™ã€ç¯å¢ƒ</strong> ç­‰å…¶ä»–å› ç´ ã€‚é—®é¢˜çš„æœ¬è´¨è¿˜æ˜¯ä¸€æ ·çš„ï¼Œæœ€ç»ˆæˆ‘ä»¬éƒ½æ˜¯æ ¹æ®å¯¹è¿™äº›æ•°æ®è¿›è¡Œåˆ†æï¼Œåˆ¤æ–­å€¼ä¸å€¼å¾—è´­ä¹°ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20240304222937185" src="https://yuluo-yx.github.io/assets/images/image-20240304222937185-abc1ea7b28555a9cac28fc3abc6a2cae.png" width="822" height="371" class="img_c29J"></p>
<blockquote>
<p>è¿™ä¸ªé˜ˆå€¼æ€ä¹ˆå¯»æ‰¾ï¼Œç”¨ä»€ä¹ˆæ ·çš„æ–¹å¼å»åˆ¤å®šã€‚æˆ–è€…è¯´è¿™ä¸ªå‡½æ•°æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¨å¯¼æ•°å­¦ç»“è®º">æ¨å¯¼æ•°å­¦ç»“è®º<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E6%8E%A8%E5%AF%BC%E6%95%B0%E5%AD%A6%E7%BB%93%E8%AE%BA" class="hash-link" aria-label="æ¨å¯¼æ•°å­¦ç»“è®ºçš„ç›´æ¥é“¾æ¥" title="æ¨å¯¼æ•°å­¦ç»“è®ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬è®¾ æˆ¿ä»· = xï¼Œé¢ç§¯ = yï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">è®¾ æˆ¿ä»· ä¸º xï¼Œé¢ç§¯ ä¸º yã€‚ </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">åˆ™æœ‰</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> x / y = å¹³ç±³ä»·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è®¾å°†åŒ—äº¬å’Œé•¿æ²»åŒºåˆ†å¼€çš„é˜ˆå€¼ä¸º <code>0.69</code> ï¼Œåˆ™ <code>x/y &gt; 0.69</code> å°±æ˜¯åŒ—äº¬ï¼Œåä¹‹åˆ™æ˜¯é•¿æ²»ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†å…¬å¼å˜å½¢ï¼Œå³å¯å¾—åˆ°å‡½æ•° f çš„å‡½æ•°è¡¨è¾¾å¼</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x,y) = x - 0.69y = 0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä»å…¬å¼æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¿™æ—¶å€™çš„é˜ˆå€¼å˜æˆäº† <code>0</code>ï¼Œå¤§äº  <code>0</code> è¡¨ç¤ºåŒ—äº¬ï¼Œå°äºè¡¨ç¤ºé•¿æ²»ã€‚è¿™é‡Œåªè€ƒè™‘äº†æˆ¿ä»·å’Œé¢ç§¯ä¸¤ä¸ªå› ç´ ã€‚æ›´ç°å®çš„æƒ…å†µæ˜¯ï¼šå› ä¸ºå…¶ä»–å› ç´ çš„å‚ä¸ï¼Œé˜ˆå€¼å¯èƒ½ä¸ä¼šæ°å¥½ç­‰äº <code>0</code>ï¼Œå¯èƒ½æ˜¯ <code>101</code>ã€‚è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥åŠ å…¥ä¸€ä¸ª<code>åç§»é‡</code> å¯¹é˜ˆå€¼è¿›è¡Œæ ¡å‡†ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x,y) = x - 0.69y - 101 = 0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240304224032237" src="https://yuluo-yx.github.io/assets/images/image-20240304224032237-f9bb0c331970f2415a5f03a1ace0ecdc.png" width="702" height="288" class="img_c29J"></p>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬è§‚å¯Ÿè¿™ä¸ªå‡½æ•°è¡¨è¾¾å¼ï¼š</p>
<p>å¦‚æœ y çš„å–å€¼å¢åŠ äº† 100ï¼Œå‡½æ•°å€¼åŠ¿å¿…å‘ç”Ÿå˜åŒ–ã€‚ä½†æ˜¯åªè¦åŒæ—¶å¯¹ x çš„å€¼åšå‡ºä¿®æ­£ï¼Œå°±å¯ä»¥æŠµæ¶ˆå‡½æ•°å€¼å‘ç”Ÿçš„å˜åŒ–ï¼Œå³</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x,y) = x - 0.69y - 101 = 0 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     [+69]  \quad   [+100]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ­¤æ—¶ï¼Œåœ¨å‡½æ•° f ä¸­ï¼Œx çš„ +69 å’Œ y çš„ -100 åœ¨æ•°å­¦å…³ç³»ä¸Šç­‰ä»·ã€‚ä½†æ˜¯åœ¨ç‰©ç†æ„ä¹‰ä¸Šï¼Œx ä»£è¡¨çš„æ˜¯æˆ¿ä»·ï¼Œy ä»£è¡¨çš„æ˜¯é¢ç§¯ã€‚<code>å•ä½/é‡çº²</code> ä¸åŒï¼Œæ— æ³•è¿›è¡Œå…¬åº¦ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x,y) = x - 0.69y - 101 = 0 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     [+69]  \quad   [+100]  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    (ä¸‡å…ƒ)   \quad   (ç±³^2)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨å½“å‰çš„å‡½æ•°ä¸­ï¼Œä»–ä»¬æ˜¯å¯ä»¥è¿›è¡Œæ¢ç®—çš„ï¼Œå› ä¸ºä»–ä»¬éƒ½å¯¹å‡½æ•° f çš„å–å€¼åšå‡ºäº†è´¡çŒ®ã€‚æ¢ç®—çš„æ–¹å¼æ¥è‡ªäºå¯¹å‡½æ•°å€¼è´¡çŒ®çš„å¤§å°ã€‚å³ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240304225027111" src="https://yuluo-yx.github.io/assets/images/image-20240304225027111-cd61692b7f065f4c2ff6c7fd46025ead.png" width="769" height="357" class="img_c29J"></p>
<p>ä»ä¸­å¯ä»¥çœ‹å‡ºï¼Œx å’Œ y å¯¹å‡½æ•°å€¼çš„è´¡çŒ®æ­£å¥½æ˜¯ x å’Œ y çš„ç³»æ•°ã€‚</p>
<p>å›å¤´çœ‹å°†æ‰æ•°æ®ç»´åº¦å¾ˆå¤šçš„æƒ…å†µï¼š</p>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">è®¾ æ•°æ®ç»´åº¦ä¾æ¬¡ä¸º x_1, x_2, x_3.....  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">åˆ™ </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x_1, x_2, x_3, x_4...) = x_1 + x_2 + x_3 + x_4 + b  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æ ¹æ®ä¸Šè¿°å¯¹ x å’Œ y çš„æ¨å¯¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å˜æˆï¼š</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1 + w_2x_2 + w_3x_3 + w_4x_4 + ... + b = y</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…¶ä¸­å‡½æ•°å€¼ y å°±æ˜¯æˆ¿å­æ˜¯å¦å€¼å¾—è´­ä¹°çš„ä¾æ®ã€‚</p>
<p>æ ¹æ®ä¸Šé¢æˆ‘ä»¬çš„æ¨å¯¼ï¼Œè¿™æ ·çš„å‡½æ•°æ˜¯æœ‰æ„ä¹‰çš„ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240304225603259" src="https://yuluo-yx.github.io/assets/images/image-20240304225603259-0ba9370619be3bbf542c83d4304424cf.png" width="918" height="417" class="img_c29J"></p>
<p>w çš„ç³»æ•°ä¸ºå¯¹å‡½æ•°å€¼çš„è´¡çŒ®ç¨‹åºï¼Œb ä¸ºé˜ˆå€¼çš„åç§»é‡ã€‚</p>
<blockquote>
<p>è§„èŒƒæ•°å­¦è¡¨è¾¾ä¸ºï¼šw -&gt; æƒé‡ç³»æ•°ã€b -&gt; åç½®ç³»æ•°ã€‚</p>
</blockquote>
<p>åœ¨åæ ‡ç³»ä¸­è¡¨è¾¾ä¸ºï¼šï¼ˆä¸ºäº†ç”»å›¾æ–¹ä¾¿ï¼Œå›åˆ°äºŒç»´ç³»æ•°è¡¨è¾¾ï¼‰</p>
<p><img decoding="async" loading="lazy" alt="image-20240304225807953" src="https://yuluo-yx.github.io/assets/images/image-20240304225807953-e801a31958f74a5e71d81ca9a9cb725c.png" width="649" height="454" class="img_c29J"></p>
<p>å‰é¢è®¨è®ºçš„é˜ˆå€¼å³ä¸ºä¸‹å›¾ä¸­çš„åˆ†ç•Œçº¿ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240304225842374" src="https://yuluo-yx.github.io/assets/images/image-20240304225842374-349d5fc3bebd7f4a089e2eab6ceabb6f.png" width="644" height="441" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åŠ å…¥å‚æ•°å‡ç»´">åŠ å…¥å‚æ•°å‡ç»´<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%8A%A0%E5%85%A5%E5%8F%82%E6%95%B0%E5%8D%87%E7%BB%B4" class="hash-link" aria-label="åŠ å…¥å‚æ•°å‡ç»´çš„ç›´æ¥é“¾æ¥" title="åŠ å…¥å‚æ•°å‡ç»´çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æ ¹æ®æ•°å­¦åŸç†ï¼Œä¸åŒçš„é˜ˆå€¼å³ä»£è¡¨äº†ä¸åŒçš„åˆ†ç•Œçº¿ã€‚å½“è¿™æ¡ç›´æ¥ç¡®å®šä¸‹æ¥ä¹‹åï¼Œå¯¹æ•°æ®çš„åˆ’åˆ†ä¹Ÿéšä¹‹ç¡®å®šã€‚å°†ä¸åŒçš„ç³»æ•°å¸¦å…¥å˜é‡ x å’Œ y å°±å¯ä»¥å¾—åˆ°ä¸åŒçš„ç»“æœã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å¼•å…¥æ›´å¤šçš„ç»´åº¦ç³»æ•°ï¼Œå¯¹åæ ‡ç³»å‡ç»´ã€‚åˆ™ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240304230033743" src="https://yuluo-yx.github.io/assets/images/image-20240304230033743-e95173d10fe573938e797f24378d51ce.png" width="705" height="459" class="img_c29J"></p>
<p>åœ¨æ›´é«˜ç»´åº¦ä¸­ï¼Œç»å¸¸ä½¿ç”¨å‘é‡å’ŒçŸ©é˜µçš„è¡¨è¾¾å½¢å¼ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1 + w_2x_2 + w_3x_3 + w_4x_4 + \cdots + b  \\ \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">å°†å…¶è½¬åŒ–ä¸ºå‘é‡å’ŒçŸ©é˜µçš„è¡¨è¾¾å¼ä¸ºï¼š\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1 &amp; w_2 &amp; w_3 &amp; w_4 &amp; \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1 \\ x_2 \\ x_3 \\ s_4 \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+b \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä»£è¡¨è¡Œå‘é‡å’Œåˆ—å‘é‡é€é¡¹ç›¸ä¹˜ï¼Œå†ç›¸åŠ  \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä¸ºäº†è®©è¡¨è¾¾å½¢å¼æ›´åŠ ç´§å‡‘ï¼Œé€šå¸¸å¯¹è¡Œå‘é‡è¿›è¡Œè½¬ç½®ï¼Œå†è¿›è¡Œç‚¹ç§¯è¿ç®—ï¼š\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1 \\ w_2 \\ w_3 \\ w_4 \\ \cdots </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1 \\ x_2 \\ x_3 \\ s_4 \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+b \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">é€šå¸¸å‘é‡å’ŒçŸ©é˜µï¼Œé€šå¸¸ä½¿ç”¨å¤§å†™å­—æ¯æ¥è¡¨ç¤ºï¼Œå³ï¼š\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(X) = W^\mathrm T Â· X + b \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">å¦å¤–ä¸€ç§è¡¨è¾¾å½¢å¼æ˜¯å°†åç½®ç³»æ•°åŒæ ·å†™è¿›åˆ°çŸ©é˜µä¸­ï¼š \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1 \\ w_2 \\ w_3 \\ w_4 \\ \cdots \\ b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1 \\ x_2 \\ x_3 \\ s_4 \\ \cdots \\ 1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right] \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">å‡½æ•°è¡¨è¾¾å¼ä¸ºï¼š\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(X) = W^\mathrm T Â· X</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨å‰é¢çš„è®¨è®ºä¸­ï¼Œç¡®å®šäº†æ•°æ®çš„é˜ˆå€¼ï¼ˆåˆ†ç•Œçº¿ä¹‹åï¼‰ã€‚ä¸‹ä¸€æ­¥è¡Œä¸ºåœ¨ <code>æœºå™¨å­¦ä¹ </code> ä¸­ç§°ä¸º <strong>å†³ç­–/é¢„æµ‹</strong>ã€‚å¯¹äºä¸€ä¸ªæ–°è¾“å…¥çš„æ•°æ®ï¼Œé€šè¿‡ x å’Œ y åœ¨åæ ‡ç³»ä¸­çš„ä½ç½®æ¥åˆ¤æ–­å¤„äºåˆ†ç•Œçº¿å“ªä¸€è¾¹ã€‚åœ¨ç¨‹åºä¸­ï¼Œå¹¶ä¸èƒ½ç›´æ¥å»çœ‹å›¾åƒã€‚è€Œæ˜¯è¦å°†å‚æ•°å€¼ä»£å…¥åˆ°å‡½æ•°ä¸­ï¼Œè®¡ç®—å‡ºå‡½æ•°å€¼ï¼Œå’Œ 0 æ¯”è¾ƒï¼Œè¿›è¡Œåˆ¤æ–­ã€‚</p>
<blockquote>
<p>åˆ°è¿™ä¸€æ­¥ï¼Œæœºå™¨å­¦ä¹ çš„é—®é¢˜å˜å¾—ç›¸å¯¹ç®€å•ï¼Œè€Œæœºå™¨å­¦ä¹ çš„éš¾ç‚¹æ˜¯åœ¨äºå¦‚ä½•ç¡®å®šä¸€æ¡æœ€å¥½çš„åˆ†ç•Œçº¿ï¼Œå³ç¡®å®šé˜ˆå€¼ã€‚è¿™ä¸ªè¿‡ç¨‹å«åš<strong>è®­ç»ƒ/å­¦ä¹ </strong>ã€‚å’ŒåŠ¨è§„ï¼Œè´ªå¿ƒç­‰ç®—æ³•ä¸åŒçš„æ˜¯ï¼Œ**æœºå™¨å­¦ä¹ åªéœ€è¦åœ¨åˆšå¼€å§‹æ—¶å¯¹å¤§é‡å¤æ‚çš„æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œç¡®å®šå‡ºæ¥å…³ç³»ã€‚åœ¨é¢å¯¹æ–°æ•°æ®æ—¶ï¼Œåªéœ€è¦è¿›è¡Œç®€å•çš„è¿ç®—å°±å¯ä»¥è¾¾æˆç›®æ ‡ã€‚**é‚£ä¹ˆï¼Œæœºå™¨å­¦ä¹ å¹¶æ²¡æœ‰å‡å°‘ç®—æ³•çš„å¤æ‚åº¦ï¼Œç›¸æ¯”ä¹‹ä¸‹è€Œè¨€ï¼Œåªæ˜¯æé«˜çš„ å†³ç­–/è®­ç»ƒ çš„åº”ç”¨æ•ˆèƒ½ã€‚</p>
<p>æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†äº†è§£å¦‚ä½•å»<code>è®­ç»ƒå’Œå­¦ä¹ </code>ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="è®­ç»ƒ--å­¦ä¹ ">è®­ç»ƒ &amp; å­¦ä¹ <a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E8%AE%AD%E7%BB%83--%E5%AD%A6%E4%B9%A0" class="hash-link" aria-label="è®­ç»ƒ &amp; å­¦ä¹ çš„ç›´æ¥é“¾æ¥" title="è®­ç»ƒ &amp; å­¦ä¹ çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>è®­ç»ƒ/å­¦ä¹  çš„ç›®çš„å¾ˆæ˜ç¡®ï¼Œå³åœ¨åæ ‡ç³»ä¸­ç¡®å®šè¿™æ¡åˆ†ç•Œçº¿ï¼åŒæ ·ï¼Œæœºå™¨å­¦ä¹ çš„éš¾ç‚¹ä¹Ÿåœ¨è¿™é‡Œã€‚</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="image-20240305195959121" src="https://yuluo-yx.github.io/assets/images/image-20240305195959121-31050473ba9a2ac39dee30955c8a978d.png" width="474" height="381" class="img_c29J"></p>
<p><img decoding="async" loading="lazy" alt="image-20240305195942932" src="https://yuluo-yx.github.io/assets/images/image-20240305195942932-bc93e500768674a2f8ca414b08cf48dc.png" width="478" height="394" class="img_c29J"></p>
<p>å¦‚å›¾ï¼Œä¸Šè¿°ä¸¤æ¡ç›´çº¿ï¼Œéƒ½èƒ½å¯¹ç°æœ‰æ•°æ®è¿›è¡Œå®Œç¾åˆ’åˆ†ã€‚ä½†æ˜¯å“ªæ¡ç›´çº¿æ˜¯æœ€ä¼˜è§£ï¼Ÿå¾€å¾€ç°å®æƒ…å†µå¹¶ä¸æ˜¯è¿™æ ·ï¼Œè€Œæ˜¯ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240305200117035" src="https://yuluo-yx.github.io/assets/images/image-20240305200117035-3d5e8d0d3f3fbee403315cab38a83fe9.png" width="471" height="329" class="img_c29J"></p>
<p>å³ä¸å­˜åœ¨è¿™æ ·çš„æœ€ä¼˜è§£ï¼Œå¯ä»¥å°†æ•°æ®è¿›è¡Œå®Œç¾åˆ’åˆ†ã€‚åªèƒ½ä»ç°æœ‰çš„ç›´çº¿ä¸­ï¼ŒæŒ‘é€‰ä¸€æ¡ç¬¦åˆå¤§å¤šæ•°æƒ…å†µï¼Œèƒ½å°†å¤§å¤šæ•°æ•°æ®åŒºåˆ†å¼€çš„ç›´çº¿ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•ç¡®å®šè¿™æ¡ç›´çº¿æ˜¯ä¸æ˜¯ç¬¦åˆç°æœ‰çš„é¢„æœŸï¼Ÿå¯¹æ­¤ï¼Œ**å°±éœ€è¦æœ‰ä¸€ä¸ªåˆ¤æ–­åˆ†ç•Œçº¿å¥½åçš„åˆ¤æ–­æ ‡å‡†ã€‚**åœ¨é¢å¯¹ä¸åŒçš„æ•°æ®é›†æ—¶ï¼ŒæŒ‘é€‰å‡ºçš„ç›´çº¿å¯èƒ½ä¸åŒï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚éšç€è¶Šæ¥è¶Šå¤šçš„æ•°æ®ï¼Œç›´çº¿ä¹Ÿä¼šéšä¹‹å˜åŒ–ã€‚<strong>æ³¨æ„ï¼šæœºå™¨å­¦ä¹ çš„ç›®çš„æ˜¯é¢„æµ‹ï¼Œè€Œä¸æ˜¯è®­ç»ƒã€‚<strong>åœ¨å½“å‰çš„æ•°æ®é›†èŒƒå›´ä¸­ï¼Œåªèƒ½åšåˆ°å½“å‰æƒ…å†µåˆ†ç•Œçº¿æœ€å¥½ï¼Œå¹¶ä¸èƒ½ä¿è¯å¯¹æ–°æ¥çš„æ•°æ®ä¹Ÿæ˜¯æœ€å¥½ã€‚è¿™ä¹Ÿæ˜¯é€‰æ‹©<code>åˆ¤æ–­æ ‡å‡†</code>æœ€å›°éš¾çš„åœ°æ–¹ã€‚å½“æˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ªåˆ¤æ–­æ ‡å‡†ä¹‹åï¼Œæ ‡å‡†ä¹‹ä¸­å°±åŒ…å«äº†æˆ‘ä»¬å¯¹æœªæ¥æ•°æ®çš„ä¸€ç§é¢„æµ‹ã€‚è¿™ä¸ªé¢„æµ‹æ— æ³•åœ¨æ•°å­¦é€»è¾‘ä¸Šæ‰¾åˆ°ç­”æ¡ˆï¼Œæ‰€ä»¥è¦æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±å¿…é¡»è¦å¼•å…¥</strong>é¢å¤–çš„å…¬è®¾</strong>ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¼•å…¥é¢å¤–å…¬è®¾">å¼•å…¥é¢å¤–å…¬è®¾<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%BC%95%E5%85%A5%E9%A2%9D%E5%A4%96%E5%85%AC%E8%AE%BE" class="hash-link" aria-label="å¼•å…¥é¢å¤–å…¬è®¾çš„ç›´æ¥é“¾æ¥" title="å¼•å…¥é¢å¤–å…¬è®¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><img decoding="async" loading="lazy" alt="image-20240305201027218" src="https://yuluo-yx.github.io/assets/images/image-20240305201027218-dd9b869349c72af6ae9ebdcd459c0047.png" width="464" height="341" class="img_c29J"></p>
<p>ä»å›¾ä¸­çœ‹ï¼Œæ¯ä¸ªç‚¹åˆ°åˆ†ç•Œçº¿çš„è·ç¦»å¤§å°ä¸ä¸€ï¼Œæ‰€æœ‰è¿™äº›ç‚¹ä¸­ï¼Œå¯¹åˆ†ç•Œçº¿æœ€å°çš„å“ªä¸€ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯åˆ†ç•Œçº¿å¯¹æ•°æ®åˆ’åˆ†çš„é—´éš”ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240305201149190" src="https://yuluo-yx.github.io/assets/images/image-20240305201149190-35ae322fdc4c0f7826c2689d1ba2ce19.png" width="490" height="325" class="img_c29J"></p>
<p>é€šè¿‡å·²æœ‰çš„ç›´è§‰åˆ¤æ–­ï¼Œåº”è¯¥æ˜¯åˆ†ç•Œçº¿åˆ°ç‚¹çš„è·ç¦»è¶Šå¤§è¶Šå¥½ã€‚å…¶ä¸­çš„é—´éš”å¯ä»¥å®¹çº³æ›´å¤šçš„ç‚¹ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20240305201251937" src="https://yuluo-yx.github.io/assets/images/image-20240305201251937-aed71ce3db691191e3a6986355ef020d.png" width="474" height="334" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å…¬è®¾æ¡ä»¶-1">å…¬è®¾æ¡ä»¶ 1<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%85%AC%E8%AE%BE%E6%9D%A1%E4%BB%B6-1" class="hash-link" aria-label="å…¬è®¾æ¡ä»¶ 1çš„ç›´æ¥é“¾æ¥" title="å…¬è®¾æ¡ä»¶ 1çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æå‡ºè¿™æ ·ä¸€ä¸ªå…¬è®¾ï¼š<strong>é—´éš”è¶Šå¤§è¶Šå¥½</strong></p>
<p>é‚£ä¹ˆï¼Œè¿™é‡Œçš„é—´éš”å¦‚ä½•è®¡ç®—ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶äº¤ç»™è®¡ç®—æœºå»åˆ¤æ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾åˆ°é—´éš”è®¡ç®—çš„è¡¨è¾¾å¼ï¼š</p>
<ol>
<li>
<p>æˆ‘ä»¬éœ€è¦çŸ¥é“ç‚¹åˆ°ç›´çº¿çš„è·ç¦» ï¼Œè¡¨è¾¾å¼ä¸ºï¼ˆå¸¦å…¥ x å’Œ y æ— æ³•ç›´æ¥å¾—åˆ°ç‚¹åˆ°ç›´çº¿çš„è·ç¦»ï¼Œéœ€è¦åšä¸€äº›ä¿®é¥°ï¼‰ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{1}{\|W\|_2} \|f(X)\| \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\|W\|_2 \text{ï¼ˆæƒé‡ç³»æ•°çš„ } L_2 \text{ èŒƒæ•°ï¼‰è¿™é‡Œçš„ } L_2 \text{ èŒƒæ•°å¯ä»¥ç†è§£ä¸º å‹¾è‚¡å®šç†åœ¨æ›´é«˜ç»´åº¦ä¸Šçš„æ‰©å±•ï¼Œå³} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\|W\|_2 = \sqrt{w_1^2 + w_2^2 + w_3^2 + w_4^2 + \cdots} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\text{å¯¹å‘é‡é‡Œçš„æ¯ä¸ªåˆ†é‡è¿›è¡Œå¹³æ–¹å†å¼€æ–¹ã€‚}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å¯¹ä¸Šè¿°çš„æ¯ä¸ªç‚¹è¿›è¡Œ 1 çš„è¿ç®—ï¼Œå³å¯å¾—åˆ°æ‰€æœ‰ç‚¹åˆ°ç›´çº¿çš„é—´éš”ï¼ˆç”¨ M(W) æ¥è¡¨ç¤ºç›´çº¿é—´éš”å‡½æ•°ï¼‰ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">M(W)=\underset {i=1,2,3 \cdots N}{min}\frac{1}{\begin{Vmatrix}W\end{Vmatrix}}_2\begin{vmatrix}f(X^{(i)})\end{vmatrix} \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å°†æ‰€æœ‰æ•°æ®å¸¦å…¥ä¸Šè¿°å…¬å¼ï¼Œåœ¨ä¸è€ƒè™‘æœºå™¨ç®—åŠ›çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—æœºå°±å¯ä»¥å®Œæˆè¿™äº›è®¡ç®—ã€‚</p>
</li>
</ol>
<p>è¿›è¡Œä¸Šè¿°æ“ä½œä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°çš„ç»“æœã€‚è¿™ä¸€åˆ‡çš„å‰ææ˜¯æˆ‘ä»¬å¯¹ <code>f(x)</code> è¿™æ ·çš„å‡½æ•°å€¼è¿›è¡Œäº†ä¸Šè¿°ä¿®é¥°ã€‚æ—¢ç„¶è¿™é‡Œæ˜¯å…¬è®¾ï¼Œé‚£ä¹ˆå®ƒå°±ä¸å”¯ä¸€ã€‚è¿™é‡Œè¿˜å¯ä»¥æœ‰ç¬¬äºŒç§å…¬è®¾ã€‚åŒæ ·ï¼Œæˆ‘ä»¬èƒ½å¶åˆ©ç”¨çš„åªæœ‰å‡½æ•°å€¼ï¼Œä»ç„¶å¯¹å…¶è¿›è¡Œä¿®é¥°ï¼Œå¾—å‡ºå‰æå‡è®¾ã€‚</p>
<p>è¿™æ¬¡çš„ä¿®é¥°æ˜¯å¯¹å…¶è¿›è¡Œ <code>sigmoid(f(x))</code> æ“ä½œï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmod(f(x)) \in (0,1)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é€šè¿‡ <code>sigmoid æ“ä½œ</code>ï¼Œå¯ä»¥å°†å‡½æ•°å€¼ç¼©æ”¾åˆ° <code>0 ~ 1</code> ä¹‹é—´ã€‚<code>sigmoid</code>å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240305203942962" src="https://yuluo-yx.github.io/assets/images/image-20240305203942962-9cbd533eafcb78995737d39ea72708fd.png" width="440" height="315" class="img_c29J"></p>
<p>å®šä¹‰åŸŸä¸ºå…¨ä½“å®æ•°ï¼Œå€¼åŸŸä¸º <code>0 - 1</code> çš„å¼€åŒºé—´ã€‚<code>0 - 1</code> çš„å¼€åŒºé—´ï¼Œå¾ˆå®¹æ˜“è®©æˆ‘ä»¬æƒ³åˆ°æ¦‚ç‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥æŠŠç»è¿‡ä¿®é¥°åçš„å‡½æ•°å€¼çœ‹ä½œæ˜¯ä¸€ä¸ªæ¦‚ç‡å€¼å‘¢ï¼Ÿ</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å…¬è®¾æ¡ä»¶-2">å…¬è®¾æ¡ä»¶ 2<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%85%AC%E8%AE%BE%E6%9D%A1%E4%BB%B6-2" class="hash-link" aria-label="å…¬è®¾æ¡ä»¶ 2çš„ç›´æ¥é“¾æ¥" title="å…¬è®¾æ¡ä»¶ 2çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æˆ‘ä»¬å°†å‡½æ•°å€¼çœ‹ä½œæ˜¯å¦‚ä¸‹çš„æ¡ä»¶æ¦‚ç‡ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">P(X = X^{(i)} \mid W)=sigmod(f(x^{(i)}))</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™ä¸ªæ¦‚ç‡çš„æ„ä¹‰å°±ä»£è¡¨äº†æŸä¸€ä¸ªæ•°æ®åœ¨åŒ—äº¬è¿˜æ˜¯é•¿æ²»çš„å¯èƒ½æ€§ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20240307140828845" src="https://yuluo-yx.github.io/assets/images/image-20240307140828845-7295ff071ef7f67f590911d8c1a9af6f.png" width="476" height="313" class="img_c29J"></p>
<p>åœ¨å½“å‰çš„æ•°æ®æƒ…å†µä¸‹ï¼ŒåŒ—äº¬çš„å‡½æ•°å€¼å¤§äº 0 ï¼Œé•¿æ²»çš„å‡½æ•°å€¼å°äº 0 ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">åŒ—äº¬ï¼šP(X = X^{(i)} \mid W)=sigmod(f(x^{(i)}))  \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">é•¿æ²»ï¼šP(X = X^{(i)} \mid W)=sigmod(-f(x^{(i)}))  \\ é•¿æ²»çš„å‡½æ•°å€¼å°äº 0 ï¼Œæ‰€ä»¥è¦å¯¹å‡½æ•°å€¼å–é™„å±å†è¿›è¡Œ sigmoid æ“ä½œã€‚ \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æ¦‚ç‡å€¼è¶Šå¤§å°±è¡¨æ˜å±äº â€œåŒ—äº¬/é•¿æ²»â€ çš„å¯èƒ½æ€§è¶Šå¤§ï¼Œåä¹‹åˆ™è¶Šå°ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŸºäºå½“å‰çš„ç†è§£ï¼Œæˆ‘ä»¬å°±å¯ä»¥æå‡ºæ–°çš„å…¬è®¾æ¡ä»¶ï¼ˆç¬¬äºŒç§å…¬è®¾ï¼‰ï¼š</p>
<p><strong>æ¦‚ç‡ï¼ˆä¼¼ç„¶ï¼‰å€¼æœ€å¤§æœ€å¥½</strong></p>
<p>æ¦‚ç‡å€¼æœ€å¤§ï¼Œå°±åº”è¯¥æ˜¯æ‰€æœ‰ç‚¹çš„æ¦‚å¿µéƒ½æœ€å¤§ï¼Œä»–ä»¬æ˜¯ç›¸ä¹˜çš„å…³ç³»ã€‚å³æˆ‘ä»¬éœ€è¦æ‰¾çš„å°±æ˜¯å½“</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\underset{W} {max} \prod_{i=0}^N P(X = X^{i}\mid {W})Â· \prod_{j = 0}^M P(X = X^{(i)} \mid {W})</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¡¨è¾¾å¼å–å€¼æœ€å¤§æ—¶ï¼Œç³»æ•° W çš„å€¼ã€‚ä¸Šè¿°è¡¨è¾¾å¼æœ€å¸¸è§çš„å½¢å¼æ˜¯ï¼šä½¿ç”¨ <code>log</code> è¿ç®—ç¬¦å°†è¿ä¹˜å˜ä¸ºè¿åŠ ã€‚</p>
<p>ç¬¬ä¸‰ç§å…¬è®¾ï¼šç°åœ¨æˆ‘ä»¬å¯ä»¥å‡æƒ³å‡ºä¸€ä¸ªå¦‚ä¸‹çš„å‡½æ•° <code>T(X)</code> ï¼Œå®ƒå¯ä»¥å¯¹æ•°æ®è¿›è¡Œå®Œç¾åˆ†ç±»ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">T(X)=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1: X \in {åŒ—äº¬} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">0: X \in {é•¿æ²»}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä»»ä½•ä¸€ä¸ªæ•°æ®çš„è¾“å…¥ï¼Œéƒ½å¯ä»¥å®Œç¾çš„åˆ¤æ–­å‡ºå®ƒå±äºåŒ—äº¬è¿˜æ˜¯é•¿æ²»ã€‚åŒ—äº¬çš„å‡½æ•°å€¼ä¸º 1 ï¼Œé•¿æ²»çš„å‡½æ•°å€¼ä¸º 0 ã€‚å›¾åƒè¡¨ç¤ºä¸ºï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240307144321343" src="https://yuluo-yx.github.io/assets/images/image-20240307144321343-3a6a76a32ec8ea1ba0b7c5a366520226.png" width="493" height="288" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å…¬è®¾æ¡ä»¶-3">å…¬è®¾æ¡ä»¶ 3<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%85%AC%E8%AE%BE%E6%9D%A1%E4%BB%B6-3" class="hash-link" aria-label="å…¬è®¾æ¡ä»¶ 3çš„ç›´æ¥é“¾æ¥" title="å…¬è®¾æ¡ä»¶ 3çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ç°å®æƒ…å†µä¸­ï¼Œè¿™ç§å‡½æ•°ä¸€å®šä¸å­˜åœ¨ï¼Œæ€»æ˜¯ä¼šæœ‰å„ç§å„æ ·çš„è¯¯å·®å’Œå™ªå£°å¯¹ <code>T(X)</code> å‡½æ•°äº§ç”Ÿå½±å“ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨ <strong>Ïµ</strong> è¡¨ç¤ºç»™å‡½æ•°å åŠ äº†ä¸€ä¸ªå™ªå£°ã€‚å®ƒä¸å†å˜å¾—å®Œç¾äº†ã€‚å‡½æ•°çš„è¾“å‡ºå€¼ä¾ç„¶æ˜¯ä¼šæ¥è¿‘ 0 å’Œ 1ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">T(X)+\epsilon=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1+\epsilon: X \in {åŒ—äº¬} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">0+\epsilon: X \in {é•¿æ²»}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™ä¸ªæ—¶å€™ <code>sigmoid</code> å‡½æ•°å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å®ƒæ¥è¡¨ç¤ºå—åˆ°å™ªå£°å¹²æ‰°åçš„ <code>T(X)</code> å‡½æ•°ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">T(X)+\epsilon=sigmoid(f(X))</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å›¾è±¡å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img decoding="async" loading="lazy" alt="Image" src="https://yuluo-yx.github.io/assets/images/image-20240308170315337-8a0a8e9b391590c2aa90a808dc4505d1.png" width="1100" height="553" class="img_c29J"></p>
<p>è¿™ä¸ªæ—¶å€™æ¯ä¸€ä¸ªæ•°æ®å¾—åˆ°çš„ <code>sigmoid</code> å‡½æ•°å€¼ä¸ä»–ä»¬å† T å‡½æ•°ä¸­å–å€¼çš„åå·®å°±æ˜¯å åŠ ä¹‹åçš„å™ªå£° <strong>Ïµ</strong> ã€‚æœ€å¥½çš„åˆ†ç•Œçº¿ï¼Œå¿…ç„¶æ˜¯ <strong>Ïµ</strong> æœ€å°çš„æ—¶å€™å¯¹åº”çš„åˆ†ç•Œçº¿ã€‚å³ï¼š<strong>æ–¹å·®æœ€å°æœ€å¥½</strong>ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\underset{W}{min}\sum_{i=0}^N(y-\hat{y})^2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">y=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1: X \in {åŒ—äº¬} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">0: X \in {é•¿æ²»}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\hat{y}=sigmoid(f(X))</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç¬¬ä¸‰ç§å…¬è®¾çš„è¡¨è¾¾å¼ä¸ºï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\sigma^2=(y-\hat{y})^2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸Šè¿°æåˆ°çš„ä¸‰ç§å…¬è®¾è¡¨ç¤ºä¸ºï¼š</p>
<ul>
<li>ç²‰çº¢è‰²ï¼šæ–¹å·®æœ€å°æœ€å¥½ï¼›</li>
<li>æ©™è‰²ï¼šæ¦‚ç‡æœ€å¤§æœ€å¥½ï¼›</li>
<li>ç»¿è‰²ï¼šé—´éš”æœ€å¤§æœ€å¥½ã€‚</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20240308170851932" src="https://yuluo-yx.github.io/assets/images/image-20240308170851932-2c7a496c239df5e09d5d9498e6766755.png" width="743" height="400" class="img_c29J"></p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå…¬è®¾ä¸åŒï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿä¸åŒï¼Œåˆ°åº•é‚£ç§ç»“æœæœ€å¥½ï¼Ÿ</p>
<p>æ²¡æœ‰ç†è®ºä¸Šçš„æ ‡å‡†ç­”æ¡ˆï¼Œè¿˜æ˜¯è¦çœ‹çœŸå®é—®é¢˜æ˜¯ä»€ä¹ˆã€‚</p>
<p>è¿™é‡Œçš„ä¸‰ç§å…¬è®¾æ¡ä»¶å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">å…¬è®¾ï¼š\begin{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä¿®é¥°å…¬åº¦ç»“æœ \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä¸ºå…¬åº¦ç»“æœèµ‹äºˆç°å®æ„ä¹‰ \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ç”¨ç°å®æ„ä¹‰å°†ä¸€ç›´å¤–æ¨è‡³æœªçŸ¥</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‰€æœ‰çš„å…¬è®¾å¾—åˆ°çš„ç»“æœéƒ½æ˜¯å¯¹å·²çŸ¥ç°å®çš„æ€»ç»“å½’çº³ï¼Œæ˜¯å¯¹æœªçŸ¥æƒ…å†µçš„ç»éªŒæ€»ç»“ã€‚</p>
<p>è™½ç„¶è¿™é‡Œå†™å‡ºäº†åˆ¤æ–­æ ‡å‡†çš„æ•°å­¦æ–¹ç¨‹ï¼Œä½†æ˜¯æ±‚å‡ºè§£æè§£å‡ ä¹ä¸å¯èƒ½ï¼Œå›°éš¾é‡é‡ã€‚è¿™é‡Œå¦‚ä½•é€‰æ‹©æœ€åˆé€‚çš„ç®—æ³•æ›´å¿«ã€æ›´å¥½çš„æ±‚å‡ºå‡½æ•°è¡¨è¾¾å¼çš„æ•°å€¼è§£ã€‚å°±æ˜¯æœºå™¨å­¦ä¹ çš„å¦ä¸€é¡¹é‡è¦å·¥ä½œï¼šç®—æ³•ã€‚</p>
<p>è™½ç„¶ç®—æ³•éå¸¸å¤šï¼Œä½†æ˜¯é’ˆå¯¹ç¥ç»ç½‘ç»œï¼Œæåˆ°ç®—æ³•å°±æ˜¯åœ¨ç‰¹æŒ‡ <code>æ¢¯åº¦ä¸‹é™æ³•</code>ã€‚</p>
<blockquote>
<p>å…¬è®¾çš„å¸¸è§å«æ³•æ˜¯ç­–ç•¥ã€‚ ç®—æ³•ï¼Œç­–ç•¥åŠ ä¸Šæ¨¡å‹ï¼Œå°±æ˜¯æœºå™¨å­¦ä¹ çš„ä¸‰å¤§è¦ç´ ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æœºå™¨å­¦ä¹ ä¸­çš„æ¨¡å‹">æœºå™¨å­¦ä¹ ä¸­çš„æ¨¡å‹<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9E%8B" class="hash-link" aria-label="æœºå™¨å­¦ä¹ ä¸­çš„æ¨¡å‹çš„ç›´æ¥é“¾æ¥" title="æœºå™¨å­¦ä¹ ä¸­çš„æ¨¡å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ•°æ®æ¨¡å‹åˆ†ç±»é—®é¢˜">æ•°æ®æ¨¡å‹åˆ†ç±»é—®é¢˜<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98" class="hash-link" aria-label="æ•°æ®æ¨¡å‹åˆ†ç±»é—®é¢˜çš„ç›´æ¥é“¾æ¥" title="æ•°æ®æ¨¡å‹åˆ†ç±»é—®é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦çœ‹çš„å°±æ˜¯æ¨¡å‹ã€‚æ¨¡å‹ç®€å•æ¥è¯´å°±æ˜¯å¯¹<code>æ•°æ®çš„åˆ†ç±»</code>ï¼Œä¸ºä»€ä¹ˆè¦é€‰æ‹©ç›´çº¿ï¼Ÿå¦‚ä¸‹çš„æ•°æ®åˆ†ç±»å›¾ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240308172044116" src="https://yuluo-yx.github.io/assets/images/image-20240308172044116-7dd9f541c4bef28bd700a5c92ebd9380.png" width="1303" height="877" class="img_c29J"></p>
<p>é¢å¯¹è¿™ç§æ•°æ®åˆ†ç±»çš„æ—¶å€™ï¼Œæ— è®ºç›´çº¿æ€ä¹ˆæ”¾ç½®ï¼Œéƒ½ä¼šå­˜åœ¨é—®é¢˜ã€‚ä½†æ˜¯ä½¿ç”¨ä¸‹é¢çš„æŠ›ç‰©çº¿ï¼Œå°±èƒ½å‡†ç¡®åˆ’åˆ†æ•°æ®ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20240307152553927" src="https://yuluo-yx.github.io/assets/images/image-20240307152553927-091900b266ce518033fa09f83a8de052.png" width="504" height="406" class="img_c29J"></p>
<p>æŠ›ç‰©çº¿æ–¹ç¨‹å¦‚ä¸‹ï¼š<code>å¯ä»¥çœ‹åˆ°ç›¸æ¯”ç›´çº¿æ–¹ç¨‹ï¼Œåªå¤šäº†ä¸€ä¸ª x1 ç³»æ•°çš„äºŒæ¬¡é¡¹</code></p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1^2+w_2x_1-x_2+b=0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240307152639893" src="https://yuluo-yx.github.io/assets/images/image-20240307152639893-febc29a74875f8e57dd35a369795e1bc.png" width="511" height="422" class="img_c29J"></p>
<p>è¿™é‡Œï¼Œå¦‚æœæˆ‘ä»¬å†å¢åŠ  ä¸€ä¸ª x2 ç»´åº¦çš„äºŒæ¬¡é¡¹ï¼Œè¿˜å¯ä»¥å˜åŒ–æˆä¸ºæ¤­åœ†å½¢çš„åˆ†ç•Œçº¿ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1^2+w_2x_2^2+w_3x_1+w_4x_2+b=0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¢åŠ  x3 ç³»æ•°çš„äºŒæ¬¡é¡¹æ—¶ï¼Œä¼šå˜æˆåŒæ›²çº¿ã€‚å¯¹æ•°æ®åˆ†ç±»æ›´åŠ å‡†ç¡®ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20240307152700317" src="https://yuluo-yx.github.io/assets/images/image-20240307152700317-c4cb880c92106a3ab990b1854823e35a.png" width="490" height="419" class="img_c29J"></p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1^2+w_2x_22+w_3x_1x_2+w_4x_1+w_5x_2+b=0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>å‰äººå·²ç»è¯æ˜è¿‡ï¼Œåªè¦å¢åŠ æ›´å¤šçš„é«˜æ¬¡é¡¹ï¼Œé‚£ä¹ˆä¸è®ºå¤šä¹ˆå¥‡æ€ªçš„åˆ†å‰²çº¿éƒ½å¯ä»¥è¡¨ç¤ºå‡ºæ¥ã€‚</p>
<p>éšç€é¡¹æ•°çš„å¢åŠ ï¼Œå¤æ‚ç¨‹åº¦ä¼šè¶Šæ¥è¶Šå¤§ã€‚ä¹Ÿå°±æ˜¯è¯´æ¨¡å‹çš„å¤æ‚ç¨‹åº¦è¶Šé«˜ã€‚</p>
</blockquote>
<p>ä¸ºäº†å›¾å½¢è¡¨ç¤ºæ–¹ä¾¿ï¼Œæš‚æ—¶è¿™é‡Œåªé’ˆå¯¹ x1 ç»´åº¦å¢åŠ æ›´é«˜æ¬¡é¡¹ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\cdots+w_1x_1^3+w_2x_1^2+w_3x_1+w_4x_2+b=0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å›¾åƒè¡¨ç¤ºä¸ºï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240307153214331" src="https://yuluo-yx.github.io/assets/images/image-20240307153214331-9903981554d9986628ef4bd3588daa3a.png" width="533" height="427" class="img_c29J"></p>
<p>ç”¨å‘é‡ç‚¹ç§¯çš„å½¢å¼è¡¨ç¤ºä¸ºï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\cdots \\ 0.00 \\ 0.00 \\ -0.20 \\ 0.50 \\ 4.60 \\ -1.00 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\cdots \\ x_1^5 \\ x_1^4 \\ x_1^3 \\ x_1^2 \\ x_1 \\ x_2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right] \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åˆ†ç±»--å›å½’é—®é¢˜">åˆ†ç±» &amp; å›å½’é—®é¢˜<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%88%86%E7%B1%BB--%E5%9B%9E%E5%BD%92%E9%97%AE%E9%A2%98" class="hash-link" aria-label="åˆ†ç±» &amp; å›å½’é—®é¢˜çš„ç›´æ¥é“¾æ¥" title="åˆ†ç±» &amp; å›å½’é—®é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æœºå™¨å­¦ä¹ é‡Œè®¨è®ºçš„æ¨¡å‹å¤æ‚ç¨‹åº¦å…¶å®å°±æ˜¯æ›²çº¿çš„å¤æ‚ç¨‹åº¦ã€‚è™½ç„¶æˆ‘ä»¬è¿™é‡Œè®¨è®ºçš„æ˜¯åˆ†ç±»é—®é¢˜ï¼Œå…¶å®å’Œå›å½’é—®é¢˜åœ¨æ¨¡å‹ä¸Šå¹¶æ²¡æœ‰æœ¬è´¨çš„åŒºåˆ«ã€‚æ¯”å¦‚ä¸Šè¿°çš„æ›²çº¿ï¼Œå¯ä»¥æ˜¯å¯¹æ•°æ®çš„åˆ†ç±»ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å¯¹è¿™äº›æ•°æ®çš„æ‹Ÿåˆã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20240307154955484" src="https://yuluo-yx.github.io/assets/images/image-20240307154955484-3c9e681b51a78c4759fc78460fc446e9.png" width="513" height="433" class="img_c29J"></p>
<p>ä¸‹é¢æˆ‘ä»¬è¿˜æ˜¯è®¨è®ºåˆ†ç±»é—®é¢˜ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¼•å…¥ç¥ç»ç½‘ç»œ">å¼•å…¥ç¥ç»ç½‘ç»œ<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%BC%95%E5%85%A5%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" class="hash-link" aria-label="å¼•å…¥ç¥ç»ç½‘ç»œçš„ç›´æ¥é“¾æ¥" title="å¼•å…¥ç¥ç»ç½‘ç»œçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ—¢ç„¶ç›´çº¿æ¨¡å‹çš„å±€é™æ€§è¿™ä¹ˆå¤§ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æé«˜æ¨¡å‹çš„å¤æ‚ç¨‹åº¦å‘¢ï¼Ÿæˆ‘ä»¬è¿™æ¬¡è®¨è®ºçš„é‡ç‚¹â€”â€”ç¥ç»ç½‘ç»œå°±æ˜¯ä¸€ç§æé«˜æ¨¡å‹è´Ÿè´£ç¨‹åº¦çš„æ–¹æ³•ã€‚</p>
<p>ä¸‹å›¾å°±è¡¨ç¤ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240307155043430" src="https://yuluo-yx.github.io/assets/images/image-20240307155043430-4cb12d3025775cd96edface0182bce58.png" width="719" height="528" class="img_c29J"></p>
<p>çº¢è‰²è¡¨ç¤ºè¾“å…¥å±‚ï¼Œè¾“å…¥å±‚çš„è¾“å‡ºè¾“å…¥åˆ°ç¥ç»ç½‘ç»œï¼Œå…¶ä¸­æ¯ä¸€ä¸ªç¥ç»å…ƒéƒ½å’Œä¸Šä¸€å±‚ï¼Œä¸‹ä¸€å±‚äº’ç›¸è¿æ¥ã€‚ç§°ä¸ºå…¨è¿æ¥ç¥ç»ç½‘ç»œã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å•ç‹¬æ‹¿å‡ºä¸€ä¸ªæœ€ç®€å•çš„ç»“æ„ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240307155217733" src="https://yuluo-yx.github.io/assets/images/image-20240307155217733-81867475e10e45e8bc5ea790410286b5.png" width="333" height="393" class="img_c29J"></p>
<p>è¿™é‡Œçš„æ¯ä¸€æ¡ä»£è¡¨çš„æ˜¯å¯¹åº”çš„æƒé‡ç³»æ•°ã€‚è¿™ä¸ªç»“æ„ï¼Œå…¶å®å°±è¡¨ç¤ºä¸ºä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ï¼Œè¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1+w_2x_2+w_3x_3+w_4x_4+w_5x_5+w_6x_6+b=z</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240307155302941" src="https://yuluo-yx.github.io/assets/images/image-20240307155302941-db84cead51c1a9487fbfef4675fd049b.png" width="615" height="384" class="img_c29J"></p>
<p>ç»è¿‡ <code>sigmoid(f(x))</code> æ¿€æ´»å‡½æ•°è®¡ç®—è¾“å‡ºç»“æœåˆ°ä¸‹ä¸€å±‚ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¿€æ´»å‡½æ•°">æ¿€æ´»å‡½æ•°<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0" class="hash-link" aria-label="æ¿€æ´»å‡½æ•°çš„ç›´æ¥é“¾æ¥" title="æ¿€æ´»å‡½æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç¥ç»ç½‘ç»œå¯¹æ¿€æ´»å‡½æ•°çš„é€‰æ‹©æ˜¯æœ‰è¦æ±‚çš„ï¼Œsigmoid åªæ˜¯ç¬¦åˆè¦æ±‚çš„å‡½æ•°ä¹‹ä¸€ã€‚è¿™ä¸ªæ¿€æ´»çš„è¿‡ç¨‹ä¸ä¼šåœ¨ç¥ç»ç½‘ç»œä¸­è¡¨ç¤ºå‡ºæ¥ï¼Œåªæ˜¯åœ¨ç¥ç»å…ƒä¸­æ˜¾ç¤ºã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20240308175155446" src="https://yuluo-yx.github.io/assets/images/image-20240308175155446-bcf61c43bf25492df064d591b59bd888.png" width="758" height="450" class="img_c29J"></p>
<p>å› ä¸ºåé¢éœ€è¦ä½¿ç”¨åæ ‡ç³»æ¥å±•ç¤ºï¼Œæ‰€ä»¥è¿™é‡Œåªè®¨è®ºäºŒç»´æƒ…å†µï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240308175254921" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASEAAACFCAIAAACbhdkAAAANXUlEQVR4nO3caYwb530G8OedIbnkXiT35C53V2sdq8uyLFuxZEkWFMeS5SOBHd8JChQokgZFjw8pArSGALdBgQL54Bboh6IuUqdo4qhykwq10USxm9iWnVVcy0dWkqVKWu3Ne8ghl/fM2w9DMlwul5RkOZLi5/dFI+7O7Cx3Hv5n/u87AxARERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERHdeMT13oGbQ+VtktdzL+impFzvHbjJiCWL/ISi5niUXC5R9W9VNZNLv846R7WYsctReZdEuXhJCchyokTVuSRDRjVs13sHblyVwiUACSEB/CZUpQVZ/sZK8IhqMGNNCEgrP9UvmtVfhwCkVdOYMVqOGVuRrD5HrCwIYUopa1+3LtIYMapDvd47cEMTgICwLrcUwARMoBtY29Yy6LTZDZmR0oBUrFp2vfeWbkzseTQiSk0OaZX7IYEHt6x7eNfODcPDqiLnItHjpz4+fOKDCU03hGIApjTNJpukzxzWsUasiy07oADb3a5DT37xa1882NfROr8wp8Vjvu6uvdtu/9zYusDM3Ew8UbR6HvzUoqV4RDQiAAVQgDEHnn3yy/fecfuvJia+++rr7wWjeWCkVX3mnt1P3PeFC+HYoZdefndmrgCYQgCQbDFSGetYEwpgAx67686Hd+18//8ufPuV194MRpNABpgryBMXptw2ZceWjfns4sRCSM8XAEAIIfjhRSWcS9WECXiB20ZGCoX8q8fHL4UiKoRqnUMK6MCxd0/Mz89sXXOLr7PDIYQQwipiVsxuirDdFDt582LGGhECEuh0KF1tLj2VDGRyeQkT0mpsmBI2IBZf1OJ6q92h2Ox5KU0pAUgpZXmhcgQ3PpSFEIpyff4cPLP9VHF8rCHr2DOlYRhCUVRFKOWXZXlBKCgUCh5v9x995ZlTidSlUCgYDAaDwUAgkEqlTPM3w2k1h3Kl4lW+emMf65yQeZWYsSZsQKIoQ8nUretuGevzjs/Np/OmEBKAIiGBVQO+wYHBmXDw2Pj7yfbOjp7e7du3d3d3WxEyTTMcDodCoXg8Pj09PTc3l81mC4VCg0SJ30rXRIiqqV9CKALSvJypKhwIvGLMWHNR4O2zH++6df0je/acnY/+fGYuUz7M1gKP7ry7p6//8I9+fOz9X0dzxcpaqqp2dnb6fD6/39/W1jY6Orpjxw6bzQZAShmLxTRNi8fjs7OzwWBQ1/V0Om0YBuqVO5SLXvWVXmXZOh2tm8n6rwsFpVNaQHVCKDCypmnCGg8UjePNgF0xXuw2IgBVQJHoAv78Swee3HN3JBr70f/8/PjEuUwuv2X1yKP77rnzti2/mDj13NH/Ph+MmACEkA2rkMvlGhwc7O3t9Xg8fr+/v7+/paXF6XQahhGLxZLJZCQSmZyctBKo67oVvCV7Ve5bCiGqz0WXF8DqjJWWFQWmCaD/9p3bPn9gdMOmFpczGgp89M47Z197JafHhFCklMzSNcSMNVIag1YAiSHga/fteWzf7u7W1mRKLxpme3uncDje+Gji+f/62QfBSF5AQljtkJoje6U6U+FyuXp7e91ud19f38jIiNvtdjqd7e3tpmkmk8lMJhMKhaanpzVNswpgsVis2UIleADMpbNNqn66ACQU54Fv/Om+x7/S0umJJeKGUfB4PA4hTp345X/+499HP/4IRoG3EFxDzFgT1hukCgBokdi9qv+hbZs3+gdtNttUNP6LiVM/OzcVS+elEKYQppTmymGqSVp1m7HuSjabraury+12DwwM+P3+rq4ur9fb1taWz+fz+XwulwuFQgsLC9b1XjgcLhQKK/4WQgDWTxf3fv1PDv7+14OB8E+PvHzuV8fziVjf2NiBp57ZtmvP+Q9OHvn2s5HpyaW38tAnwoxdFmtesHUHiwDaAQVYBIrlWlfqcFzZNpedyFWVI3OFmY+Korjd7o6OjuHhYb/f73a7fT5fe3u71UfJZrNzc3PhcDgSiVgL+Xy+OsD+u/Z+47m/WcxkXnzuUOD0SRjlWNpcjz/7V7sOPnT0xRdO/PB72WS8fL8OfVLseVyWyvFmBSBZyYPVc8fV3J+5UgNjeU2rTqBpmpqmaZo2PT1d+QZFUZxOp8fjGRoa6u/v7+zsHBsb83q91irZbDYYCkW02Lm54Jb9D7W2d/zgn/8pdOEUJCBUa30Y2Vd/+H3/2IY7dt595idHswmNH7/XCjPWnKg8TEBKKaUAlKVhaHq5teKWq4anq2NW/dXl8ausJaVUFMUaIUin0+l0en5+vnrjqqq63e6BwcGOzg53V9fW7dvX3bo5GoslLlw0szlIs/R7GSagZgLB6EJgzepVdk8XZqdhGmzUXxPMWFMCgJClM8JSvZJQISSkaR2FUpZSd4Wbro5TTcyqw1a3VVhJoDVBxEpazcaLxWI0Gk2lUi3OFm9v77DdOZTPqXZn6deyqnP1Tld1KZfco0qfADPWWOkGTeuIFJDWsS3K7e3yZRogoQhFWmeOl1fWalJUaccvr4o1uaqsgqWzQ2w2W09PT3d3t9frHRoa6u3tteqYw26P64l0NncxosXD4dW+4ZaBQXHWIXMZSAkBKCpMQ/F6O/v78vmckU6D98FdO8xYc0IICalAKoABacjSHWUFQEqplid9SmlWnltVmXnYOGyVRFkXWkt+4tJpVjULdru9r6/PuvQaGRnx+XzWIJvdbtd1XdO0aDR68uTJYDAYj8fj8Xil178+HFt967b7H33syOn/jU5PAoAUMIoA7rn/4Mgtt4z/5JVFLVquYNWFjGeNV4lnA02UHjQgoEipAhvaHXs3rl0/NOBQ1bmIdnzi3LsxPWNKARiAAesxVvUvnypWKkrL2e12h8PR09MzMDDQ09Nj5crpdDocDmuySCQS0XU9HA7Pzs4mEgld15cPnQFQhSIBU5qwtz5z6K/vfuBLJ0+MH/3XF7UPTyKXgW9o3xNP3//Y48lo6LvPfitwdgLCLJ9GVj8imTG7GsxYI9a7o0AokF3AU5+77fe+sHfTKr/NLCimIWz2QCp/5K0TL7z5y6m4XgCKSx5ZtXRTzQajnU6ny+Xq7u4eGRmxxqMHBwcdDkexWBRCJBKJhYWFRCIRCoWmpqZ0Xc/lciv19yvlUS65M1tIoUCaaPc+/ReHdj7wUL5ozk9OZfW0b2jI5x+YvXj+X57/2/nxN2QhV26k1tQxZuxqMGMrEuXLfgXoBP5w354/OHCvQPG1E+Nvv/deIZvdun7D/t17Vq0a+fFbb3/n2BuXYgkDMMuHeM1Ep2qtra2dnZ1ut3t0dHRgYMCKljW4XCgUksnk/Px8PB6PRqMXL17Udb1BlqpH1Zafcy5foTSXyubcuP/gzgceHl6zrsXuSka1D8ffPn7435KBS0IV0jRgVuaFVDBgV4kZa8J6gx5cPfyXT3zZoarPv/Tyq5PTSUABHMC2Dte3nnpkw9ia7/zg8JFfn08YtQdie3u7x+OxqpPP53O5XG63u7W1NZVK5fP5VCplTdTQNM0qUw0SUslt3cFrLLuKq7sFKaVQFGlKQELY0dOntDhlRJO5BKQBRRGV6cJ0jbDn0YQA3MDezRu8na7vH3v99YVARlXtVtNeiPFU9qV3xv+sv2vfHdvOBOOas629p9c3MDA4ONjR0eFyuVpaWnK5XDKZTCaTgUBgdnZW1/VgMLi4uFh3rFlVVVlWt/NRPQ2/slalx9j81xHCenaWEIqUBYTnTAAQilAERG37n64FZqwRAWFCehQMeT36Yur0bDCTzRsABFRrfrqUZyYvTc/Mb16/8Zt/vOlsujAXjydTqZmZmZmZmWg0qmlaJpOpG6e606aWz7KvfH/d4TJZdZ91U0tXrE6TNKXBW+I/JcxYQwJCwumwOR32Qi6XKxqV25/Nckshn5cC6qKe+od/P/rW5FTdabnVt6JYr9StPA3+26BSXd0Ukzrb4SXXp4MfXg1JKYDFbFFfTLe3tXa3OOyAIgCJ0nM7AG9Ha7fHnc7l4oWCUXWBWzNPqnoeRvV9KDcOBuxTwow1YvUVY8DHC0Gnq+3e7Vt9XR4hYRewAyrQAXx+69bB/r7TU5PRZLL6DNBSs1zTVafPAj5fsQkVKAKpaGTT0NDOzZt6FRkLhBezOTvgB75659av7t+XKhReOPbmRDBcQGkM2iKW3ph8A9Yu+i3gX70Ra2aUQ0BI3Lfa/81HHrx9dHRuYf70hQuZbH7NyOiGtWu1fP7vjvzH4Q/PaIWiFNbAUv17MVm7PpuYsUbKN0ELBVCk3OpueXr3jv13bR/s7rILoS1m3j0/+b2fvvbWbHDRhBQwAVOWJg5fUUudfocxY81ZcVEBA7ABa9oco153i80WiGlnUlndhGp1QUrz+0R1P50BI7oCQtR+JimAemN2CYmIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiI6HfW/wPTCsqJ+gx1BgAAAABJRU5ErkJggg==" width="289" height="133" class="img_c29J"></p>
<p>å…¶ç”¨å‘é‡è¡¨ç¤ºä¸ºï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1\\x_2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1\\w_2 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+[b]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">= [z]\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(z)=a</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¡¨è¾¾å¼çš„è¾“å…¥è¾“å‡ºåœ¨åæ ‡ç³»ä¸­æ˜¾ç¤ºä¸ºå¦‚ä¸‹å›¾çš„ä¸€ä¸ªæ›²é¢ï¼šå¯¹åº”çš„åˆ†ç•Œçº¿å°±æ˜¯ x1 å’Œ x2 å¹³é¢ä¸Šçš„çº¢è‰²ç›´çº¿ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20240307160444347" src="https://yuluo-yx.github.io/assets/images/image-20240307160444347-986456b001ed1860dfa1c7855f1ae9f6.png" width="647" height="319" class="img_c29J"></p>
<p>å¦‚æœä¸å­˜åœ¨æ¿€æ´»å‡½æ•°ï¼Œå°±åªæ˜¯ä¸€ä¸ªé¢ï¼Œå¦‚å›¾ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240307160520189" src="https://yuluo-yx.github.io/assets/images/image-20240307160520189-a87b7f2e60582a0dc76744497df4ef8e.png" width="614" height="338" class="img_c29J"></p>
<p>å†åŠ å…¥ä¸€ä¸ªç¥ç»å…ƒæ—¶ï¼Œè¡¨ç¤ºå¦‚ä¸‹ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240308175501778" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARMAAACGCAIAAABxF/mrAAAQS0lEQVR4nO3ce3Bc1X0H8O85dx9arXa10uqxklYytrEtbAdj4RjbgI3Cw8YOU4IDJU6TQNM0TZuhM/kjLSU0mUzboZMpw0ymk9KBtCGhhEdFA6EEQ7GLiW0w5mEb2/it12q12rdWu9rHPb/+cXdXq4eN8chYl/4+9mh2Vvu4V3u/95zzO+cuwBhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxsxCXOoNuEDn3m76lLaC/f+lXeoNuBDTYyMAad7TADMheak34EJQ6SdNbl7KtzlCjJ2TmEiJ4MCwT9Fn4mAr7wSPb9inxcTJKTcyBJDg2LBPlfmSIyp+lu9RpeAICCkEACIqjYI4Umz2mTE5QkBIACABKgAEeAFfVZUmZSybHdb1HKAJgKAAcHTYRWC65AgUwwMLSIL8AltWLN58zarO9g6btA5F4jsOHnzq7Xc/jCeVgAIUVbRIQhBxjtgsMOV8DkAWkAS6al0P3nn7N7fc4nM5g0ND8XjcV1/X3dW1esmi4MDAQDyZhzEeEpVxEcJ05ws255jvGBIQEiSByy3y/ru23nh119sHD/z8v199LxTOAfMd1m3rr936he6T4dCDv35+X39gHAA3NWy2ma/NMZYLWICt16y6bc3qA8eP/8NL23eFwglgDBgsqL0nz9RaxLrlnYXx9KHgcDKXn5gh5daGzRLTrSEQABTgAZa2t+cKuZf37OkbCVsENEACVoEksP2dfX2DA1cumO9zu21CSFHMDLc8bLaYLjkABAG1VRavq3osMxbK5LKEAhVrAIoggXA8FU0kq+xWYbHkiBSdNTPcCrELY7nUG/BJkYAAQAVdEmlSClGeyZmY6hGEQkH31NV/5yt/eH1irDc0MhwKDQ8PBwKBsbGxyhRV3uZ2iZ0/0yUHBNKAZIGCsfjSy9oX1NW82S/TuiICldrQhX6fv8XXPxL63Z79qZo6d2NTV1eX1+vVNE0ppet6NBodHh6ORqODg4MDAwPpdFrX9RkzYxSyL0I5e/qSISGEIFKTHmLOFE/Z8OLfcNqSXHPuXJEZkwMAUWD34cPXLVuy9Qs3HB9J/E9/IA1IgIBFwB+svqapyfdMz/OvvXcokiuUnyuE8Hg8zc3Nra2tTqdz/vz5a9euFUJIKYUQ0Wg0Go3G4/GBgYFQKJRIJIxEYVrTVBkk44Zxp1Kq8mHnjBwVm0kpoJRRLyTSAUDaICRUDkaKhER5OcTcJox/pfTXAjYgCeSINEAKUSAiTEmQCfZrRqbs5QvAAjQB37vt5ruuXxOJRnp27tx14EQ2l1t2mf/29dd3XXnlzoOHfvziKydDYb1ibc7ZOBwOv9/v9Xo9Ho/f729sbLTb7VVVVUbrNDo6Gg6HT58+nUgkYrFYMpk04lRJSimlLCfHSIuRHEzrAQohiMpdS5JSKlIg0XzVuhXdN81b0lldUxMJBt/dtePE6y/nRhOQgFKAwhwmS4VaBdw0375l7dIVSxY4qmzDkfibHxx79o3e/kxBSC2viKAkQBBUXDhlSqZMDgQ0wEroELine+2dN6zzupyjyZRegNvt0i2WnR8efvjFVw8Mh3UpdSJFk09y5zeecTgcPp/P6XQ2NDR0dHTU19fb7XaXy1UoFFKp1NjYWCQS6e/vj0QiRktVKBSmvEK5/FCOUMVtSZAQQpIi0klzbPz2dzdsvctWWx8dTed15XG5qwSO7tvb87NHIkffh8pDfewZ4FLSAA1wAd/dsuxbX7qupb4mmUjkczlPrdPqcO4+2P+3//zbN4NjORIEMjrVChqgV/bcTNSLM2dyAKBYhq4Cru3wbVq5dLm/zapZ+iKxHR8effnY6WA6a1QPqNTXEQCEOHdihBCaphkPUUpNf6zFYvF4PB6Pp62tra2tzbjtcrlyuVwul8tms6FQaHBwMBwODw8Ph8Ph6XGqfCsppFKKoN/4p/dt+vq9oVBoe8/zR/bszcXj9UuW3PLlu69ed92xD/b3/N0Dkf6Tc/aIEgIC0AgW4K9vXviX39icGEs/9p+vvrZnMJXRF7bi3tvX3XzdqsOnI3/y0G8OxlK6KDY3BAkoUbpCUUxOzhzd2xITJweTu8luQAIpoGAERAgQzcqfX0pZ7n2d7QG1tbUul6utrc3v99fV1RmNla7r+Xw+k8mEQqFgMDgyMhIIBKLR6Pj4eOVLta1e/50f/v34eObxB+8fOvo+VKkrKB13/M2PPn/Lpt/96t/eeuYXuWRiLtb9jNgIoeuqu8X6L391j2YT9z3861dPJbOljlgD8E9/1v3lTev/9bntP+7ZH8/kjOGO8QGaNDnmqxCg+GGVL6Uunr6S5d8Zo4hZig2AynH/FEaolFKxWCwWi/X19U1spBBVVVV1dXV+v7+pqcnj8XR2drrdbgBElNf1oeHhcCR6PBBasfG2qhr3048/FjpzTECQkCAlpEZqfHvPMx1Ll69ed/3RV34zHI/Nzv7MLgIBCiSB7muuqqt3P9rz0puDaV1ACkEgi0REx8+e2rGy8/Jrr17qf/lQMp3TJ0dlpled68yYnOLYesaSkyBx8S5zm14oI6IpZbdyPY2IMplMJpMJBAKVT9E0rba2trXNX1vrcXs8K6/+/ILlnxuJxcInjunjGRAZfRkiArRU/0DoTN8VnYvX3LhptO+EVZOV7/WJNv6itFdCCJAEWYg8heSqKy9PZFK//2Aoky0QCUAIQNfJAhxP4NDJvtWrlnU0W47FYVRYZrqW1zTVNjMmx1BsU8rte+ljKLf8s/ABlKNSDgMm56eyela+v3x7xpK0Ua8bS6er7Q6vt7HdUt02noXFRgAgQAQpBUCkjOZUV7quq+ZmX53IayCj/F25hee/O7MfHgGANEDqupdSTocNek4oksVTGpEwxjLQiqMaWC1WCFFuckTpQzRdeEyWHFG8PmfiCmqj3zbxlVFCEFA+YItH/IW917RJG5yl2Zlyo3ybiDRNa2xs9Hq99fX17e3tXq/XYrG43W6bzZZKjI6P506FY+lYpN3fZvf58JEV+TxNVDR0a6O3saMtl8u88NQTwTMnL2g/PiUC8H792uWbVn1ugWtXMEU5FEgpggDygFfDZS2NiUSqfyijF6i00mPmLwCDGaJjsuSUxy4ECIIsXfipAAugAXki43bxEusLSs30eFS2J2d7lpTS5/O1tLS43e729vaWlha73W632y0WSyKRiMfj8Xj84MGDg4OD8Xg8FouVy27LItF7li279Y47nj3yXqT/TOVr3nDrF+fNn7/7xf8aG02WCxUX5uKs0CMAEqQJkdNp5/5DWzesvGvjht0fvLA3m1KABhQIDuBrty1bvsTf8/rbZ8bzJCCFUCSIVGX3gABR/GBN0OyYsLYmjNoyNBLG9W1X1NjWdy5e5PdbrdbBkZHdR468E06mdSLgfKZBZ36Tsy+3sVgsFoulubm5paWloaGhubnZmDm12WzGQoRwOJxMJoeHh/v7+xOJRCqVmj5ziuKfXhIUrDXbHvjR2i1ffGffWy888e+x99/DeBrNrd13brv1zrvjoaGfP/j94LFDEzW3ydt5nnt0kepyovRfAxzAT+7dsG3z9ceOHvvpr1763xNjGR0+ia/ddsU3794YyeT/+IFf7g4mdYKxVgKAgKqcDRWAgKCKU+ScZc7kABpgIXiBu1dd9Y2bNyye10p6gZTSrNaR0UzPrr2PvrHnVDyZA8qH24xhOPcqT5vNZsyEtre3NzU1ud1un89nt9uNqZ5kMjk0NBSLxcLhcG9v7+jo6Pj4+IyFOGNwYiwymPoAqYEUnPXbfvDDNVu2ZLK5/hOn9bFca0dHg6+599hHv3zkHwNvv0G5LGjmV760peqJ5AjohEbgJ9++6Y6bVzlQOH6qLzmWaWtubGrzBUai9z/yZM/RUUXI60ZUjHGOwpRFbsUOOCdnthmfkx2oBb614dp7b+lWqrD9rbd2Hzgwns2uWLz41jXrFnZ09Oze/dArO09G4+e55Ku6utrlctXV1c2bN6+5ubmmpqahoaG6ujqbzeZyudHR0UAgkEgkIpHIqVOnksnk2UrVlYfyjL0+TA+qUSa0Oq7YuHntps3zFy62WO3xWOzdt36/58lfpIJ9kBqUPmNyLrnKyrImUCDUANvWtNy+/qrliy6z2GyReGr3+0ce79n/biIrJPKq2D+j4pCVMPd7ZjMxZXKM1QObF/q/f+eX7Bbrw08+99vTfQkAgAZc43T84K7bF3Ve/tBTzz538KOEPvVzqampqaur83q9xkyL0+l0u91OpzOVSuVyuXQ6HQwGg8FgLBYbGho6d0gw05o0TKsoVNbopj8FgJAakQIRpF3zNpDNpuIxpJMgBUgpNSJVXA86x1Qmh1AceepALdBeC00imsCQggI0iYICoVRam9rUTL1njjNZhQCAMXpxAWs6O91u13+8+vprweGM1KyADhDo7fT403v33dfSeGPXyo9C8ajNUe2tb2ltbWtrczqdDofD4XDk8/lEIjE2NhYIBPr6+pLJZDgcTqfT00Ni9LIweT60shI9dfNmqrydLV0ThQelozivmtNHBksPkwKakFKRojnZ4GDa1QQ6kQSsUqQUHUoU75eQBNKptK6jWIA3Qx3g7EyXHAEBInILtDZ4Y6nUB31Do5msmlgzIBRw8NTJ3oGBzkVLvvcXf348qw/GosnR0d7e3kAgEA6HY7FYJpOZccxjHNOVszdTpnEqf4WPWQ09w1Fxtoq2cRAppYzVqMZ3yhkdGUX6HL/KoFwfK/7FAF0VZ2nKK2uAqd2y6fszd/dwJqZLjjHFDodNq7FZKV/I6npxuClIEISAIGSypAPpsdRPn35y1+m+GRddGi0JKhqTGWdmJt74LFXp80nIeezWxDMxqbg094fKwOSDvjLlVHnfOXfEDHs5ifm+h8C4ujCZ1ePpjLva2WK32YuroKUUEgQFqq+rqvW4UtlMopAnQJZ6XJjc+zJKZHPvqwio4v9nw2dmRyaYLDnlGmgMODwwaLNZu1euaK7zgJQVsBIJkBPo7upqa2k53NsbTo4a86FGw1Lua5WDVDlwZ+z8mez71ozYSKAAjI4El/nb1i27okEUYsPh9HjWDlwm8Eddy79y0w1junps+xtHgiN66Yw342oaxi6M6cY5xdqaBpxIF57csavJ7fzqjRu6ly0+eurUeDZ/+bx5C+d1RHP5R3te3D84lK8odnJa2CwyXy+luMKWoAFW4EpX1VfXr924uqu1vtYiZCQ1tu/EiSe279wxMJJSqLx4/2MnVRg7f6ZMTrn3JYkUYAUWO+0LvB6rlIPR6JFUNqmgCaiJ6xCK5eZzXKPG2CdivuSUFPthYtpXCwiUrnAxlrJ/3BpnxlhFlcy85wTGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMWZe/wfmhzVPFKg4vQAAAABJRU5ErkJggg==" width="275" height="134" class="img_c29J"></p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1^{[0]}\\x_2^{[0]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1^{[1]}\\w_2^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+[b^{[1]}]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">= [z^{[1]}]\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(z^{[1]}=a^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡Œç”¨ä¸­æ‹¬å·ä¸­çš„ä¸Šæ ‡æ•°å­—è¡¨ç¤ºæ˜¯ç¥ç»å…ƒçš„ç¬¬å‡ å±‚ã€‚</p>
<blockquote>
<p>è¾“å…¥å±‚å¯¹åº”çš„æ˜¯ 0 å±‚ã€‚ç¬¬ä¸€å±‚çš„è¾“å‡ºç»“æœä¼šä½œä¸ºç¬¬äºŒå±‚çš„è¾“å…¥ã€‚</p>
</blockquote>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[a^{1}]^\mathrm TÂ·[w_1^{[2]}]+[b^{[2]}]=[z^{[2]}] \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(z^{[2]}) = a^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¢åŠ ä¸€å±‚ç¥ç»å…ƒä¹‹åï¼Œå›¾åƒå¹¶ä¸ä¼šæœ‰å¤šå¤§çš„å˜åŒ–ï¼Œä»ç„¶æ˜¯ä¸‹é¢è¿™ç§æ›²é¢ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240307161032336" src="https://yuluo-yx.github.io/assets/images/image-20240307161032336-f9ebeb574a56b3f65124fd37c75674e0.png" width="600" height="333" class="img_c29J"></p>
<p>æ¥ä¸‹æ¥å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæˆ‘ä»¬åœ¨å¤šåŠ ä¸€ä¸ªç¥ç»å…ƒä¹‹åï¼Œ</p>
<p><img decoding="async" loading="lazy" alt="image-20240322185329932" src="https://yuluo-yx.github.io/assets/images/image-20240322185329932-17111048118771-9513531d862724ddc869b9e61b5c7aa5.png" width="353" height="160" class="img_c29J"></p>
<p>æ¯ä¸ªç¥ç»å…ƒéƒ½æœ‰ <code>W1, W2 å’Œ b</code> ä¸€ç»„ç³»æ•°ã€‚è¿™æ—¶å€™ W å°±ä¸å†æ˜¯å‘é‡ï¼Œè€Œæ˜¯çŸ©é˜µã€‚ä¸è¿‡ä»ç„¶æ˜¯è¿›è¡Œçº¿æ€§è¿ç®—ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1^{[0]}\\x_2^{[0]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.1}^{[1]} \quad w_{2.1}^{[1]}  \\w_{1.2}^{[1]} \quad w_{2.2}^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+[b_1^{[1]} \quad b_2^{[1]}]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">= [ \quad z_2^{[1]}]\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">è½¬ç½®ä¹‹åï¼š\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1^{[0]}\\x_2^{[0]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.1}^{[1]} \quad w_{2.1}^{[1]}  \\w_{1.2}^{[1]} \quad w_{2.2}^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[b_1^{[1]} \\ b_2^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[z_1^{[1]}] \\ z_2^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æ¿€æ´»å‡½æ•°ä¹Ÿå˜æˆä½¿ç”¨å‘é‡è¡¨ç¤ºçš„å½¢å¼ï¼š</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(Z^{[1]}) = A^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>è¿™é‡Œè¡¨ç¤ºæ¯ä¸€é¡¹ï¼Œæ¯ä¸€ä¸ªåˆ†é‡éƒ½è¦ç»è¿‡ <code>sigmoid</code> è®¡ç®—ã€‚</p>
</blockquote>
<p>ç¬¬äºŒå±‚çš„è¾“å…¥ä¹Ÿä¼šç›¸åº”å˜æˆä¸¤ä¸ªï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">a_1^{[1]}\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">a_2^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1^{[2]} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_2^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">b^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">z^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right] \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(Z^{[2]}) = a^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ­¤æ—¶çš„å›¾åƒä¼šå˜çš„æ›´åŠ å¤šæ ·ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190244078" src="https://yuluo-yx.github.io/assets/images/image-20240322190244078-e0af0c8a230cd9b309fd5ac97793a1cc.png" width="824" height="481" class="img_c29J"></p>
<p>å°¤å…¶æ˜¯åˆ†ç•Œçº¿ï¼Œå·²ç»ä¸æ­¢æ˜¯ä¸€æ¡ç›´çº¿äº†ï¼Œè€Œæ˜¯å‘ç”Ÿäº†å¼¯æ›²ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190340302" src="https://yuluo-yx.github.io/assets/images/image-20240322190340302-27047e855d391eae0154c401b0327fbb.png" width="833" height="522" class="img_c29J"></p>
<p>å¦‚æœæˆ‘ä»¬ç»§ç»­å¢åŠ ç¥ç»å…ƒï¼Œå¢åŠ åˆ°å››ä¸ªï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190431511" src="https://yuluo-yx.github.io/assets/images/image-20240322190431511-a96cde186bd6e76357335819cb6b4a97.png" width="435" height="146" class="img_c29J"></p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1^{[0]}\\x_2^{[0]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.1}^{[1]} \quad w_{2.1}^{[1]} \quad w_{3.1}^{[1]} \quad w_{4.1}^{[1]}  \\w_{1.2}^{[1]} \quad w_{2.2}^{[1]} \quad w_{3.2}^{[1]} \quad w_{4.2}^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[b_1^{[1]} \\ b_2^{[1]} \\ [b_3^{[1]} \\ b_4^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[z_1^{[1]}] \\ z_2^{[1]} \\ [z_3^{[1]}] \\ z_4^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">a_1^{[1]}\\a_2^{[1]}\\a_3^{[1]}\\a_4^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1^{[2]} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_2^{[2]} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_3^{[2]} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_4^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">b^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">z^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right] \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ­¤æ—¶å›¾å½¢å˜åŒ–ä¸ºï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190509691" src="https://yuluo-yx.github.io/assets/images/image-20240322190509691-0b039e5b98f213ddc02a329aa888d643.png" width="813" height="592" class="img_c29J"></p>
<p>æ— è®ºæ˜¯è¾“å‡ºç»“æœçš„æ›²é¢ï¼Œè¿˜æ˜¯åˆ†ç•Œçº¿ï¼Œä»–ä»¬çš„å¤æ‚ç¨‹åº¦å¤§å¤§å¢åŠ ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190536513" src="https://yuluo-yx.github.io/assets/images/image-20240322190536513-6933971fa9c15ce7d12a11ca10cdad7e.png" width="840" height="560" class="img_c29J"></p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬æŒç»­å¢åŠ ç¥ç»å…ƒï¼Œå›¾å½¢çš„å¤æ‚ç¨‹åº¦ä¼šè¶Šæ¥è¶Šé«˜ã€‚</p>
<p>æ•°æ®å®¶ä¹Ÿè¯æ˜äº†ï¼Œåªè¦å¢åŠ çš„ç¥ç»å…ƒè¶³å¤Ÿå¤šï¼Œä»»ä½•ä¸€ç§å¤æ‚çš„æ›²çº¿éƒ½èƒ½å¤Ÿè¢«æ— é™çš„æ¥è¿‘è¡¨è¾¾å‡ºæ¥ï¼Œå³ä¸‡èƒ½é€¼è¿‘å®šç†ï¼ˆé€šç”¨è¿‘ä¼¼å®šç†ï¼‰ã€‚</p>
<p>ç¥ç»ç½‘ç»œè¦æƒ³å®ç°ä¸‡èƒ½é€¼è¿‘ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå…³é”®æ˜¯<code>æ¿€æ´»å‡½æ•°</code>ã€‚å¿…é¡»æ˜¯éçº¿æ€§çš„ï¼Œå¦‚æœæ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼Œå†å¤šçš„ç¥ç»å…ƒä¹Ÿä¸ä¼šå¢åŠ æ¨¡å‹çš„å¤æ‚æ€§ã€‚æ¨¡å‹çš„å›¾åƒåªä¼šæ˜¯ä¸€ä¸ªè¶…å¹³é¢ã€‚å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°å¦‚ä¸‹ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322193525270" src="https://yuluo-yx.github.io/assets/images/image-20240322193525270-13f5e1e013149bd3ce48c3c0ea6fb83a.png" width="869" height="643" class="img_c29J"></p>
<p>ä¹Ÿå¯ä»¥æ˜¯ï¼š<code>sin(x) sinc(x) Gaussion(x)</code> ã€‚ä¸åŒçš„æ¿€æ´»å‡½æ•°å¯¹åº”çš„å›¾å½¢æ˜¯éå¸¸ä¸åŒçš„ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¿€æ´»å‡½æ•°æ·±å…¥">æ¿€æ´»å‡½æ•°æ·±å…¥<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0%E6%B7%B1%E5%85%A5" class="hash-link" aria-label="æ¿€æ´»å‡½æ•°æ·±å…¥çš„ç›´æ¥é“¾æ¥" title="æ¿€æ´»å‡½æ•°æ·±å…¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä¸ºä»€ä¹ˆå¢åŠ æ›´å¤šçš„ç¥ç»å…ƒä¼šæœ‰æ›´å¼ºçš„èƒ½åŠ›ï¼Œä»å¦ä¸€ä¸ªè§’åº¦è¿›è¡Œè§£é‡Šã€‚</p>
<p>å°†å‰é¢ç¥ç»ç½‘ç»œéƒ¨åˆ†çœ‹ä½œä¸ºä¸€ä¸ªé»‘ç›’ï¼Œä¸è®ºè¾“å…¥çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·å­ï¼Œæœ€ç»ˆè¾“å‡ºåˆ°æœ€åä¸€ä¸ªç¥ç»å…ƒåªæ˜¯ä¸€ä¸ªè®¡ç®—ç»“æœã€‚å‡è®¾ä»–æœ‰ 10 ç»´ã€‚å¦‚å›¾ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322193938404" src="https://yuluo-yx.github.io/assets/images/image-20240322193938404-3bab29078b67439b444ab52fc82a39d3.png" width="567" height="451" class="img_c29J"></p>
<p>æ•°æ®ä»2ç»´åˆ°10ç»´ã€‚å…¶ä¸­çš„å…³é”®æ˜¯æ•°æ®çš„è¾“å…¥è¿›è¡Œäº†ä¸€ä¸ªçŸ©é˜µè¿ç®—ï¼ŒçŸ©é˜µå¯¹ä¸€ä¸ªå‘é‡è¿›è¡Œæ“ä½œã€‚å°†å…¶å˜ä¸ºå¦å¤–ä¸€ä¸ªå‘é‡ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322194200931" src="https://yuluo-yx.github.io/assets/images/image-20240322194200931-b3b6c937fb62d2d15a9d11254513a678.png" width="1045" height="448" class="img_c29J"></p>
<p>ä¾‹å¦‚å¦‚ä¸‹çš„å‘é‡ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1\\1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240322194307256" src="https://yuluo-yx.github.io/assets/images/image-20240322194307256-9142512479a7721eb7e8e93a8b848d29.png" width="923" height="562" class="img_c29J"></p>
<p>è¿›è¡Œå¦‚ä¸‹çš„è¿ç®—ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1\\1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">cos\theta \quad -sin\theta\\sin\theta \quad cos\theta</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°†å‘é‡æ—‹è½¬ <code>Î¸</code> è§’åº¦ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322194625846" src="https://yuluo-yx.github.io/assets/images/image-20240322194625846-f4aa6003cf357b124c2f42fbc12388b2.png" width="640" height="387" class="img_c29J"></p>
<p>é‚£ä¹ˆè¿™ä¸ªçŸ©é˜µçš„ä½œç”¨å°±æ˜¯ä½¿å‘é‡å‘ç”Ÿæ—‹è½¬ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä¸‹çš„çŸ©é˜µï¼Œå®Œå…¨å¯ä»¥èµ·åˆ°å¯¹å‘é‡è¿›è¡Œå‡ç»´çš„ä½œç”¨ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1\\1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.1} \quad w_{2.1} \quad w_{3.1} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.2} \quad w_{2.2} \quad w_{3.2} </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240322194922199" src="https://yuluo-yx.github.io/assets/images/image-20240322194922199-351451e02a2e2d62d6e3d24cb6150c52.png" width="489" height="385" class="img_c29J"></p>
<p>å¦‚æœæ•°æ®åªæ˜¯äºŒç»´çš„ï¼Œå®ƒä»¬äº’ç›¸å‚æ‚åœ¨ä¸€èµ·ï¼Œå¾ˆéš¾ç›´æ¥ç”¨ç›´çº¿å¯¹æ•°æ®è¿›è¡Œåˆ’åˆ†ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195040705" src="https://yuluo-yx.github.io/assets/images/image-20240322195040705-8031b65cf1879bcb50859a09f4e05cde.png" width="503" height="380" class="img_c29J"></p>
<p>å¦‚æœå¯¹å®ƒä»¬è¿›è¡Œå‡ç»´ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195114768" src="https://yuluo-yx.github.io/assets/images/image-20240322195114768-c04692051efa0f766a0f0efe534a8713.png" width="476" height="375" class="img_c29J"></p>
<p>ç”¨è·Ÿç®€å•çš„æ¨¡å‹ä¹Ÿå¯ä»¥å°†ä»–ä»¬åˆ†å¼€ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195132104" src="https://yuluo-yx.github.io/assets/images/image-20240322195132104-04d452a68f0aba0bc99250d7ec0d22da.png" width="550" height="393" class="img_c29J"></p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç¥ç»å…ƒä¸­ä¸­é—´çš„æ“ä½œçœ‹ä½œæ˜¯æ•°æ®å‡ç»´çš„æ“ä½œï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195221569" src="https://yuluo-yx.github.io/assets/images/image-20240322195221569-09bd100acfeb8de947860754a8f165ea.png" width="423" height="275" class="img_c29J"></p>
<p>æœ‰å¤šå°‘ç¥ç»å…ƒï¼Œå°±ä¼šæŠŠæ•°æ®å‡åˆ°å¤šå°‘ç»´ã€‚åªè¦ç»´åº¦å¤Ÿé«˜ï¼Œä¸€å®šä¼šæ‰¾åˆ°ä¸€ä¸ªè¶…å¹³é¢ï¼Œèƒ½å¯¹æ•°æ®å®Œæˆåˆ’åˆ†ã€‚</p>
<p>è¿™æ ·å°±å˜æˆäº†æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„ <code>f(x)</code> é—®é¢˜ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195351911" src="https://yuluo-yx.github.io/assets/images/image-20240322195351911-5aa536d178dfdaa1518f37d5abbcaaff.png" width="920" height="479" class="img_c29J"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¤šåˆ†ç±»é—®é¢˜">å¤šåˆ†ç±»é—®é¢˜<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E5%A4%9A%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98" class="hash-link" aria-label="å¤šåˆ†ç±»é—®é¢˜çš„ç›´æ¥é“¾æ¥" title="å¤šåˆ†ç±»é—®é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¸€ä¸ªç¥ç»ç½‘ç»œå¹¶ä¸æ˜¯åªèƒ½æœ‰ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹ï¼Œå¤„ç†äºŒåˆ†ç±»é—®é¢˜ã€‚ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªèŠ‚ç‚¹ï¼Œè¿›è¡Œå¤šåˆ†ç±»é—®é¢˜çš„è®¨è®ºï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195656661" src="https://yuluo-yx.github.io/assets/images/image-20240322195656661-210ebe930ed96272546dada9f2600cd2.png" width="740" height="441" class="img_c29J"></p>
<p>å…¶å®è´¨ä¹Ÿæ˜¯åœ¨æ¯ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹ä¸Šè¿›è¡ŒäºŒåˆ†ç±»åˆ¤æ–­ï¼Œå°†å„ä¸ªèŠ‚ç‚¹ç»¼åˆèµ·æ¥ï¼Œå°±å¯ä»¥å»è§£å†³å¤šåˆ†ç±»é—®é¢˜ã€‚çœŸå®çš„åœºæ™¯ä¸­ï¼Œå¹¶ä¸åƒæ˜¯ä¸Šè¿°æè¿°çš„ç²—ç³™ï¼Œè€Œæ˜¯é€šè¿‡ <code>softMax(Y)</code>å‡½æ•°è¿›è¡Œç»Ÿä¸€æè¿°ã€‚å‡½æ•°è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">softMax(\hat{Y}) = \frac{e^{\hat{y_i}}}{\sum_{j=1}^4e^{\hat{y_j}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°±æ˜¯å¯¹ <code>singmoid(x)</code> å‡½æ•°çš„æ‰©å±•å’Œå‡çº§ã€‚</p>
<p>å®Œæ•´çš„ç¥ç»ç½‘ç»œå¦‚ä¸‹ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322200530988" src="https://yuluo-yx.github.io/assets/images/image-20240322200530988-c99920a5d01a4fd11e8ce59f89789873.png" width="673" height="508" class="img_c29J"></p>
<p>è¿™é‡Œçš„éšè—å±‚æš‚æ—¶ç†è§£ä¸ºå¯¹æ•°æ®è¿›è¡Œå‡ç»´æ“ä½œã€‚ä¸è¿‡æ›´å¸¸è§çš„ç¥ç»ç½‘ç»œåº”è¯¥æ˜¯å¦‚ä¸‹çš„è¡¨ç¤ºï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322200647520" src="https://yuluo-yx.github.io/assets/images/image-20240322200647520-1f775003d4f504a045ab93e39bd9a150.png" width="872" height="455" class="img_c29J"></p>
<p>åŸºäºå¦‚ä¸Šçš„ç¥ç»ç½‘ç»œï¼Œç»§ç»­ä½¿ç”¨éšè—å±‚å°±æ˜¯å¯¹æ•°æ®å‡ç»´çš„çœ‹æ³•ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ï¼Œä»å·¦åˆ°å³ï¼Œç¥ç»å…ƒçš„ä¸ªæ•°åœ¨é€’å‡ã€‚æˆ‘ä»¬ä»ç„¶å›å½’åˆ°ç®€å•é—®é¢˜ï¼š</p>
<p>ç¥ç»ç½‘ç»œçš„è¾“å…¥è¾“å‡ºå¯ä»¥æ˜¯ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322200840361" src="https://yuluo-yx.github.io/assets/images/image-20240322200840361-f8eaa858eb3d0120ac5f9ec597d02b9f.png" width="515" height="378" class="img_c29J"></p>
<p>åŸºäºä¸Šè¿°ç¥ç»ç½‘ç»œå¾ˆéš¾æœ‰æ–°çš„å‘ç°ï¼Œæˆ‘ä»¬åªéœ€è¦å°†é—®é¢˜æ¢æˆä¸‹è¿°è¿™æ ·ï¼Œå°±ä¼šæœ‰æ–°çš„å‘ç°ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322201001608" src="https://yuluo-yx.github.io/assets/images/image-20240322201001608-7dcd40745203d1360d96d3081d8f7a1b.png" width="480" height="417" class="img_c29J"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¡ˆä¾‹åˆ†æ----åˆ¤æ–­é¢éƒ¨è¡¨æƒ…--ocr">æ¡ˆä¾‹åˆ†æ  - åˆ¤æ–­é¢éƒ¨è¡¨æƒ… &amp; OCR<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90----%E5%88%A4%E6%96%AD%E9%9D%A2%E9%83%A8%E8%A1%A8%E6%83%85--ocr" class="hash-link" aria-label="æ¡ˆä¾‹åˆ†æ  - åˆ¤æ–­é¢éƒ¨è¡¨æƒ… &amp; OCRçš„ç›´æ¥é“¾æ¥" title="æ¡ˆä¾‹åˆ†æ  - åˆ¤æ–­é¢éƒ¨è¡¨æƒ… &amp; OCRçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¸Šè¿°çš„æ•°æ®ç»´åº¦å®Œå…¨å¯ä»¥çœ‹ä½œæ˜¯åˆ¤æ–­ä¸€ä¸ªäººå¿ƒæƒ…çš„ç‰¹å¾ã€‚åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå¯æ²¡æœ‰è¿™ä¹ˆæ¸…æ™°çš„è¾“å…¥æ•°æ®å»è®©æ¨¡å‹è¿›è¡Œåˆ¤æ–­ã€‚è€Œåœ¨ç°å®ç”Ÿæ´»ä¸­å­˜åœ¨å¯èƒ½æ˜¯è¿™æ ·çš„ä¸€å¼ åŸå§‹å›¾ç‰‡ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322201056290" src="https://yuluo-yx.github.io/assets/images/image-20240322201056290-8ba9f049a5b8e3a2dfd03e143bc0c97a.png" width="265" height="332" class="img_c29J"></p>
<p>å›¾ç‰‡ä¸Šçš„æ¯ä¸€ä¸ªåƒç´ éƒ½æ˜¯æ•°æ®çš„ä¸€ä¸ªç»´åº¦ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322201249208" src="https://yuluo-yx.github.io/assets/images/image-20240322201249208-715fa0856b41d3218072f56f2376dec2.png" width="718" height="492" class="img_c29J"></p>
<p>è¿™æ—¶å€™åœ¨åŠ å…¥éšè—å±‚ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20240322201311835" src="https://yuluo-yx.github.io/assets/images/image-20240322201311835-500a45e7e4248c45183d46bd1b94654a.png" width="857" height="476" class="img_c29J"></p>
<p>å°±å¯ä»¥ç†è§£æˆäººç±»é¢éƒ¨è¡¨æƒ…çš„ç‰¹å¾ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¿™é‡Œåè€Œé™ç»´äº†å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºè¿™é‡Œçš„ä¸€ä¸ªç‰¹å¾ï¼Œå¹¶ä¸éœ€è¦åŸå§‹æ•°æ®é‡Œçš„æ‰€æœ‰ç»´åº¦ã€‚ä¾‹å¦‚çœ¼ç›çš„åŠ¨ä½œï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥åªå…³æ³¨çœ¼é•œçš„åƒç´ ç‚¹ã€‚</p>
<p>è¿™é‡Œéšè—å±‚å°±å¯ä»¥ç†è§£æˆå¯¹ä¸Šä¸€å±‚åŸå§‹æ•°æ®çš„æŠ½è±¡ã€‚</p>
<p>å¦‚æœåªæ˜¯åˆ°æ­¤ç¨‹åº¦çš„è¯ï¼Œè¿˜æ˜¯ä¸èƒ½æœ‰æ•ˆçš„è§£é‡Šä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œéœ€è¦è¿™ä¹ˆå¤šå±‚ã€‚è¿™æ—¶å€™å¦‚æœæˆ‘ä»¬æ¢ä¸ªé—®é¢˜ç»§ç»­ç†è§£ï¼Œå°±ä¼šæ˜ç™½ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨ç¥ç»ç½‘ç»œå»åˆ¤æ–­æ‰‹å†™çš„æ•°å­—ï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323184129253.png" alt="image-20240323184129253" style="zoom:67%;">
<p>æ¯”å¦‚æ•°å­— 8 ï¼Œç¥ç»ç½‘ç»œå¾ˆå¯èƒ½ä¼šå°† 8 ä¸Šä¸‹ä¸¤éƒ¨åˆ†çš„ç‰¹å¾æå–å‡ºæ¥ä½œä¸ºåˆ¤æ–­çš„ä¾æ®ã€‚å¦‚å›¾ï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323184311528.png" alt="image-20240323184311528" style="zoom:67%;">
<p>è¿™é‡Œå°†å…¶æ”¾åœ¨ç¬¬äºŒä¸ªéšè—å±‚çš„åŸå› æ˜¯ï¼Œä¸¤ä¸ªåœ†å¯èƒ½è¿˜æœ‰å…¶è‡ªå·±çš„å­ç‰¹å¾ï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323184422041.png" alt="image-20240323184422041" style="zoom:67%;">
<p>ä»–ä»¬éƒ½ç”±å››éƒ¨åˆ†åœ†å¼§ç»„æˆã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯åœ¨é‡åˆ°åŒæ ·çš„ç‰¹å¾æ—¶å¯ä»¥å¤ç”¨ï¼Œæ¯”å¦‚æ•°å­— 6 ï¼Œä¸‹åŠéƒ¨åˆ†ä¹Ÿæ˜¯ä¸€ä¸ªåœ†åœˆçš„ç»“æ„ï¼Œä¸‹é¢çš„ç‰¹å¾å°±å¯ä»¥å’Œ 8 è¿›è¡Œå¤ç”¨ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323184635859.png" alt="image-20240323184635859" style="zoom:67%;">
<p>ä¸ŠåŠéƒ¨åˆ†çš„ä¸€ç«–æ‰æ˜¯æ•°å­— 6 ç‹¬æœ‰çš„ç‰¹å¾ã€‚</p>
<p>å¯¹åº”çš„æ•°å­— 5 ï¼Œä¸‹åŠéƒ¨åˆ†æ˜¯åŠä¸ªåœ†å¼§ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥è¿›è¡Œå¤ç”¨ï¼Œä¸åŒçš„ç‰¹å¾åªæœ‰ä¸Šé¢çš„ ä¸€æ¨ª è¿™ä¸€éƒ¨åˆ†ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323184805162.png" alt="image-20240323184805162" style="zoom:67%;">
<p>å¯¹ç¥ç»ç½‘ç»œçš„å±‚æ•°å¯ä»¥ç†è§£ä¸ºï¼šéšè—å±‚è¶Šæ·±ï¼Œå¯¹æ•°æ®çš„æŠ½è±¡ç¨‹åº¦è¶Šé«˜ã€‚</p>
<blockquote>
<p>è¿™é‡Œåªæ˜¯ç”¨äº†æˆ‘ä»¬äººèƒ½ç†è§£çš„ç‰¹å¾è¿›è¡Œæè¿°ï¼Œç¥ç»ç½‘ç»œè‡ªå·±å­¦ä¹ åˆ°çš„ç‰¹å¾ï¼Œå¯èƒ½äººæ— æ³•ç†è§£ï¼Œä½†æ˜¯é¢„æµ‹ç»“æœåŒæ ·ååˆ†å‡†ç¡®ã€‚</p>
</blockquote>
<p>ä¸Šè¿°çš„å°±æ˜¯å¯¹ä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œçš„æè¿°ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323185042001.png" alt="image-20240323185042001" style="zoom:67%;">
<blockquote>
<p>æ¨¡å‹  -&gt; éšè—å±‚</p>
<p>ç­–ç•¥ -&gt; è¾“å‡ºå±‚</p>
<p>å…¶å®åœ¨è¾“å…¥å±‚ä¹Ÿéœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ã€‚éšç€ç®—åŠ›éœ€æ±‚è¶Šæ¥è¶Šå¤§ï¼Œå¦‚ä½•å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ä½¿å…¶å¾—åˆ°æœ€ä½³ç»“æœã€‚ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç®—æ³•---æ¢¯åº¦ä¸‹é™ç®—æ³•">ç®—æ³• - æ¢¯åº¦ä¸‹é™ç®—æ³•<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E7%AE%97%E6%B3%95---%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E7%AE%97%E6%B3%95" class="hash-link" aria-label="ç®—æ³• - æ¢¯åº¦ä¸‹é™ç®—æ³•çš„ç›´æ¥é“¾æ¥" title="ç®—æ³• - æ¢¯åº¦ä¸‹é™ç®—æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œè¿™ä¸ªç®—æ³•æ²¡æœ‰åˆ«çš„ï¼Œå°±æ˜¯åå‘ä¼ æ’­ï¼ˆæ¢¯åº¦ä¸‹é™ï¼‰ç®—æ³•ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323185330009.png" alt="image-20240323185330009" style="zoom:67%;">
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç®—æ³•æ¨å¯¼">ç®—æ³•æ¨å¯¼<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E7%AE%97%E6%B3%95%E6%8E%A8%E5%AF%BC" class="hash-link" aria-label="ç®—æ³•æ¨å¯¼çš„ç›´æ¥é“¾æ¥" title="ç®—æ³•æ¨å¯¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¸€ä¸ªç¥ç»ç½‘ç»œæˆ‘ä»¬å®Œå…¨çœ‹ä½œæ˜¯ä¸€ä¸ªè¿™æ ·çš„å‡½æ•°ï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_w(X) = \hat{Y}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åªä¸è¿‡è¿™ä¸ªå‡½æ•°ç›¸å½“å¤æ‚è€Œå·²ã€‚å¦‚æœç¥ç»ç½‘ç»œå·²ç»è®­ç»ƒæˆåŠŸï¼Œåœ¨è¿›è¡Œåˆ¤æ–­å’Œå†³ç­–çš„æ—¶å€™ï¼Œä»–ä»¬çš„è¾“å…¥å°±æ˜¯ X ç³»æ•° W æ˜¯ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºæ­£å‘ä¼ æ’­ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªç¥ç»ç½‘ç»œæ­£åœ¨è¢«è®­ç»ƒï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»å°±ä¼šå˜å¾—ç›¸å…³ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_X(W) = \hat{Y}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>x ä½œä¸ºå·²çŸ¥çš„å‚æ•°ï¼Œç³»æ•°ä½œä¸ºå˜é‡ï¼Œæ˜¯éœ€è¦æ±‚è§£çš„ã€‚å› æ­¤ï¼Œå‡½æ•°çš„å›¾åƒä¹Ÿä¼šå‘ç”Ÿç›¸åº”çš„å˜åŒ–ã€‚å¦‚å›¾ä¸ºä¸€ä¸ªæ­£å‘ä¼ æ’­çš„å‡½æ•°å›¾åƒï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323185807364.png" alt="image-20240323185807364" style="zoom:80%;">
<p>å¦‚æœå°†ç³»æ•° W çœ‹ä½œå˜é‡çš„è¯ï¼Œåæ ‡ä¸å†æ˜¯ x1 å’Œ  x2 è€Œæ˜¯ w1 å’Œ w2ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323185917793.png" alt="image-20240323185917793" style="zoom:80%;">
<p>ä¸Šå›¾ä¸ºä¸€ä¸ªç®€åŒ–å¤„ç†ï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾ä¸çŸ¥é“ç¥ç»ç½‘ç»œçš„å…·ä½“æƒ…å†µï¼Œåªæ˜¯å°† æ‰€æœ‰çš„ç³»æ•°çœ‹æˆæ˜¯ä¸€ä¸ªå‘é‡ã€‚åé¢æˆ‘ä»¬ä¼šä¿®æ­£å›¾åƒã€‚è¿™é‡Œçš„æœ€é«˜ç‚¹å°±æ˜¯æˆ‘ä»¬åœ¨é€‰æ‹©ç­–ç•¥åå¸Œæœ›å‡ºç°çš„ç»“æœã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323190054804.png" alt="image-20240323190054804" style="zoom:50%;">
<p>æˆ‘ä»¬è¿™é‡Œçš„ç»“æœä¸æ˜¯æ±‚å‡º Y çš„å€¼ï¼Œè€Œæ˜¯æ±‚å‡ºä»¤ Y æœ€å¤§æ—¶ W çš„å–å€¼ã€‚</p>
<p>è¿™ä¸ª W çš„å–å€¼å°±æ˜¯æœ€é«˜ç‚¹åœ¨ç³»æ•°å¹³é¢ä¸Šçš„æŠ•å½±ï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323190459383.png" alt="image-20240323190459383" style="zoom:50%;">
<p>ä¸è¿‡ï¼Œæˆ‘ä»¬åœ¨åˆå§‹åŒ–ä¸€ä¸ªç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œç³»æ•° W å¯èƒ½å‡ºç°åœ¨ä»»ä½•ä¸€ä¸ªä½ç½®ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œä»–åˆ°æœ€ä¼˜ç‚¹çš„è·ç¦»å°±æ˜¯æˆ‘ä»¬æ±‚è§£çš„ç›®æ ‡ï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323190600402.png" alt="image-20240323190600402" style="zoom:50%;">
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_x(W^*) = \hat{Y_*} </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">W - W^* = \Delta W</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½†æ˜¯åœ¨å®é™…åœºæ™¯ï¼Œä¸Šè¿° W çš„å€¼å¾ˆéš¾ç›´æ¥è®¡ç®—å‡ºæ¥ã€‚å¦‚æœåˆ©ç”¨å¦‚ä¸‹çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å‡ºï¼š</p>
<p>åœ¨æ›²é¢ä¸Šçš„ä»»æ„ä¸€ç‚¹ï¼šéƒ½å¯ä»¥æ±‚å‡ºä¸€ä¸ªå‘é‡ï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323190857379.png" alt="image-20240323190857379" style="zoom:50%;">
<p>è¿™ä¸ªå‘é‡æ€»æ˜¯æŒ‡å‘ä¸Šå‡æœ€å¿«çš„æ–¹å‘ï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323190950437.png" alt="image-20240323190950437" style="zoom:50%;">
<p>é‚£ä¹ˆè¿™ä¸ªå‘é‡åœ¨å‚æ•°å¹³é¢ä¸Šçš„<code>æŠ•å½±</code>å°±å«åš <code>æ¢¯åº¦</code>ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323191034894.png" alt="image-20240323191034894" style="zoom:50%;">
<p>æ¢¯åº¦æ€»æ˜¯æŒ‡å‘ä¸Šå‡æœ€å¿«çš„æ–¹å‘ï¼Œé‚£ä¹ˆä¸ºä½•ç§°ä¸ºæ¢¯åº¦ä¸‹é™æ³•å‘¢ï¼Ÿåœ¨é€‰æ‹©ç­–ç•¥çš„æ—¶å€™ï¼Œæœ‰çš„ç­–ç•¥æ˜¯æ±‚æœ€å¤§ï¼Œæœ‰çš„æ˜¯æ±‚æœ€å°ã€‚ä¸ºäº†å°†å…¶ç»Ÿä¸€çœ‹å¾…ï¼Œå³ä¾¿æ˜¯æ±‚æœ€å¤§çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å…¶ä¸ŠåŠ ä¸Šè´Ÿå·ä½¿å…¶å˜æˆæ±‚æœ€å°çš„é—®é¢˜ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323191347399.png" alt="image-20240323191347399" style="zoom:50%;">
<p>ä¸è¿‡è™½ç„¶çš„è¿™é‡Œæ›²é¢åäº†ï¼Œä½†æ˜¯æ¢¯åº¦ä»ç„¶æ˜¯æŒ‡å‘ä¸Šå‡æœ€å¿«çš„æ–¹å‘ã€‚æ‰€ä»¥åœ¨å…·ä½“æ“ä½œçš„æ—¶å€™ï¼Œä¼šå¯¹æ¢¯åº¦å…ˆæ±‚åï¼Œè¿™æ ·æ¢¯åº¦å°±ä¼šæŒ‡å‘ä¸‹é™æœ€å¿«çš„æ–¹å‘ã€‚è¿™å°±æ˜¯è¿™ä¸ªç®—æ³•  <code>æ¢¯åº¦ä¸‹é™æ³•</code>çš„ç”±æ¥ï¼Œä¸è¿‡å…¶æœ¬è´¨ä»ç„¶ç›¸åŒã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323191619191.png" alt="image-20240323191619191" style="zoom:50%;">
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¢¯åº¦ä¸‹é™æ³•åœ¨æ¨¡å‹ä¸­çš„åº”ç”¨">æ¢¯åº¦ä¸‹é™æ³•åœ¨æ¨¡å‹ä¸­çš„åº”ç”¨<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95%E5%9C%A8%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8" class="hash-link" aria-label="æ¢¯åº¦ä¸‹é™æ³•åœ¨æ¨¡å‹ä¸­çš„åº”ç”¨çš„ç›´æ¥é“¾æ¥" title="æ¢¯åº¦ä¸‹é™æ³•åœ¨æ¨¡å‹ä¸­çš„åº”ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ¢¯åº¦æ€»æ˜¯æŒ‡å‘ä¸Šå‡æœ€å¿«çš„æ–¹å‘ï¼Œå³æ€»æ˜¯å’Œç­‰é«˜çº¿å‚ç›´ã€‚æ¢¯åº¦æœ¬èº«æ˜¯ä¸€ä¸ªå‘é‡ï¼Œæ‰€ä»¥å°±ä»£è¡¨äº†ä»–åœ¨æ‰€æœ‰å‚æ•°ç»´åº¦ä¸Šéƒ½æœ‰åˆ†é‡ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323191828250.png" alt="image-20240323191828250" style="zoom:50%;">
<p>å¦‚æœæ‰€æœ‰çš„å‚æ•°éƒ½æŒ‰ç…§æ¢¯åº¦çš„åˆ†é‡è¿›è¡Œè°ƒæ•´ï¼Œè¿™æ ·å°±ä»£è¡¨å‚æ•° W åšå‡ºäº†å½“å‰æƒ…å†µä¸‹æœ€å¥½çš„é€‰æ‹©ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1\\w_2 \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\pm</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\Delta{w_1}\\\Delta{w_2} \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸€æ¬¡æ¬¡æ…¢æ…¢ç§»åŠ¨ï¼Œæ€»ä¼šæ¥è¿‘å…¶çº§å€¼ç‚¹ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323191930106.png" alt="image-20240323191930106" style="zoom:50%;">
<p>å³ä¾¿åœ¨è¿™æ ·çš„åœºæ™¯ä¸‹ï¼Œä»ç„¶å­˜åœ¨é—®é¢˜ï¼Œæ¢¯åº¦åªæ˜¯æŒ‡å‘äº†ä¸Šå‡æœ€å¿«çš„æ–¹å‘ï¼Œè€Œæ²¡æœ‰æŒ‡å‡ºå…¶ä¸Šå‡æ—¶æ¯ä¸€æ­¥çš„æ­¥é•¿ã€‚</p>
<p>æ­¥é•¿åœ¨æ¢¯åº¦ä¸‹é™æ³•ä¸­é€šå¸¸ç”¨ Î· æ¥è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„å­¦ä¹ ç‡äº†ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1\\w_2 \\ \cdots \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\pm</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\eta Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\Delta{w_1}\\\Delta{w_2} \\ \cdots \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®ƒæ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œä¸èƒ½ç”±ç¥ç»ç½‘ç»œå­¦ä¹ å¾—åˆ°ï¼Œéœ€è¦æ‰‹åŠ¨è¿›è¡Œé…ç½®ã€‚</p>
<blockquote>
<p>Î· è¿‡å¤§å°±ä¼šå¾ˆå¿«æ¥è¿‘æå€¼ç‚¹ï¼Œä½†æ˜¯ä¼šé€ æˆåå¤æ¨ªè·³ï¼Œæ— æ³•æ”¶æ•›çš„ç»“æœã€‚</p>
<p>Î· è¿‡å°ï¼Œæ•´ä½“è·¯å¾„æœ€ä¼˜ï¼Œç§»åŠ¨ç›¸åŒæ¬¡æ•°ï¼Œç§»åŠ¨è·ç¦»ä¼šæ¯”è¾ƒçŸ­ã€‚</p>
<p>ç°åœ¨å·²ç»æœ‰äº†å¾ˆå¤šæ¢¯åº¦ä¸‹é™çš„è¿›é˜¶æ–¹æ¡ˆã€‚</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç®—æ³•å®è·µ">ç®—æ³•å®è·µ<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E7%AE%97%E6%B3%95%E5%AE%9E%E8%B7%B5" class="hash-link" aria-label="ç®—æ³•å®è·µçš„ç›´æ¥é“¾æ¥" title="ç®—æ³•å®è·µçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»ç†è§£äº†å…¶æ€è·¯ï¼Œå¦‚ä½•æ±‚å‡ºæ¢¯åº¦ï¼Ÿå°±æ˜¯å¦‚ä½•æ±‚å‡ºåˆ†é‡çš„å…·ä½“å€¼ã€‚å¦‚æœéå¸¸ç¬¼ç»Ÿçš„çœ‹å¾…ï¼šæ±‚æ¢¯åº¦çš„ç­”æ¡ˆä¸ºå¯¹å‡½æ•°æ±‚åå¯¼ã€‚æ¯ä¸€ä¸ªå˜é‡çš„ç»´åº¦éƒ½è¦æ±‚åå¯¼ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1\\w_2 \\ \cdots \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\pm</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\eta Â·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f}}{\partial{w_1}}\\\frac{\partial{f}}{\partial{w_2}}\\ \cdots \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸Šè¿°ä¸­çš„æ¢¯åº¦ä¹Ÿå¯ä»¥ç”¨ âˆ‡f è¡¨ç¤ºï¼Œè¯»ä½œ nablafã€‚</p>
<p>æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯å…·ä½“å¦‚ä½•æ±‚å‡ºåå¯¼ã€‚å¦‚æœæˆ‘ä»¬æŠŠç¥ç»ç½‘ç»œæ•´ä½“çœ‹ä½œæ˜¯ä¸€ä¸ªé»‘ç›’ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323193708237.png" alt="image-20240323193708237" style="zoom:50%;">
<blockquote>
<p>è¾“å…¥å±‚æ˜¯ X ä¸åŒçš„ç³»æ•° W å¯¹åº”ä¸åŒçš„ Y å€¼ã€‚w å…¨éƒ¨åœ¨é»‘ç›’ä¸­ã€‚</p>
</blockquote>
<p>æ‰€è°“çš„æ¢¯åº¦ä¸‹é™ä¾¿æ˜¯ï¼šå°†è®¡ç®—å‡ºæ¥çš„æ¢¯åº¦åå‘ä¼ æ’­åˆ°ç¥ç»ç½‘ç»œä¸­ï¼Œè®©æ‰€æœ‰çš„ W è¿›è¡Œä¿®æ”¹ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323193835793.png" alt="image-20240323193835793" style="zoom:50%;">
<p>å¯¹äºç¥ç»ç½‘ç»œéº»çƒ¦çš„ä¸€ç‚¹æ˜¯ï¼šä¸åŒçš„ W ä¹‹é—´æ˜¯å­˜åœ¨ä¾èµ–å…³ç³»çš„ï¼Œä¸æ˜¯å•ç‹¬å­˜åœ¨ã€‚è¿™ä¸ªä¾èµ–å…³ç³»å°±æ˜¯ç¥ç»ç½‘ç»œçš„ç»“æ„å›¾ã€‚å› æ­¤è¦æƒ³è®¡ç®—å‡ºæ¯ä¸ªç³»æ•°å¯¹åº”æ¢¯åº¦çš„åˆ†é‡è¿˜éœ€è¦å°†é»‘ç›’æ‹†å¼€æ‰è¡Œã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªé»‘ç›’é‡Œé¢åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>å…¶æœ¬è´¨å°±æ˜¯å¦‚ä¸‹å›¾ä¸­çš„ä¸‰è¡Œè¡¨è¾¾å¼ï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323194153127.png" alt="image-20240323194153127" style="zoom:50%;">
<p>è¿™é‡Œçš„è¡¨è¾¾å¼éƒ½æ˜¯åœ¨è¿›è¡Œå‘é‡è®¡ç®—ï¼Œæ‰€ä»¥ä¸ºäº†åé¢çš„è¡¨è¾¾æ–¹ä¾¿ï¼Œå°†å…¶ä½¿ç”¨ä¸‹é¢çš„å½¢å¼è¡¨ç¤ºï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ReLU(XÂ·W^{[1]}) = A^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_k^{[1]}(W^{[k]}_1) = a^{[1]}_k</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ReLU(A^{[1]}Â·W^{[2]}) = A^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_j^{[2]}(A^{1},W^{[2]}_j) = a^{[2]}_j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">softmax(A^{2},W^{[3]})</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_i^{[3]}(A^{2},W^{[3]}_i) = a^{[3]}_i</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…¶ä¸­ i,j,k åˆ†åˆ«å¯¹åº”è¿™ä¸€å±‚ä¸åŒçš„ç¥ç»å…ƒã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥åˆ†ææœ€ä¸‹é¢è¿™ä¸€ä¸ªè¡¨è¾¾å¼ï¼šå®ƒè¡¨ç¤ºçš„æ˜¯æŸä¸€ä¸ªèŠ‚ç‚¹ä¸Šè¦å®Œæˆçš„è®¡ç®—ã€‚</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323194928901.png" alt="image-20240323194928901" style="zoom:50%;">
<p>å®ƒçš„æ¢¯åº¦ç­‰äºï¼šå¯¹æ‰€æœ‰å˜é‡çš„ç»´åº¦æ±‚åå¯¼ã€‚</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\nabla{f_i^{3}} = </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f^{[3]}_i}}{\partial{w^{[3]}_{i,1}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f^{[3]}_i}}{\partial{w^{[3]}_{i,2}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f^{[3]}_i}}{\partial{a^{[3]}_{1}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f^{[3]}_i}}{\partial{a^{[3]}_{2}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡ŒåŒæ—¶ä¹Ÿè¦å¯¹ A æ±‚åå¯¼ï¼Œå› ä¸º A ä¹Ÿæ˜¯ä¸€ä¸ªå½“å‰èŠ‚ç‚¹çš„è¾“å…¥æ•°æ®ï¼Œå…³ç³»å¦‚ä¸‹ï¼š</p>
<img src="https://yuluo-yx.github.io/img/machine_learning/image-20240323195607817.png" alt="image-20240323195607817" style="zoom:50%;">
<p>æˆ‘ä»¬åœ¨è€ƒè™‘ä¹‹å‰ä¸€ä¸ªç¥ç»å…ƒçš„å‚æ•°æ±‚å¯¼æ—¶ï¼Œéœ€è¦ç»“åˆå‰é¢ä¸€å±‚ç¥ç»å…ƒçš„å½±å“ï¼Œå³ J å±‚çš„ a ç³»æ•°çš„åå¯¼è¡¨è¾¾å¼ä¸ºï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">W_j^{[2]} \pm \eta^2Â·\frac{\partial{f_j^{[2]}}}{\partial{W_j^{[2]}}}\sum_{i=1}^4\frac{\partial{f_i^{[3]}}}{\partial{f_j^{[2]}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>K å±‚çš„åå¯¼ç³»æ•°çš„è¡¨è¾¾å¼ä¸ºï¼š</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">W_k^{[1]} \pm \eta^3\sum_{j=1}^7\sum_{i=1}^4\frac{\partial{f_k^{[1]}}}{\partial{W_k^{[1]}}}\frac{\partial{f_j^{[2]}}}{\partial{f_k^{[1]}}}\frac{\partial{f_i^{[3]}}}{\partial{f_j^{[2]}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœåå‘ä¼ æ’­çš„æ¬¡æ•°è¶Šå¤šï¼Œé‚£ä¹ˆå­¦ä¹ ç‡çš„æ¬¡æ•°å°±è¶Šé«˜ã€‚æˆ‘ä»¬çŸ¥é“å­¦ä¹ ç‡å¾€å¾€æ˜¯å°äº 1 çš„ï¼Œé‚£ä¹ˆç»è¿‡æ¬¡æ–¹è¿ç®—ä¹‹åå†å’Œæ¢¯åº¦ç›¸ä¹˜ï¼Œå°±ä¸ä¼šå¯¹å‚æ•°åšå‡ºå¤šå°‘è°ƒæ•´ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸è¯´çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ€»ç»“">æ€»ç»“<a href="https://yuluo-yx.github.io/blog/deep-learn-init#%E6%80%BB%E7%BB%93" class="hash-link" aria-label="æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œå°±æè¿°å®Œäº†ç¥ç»ç½‘ç»œé‡Œçš„æ¨¡å‹ï¼Œç®—æ³•å’Œç­–ç•¥ã€‚</p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="AI" term="AI"/>
        <category label="machine learning" term="machine learning"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[éšç¬” 2024/11/24]]></title>
        <id>https://yuluo-yx.github.io/blog/write-somethings</id>
        <link href="https://yuluo-yx.github.io/blog/write-somethings"/>
        <updated>2024-11-24T18:28:38.000Z</updated>
        <summary type="html"><![CDATA[&emsp;&emsp;ä»Šå¤©æ˜¯ 24 å¹´ 11 æœˆ 24 å·ï¼Œæ˜ŸæœŸæ—¥ï¼Œåˆšä»æ­å·æ¥åˆ°éƒ‘å·ä¸ä¹…ã€‚æƒ³æ¥æƒ³å»åº”è¯¥å†™ç‚¹ä»€ä¹ˆï¼Œç®—æ˜¯ç»å†äº†ä¸€æ®µå¤§èµ·å¤§è½ã€‚]]></summary>
        <content type="html"><![CDATA[<p>â€ƒâ€ƒä»Šå¤©æ˜¯ 24 å¹´ 11 æœˆ 24 å·ï¼Œæ˜ŸæœŸæ—¥ï¼Œåˆšä»æ­å·æ¥åˆ°éƒ‘å·ä¸ä¹…ã€‚æƒ³æ¥æƒ³å»åº”è¯¥å†™ç‚¹ä»€ä¹ˆï¼Œç®—æ˜¯ç»å†äº†ä¸€æ®µå¤§èµ·å¤§è½ã€‚</p>
<p>â€ƒâ€ƒæ¥åˆ°éƒ‘å·ä¹‹åè§è¯†åˆ°äº†è®¸å¤šä¸œè¥¿ï¼Œä¸åŒäºè€å®¶å’Œæ­å·ã€‚éƒ‘å·ç»™äººçš„æ„Ÿè§‰æ›´æœ‰çƒŸç«æ°”ï¼Œæ²¡æœ‰æ­å·çš„å±€ä¿ƒæ„Ÿã€‚ç»™äººçš„æ„Ÿè§‰æ˜¯ä¸€ç§æ…¢èŠ‚å¥çš„ç”Ÿæ´»æ°”æ¯ã€‚æˆ‘ä½çš„åœ°æ–¹åœ¨ä¸€ä¸ªæ—§å°åŒºï¼Œè™½ç„¶ä¸å¦‚å½“åˆåœ¨æ­å·ä½çš„å°åŒºé«˜æ¡£äº›ï¼Œä½†æ˜¯ä¹Ÿåˆ«å…·ä¸€æ ¼ï¼Œåœ¨è·¯ä¸Šè¿˜èƒ½çœ‹åˆ°å°æ—¶å€™åœ¨è€å®¶è§åˆ°çš„æ‰‹æ‰¶æ‹–æ‹‰æœºï¼Œå°åŒºé—¨å£æœ‰å¾ˆå¤šå°å•†è´©ï¼Œä¹°èœçš„ï¼Œä¹°æ°´æœçš„ï¼Œç‰¹åˆ«æ˜¯åˆ°äº†æ™šä¸Šï¼Œæœ‰å¾ˆå¤šè·¯è¾¹æ‘Šã€‚ç»™äººä¸€ç§åœ¨æ­å·äº”å¸¸å¤œå¸‚çš„æ„Ÿè§‰ã€‚å‘³é“å’Œäº”å¸¸å¤œå¸‚å·®ä¸å¤šï¼Œä½†æ˜¯ä»·æ ¼æ¯”äº”å¸¸ä½ä¸€æ¡£ã€‚</p>
<p>â€ƒâ€ƒæ¯å¤©è¿‡ç€æ—¥å‡ºè€Œä½œï¼Œæ—¥è½è€Œæ¯çš„ç”Ÿæ´»ã€‚æˆ¿å­åˆ°å…¬å¸ï¼Œå…¬äº¤è½¦ç›´è¾¾ã€‚ç»å¸¸åœ¨æƒ³ï¼Œæˆ‘ä¹Ÿç®—æ˜¯å¹¸è¿å„¿ï¼Œåœ¨ 24 å¹´å¤§èƒŒæ™¯ä¸å¥½çš„æƒ…å†µä¸‹ï¼Œåœ¨ä¸€ä¸ªè¿˜ä¸é”™çš„åŸå¸‚æ‰¾åˆ°äº†ä¸€ä¸ªæ»¡æ„çš„å·¥ä½œï¼Œåªæ˜¯ç›®å‰è¿˜æ²¡å‘å·¥èµ„ã€‚</p>
<p>â€ƒâ€ƒæ¯å¤©ä¸‹ç­ä¹‹åï¼Œæˆ´ç€è€³æœºï¼Œåç€å…¬äº¤è½¦ï¼Œçœ‹ç€ä¸Šè½¦ä¸‹è½¦çš„ï¼Œè·¯æ—æ¥æ¥å¾€å¾€çš„äººï¼Œä¹Ÿåˆ«æœ‰ä¸€ç•ªæ»‹å‘³åœ¨å¿ƒå¤´ã€‚å›åˆ°æˆ¿å­é‡Œï¼Œçœ‹ç€å¼€æºç¤¾åŒºç¾¤é‡Œçš„èŠå¤©ä¿¡æ¯ï¼Œè‡ªå·±åœ¨å¼€æºç¾¤é‡Œçš„å‘è¨€ï¼Œä¸åŒäººåœ¨ç¾¤é‡Œæ€ç»´çš„ç¢°æ’ã€‚ä¸€å¤©è¿‡çš„ç®€å•å……å®åˆå¹³æ·¡ã€‚</p>
<p>â€ƒâ€ƒç‰¹æœ‰ç¼˜åˆ†çš„ä¸€ä»¶äº‹æ˜¯ ç«Ÿç„¶æœ‰ä¸€ä¸ªå’Œæˆ‘åœ¨åŒä¸€ç«™å…¬äº¤ä¸Šè½¦åˆåŒä¸€ç«™ä¸‹è½¦çš„å¥³ç”Ÿï¼Œä¹Ÿç®—æŒºæœ‰ç¼˜åˆ†ã€‚</p>
<p>â€ƒâ€ƒå‘¨æœ«åŒä¼‘ï¼Œå¯èƒ½æ˜¯åœ¨æ­å·ä¸æ•¢å¥¢æœ›çš„äº‹æƒ…ï¼Œåœ¨æ­å·ä¸Šç­ï¼Œç»™äººçš„æ„Ÿè§‰æ˜¯ åŒä¼‘æ˜¯çŠ¯æ³•çš„ï¼Œä¸Šç­æ—¶é—´ä»¥å•ä¼‘å±…å¤šï¼Œå¶è§å¤§å°å‘¨ã€‚å‘¨æœ«ä¸¤å¤©ï¼Œä¸€å¤©èººå¹³ä¹±é€›ï¼Œä¸€å¤©æŠ•èº«äºå¼€æºå’Œå…´è¶£çˆ±å¥½ã€‚åˆæ¥ä¹åˆ°ï¼Œæ¯ä¸ªåœ°æ–¹éƒ½æœ‰è‡ªå·±éƒ½æœ‰çš„ç‰¹ç‚¹ï¼Œä¸å»é€›é€›ï¼Œç®—æ˜¯ç™½æ¥ä¸€è¶Ÿäº†ï¼</p>
<p>â€ƒâ€ƒæœ‰æ—¶å€™èººåœ¨åºŠä¸Šï¼Œæƒ³ç€è¿™æ ·è¿‡ç€æ¸ºå°åˆé‡å¤çš„æ—¥å­ä¹ŸæŒºå¥½çš„ã€‚ä¸å¦‚æœ‹å‹åœˆè§åˆ°çš„ç²¾è‡´ï¼Œä½†æ˜¯ç®€ç®€å•å•ä¹Ÿä¸ä¹å‘³ã€‚</p>
<p>â€ƒâ€ƒäºæ­¤è€Œæ¥çš„å¦ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘åˆ°åº•åº”è¯¥è¿‡æ€æ ·çš„äººç”Ÿï¼Ÿä¹‹å‰åˆ·è§†é¢‘åˆ·åˆ°è¿‡å¤§å†°è€å¸ˆçš„ç›´æ’­è§†é¢‘ï¼Œä»ä¸­ä¹Ÿé¢†æ‚Ÿåˆ°äº†ä¸€äº›ã€‚è®ºè¯­ä¸­è¯´ï¼ŒäºŒåè€Œå† ï¼Œä¸‰åè€Œç«‹ã€‚å››åè€Œä¸æƒ‘ã€‚æ­¤æ—¶æ­£ç›´å¼±å† ä¹‹å¹´ï¼Œæ‰€æœ‰çš„ä¸€åˆ‡éƒ½åˆšåˆšå¼€å§‹ã€‚</p>
<p>â€ƒâ€ƒæˆ‘è§‰å¾—äººç”Ÿä¸èƒ½è¢«è¿‡æ—©å®šä¹‰ï¼Œä¹Ÿä¸åº”è¯¥è¢«è¿‡æ—©å®šä¹‰ï¼Œé‡‘æ— è¶³èµ¤äººæ— å®Œäººã€‚</p>
<hr>
<p>â€ƒâ€ƒæœ€åï¼Œé™„ä¸€å¼ äºä»Šå¤©ä¸‹åˆæ‹çš„ç…§ç‰‡ï¼Œå¸Œæœ›å¹´è¿‡åŠç™¾ï¼Œä¹Ÿèƒ½æœ‰è¿™æ ·çš„çŠ¶æ€ã€‚</p>
<p><img decoding="async" loading="lazy" alt="éƒ‘å·ä¸œå‘¨è·¯åœ°é“å£å¼¹é’¢ç´çš„è€äºº" src="https://yuluo-yx.github.io/assets/images/other2-dc53be7390bd89c6248314d3eb948c03.jpg" width="1702" height="1276" class="img_c29J"></p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="éšç¬”" term="éšç¬”"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯æ¨é€]]></title>
        <id>https://yuluo-yx.github.io/blog/wechatminiapp-msg-push</id>
        <link href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push"/>
        <updated>2024-10-10T22:41:01.000Z</updated>
        <summary type="html"><![CDATA[éœ€æ±‚èƒŒæ™¯]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="éœ€æ±‚èƒŒæ™¯">éœ€æ±‚èƒŒæ™¯<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E9%9C%80%E6%B1%82%E8%83%8C%E6%99%AF" class="hash-link" aria-label="éœ€æ±‚èƒŒæ™¯çš„ç›´æ¥é“¾æ¥" title="éœ€æ±‚èƒŒæ™¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ç®¡ç†å‘˜åœ¨åå°ç»™å°ç¨‹åºç”¨æˆ·æ¨é€ä¸€äº›æ¶ˆæ¯ï¼Œä¾‹å¦‚ç”¨æˆ·æ”¶è´¹é€šçŸ¥ï¼Œå·¥å•ç»´æŠ¤é€šçŸ¥ç­‰ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åŠŸèƒ½æµç¨‹å›¾">åŠŸèƒ½æµç¨‹å›¾<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B%E5%9B%BE" class="hash-link" aria-label="åŠŸèƒ½æµç¨‹å›¾çš„ç›´æ¥é“¾æ¥" title="åŠŸèƒ½æµç¨‹å›¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><img decoding="async" loading="lazy" alt="å¾®ä¿¡ç”¨æˆ·æ¶ˆæ¯æ¨é€æµç¨‹å›¾" src="https://yuluo-yx.github.io/assets/images/img6-73d9b6e549c958a2d307347a87eb8784.png" width="1106" height="586" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åŠŸèƒ½å®ç°">åŠŸèƒ½å®ç°<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="åŠŸèƒ½å®ç°çš„ç›´æ¥é“¾æ¥" title="åŠŸèƒ½å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å°ç¨‹åºé¡¹ç›®æ·»åŠ å¦‚ä¸‹ä»£ç å¼€å¯ç”¨æˆ·è®¢é˜…">å°ç¨‹åºé¡¹ç›®æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œå¼€å¯ç”¨æˆ·è®¢é˜…<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%B7%BB%E5%8A%A0%E5%A6%82%E4%B8%8B%E4%BB%A3%E7%A0%81%E5%BC%80%E5%90%AF%E7%94%A8%E6%88%B7%E8%AE%A2%E9%98%85" class="hash-link" aria-label="å°ç¨‹åºé¡¹ç›®æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œå¼€å¯ç”¨æˆ·è®¢é˜…çš„ç›´æ¥é“¾æ¥" title="å°ç¨‹åºé¡¹ç›®æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œå¼€å¯ç”¨æˆ·è®¢é˜…çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>ç”¨æˆ·è®¢é˜…æ¶ˆæ¯æ–‡æ¡£ï¼š<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/subscribe-message.html" target="_blank" rel="noopener noreferrer">https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/subscribe-message.html</a></p>
</blockquote>
<p>åœ¨å°ç¨‹åºä¸­åŠ å…¥å¦‚ä¸‹ä»£ç ï¼Œå¼€å¯ç”¨æˆ·è®¢é˜…ï¼š</p>
<div class="language-tsx codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-tsx codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  uni</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">requestSubscribeMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ¨¡æ¿æ¶ˆæ¯ id</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    tmplIds</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">'tmpId'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">success</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token console class-name" style="color:hsl(35, 99%, 36%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">fail</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token console class-name" style="color:hsl(35, 99%, 36%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<ol>
<li>å¾®ä¿¡å¼€å‘å·¥å…·æ˜¾ç¤ºç”¨æˆ·è®¢é˜…æ¶ˆæ¯å¼¹çª—å’ŒçœŸæœºè°ƒè¯•ä¸­ï¼Œæ˜¾ç¤ºå¾—å†…å®¹ä¸ä¸€æ ·ï¼Œæ³¨æ„ç”„åˆ«ã€‚</li>
<li>ç”¨æˆ·åœ¨è®¢é˜…æ¶ˆæ¯ä¹‹åï¼Œç‚¹å‡»ä¸‹é¢å¾—å¯¹å·å°±æ˜¯æ°¸ä¹…è®¢é˜…ï¼Œå¯ä»¥åœ¨å°ç¨‹åºè®¾ç½®ä¸­å…³é—­ã€‚ï¼ˆå®é™…è¿˜æ˜¯èµ°äº†è®¢é˜…ï¼Œä½†æ˜¯ç”¨æˆ·æ— æ„Ÿï¼‰</li>
<li>ç”¨æˆ·è®¢é˜…æ¶ˆæ¯ä¸€å®šè¦é€šè¿‡<strong>ç”¨æˆ·ç‚¹å‡»äº‹ä»¶æˆ–è€…æ”¯ä»˜å›è°ƒ</strong>è§¦å‘ï¼Œåœ¨ await ä¸­ä¸ç”Ÿæ•ˆã€‚</li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/setting/wx.getSetting.html" target="_blank" rel="noopener noreferrer">wx.getSetting()</a> æ¥å£å¯è·å–ç”¨æˆ·å¯¹ç›¸å…³æ¨¡æ¿æ¶ˆæ¯çš„è®¢é˜…çŠ¶æ€ã€‚</li>
<li>åœ¨è§¦å‘ç”¨æˆ·è®¢é˜…æ¶ˆæ¯äº‹ä»¶ä¹‹åï¼Œå¾®ä¿¡æœåŠ¡å™¨ä¼šå‘é€éªŒè¯è¯·æ±‚åˆ°å¼€å‘è€…æœåŠ¡å™¨è¿›è¡Œä¿¡æ¯éªŒè¯ã€‚</li>
</ol>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åå°åŠŸèƒ½">åå°åŠŸèƒ½<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E5%90%8E%E5%8F%B0%E5%8A%9F%E8%83%BD" class="hash-link" aria-label="åå°åŠŸèƒ½çš„ç›´æ¥é“¾æ¥" title="åå°åŠŸèƒ½çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åŠŸèƒ½æè¿°">åŠŸèƒ½æè¿°<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E5%8A%9F%E8%83%BD%E6%8F%8F%E8%BF%B0" class="hash-link" aria-label="åŠŸèƒ½æè¿°çš„ç›´æ¥é“¾æ¥" title="åŠŸèƒ½æè¿°çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åå°åŠŸèƒ½ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªï¼š</p>
<ol>
<li>æ¥å—å¾®ä¿¡æœåŠ¡å™¨å¾—ç”¨æˆ·è®¢é˜…æ¶ˆæ¯éªŒè¯ï¼›</li>
<li>éªŒè¯é€šè¿‡åï¼Œæ¥å—å¾®ä¿¡æœåŠ¡å™¨å¾—ç”¨æˆ·è®¢é˜…æ¶ˆæ¯äº‹ä»¶ï¼›</li>
<li>å‘é€æ¶ˆæ¯ç»™æŒ‡å®š openId ç”¨æˆ·</li>
</ol>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ä»£ç å®ç°">ä»£ç å®ç°<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="ä»£ç å®ç°çš„ç›´æ¥é“¾æ¥" title="ä»£ç å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ol>
<li>
<p>å¾®ä¿¡æœåŠ¡å™¨æƒé™éªŒè¯</p>
<blockquote>
<p>å¾®ä¿¡æƒé™éªŒè¯ç­–ç•¥ï¼š</p>
<p>å°†è‡ªå®šä¹‰ token å’Œ timestampã€nonce æŒ‰ç…§å­—å…¸åºæ’åˆ—ï¼Œä¹‹å SHA1 åŠ å¯†å’Œ signature è¿›è¡Œå¯¹æ¯”ï¼Œç›¸åŒè¿”å› echostrã€‚</p>
</blockquote>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// controller</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * å¾®ä¿¡æœåŠ¡å™¨é‰´æƒæ¥å£</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @param signature ç­¾å</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @param timestamp æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @param nonce     éšæœºæ•°</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @param echostr   éšæœºå­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @return é‰´æƒé€šè¿‡è¿”å› echostr</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">value </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/user"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">userAuth</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> signature</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> nonce</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> echostr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> messageService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">auth</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">signature</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> nonce</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> echostr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// service</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">auth</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> signature</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> nonce</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> echostr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"æ¥æ”¶åˆ°çš„å‚æ•°ï¼š{} {} {} {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> signature</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> nonce</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> echostr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> arr </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">wxConfigProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMsgToken</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> nonce</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Arrays</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">sort</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token plain"> sb </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> str </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> arr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        sb</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">append</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> computedSignature </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SHAUtil</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">sha1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">sb</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¾®ä¿¡æœåŠ¡å™¨æ¥æ”¶åˆ°çš„ ç­¾åï¼š{}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> signature</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"SHA1 è®¡ç®—å‡ºçš„ç­¾åï¼š{}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> computedSignature</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">computedSignature</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">signature</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> echostr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å¾®ä¿¡ç”¨æˆ·è®¢é˜…äº‹ä»¶æ¥å—æ¥å£</p>
<blockquote>
<p>ç”¨æˆ·äº‹ä»¶æ¥å£å¿…é¡»å’Œæƒé™éªŒè¯æ¥å£åŒåï¼Œå¾®ä¿¡æœåŠ¡å™¨ä¼šå‘é€ GET ç”¨äºéªŒè¯ï¼ŒPOST ç”¨äºå‘é€ç”¨æˆ·è®¢é˜…äº‹ä»¶æ¶ˆæ¯ã€‚</p>
</blockquote>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// controller</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">* å¾®ä¿¡æœåŠ¡å™¨å¤„ç†ç”¨æˆ·äº‹ä»¶æ¥å£</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@PostMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">value </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/user"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HttpServletRequest</span><span class="token plain"> request</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    messageService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">auth</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// service</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * // æ¥å£è¿”å› JSON å’Œ XML è¿”å›ä½“å¯ä»¥åœ¨å¾®ä¿¡å°ç¨‹åºè‡ªå®šä¹‰è¿”å›æ ¼å¼ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * "ToUserName":"gh_ea84a199bf81",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * "FromUserName":"oG0NJ5Oi_3Dd1HlZJ14xfnA0sJ6s",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * "CreateTime":1686131943,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * "MsgType":"event",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * "Event":"subscribe_msg_popup_event",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * "List":{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * "PopupScene":"0",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * "SubscribeStatusString":"accept",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * "TemplateId":"4ondVRxk4L20ihrJ3iI15BDK72XatGPxE0MeCVwHasQ"</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * // é€‰æ‹©æ˜æ–‡åŠ å¯†å…¼å®¹æ¨¡å¼æ—¶ï¼Œè¿˜ä¼šè¿”å›åŠ å¯†å†…å®¹ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HttpServletRequest</span><span class="token plain"> request</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BufferedReader</span><span class="token plain"> reader </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BufferedReader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">InputStreamReader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getInputStream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token plain"> requestContent </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> line</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">line </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> reader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">readLine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            requestContent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">append</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">line</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        reader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">close</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">hasText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">requestContent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ServiceException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¾®ä¿¡æœåŠ¡å™¨å“åº”å¤±è´¥ï¼"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¾®ä¿¡æœåŠ¡å™¨å“åº”ï¼š{}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> requestContent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">JsonNode</span><span class="token plain"> jsonNode </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">JsonUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">fromJson</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">requestContent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">TypeReference</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è§£æä¸º JSONNode</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toUserName </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> jsonNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ToUserName"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">asText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> fromUserName </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> jsonNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"FromUserName"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">asText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token plain"> createTime </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> jsonNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"CreateTime"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">asLong</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> msgType </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> jsonNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"MsgType"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">asText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> event </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> jsonNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Event"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">asText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">JsonNode</span><span class="token plain"> listNode </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> jsonNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"List"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> subscribeStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> listNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"SubscribeStatusString"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">asText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> templateId </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> listNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"TemplateId"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">asText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// éœ€è¦ä¿å­˜çš„ç”¨æˆ·è®¢é˜…æ¶ˆæ¯å®ä½“ä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsg</span><span class="token plain"> dbWeChatMsg </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">weChatMsgMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">selectOneByQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryWrapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">eq</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsg</span><span class="token operator" style="color:hsl(221, 87%, 60%)">::</span><span class="token function" style="color:hsl(221, 87%, 60%)">getFromUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> fromUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¦‚æœå·²ç»å­˜åœ¨ï¼Œåˆ™æ›´æ–°è¦†ç›–å­—æ®µå³å¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nonNull</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dbWeChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            dbWeChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setSubscribeStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">subscribeStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            dbWeChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setTmplId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">templateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            dbWeChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">weChatMsgMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">update</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dbWeChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ²¡æœ‰åˆ™æ’å…¥æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsg</span><span class="token plain"> weChatMsg </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SnowFlakeIdGenerator</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">generateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setFromUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">fromUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setCreateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">valueOf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">createTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setMsgType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">msgType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setEvent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setTmplId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">templateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setSubscribeStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">subscribeStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">weChatMsgMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">insert</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ServiceException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"æ¥å—å¾®ä¿¡æœåŠ¡å™¨è®¢é˜…æ¶ˆæ¯å¼‚å¸¸ï¼šerr: "</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å®ä½“</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Table</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">value </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"tbl_wechat_sub"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsg</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Long</span><span class="token plain"> id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> fromUserName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> createTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> msgType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> subscribeStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> tmplId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>è‡³æ­¤ï¼Œå¾®ä¿¡å°ç¨‹åºæœåŠ¡å™¨çš„äº¤äº’åŠŸèƒ½å°±å®Œæˆäº†ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯å¼€é€šå’Œå‘é€æ¶ˆæ¯">å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯å¼€é€šå’Œå‘é€æ¶ˆæ¯<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%B6%88%E6%81%AF%E5%BC%80%E9%80%9A%E5%92%8C%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF" class="hash-link" aria-label="å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯å¼€é€šå’Œå‘é€æ¶ˆæ¯çš„ç›´æ¥é“¾æ¥" title="å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯å¼€é€šå’Œå‘é€æ¶ˆæ¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¶ˆæ¯å‘é€åå°åŠŸèƒ½å®ç°">æ¶ˆæ¯å‘é€åå°åŠŸèƒ½å®ç°<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81%E5%90%8E%E5%8F%B0%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="æ¶ˆæ¯å‘é€åå°åŠŸèƒ½å®ç°çš„ç›´æ¥é“¾æ¥" title="æ¶ˆæ¯å‘é€åå°åŠŸèƒ½å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ol>
<li>
<p>æ¶ˆæ¯å‘é€å™¨</p>
<blockquote>
<p>åå°å‘é€æ¶ˆæ¯æ—¶ï¼Œéœ€è¦è·å– accessTokenï¼Œä¸€èˆ¬2ä¸ªå°æ—¶åˆ·æ–°ä¸€æ¬¡ï¼Œéœ€è¦åŠ¨æ€è·å–ã€‚</p>
</blockquote>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatSubscribeMessageSender</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">org</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">slf4j</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatSubscribeMessageSender</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">sendSubscribeMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> accessToken</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> openid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> templateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> page</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> data</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> url </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GarageConstants</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatConstants</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MsgBaseUrl</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"?access_token="</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> accessToken</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">URL</span><span class="token plain"> apiUrl </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">URL</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HttpURLConnection</span><span class="token plain"> connection </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HttpURLConnection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> apiUrl</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">openConnection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            connection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setRequestMethod</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"POST"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            connection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setRequestProperty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Content-Type"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"application/json;charset=UTF-8"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            connection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setDoOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ„å»ºè¯·æ±‚ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> body </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">buildRequestBody</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">openid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> templateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">byte</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> requestBodyBytes </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> body</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getBytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StandardCharsets</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">UTF_8</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å‘é€è¯·æ±‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            connection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutputStream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">write</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">requestBodyBytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¯»å–å“åº”</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> responseCode </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> connection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResponseCode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BufferedReader</span><span class="token plain"> reader </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BufferedReader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">InputStreamReader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">connection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getInputStream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token plain"> response </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> line</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">line </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> reader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">readLine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">append</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">line</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            reader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">close</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">responseCode </span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HttpURLConnection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">HTTP_OK</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¯·æ±‚æˆåŠŸå¤„ç†é€»è¾‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å‘é€è®¢é˜…æ¶ˆæ¯æˆåŠŸ. resp: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¯·æ±‚å¤±è´¥å¤„ç†é€»è¾‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å‘é€è®¢é˜…æ¶ˆæ¯å¤±è´¥, å“åº”ï¼š{}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            connection</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">disconnect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ServiceException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¾®ä¿¡æ¶ˆæ¯æ¨é€å¤±è´¥ï¼err: "</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * æ„å»ºè¯·æ±‚ä½“çš„JSONå­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">buildRequestBody</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> openid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> templateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> page</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> data</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">format</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"{\"touser\":\"%s\",\"template_id\":\"%s\",\"page\":\"%s\",\"data\":%s}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                openid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> templateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å‘é€å¾®ä¿¡æ¶ˆæ¯</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsgHelper</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsgHelper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ¨é€æ¶ˆæ¯çš„æ—¶å€™éœ€è¦ accessTokenï¼Œè¿™é‡Œæ˜¯è·å–</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// token çš„æ–¹æ³•ï¼Œåœ¨å®é™…ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬æ˜¯å®šæ—¶åˆ·æ–°ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¸¤ä¸ªå°æ—¶å†…æœ‰æ•ˆï¼Œè·å–accesstokenæ—¶éœ€è¦appidå’Œsecretä¿¡æ¯ï¼Œä¸€èˆ¬æ˜¯åå°å‚æ•°æˆ–å¸¸é‡è¿›è¡Œé…ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è·å– accessToken çš„è¯·æ±‚æ¥å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GetAccessToken</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GarageConstants</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatConstants</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">TokenBaseUrl</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"&amp;appid={appid}&amp;secret={secret}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">refreshAccessToken</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> appid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> secret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RestTemplate</span><span class="token plain"> restTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">hasText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">appid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">||</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">hasText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">secret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"åˆ·æ–°å¾®ä¿¡ AccessToken æ—¶ï¼Œç¼ºå°‘ appid æˆ– secret å‚æ•°ï¼"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ServiceException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"åˆ·æ–°å¾®ä¿¡ AccessToken æ—¶ï¼Œç¼ºå°‘ appid æˆ– secret å‚æ•°ï¼"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> param </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        param</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"appid"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain">appid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        param</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"secret"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain">secret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ResponseEntity</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">JSONObject</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> resp </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> restTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getForEntity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GetAccessToken</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">JSONObject</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                param</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">JSONObject</span><span class="token plain"> jsonObj </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> resp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getBody</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> accessToken </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">jsonObj </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            accessToken </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> jsonObj</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getStr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"access_token"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> accessToken</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createDataItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> item </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        item</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"value"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> item</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å‘é€å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * @param configProperties å¾®ä¿¡é…ç½®å±æ€§</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * @param restTemplate restTemplate æ¨¡æ¿</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * @param openId ç”¨æˆ· openId</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * @param templateId æ¨¡æ¿ Id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * @param page ç‚¹å‡»è·³è½¬çš„é¡µé¢è·¯å¾„</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * @param jsonData å‘é€çš„ json æ•°æ®</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * @param messageSender æ¶ˆæ¯å‘é€å™¨</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WXConfigProperties</span><span class="token plain"> configProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RestTemplate</span><span class="token plain"> restTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> openId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> templateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> page</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> jsonData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatSubscribeMessageSender</span><span class="token plain"> messageSender</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åˆ·æ–° token</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> accessToken </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsgHelper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">refreshAccessToken</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                configProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getAppId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                configProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getAppSecret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                restTemplate</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        messageSender</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">sendSubscribeMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">accessToken</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> openId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> templateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> jsonData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>åœ¨ä¸šåŠ¡é€»è¾‘ä¸­è°ƒç”¨</p>
<blockquote>
<p>ä¸€èˆ¬éœ€è¦è·å–é€šçŸ¥ç”¨æˆ·çš„ openIdï¼Œå»æ•°æ®åº“ä¸­æŸ¥è¯¢åˆ° templateIdï¼Œä¹‹åç»„è£…æ¶ˆæ¯ç„¶åå‘é€ç»™ç”¨æˆ·ã€‚</p>
</blockquote>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// é…ç½®çš„ JSON æ•°æ®ä¿¡æ¯éœ€è¦çœ‹åé¢çš„ å¾®ä¿¡æ¨¡æ¿å‚æ•°ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token class-name" style="color:hsl(35, 99%, 36%)">JSONObject</span><span class="token plain"> messageData </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">JSONObject</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">messageData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">set</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"thing8"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createDataItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"æœåŠ¡å†…å®¹"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> projectInfoById</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">messageData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">set</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"thing5"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createDataItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¤‡æ³¨"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> userNotify</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> jsonData </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> messageData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toJSONString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç»„è£…å‘é€æ¶ˆæ¯éœ€è¦çš„å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsgHelper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    configProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    restTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOpenId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    weChatMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getTmplId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"pages/index"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    jsonData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    messageSender</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å°ç¨‹åºåå°é…ç½®">å°ç¨‹åºåå°é…ç½®<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%90%8E%E5%8F%B0%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="å°ç¨‹åºåå°é…ç½®çš„ç›´æ¥é“¾æ¥" title="å°ç¨‹åºåå°é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¶ˆæ¯æ¨é€é…ç½®">æ¶ˆæ¯æ¨é€é…ç½®<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="æ¶ˆæ¯æ¨é€é…ç½®çš„ç›´æ¥é“¾æ¥" title="æ¶ˆæ¯æ¨é€é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<p>åœ¨å°ç¨‹åºåå° -&gt; ç®¡ç† -&gt; å¼€å‘ç®¡ç† -&gt; æ¶ˆæ¯æ¨é€ä¸­é…ç½®åå°æœåŠ¡å™¨åœ°å€åœ°å€ä¿¡æ¯ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šåœ¨é…ç½®æ—¶éœ€è¦å‘é€éªŒè¯åˆ°åå°æœåŠ¡å™¨éªŒè¯ï¼Œæ‰€ä»¥éœ€è¦éƒ¨ç½²åˆ°å…¬ç½‘å¯è®¿é—®å¾—ç¯å¢ƒä¸­æµ‹è¯•ã€‚</p>
</blockquote>
<p>å®Œæˆç›¸å…³é…ç½®å¦‚ä¸‹ï¼š</p>
<p><img decoding="async" loading="lazy" alt="å¾®ä¿¡æ¶ˆæ¯æ¨é€é…ç½®" src="https://yuluo-yx.github.io/assets/images/img3-f3ed982b34d412a323323c4153e9cde6.png" width="1361" height="514" class="img_c29J"></p>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¨¡æ¿æ¶ˆæ¯é…ç½®">æ¨¡æ¿æ¶ˆæ¯é…ç½®<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E6%A8%A1%E6%9D%BF%E6%B6%88%E6%81%AF%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="æ¨¡æ¿æ¶ˆæ¯é…ç½®çš„ç›´æ¥é“¾æ¥" title="æ¨¡æ¿æ¶ˆæ¯é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<p>å°ç¨‹åºåå° -&gt; åŸºç¡€åŠŸèƒ½ -&gt; è®¢é˜…æ¶ˆæ¯  -&gt; åœ¨æˆ‘çš„æ¨¡æ¿ä¸­é€‰æ‹©æ¨¡æ¿é…ç½®ã€‚</p>
<p><img decoding="async" loading="lazy" alt="å¾®ä¿¡æ¶ˆæ¯æ¨¡æ¿é…ç½®" src="https://yuluo-yx.github.io/assets/images/img4-94412200e0973b30f71b1d8324a61a43.png" width="1410" height="572" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æµ‹è¯•">æµ‹è¯•<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E6%B5%8B%E8%AF%95" class="hash-link" aria-label="æµ‹è¯•çš„ç›´æ¥é“¾æ¥" title="æµ‹è¯•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ‰‹åŠ¨ç¼–å†™-controller-æ¥å£">æ‰‹åŠ¨ç¼–å†™ controller æ¥å£<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E6%89%8B%E5%8A%A8%E7%BC%96%E5%86%99-controller-%E6%8E%A5%E5%8F%A3" class="hash-link" aria-label="æ‰‹åŠ¨ç¼–å†™ controller æ¥å£çš„ç›´æ¥é“¾æ¥" title="æ‰‹åŠ¨ç¼–å†™ controller æ¥å£çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * æµ‹è¯•ä½¿ç”¨</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * æ¨¡æ‹Ÿæ¶ˆæ¯æ¨é€ï¼Œå†™æ­»æ‰€æœ‰çš„å‚æ•°ä¿¡æ¯ï¼Œå®é™…ä¸­åº”è¯¥ä»æ•°æ®åº“ä¸­æŸ¥è¯¢åˆ°å·²ç»è®¢é˜…æ¶ˆæ¯çš„ç”¨æˆ·å‘é€æ¶ˆæ¯é€šçŸ¥ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/push"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">push</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> openid </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"ooaER7ctq6G_5CNrs0LE2vR2wCzk"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> templateId </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"3gMbhH_bFuZlXiaJffCqXlNoqKvJwz_zUSmr-z1jEyo"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> page </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/pages/index"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">JSONObject</span><span class="token plain"> messageData </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">JSONObject</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    messageData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">set</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"thing1"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createDataItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å…¬å¸åç§°"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"æµ‹è¯•å…¬å¸"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    messageData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">set</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"thing4"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createDataItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"åœ°å€"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¤©åº­"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    messageData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">set</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"name2"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createDataItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ç”¨æˆ·å§“å"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"æµ‹è¯•-ç‰§ç”Ÿ"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    messageData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">set</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"phone_number3"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createDataItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"è”ç³»æ–¹å¼"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"18198086793"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    messageData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">set</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"thing19"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createDataItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"æŠ¥ä¿®åŸå› "</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"æµ‹è¯•æ¶ˆæ¯æ¨é€"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> jsonData </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> messageData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toJSONString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WeChatMsgHelper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">configProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> restTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> openid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> templateId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> jsonData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> messageSender</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å®é™…ä½¿ç”¨">å®é™…ä½¿ç”¨<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E5%AE%9E%E9%99%85%E4%BD%BF%E7%94%A8" class="hash-link" aria-label="å®é™…ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="å®é™…ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å®é™…ä½¿ç”¨éœ€è¦åœ¨ä¸šåŠ¡ä»£ç é€»è¾‘ä¸­è°ƒç”¨ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ•ˆæœé¢„è§ˆ">æ•ˆæœé¢„è§ˆ<a href="https://yuluo-yx.github.io/blog/wechatminiapp-msg-push#%E6%95%88%E6%9E%9C%E9%A2%84%E8%A7%88" class="hash-link" aria-label="æ•ˆæœé¢„è§ˆçš„ç›´æ¥é“¾æ¥" title="æ•ˆæœé¢„è§ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¾®ä¿¡å°ç¨‹åºæ¥æ”¶å¦‚ä¸‹ï¼š</p>
<p><img decoding="async" loading="lazy" alt="å¾®ä¿¡å°ç¨‹åºæ¥æ”¶" src="https://yuluo-yx.github.io/assets/images/img5-8e2d06ef425a4ed6ef4ec7687c0b76c2.png" width="1200" height="2652" class="img_c29J"></p>]]></content>
        <author>
            <name>ç‰§ç”Ÿ</name>
            <email>yuluo08290126@gmail.com</email>
            <uri>https://github.com/yuluo-yx</uri>
        </author>
        <category label="Unipp" term="Unipp"/>
        <category label="å¾®ä¿¡å°ç¨‹åº" term="å¾®ä¿¡å°ç¨‹åº"/>
        <category label="Vue3" term="Vue3"/>
    </entry>
</feed>