<!doctype html>
<html lang="zh-CN" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">深度学习初探 | 牧生</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://yuluo-yx.github.io/blog/deep-learn-init"><meta data-rh="true" property="og:locale" content="zh_CN"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="author" content="牧生"><meta data-rh="true" property="og:title" content="深度学习初探 | 牧生"><meta data-rh="true" name="description" content="尝试理解神经网络的工作原理！旧文新发。"><meta data-rh="true" property="og:description" content="尝试理解神经网络的工作原理！旧文新发。"><meta data-rh="true" name="keywords" content="AI,machine learning"><meta data-rh="true" property="og:image" content="https://yuluo-yx.github.io/img/machine_learning/image-20240323191347399.png"><meta data-rh="true" name="twitter:image" content="https://yuluo-yx.github.io/img/machine_learning/image-20240323191347399.png"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-01-01T15:45:35.000Z"><meta data-rh="true" property="article:author" content="https://github.com/yuluo-yx"><meta data-rh="true" property="article:tag" content="AI,machine learning"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://yuluo-yx.github.io/blog/deep-learn-init"><link data-rh="true" rel="alternate" href="https://yuluo-yx.github.io/blog/deep-learn-init" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://yuluo-yx.github.io/blog/deep-learn-init" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://1FVT9MRV7U-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S4SD5NXWXF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S4SD5NXWXF",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="牧生" href="/opensearch.xml">


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?04599de77e7588461f7822ce2f5dbffc";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<link rel="icon" href="/img/logo.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#12affa">

<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="牧生 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="牧生 Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="牧生 JSON Feed">

<script>!function(){console.log("%c Kz Blog %c https://github.com/kuizuo/blog","color: #fff; margin: 1em 0; padding: 5px 0; background: #12affa;","margin: 1em 0; padding: 5px 0; background: #efefef;");document.firstChild?.nodeType!==Node.COMMENT_NODE&&document.prepend(document.createComment("\nThis Webisite Powered By Yuluo Blog.\nWritten by Docusaurus, Coding with Love.\n--------\nLove what you do and do what you love.\n"))}()</script>
<meta name="description" content="牧生的个人博客">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/misans@4.0.0/lib/Normal/MiSans-Normal.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/misans@4.0.0/lib/Normal/MiSans-Medium.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/misans@4.0.0/lib/Normal/MiSans-Semibold.min.css"><link rel="stylesheet" href="/assets/css/styles.16586c50.css">
<script src="/assets/js/runtime~main.92ca0731.js" defer="defer"></script>
<script src="/assets/js/main.609de2ad.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.png"><link rel="preload" as="image" href="/img/logo-white.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323184129253.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323184311528.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323184422041.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323184635859.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323184805162.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323185042001.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323185330009.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323185807364.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323185917793.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323190054804.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323190459383.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323190600402.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323190857379.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323190950437.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323191034894.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323191347399.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323191619191.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323191828250.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323191930106.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323193708237.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323193835793.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323194153127.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323194928901.png"><link rel="preload" as="image" href="/img/machine_learning/image-20240323195607817.png"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_sQ9c" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_jvwV"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="牧生" class="themedComponent_MVeU themedComponent--light_h7vJ"><img src="/img/logo-white.png" alt="牧生" class="themedComponent_MVeU themedComponent--dark_mUEU"></div></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a><a class="navbar__item navbar__link" href="/friends">友链</a><a class="navbar__item navbar__link" href="/about">关于</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">更多</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/introduction">专栏</a></li><li><a class="dropdown__link" href="/blog/archive">归档</a></li></ul></div><div class="toggle_OSfu colorModeToggle_x44X"><button class="clean-btn toggleButton_XIqj toggleButtonDisabled_aIoK" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_hCIx"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_tq4o"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_dCNk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_JGzc"><div class="margin-vert--md container"><div class="row"><aside class="col col--2"><nav class="sidebar_brwN thin-scrollbar" aria-label="最近博文导航" style="opacity:0"><div class="backButton_MCHS"><span></span></div><a class="sidebarItemTitle_r4Q1 margin-bottom--sm" href="/blog">博文</a><div role="group"><h3>2025</h3><ul class="sidebarItemList_QwSx clean-list"><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/java-and-go-sdk-manager">Java &amp; Go SDK 管理实践</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/google-adk-java-quickstart">Google ADK Java QuickStart</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/gemini-cli-quickstart">Gemini CLI QuickStart</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/spring-ai-alibaba-graph-quickstart">spring ai alibaba graph quickstart</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/gemini-fullstack-langgraph-quickstart">谷歌开源 gemini-fullstack-langgraph-quickstart 体验</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/spring-ai-alibaba-playground">Spring AI Alibaba Playground</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/spring-ai-alibaba-nacos-prompt">Spring AI Alibaba 动态 Prompt 最佳实践</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/opentelemetry-project">Opentelemetry 项目解读</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/spring-ai-alibaba-observations">Spring AI 可观测性</a></li><li class="sidebarItem_lnhn"><a class="sidebarItemLink_yNGZ" href="/blog/mcp">MCP 介绍和基本使用</a></li></ul></div></nav></aside><main class="col col--8" itemscope="" itemtype="http://schema.org/Blog"><article class="relative px-4 pt-4 pb-3 lg:px-4" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://yuluo-yx.github.io/img/machine_learning/image-20240323191347399.png"><div class="z-1 absolute inset-0 h-[224px]"><div class="size-full rounded-[var(--ifm-pagination-nav-border-radius)] bg-cover bg-center bg-no-repeat" style="-webkit-mask-image:linear-gradient(180deg, #fff -17.19%, #00000000 92.43%);mask-image:linear-gradient(180deg, #fff -17.19%, #00000000 92.43%);background-image:url(&quot;/img/machine_learning/image-20240323191347399.png&quot;)"></div></div><div style="height:120px"></div><header style="position:relative;z-index:2"><h1 class="" itemprop="headline">深度学习初探</h1><div class="inline-flex flex-wrap gap-1.5 text-base margin-bottom--md"><div class="inline-flex items-center gap-1"><span></span><time datetime="2025-01-01T15:45:35.000Z" itemprop="datePublished" class="truncate">2025年1月1日</time></div><div class="inline-flex items-center gap-1"><span></span><div class="truncate inline-flex text-center"><div><a class="tag_d0Lz tagRegular_bmnp tag !border-0 p-0.5 text-text hover:text-link" href="/blog/tags/ai">AI</a></div><div>/<a class="tag_d0Lz tagRegular_bmnp tag !border-0 p-0.5 text-text hover:text-link" href="/blog/tags/machine-learning">machine learning</a></div></div></div><div class="inline-flex items-center gap-1"><span></span><span class="truncate">阅读需 28 分钟</span></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody" style="position:relative"><blockquote>
<p>尝试理解神经网络的工作原理！旧文新发。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="分类问题引入">分类问题引入<a href="#分类问题引入" class="hash-link" aria-label="分类问题引入的直接链接" title="分类问题引入的直接链接">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="少维度分类">少维度分类<a href="#少维度分类" class="hash-link" aria-label="少维度分类的直接链接" title="少维度分类的直接链接">​</a></h3>
<p>如下图是一个北京和长治的房价对比图：</p>
<p><img decoding="async" loading="lazy" alt="image-20240304220239621" src="/assets/images/image-20240304220239621-5e1e405788d201d58d87b79128d883c3.png" width="712" height="445" class="img_c29J"></p>
<p>如上使用表格的形式表示，可能不是很直观。换成如下的坐标系就能很清楚的看出来区别：</p>
<p><img decoding="async" loading="lazy" alt="image-20240304221939557" src="/assets/images/image-20240304221939557-0546a4abfa3459685a0d63ccc3df75d0.png" width="746" height="456" class="img_c29J"></p>
<p>图中标注一条黄色的数据线，可以看出，黄线左边的属于北京，右边的属于长治。</p>
<p>我们可以将问题进一步分析，使其变得更简单：在日常生活中，根据我们的经验知道，决定房子价格的因素其实是</p>
<p>价格/面积 = 平方价</p>
<p><img decoding="async" loading="lazy" alt="image-20240304222249022" src="/assets/images/image-20240304222249022-49f1cac89ef2439566837be197137ef6.png" width="513" height="327" class="img_c29J"></p>
<p>高者属于北京，低的则是长治。为此，我们可以找到一个阈值，将其进行划分。</p>
<blockquote>
<p><strong>上述就是最简单的分类问题，只有价格和面积两个维度。</strong></p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="多维度分类">多维度分类<a href="#多维度分类" class="hash-link" aria-label="多维度分类的直接链接" title="多维度分类的直接链接">​</a></h3>
<p>在现实生活中，判断房子值不值得购买。不可能只有 <strong>房价 &amp; 面积</strong> 两个因素，可能还有 <strong>楼层、通勤、年限、环境</strong> 等其他因素。问题的本质还是一样的，最终我们都是根据对这些数据进行分析，判断值不值得购买。</p>
<p><img decoding="async" loading="lazy" alt="image-20240304222937185" src="/assets/images/image-20240304222937185-abc1ea7b28555a9cac28fc3abc6a2cae.png" width="822" height="371" class="img_c29J"></p>
<blockquote>
<p>这个阈值怎么寻找，用什么样的方式去判定。或者说这个函数是什么样子？</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="推导数学结论">推导数学结论<a href="#推导数学结论" class="hash-link" aria-label="推导数学结论的直接链接" title="推导数学结论的直接链接">​</a></h4>
<p>这里，我们设 房价 = x，面积 = y：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">设 房价 为 x，面积 为 y。 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">则有</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> x / y = 平米价</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>设将北京和长治区分开的阈值为 <code>0.69</code> ，则 <code>x/y &gt; 0.69</code> 就是北京，反之则是长治。</p>
<p>接下来我们将公式变形，即可得到函数 f 的函数表达式</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x,y) = x - 0.69y = 0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>从公式我们可以看出，这时候的阈值变成了 <code>0</code>，大于  <code>0</code> 表示北京，小于表示长治。这里只考虑了房价和面积两个因素。更现实的情况是：因为其他因素的参与，阈值可能不会恰好等于 <code>0</code>，可能是 <code>101</code>。这里我们就可以加入一个<code>偏移量</code> 对阈值进行校准。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x,y) = x - 0.69y - 101 = 0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240304224032237" src="/assets/images/image-20240304224032237-f9bb0c331970f2415a5f03a1ace0ecdc.png" width="702" height="288" class="img_c29J"></p>
<p>此时，我们观察这个函数表达式：</p>
<p>如果 y 的取值增加了 100，函数值势必发生变化。但是只要同时对 x 的值做出修正，就可以抵消函数值发生的变化，即</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x,y) = x - 0.69y - 101 = 0 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     [+69]  \quad   [+100]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此时，在函数 f 中，x 的 +69 和 y 的 -100 在数学关系上等价。但是在物理意义上，x 代表的是房价，y 代表的是面积。<code>单位/量纲</code> 不同，无法进行公度。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x,y) = x - 0.69y - 101 = 0 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     [+69]  \quad   [+100]  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    (万元)   \quad   (米^2)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在当前的函数中，他们是可以进行换算的，因为他们都对函数 f 的取值做出了贡献。换算的方式来自于对函数值贡献的大小。即：</p>
<p><img decoding="async" loading="lazy" alt="image-20240304225027111" src="/assets/images/image-20240304225027111-cd61692b7f065f4c2ff6c7fd46025ead.png" width="769" height="357" class="img_c29J"></p>
<p>从中可以看出，x 和 y 对函数值的贡献正好是 x 和 y 的系数。</p>
<p>回头看将才数据维度很多的情况：</p>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">设 数据维度依次为 x_1, x_2, x_3.....  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">则 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(x_1, x_2, x_3, x_4...) = x_1 + x_2 + x_3 + x_4 + b  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">根据上述对 x 和 y 的推导，我们可以将其变成：</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1 + w_2x_2 + w_3x_3 + w_4x_4 + ... + b = y</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中函数值 y 就是房子是否值得购买的依据。</p>
<p>根据上面我们的推导，这样的函数是有意义的：</p>
<p><img decoding="async" loading="lazy" alt="image-20240304225603259" src="/assets/images/image-20240304225603259-0ba9370619be3bbf542c83d4304424cf.png" width="918" height="417" class="img_c29J"></p>
<p>w 的系数为对函数值的贡献程序，b 为阈值的偏移量。</p>
<blockquote>
<p>规范数学表达为：w -&gt; 权重系数、b -&gt; 偏置系数。</p>
</blockquote>
<p>在坐标系中表达为：（为了画图方便，回到二维系数表达）</p>
<p><img decoding="async" loading="lazy" alt="image-20240304225807953" src="/assets/images/image-20240304225807953-e801a31958f74a5e71d81ca9a9cb725c.png" width="649" height="454" class="img_c29J"></p>
<p>前面讨论的阈值即为下图中的分界线：</p>
<p><img decoding="async" loading="lazy" alt="image-20240304225842374" src="/assets/images/image-20240304225842374-349d5fc3bebd7f4a089e2eab6ceabb6f.png" width="644" height="441" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="加入参数升维">加入参数升维<a href="#加入参数升维" class="hash-link" aria-label="加入参数升维的直接链接" title="加入参数升维的直接链接">​</a></h4>
<p>根据数学原理，不同的阈值即代表了不同的分界线。当这条直接确定下来之后，对数据的划分也随之确定。将不同的系数带入变量 x 和 y 就可以得到不同的结果。</p>
<p>如果我们引入更多的维度系数，对坐标系升维。则：</p>
<p><img decoding="async" loading="lazy" alt="image-20240304230033743" src="/assets/images/image-20240304230033743-e95173d10fe573938e797f24378d51ce.png" width="705" height="459" class="img_c29J"></p>
<p>在更高维度中，经常使用向量和矩阵的表达形式：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1 + w_2x_2 + w_3x_3 + w_4x_4 + \cdots + b  \\ \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">将其转化为向量和矩阵的表达式为：\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1 &amp; w_2 &amp; w_3 &amp; w_4 &amp; \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1 \\ x_2 \\ x_3 \\ s_4 \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+b \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">代表行向量和列向量逐项相乘，再相加 \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">为了让表达形式更加紧凑，通常对行向量进行转置，再进行点积运算：\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1 \\ w_2 \\ w_3 \\ w_4 \\ \cdots </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1 \\ x_2 \\ x_3 \\ s_4 \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+b \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">通常向量和矩阵，通常使用大写字母来表示，即：\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(X) = W^\mathrm T · X + b \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">另外一种表达形式是将偏置系数同样写进到矩阵中： \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1 \\ w_2 \\ w_3 \\ w_4 \\ \cdots \\ b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1 \\ x_2 \\ x_3 \\ s_4 \\ \cdots \\ 1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right] \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">函数表达式为：\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f(X) = W^\mathrm T · X</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在前面的讨论中，确定了数据的阈值（分界线之后）。下一步行为在 <code>机器学习</code> 中称为 <strong>决策/预测</strong>。对于一个新输入的数据，通过 x 和 y 在坐标系中的位置来判断处于分界线哪一边。在程序中，并不能直接去看图像。而是要将参数值代入到函数中，计算出函数值，和 0 比较，进行判断。</p>
<blockquote>
<p>到这一步，机器学习的问题变得相对简单，而机器学习的难点是在于如何确定一条最好的分界线，即确定阈值。这个过程叫做<strong>训练/学习</strong>。和动规，贪心等算法不同的是，**机器学习只需要在刚开始时对大量复杂的数据进行计算，确定出来关系。在面对新数据时，只需要进行简单的运算就可以达成目标。**那么，机器学习并没有减少算法的复杂度，相比之下而言，只是提高的 决策/训练 的应用效能。</p>
<p>所以接下来，我们将了解如何去<code>训练和学习</code>。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="训练--学习">训练 &amp; 学习<a href="#训练--学习" class="hash-link" aria-label="训练 &amp; 学习的直接链接" title="训练 &amp; 学习的直接链接">​</a></h2>
<blockquote>
<p>训练/学习 的目的很明确，即在坐标系中确定这条分界线！同样，机器学习的难点也在这里。</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="image-20240305195959121" src="/assets/images/image-20240305195959121-31050473ba9a2ac39dee30955c8a978d.png" width="474" height="381" class="img_c29J"></p>
<p><img decoding="async" loading="lazy" alt="image-20240305195942932" src="/assets/images/image-20240305195942932-bc93e500768674a2f8ca414b08cf48dc.png" width="478" height="394" class="img_c29J"></p>
<p>如图，上述两条直线，都能对现有数据进行完美划分。但是哪条直线是最优解？往往现实情况并不是这样，而是下图所示：</p>
<p><img decoding="async" loading="lazy" alt="image-20240305200117035" src="/assets/images/image-20240305200117035-3d5e8d0d3f3fbee403315cab38a83fe9.png" width="471" height="329" class="img_c29J"></p>
<p>即不存在这样的最优解，可以将数据进行完美划分。只能从现有的直线中，挑选一条符合大多数情况，能将大多数数据区分开的直线。</p>
<p>那么如何确定这条直线是不是符合现有的预期？对此，**就需要有一个判断分界线好坏的判断标准。**在面对不同的数据集时，挑选出的直线可能不同，如上图所示。随着越来越多的数据，直线也会随之变化。<strong>注意：机器学习的目的是预测，而不是训练。<strong>在当前的数据集范围中，只能做到当前情况分界线最好，并不能保证对新来的数据也是最好。这也是选择<code>判断标准</code>最困难的地方。当我们选择了一个判断标准之后，标准之中就包含了我们对未来数据的一种预测。这个预测无法在数学逻辑上找到答案，所以要想解决这个问题，就必须要引入</strong>额外的公设</strong>。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="引入额外公设">引入额外公设<a href="#引入额外公设" class="hash-link" aria-label="引入额外公设的直接链接" title="引入额外公设的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="image-20240305201027218" src="/assets/images/image-20240305201027218-dd9b869349c72af6ae9ebdcd459c0047.png" width="464" height="341" class="img_c29J"></p>
<p>从图中看，每个点到分界线的距离大小不一，所有这些点中，对分界线最小的哪一个，我们可以把它看作是分界线对数据划分的间隔：</p>
<p><img decoding="async" loading="lazy" alt="image-20240305201149190" src="/assets/images/image-20240305201149190-35ae322fdc4c0f7826c2689d1ba2ce19.png" width="490" height="325" class="img_c29J"></p>
<p>通过已有的直觉判断，应该是分界线到点的距离越大越好。其中的间隔可以容纳更多的点。</p>
<p><img decoding="async" loading="lazy" alt="image-20240305201251937" src="/assets/images/image-20240305201251937-aed71ce3db691191e3a6986355ef020d.png" width="474" height="334" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="公设条件-1">公设条件 1<a href="#公设条件-1" class="hash-link" aria-label="公设条件 1的直接链接" title="公设条件 1的直接链接">​</a></h4>
<p>因此，我们可以提出这样一个公设：<strong>间隔越大越好</strong></p>
<p>那么，这里的间隔如何计算，我们需要将其交给计算机去判断，所以我们需要找到间隔计算的表达式：</p>
<ol>
<li>
<p>我们需要知道点到直线的距离 ，表达式为（带入 x 和 y 无法直接得到点到直线的距离，需要做一些修饰）：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{1}{\|W\|_2} \|f(X)\| \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\|W\|_2 \text{（权重系数的 } L_2 \text{ 范数）这里的 } L_2 \text{ 范数可以理解为 勾股定理在更高维度上的扩展，即} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\|W\|_2 = \sqrt{w_1^2 + w_2^2 + w_3^2 + w_4^2 + \cdots} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\text{对向量里的每个分量进行平方再开方。}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>对上述的每个点进行 1 的运算，即可得到所有点到直线的间隔（用 M(W) 来表示直线间隔函数）：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">M(W)=\underset {i=1,2,3 \cdots N}{min}\frac{1}{\begin{Vmatrix}W\end{Vmatrix}}_2\begin{vmatrix}f(X^{(i)})\end{vmatrix} \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>将所有数据带入上述公式，在不考虑机器算力的情况下，计算机就可以完成这些计算。</p>
</li>
</ol>
<p>进行上述操作之后，我们就能得到的结果。这一切的前提是我们对 <code>f(x)</code> 这样的函数值进行了上述修饰。既然这里是公设，那么它就不唯一。这里还可以有第二种公设。同样，我们能偶利用的只有函数值，仍然对其进行修饰，得出前提假设。</p>
<p>这次的修饰是对其进行 <code>sigmoid(f(x))</code> 操作：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmod(f(x)) \in (0,1)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>通过 <code>sigmoid 操作</code>，可以将函数值缩放到 <code>0 ~ 1</code> 之间。<code>sigmoid</code>函数图像如下：</p>
<p><img decoding="async" loading="lazy" alt="image-20240305203942962" src="/assets/images/image-20240305203942962-9cbd533eafcb78995737d39ea72708fd.png" width="440" height="315" class="img_c29J"></p>
<p>定义域为全体实数，值域为 <code>0 - 1</code> 的开区间。<code>0 - 1</code> 的开区间，很容易让我们想到概率，那么我们是否可以把经过修饰后的函数值看作是一个概率值呢？</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="公设条件-2">公设条件 2<a href="#公设条件-2" class="hash-link" aria-label="公设条件 2的直接链接" title="公设条件 2的直接链接">​</a></h4>
<p>我们将函数值看作是如下的条件概率：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">P(X = X^{(i)} \mid W)=sigmod(f(x^{(i)}))</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个概率的意义就代表了某一个数据在北京还是长治的可能性。</p>
<p><img decoding="async" loading="lazy" alt="image-20240307140828845" src="/assets/images/image-20240307140828845-7295ff071ef7f67f590911d8c1a9af6f.png" width="476" height="313" class="img_c29J"></p>
<p>在当前的数据情况下，北京的函数值大于 0 ，长治的函数值小于 0 。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">北京：P(X = X^{(i)} \mid W)=sigmod(f(x^{(i)}))  \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">长治：P(X = X^{(i)} \mid W)=sigmod(-f(x^{(i)}))  \\ 长治的函数值小于 0 ，所以要对函数值取附属再进行 sigmoid 操作。 \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">概率值越大就表明属于 “北京/长治” 的可能性越大，反之则越小。</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>基于当前的理解，我们就可以提出新的公设条件（第二种公设）：</p>
<p><strong>概率（似然）值最大最好</strong></p>
<p>概率值最大，就应该是所有点的概念都最大，他们是相乘的关系。即我们需要找的就是当</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\underset{W} {max} \prod_{i=0}^N P(X = X^{i}\mid {W})· \prod_{j = 0}^M P(X = X^{(i)} \mid {W})</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>表达式取值最大时，系数 W 的值。上述表达式最常见的形式是：使用 <code>log</code> 运算符将连乘变为连加。</p>
<p>第三种公设：现在我们可以假想出一个如下的函数 <code>T(X)</code> ，它可以对数据进行完美分类。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">T(X)=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1: X \in {北京} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">0: X \in {长治}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>任何一个数据的输入，都可以完美的判断出它属于北京还是长治。北京的函数值为 1 ，长治的函数值为 0 。图像表示为：</p>
<p><img decoding="async" loading="lazy" alt="image-20240307144321343" src="/assets/images/image-20240307144321343-3a6a76a32ec8ea1ba0b7c5a366520226.png" width="493" height="288" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="公设条件-3">公设条件 3<a href="#公设条件-3" class="hash-link" aria-label="公设条件 3的直接链接" title="公设条件 3的直接链接">​</a></h4>
<p>那么，我们知道，在现实情况中，这种函数一定不存在，总是会有各种各样的误差和噪声对 <code>T(X)</code> 函数产生影响。这里我们用 <strong>ϵ</strong> 表示给函数叠加了一个噪声。它不再变得完美了。函数的输出值依然是会接近 0 和 1。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">T(X)+\epsilon=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1+\epsilon: X \in {北京} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">0+\epsilon: X \in {长治}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个时候 <code>sigmoid</code> 函数就可以派上用场了，我们就可以用它来表示受到噪声干扰后的 <code>T(X)</code> 函数。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">T(X)+\epsilon=sigmoid(f(X))</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>图象如下所示：</p>
<p><img decoding="async" loading="lazy" alt="Image" src="/assets/images/image-20240308170315337-8a0a8e9b391590c2aa90a808dc4505d1.png" width="1100" height="553" class="img_c29J"></p>
<p>这个时候每一个数据得到的 <code>sigmoid</code> 函数值与他们再 T 函数中取值的偏差就是叠加之后的噪声 <strong>ϵ</strong> 。最好的分界线，必然是 <strong>ϵ</strong> 最小的时候对应的分界线。即：<strong>方差最小最好</strong>。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\underset{W}{min}\sum_{i=0}^N(y-\hat{y})^2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">y=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1: X \in {北京} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">0: X \in {长治}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\hat{y}=sigmoid(f(X))</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>第三种公设的表达式为：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\sigma^2=(y-\hat{y})^2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上述提到的三种公设表示为：</p>
<ul>
<li>粉红色：方差最小最好；</li>
<li>橙色：概率最大最好；</li>
<li>绿色：间隔最大最好。</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image-20240308170851932" src="/assets/images/image-20240308170851932-2c7a496c239df5e09d5d9498e6766755.png" width="743" height="400" class="img_c29J"></p>
<p>我们知道，公设不同，得到的结果也不同，到底那种结果最好？</p>
<p>没有理论上的标准答案，还是要看真实问题是什么。</p>
<p>这里的三种公设条件可以表示为：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">公设：\begin{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">修饰公度结果 \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">为公度结果赋予现实意义 \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">用现实意义将一直外推至未知</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{cases}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>所有的公设得到的结果都是对已知现实的总结归纳，是对未知情况的经验总结。</p>
<p>虽然这里写出了判断标准的数学方程，但是求出解析解几乎不可能，困难重重。这里如何选择最合适的算法更快、更好的求出函数表达式的数值解。就是机器学习的另一项重要工作：算法。</p>
<p>虽然算法非常多，但是针对神经网络，提到算法就是在特指 <code>梯度下降法</code>。</p>
<blockquote>
<p>公设的常见叫法是策略。 算法，策略加上模型，就是机器学习的三大要素。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="机器学习中的模型">机器学习中的模型<a href="#机器学习中的模型" class="hash-link" aria-label="机器学习中的模型的直接链接" title="机器学习中的模型的直接链接">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="数据模型分类问题">数据模型分类问题<a href="#数据模型分类问题" class="hash-link" aria-label="数据模型分类问题的直接链接" title="数据模型分类问题的直接链接">​</a></h3>
<p>接下来我们要看的就是模型。模型简单来说就是对<code>数据的分类</code>，为什么要选择直线？如下的数据分类图：</p>
<p><img decoding="async" loading="lazy" alt="image-20240308172044116" src="/assets/images/image-20240308172044116-7dd9f541c4bef28bd700a5c92ebd9380.png" width="1303" height="877" class="img_c29J"></p>
<p>面对这种数据分类的时候，无论直线怎么放置，都会存在问题。但是使用下面的抛物线，就能准确划分数据。</p>
<p><img decoding="async" loading="lazy" alt="image-20240307152553927" src="/assets/images/image-20240307152553927-091900b266ce518033fa09f83a8de052.png" width="504" height="406" class="img_c29J"></p>
<p>抛物线方程如下：<code>可以看到相比直线方程，只多了一个 x1 系数的二次项</code></p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1^2+w_2x_1-x_2+b=0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240307152639893" src="/assets/images/image-20240307152639893-febc29a74875f8e57dd35a369795e1bc.png" width="511" height="422" class="img_c29J"></p>
<p>这里，如果我们再增加 一个 x2 维度的二次项，还可以变化成为椭圆形的分界线。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1^2+w_2x_2^2+w_3x_1+w_4x_2+b=0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>增加 x3 系数的二次项时，会变成双曲线。对数据分类更加准确。</p>
<p><img decoding="async" loading="lazy" alt="image-20240307152700317" src="/assets/images/image-20240307152700317-c4cb880c92106a3ab990b1854823e35a.png" width="490" height="419" class="img_c29J"></p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1^2+w_2x_22+w_3x_1x_2+w_4x_1+w_5x_2+b=0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>前人已经证明过，只要增加更多的高次项，那么不论多么奇怪的分割线都可以表示出来。</p>
<p>随着项数的增加，复杂程度会越来越大。也就是说模型的复杂程度越高。</p>
</blockquote>
<p>为了图形表示方便，暂时这里只针对 x1 维度增加更高次项。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\cdots+w_1x_1^3+w_2x_1^2+w_3x_1+w_4x_2+b=0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>图像表示为：</p>
<p><img decoding="async" loading="lazy" alt="image-20240307153214331" src="/assets/images/image-20240307153214331-9903981554d9986628ef4bd3588daa3a.png" width="533" height="427" class="img_c29J"></p>
<p>用向量点积的形式表示为：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\cdots \\ 0.00 \\ 0.00 \\ -0.20 \\ 0.50 \\ 4.60 \\ -1.00 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\cdots \\ x_1^5 \\ x_1^4 \\ x_1^3 \\ x_1^2 \\ x_1 \\ x_2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right] \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="分类--回归问题">分类 &amp; 回归问题<a href="#分类--回归问题" class="hash-link" aria-label="分类 &amp; 回归问题的直接链接" title="分类 &amp; 回归问题的直接链接">​</a></h3>
<p>机器学习里讨论的模型复杂程度其实就是曲线的复杂程度。虽然我们这里讨论的是分类问题，其实和回归问题在模型上并没有本质的区别。比如上述的曲线，可以是对数据的分类，也可以看作是对这些数据的拟合。</p>
<p><img decoding="async" loading="lazy" alt="image-20240307154955484" src="/assets/images/image-20240307154955484-3c9e681b51a78c4759fc78460fc446e9.png" width="513" height="433" class="img_c29J"></p>
<p>下面我们还是讨论分类问题。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="引入神经网络">引入神经网络<a href="#引入神经网络" class="hash-link" aria-label="引入神经网络的直接链接" title="引入神经网络的直接链接">​</a></h3>
<p>既然直线模型的局限性这么大，我们是不是可以提高模型的复杂程度呢？我们这次讨论的重点——神经网络就是一种提高模型负责程度的方法。</p>
<p>下图就表示一个神经网络：</p>
<p><img decoding="async" loading="lazy" alt="image-20240307155043430" src="/assets/images/image-20240307155043430-4cb12d3025775cd96edface0182bce58.png" width="719" height="528" class="img_c29J"></p>
<p>红色表示输入层，输入层的输出输入到神经网络，其中每一个神经元都和上一层，下一层互相连接。称为全连接神经网络。这里，我们单独拿出一个最简单的结构：</p>
<p><img decoding="async" loading="lazy" alt="image-20240307155217733" src="/assets/images/image-20240307155217733-81867475e10e45e8bc5ea790410286b5.png" width="333" height="393" class="img_c29J"></p>
<p>这里的每一条代表的是对应的权重系数。这个结构，其实就表示为一个线性方程，表达式如下：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1x_1+w_2x_2+w_3x_3+w_4x_4+w_5x_5+w_6x_6+b=z</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240307155302941" src="/assets/images/image-20240307155302941-db84cead51c1a9487fbfef4675fd049b.png" width="615" height="384" class="img_c29J"></p>
<p>经过 <code>sigmoid(f(x))</code> 激活函数计算输出结果到下一层。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="激活函数">激活函数<a href="#激活函数" class="hash-link" aria-label="激活函数的直接链接" title="激活函数的直接链接">​</a></h3>
<p>神经网络对激活函数的选择是有要求的，sigmoid 只是符合要求的函数之一。这个激活的过程不会在神经网络中表示出来，只是在神经元中显示。</p>
<p><img decoding="async" loading="lazy" alt="image-20240308175155446" src="/assets/images/image-20240308175155446-bcf61c43bf25492df064d591b59bd888.png" width="758" height="450" class="img_c29J"></p>
<p>因为后面需要使用坐标系来展示，所以这里只讨论二维情况：</p>
<p><img decoding="async" loading="lazy" alt="image-20240308175254921" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASEAAACFCAIAAACbhdkAAAANXUlEQVR4nO3caYwb530G8OedIbnkXiT35C53V2sdq8uyLFuxZEkWFMeS5SOBHd8JChQokgZFjw8pArSGALdBgQL54Bboh6IuUqdo4qhykwq10USxm9iWnVVcy0dWkqVKWu3Ne8ghl/fM2w9DMlwul5RkOZLi5/dFI+7O7Cx3Hv5n/u87AxARERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERHdeMT13oGbQ+VtktdzL+impFzvHbjJiCWL/ISi5niUXC5R9W9VNZNLv846R7WYsctReZdEuXhJCchyokTVuSRDRjVs13sHblyVwiUACSEB/CZUpQVZ/sZK8IhqMGNNCEgrP9UvmtVfhwCkVdOYMVqOGVuRrD5HrCwIYUopa1+3LtIYMapDvd47cEMTgICwLrcUwARMoBtY29Yy6LTZDZmR0oBUrFp2vfeWbkzseTQiSk0OaZX7IYEHt6x7eNfODcPDqiLnItHjpz4+fOKDCU03hGIApjTNJpukzxzWsUasiy07oADb3a5DT37xa1882NfROr8wp8Vjvu6uvdtu/9zYusDM3Ew8UbR6HvzUoqV4RDQiAAVQgDEHnn3yy/fecfuvJia+++rr7wWjeWCkVX3mnt1P3PeFC+HYoZdefndmrgCYQgCQbDFSGetYEwpgAx67686Hd+18//8ufPuV194MRpNABpgryBMXptw2ZceWjfns4sRCSM8XAEAIIfjhRSWcS9WECXiB20ZGCoX8q8fHL4UiKoRqnUMK6MCxd0/Mz89sXXOLr7PDIYQQwipiVsxuirDdFDt582LGGhECEuh0KF1tLj2VDGRyeQkT0mpsmBI2IBZf1OJ6q92h2Ox5KU0pAUgpZXmhcgQ3PpSFEIpyff4cPLP9VHF8rCHr2DOlYRhCUVRFKOWXZXlBKCgUCh5v9x995ZlTidSlUCgYDAaDwUAgkEqlTPM3w2k1h3Kl4lW+emMf65yQeZWYsSZsQKIoQ8nUretuGevzjs/Np/OmEBKAIiGBVQO+wYHBmXDw2Pj7yfbOjp7e7du3d3d3WxEyTTMcDodCoXg8Pj09PTc3l81mC4VCg0SJ30rXRIiqqV9CKALSvJyp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" width="289" height="133" class="img_c29J"></p>
<p>其用向量表示为：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1\\x_2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1\\w_2 </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+[b]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">= [z]\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(z)=a</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>表达式的输入输出在坐标系中显示为如下图的一个曲面：对应的分界线就是 x1 和 x2 平面上的红色直线。</p>
<p><img decoding="async" loading="lazy" alt="image-20240307160444347" src="/assets/images/image-20240307160444347-986456b001ed1860dfa1c7855f1ae9f6.png" width="647" height="319" class="img_c29J"></p>
<p>如果不存在激活函数，就只是一个面，如图：</p>
<p><img decoding="async" loading="lazy" alt="image-20240307160520189" src="/assets/images/image-20240307160520189-a87b7f2e60582a0dc76744497df4ef8e.png" width="614" height="338" class="img_c29J"></p>
<p>再加入一个神经元时，表示如下：</p>
<p><img decoding="async" loading="lazy" alt="image-20240308175501778" src="data:image/png;base64,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" width="275" height="134" class="img_c29J"></p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1^{[0]}\\x_2^{[0]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1^{[1]}\\w_2^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+[b^{[1]}]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">= [z^{[1]}]\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(z^{[1]}=a^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里用中括号中的上标数字表示是神经元的第几层。</p>
<blockquote>
<p>输入层对应的是 0 层。第一层的输出结果会作为第二层的输入。</p>
</blockquote>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[a^{1}]^\mathrm T·[w_1^{[2]}]+[b^{[2]}]=[z^{[2]}] \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(z^{[2]}) = a^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>增加一层神经元之后，图像并不会有多大的变化，仍然是下面这种曲面：</p>
<p><img decoding="async" loading="lazy" alt="image-20240307161032336" src="/assets/images/image-20240307161032336-f9ebeb574a56b3f65124fd37c75674e0.png" width="600" height="333" class="img_c29J"></p>
<p>接下来就会发生变化，我们在多加一个神经元之后，</p>
<p><img decoding="async" loading="lazy" alt="image-20240322185329932" src="/assets/images/image-20240322185329932-17111048118771-9513531d862724ddc869b9e61b5c7aa5.png" width="353" height="160" class="img_c29J"></p>
<p>每个神经元都有 <code>W1, W2 和 b</code> 一组系数。这时候 W 就不再是向量，而是矩阵。不过仍然是进行线性运算。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1^{[0]}\\x_2^{[0]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.1}^{[1]} \quad w_{2.1}^{[1]}  \\w_{1.2}^{[1]} \quad w_{2.2}^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+[b_1^{[1]} \quad b_2^{[1]}]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">= [ \quad z_2^{[1]}]\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">转置之后：\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1^{[0]}\\x_2^{[0]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.1}^{[1]} \quad w_{2.1}^{[1]}  \\w_{1.2}^{[1]} \quad w_{2.2}^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[b_1^{[1]} \\ b_2^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[z_1^{[1]}] \\ z_2^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">激活函数也变成使用向量表示的形式：</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(Z^{[1]}) = A^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>这里表示每一项，每一个分量都要经过 <code>sigmoid</code> 计算。</p>
</blockquote>
<p>第二层的输入也会相应变成两个：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">a_1^{[1]}\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">a_2^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1^{[2]} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_2^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">b^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">z^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right] \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sigmoid(Z^{[2]}) = a^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此时的图像会变的更加多样：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190244078" src="/assets/images/image-20240322190244078-e0af0c8a230cd9b309fd5ac97793a1cc.png" width="824" height="481" class="img_c29J"></p>
<p>尤其是分界线，已经不止是一条直线了，而是发生了弯曲。</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190340302" src="/assets/images/image-20240322190340302-27047e855d391eae0154c401b0327fbb.png" width="833" height="522" class="img_c29J"></p>
<p>如果我们继续增加神经元，增加到四个：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190431511" src="/assets/images/image-20240322190431511-a96cde186bd6e76357335819cb6b4a97.png" width="435" height="146" class="img_c29J"></p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x_1^{[0]}\\x_2^{[0]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.1}^{[1]} \quad w_{2.1}^{[1]} \quad w_{3.1}^{[1]} \quad w_{4.1}^{[1]}  \\w_{1.2}^{[1]} \quad w_{2.2}^{[1]} \quad w_{3.2}^{[1]} \quad w_{4.2}^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[b_1^{[1]} \\ b_2^{[1]} \\ [b_3^{[1]} \\ b_4^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[z_1^{[1]}] \\ z_2^{[1]} \\ [z_3^{[1]}] \\ z_4^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">a_1^{[1]}\\a_2^{[1]}\\a_3^{[1]}\\a_4^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]^\mathrm T</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1^{[2]} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_2^{[2]} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_3^{[2]} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_4^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">+</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">b^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">=</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">z^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right] \\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此时图形变化为：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190509691" src="/assets/images/image-20240322190509691-0b039e5b98f213ddc02a329aa888d643.png" width="813" height="592" class="img_c29J"></p>
<p>无论是输出结果的曲面，还是分界线，他们的复杂程度大大增加：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322190536513" src="/assets/images/image-20240322190536513-6933971fa9c15ce7d12a11ca10cdad7e.png" width="840" height="560" class="img_c29J"></p>
<p>至此，我们持续增加神经元，图形的复杂程度会越来越高。</p>
<p>数据家也证明了，只要增加的神经元足够多，任何一种复杂的曲线都能够被无限的接近表达出来，即万能逼近定理（通用近似定理）。</p>
<p>神经网络要想实现万能逼近，其中有一个关键是<code>激活函数</code>。必须是非线性的，如果没有激活函数，再多的神经元也不会增加模型的复杂性。模型的图像只会是一个超平面。常用的激活函数如下：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322193525270" src="/assets/images/image-20240322193525270-13f5e1e013149bd3ce48c3c0ea6fb83a.png" width="869" height="643" class="img_c29J"></p>
<p>也可以是：<code>sin(x) sinc(x) Gaussion(x)</code> 。不同的激活函数对应的图形是非常不同的。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="激活函数深入">激活函数深入<a href="#激活函数深入" class="hash-link" aria-label="激活函数深入的直接链接" title="激活函数深入的直接链接">​</a></h2>
<p>为什么增加更多的神经元会有更强的能力，从另一个角度进行解释。</p>
<p>将前面神经网络部分看作为一个黑盒，不论输入的数据是什么样子，最终输出到最后一个神经元只是一个计算结果。假设他有 10 维。如图：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322193938404" src="/assets/images/image-20240322193938404-3bab29078b67439b444ab52fc82a39d3.png" width="567" height="451" class="img_c29J"></p>
<p>数据从2维到10维。其中的关键是数据的输入进行了一个矩阵运算，矩阵对一个向量进行操作。将其变为另外一个向量：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322194200931" src="/assets/images/image-20240322194200931-b3b6c937fb62d2d15a9d11254513a678.png" width="1045" height="448" class="img_c29J"></p>
<p>例如如下的向量：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1\\1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240322194307256" src="/assets/images/image-20240322194307256-9142512479a7721eb7e8e93a8b848d29.png" width="923" height="562" class="img_c29J"></p>
<p>进行如下的运算：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1\\1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">cos\theta \quad -sin\theta\\sin\theta \quad cos\theta</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将向量旋转 <code>θ</code> 角度：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322194625846" src="/assets/images/image-20240322194625846-f4aa6003cf357b124c2f42fbc12388b2.png" width="640" height="387" class="img_c29J"></p>
<p>那么这个矩阵的作用就是使向量发生旋转。</p>
<p>那么如下的矩阵，完全可以起到对向量进行升维的作用：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1\\1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.1} \quad w_{2.1} \quad w_{3.1} \\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_{1.2} \quad w_{2.2} \quad w_{3.2} </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20240322194922199" src="/assets/images/image-20240322194922199-351451e02a2e2d62d6e3d24cb6150c52.png" width="489" height="385" class="img_c29J"></p>
<p>如果数据只是二维的，它们互相参杂在一起，很难直接用直线对数据进行划分：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195040705" src="/assets/images/image-20240322195040705-8031b65cf1879bcb50859a09f4e05cde.png" width="503" height="380" class="img_c29J"></p>
<p>如果对它们进行升维：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195114768" src="/assets/images/image-20240322195114768-c04692051efa0f766a0f0efe534a8713.png" width="476" height="375" class="img_c29J"></p>
<p>用跟简单的模型也可以将他们分开：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195132104" src="/assets/images/image-20240322195132104-04d452a68f0aba0bc99250d7ec0d22da.png" width="550" height="393" class="img_c29J"></p>
<p>因此，我们可以把神经元中中间的操作看作是数据升维的操作：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195221569" src="/assets/images/image-20240322195221569-09bd100acfeb8de947860754a8f165ea.png" width="423" height="275" class="img_c29J"></p>
<p>有多少神经元，就会把数据升到多少维。只要维度够高，一定会找到一个超平面，能对数据完成划分。</p>
<p>这样就变成了我们之前讨论的 <code>f(x)</code> 问题：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195351911" src="/assets/images/image-20240322195351911-5aa536d178dfdaa1518f37d5abbcaaff.png" width="920" height="479" class="img_c29J"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="多分类问题">多分类问题<a href="#多分类问题" class="hash-link" aria-label="多分类问题的直接链接" title="多分类问题的直接链接">​</a></h3>
<p>一个神经网络并不是只能有一个输出节点，处理二分类问题。也可以有多个节点，进行多分类问题的讨论：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322195656661" src="/assets/images/image-20240322195656661-210ebe930ed96272546dada9f2600cd2.png" width="740" height="441" class="img_c29J"></p>
<p>其实质也是在每一个输出节点上进行二分类判断，将各个节点综合起来，就可以去解决多分类问题。真实的场景中，并不像是上述描述的粗糙，而是通过 <code>softMax(Y)</code>函数进行统一描述。函数表达式如下：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">softMax(\hat{Y}) = \frac{e^{\hat{y_i}}}{\sum_{j=1}^4e^{\hat{y_j}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>就是对 <code>singmoid(x)</code> 函数的扩展和升级。</p>
<p>完整的神经网络如下：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322200530988" src="/assets/images/image-20240322200530988-c99920a5d01a4fd11e8ce59f89789873.png" width="673" height="508" class="img_c29J"></p>
<p>这里的隐藏层暂时理解为对数据进行升维操作。不过更常见的神经网络应该是如下的表示：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322200647520" src="/assets/images/image-20240322200647520-1f775003d4f504a045ab93e39bd9a150.png" width="872" height="455" class="img_c29J"></p>
<p>基于如上的神经网络，继续使用隐藏层就是对数据升维的看法，就会出现问题，从左到右，神经元的个数在递减。我们仍然回归到简单问题：</p>
<p>神经网络的输入输出可以是：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322200840361" src="/assets/images/image-20240322200840361-f8eaa858eb3d0120ac5f9ec597d02b9f.png" width="515" height="378" class="img_c29J"></p>
<p>基于上述神经网络很难有新的发现，我们只需要将问题换成下述这样，就会有新的发现：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322201001608" src="/assets/images/image-20240322201001608-7dcd40745203d1360d96d3081d8f7a1b.png" width="480" height="417" class="img_c29J"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="案例分析----判断面部表情--ocr">案例分析  - 判断面部表情 &amp; OCR<a href="#案例分析----判断面部表情--ocr" class="hash-link" aria-label="案例分析  - 判断面部表情 &amp; OCR的直接链接" title="案例分析  - 判断面部表情 &amp; OCR的直接链接">​</a></h3>
<p>上述的数据维度完全可以看作是判断一个人心情的特征。在现实生活中，可没有这么清晰的输入数据去让模型进行判断。而在现实生活中存在可能是这样的一张原始图片：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322201056290" src="/assets/images/image-20240322201056290-8ba9f049a5b8e3a2dfd03e143bc0c97a.png" width="265" height="332" class="img_c29J"></p>
<p>图片上的每一个像素都是数据的一个维度：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322201249208" src="/assets/images/image-20240322201249208-715fa0856b41d3218072f56f2376dec2.png" width="718" height="492" class="img_c29J"></p>
<p>这时候在加入隐藏层：</p>
<p><img decoding="async" loading="lazy" alt="image-20240322201311835" src="/assets/images/image-20240322201311835-500a45e7e4248c45183d46bd1b94654a.png" width="857" height="476" class="img_c29J"></p>
<p>就可以理解成人类面部表情的特征。</p>
<p>为什么这里反而降维了呢？这是因为这里的一个特征，并不需要原始数据里的所有维度。例如眼睛的动作，我们完全可以只关注眼镜的像素点。</p>
<p>这里隐藏层就可以理解成对上一层原始数据的抽象。</p>
<p>如果只是到此程度的话，还是不能有效的解释为什么神经网络需要这么多层。这时候如果我们换个问题继续理解，就会明白。</p>
<p>比如我们需要使用神经网络去判断手写的数字：</p>
<img src="/img/machine_learning/image-20240323184129253.png" alt="image-20240323184129253" style="zoom:67%;">
<p>比如数字 8 ，神经网络很可能会将 8 上下两部分的特征提取出来作为判断的依据。如图：</p>
<img src="/img/machine_learning/image-20240323184311528.png" alt="image-20240323184311528" style="zoom:67%;">
<p>这里将其放在第二个隐藏层的原因是，两个圆可能还有其自己的子特征：</p>
<img src="/img/machine_learning/image-20240323184422041.png" alt="image-20240323184422041" style="zoom:67%;">
<p>他们都由四部分圆弧组成。这样做的好处是在遇到同样的特征时可以复用，比如数字 6 ，下半部分也是一个圆圈的结构，下面的特征就可以和 8 进行复用。</p>
<img src="/img/machine_learning/image-20240323184635859.png" alt="image-20240323184635859" style="zoom:67%;">
<p>上半部分的一竖才是数字 6 独有的特征。</p>
<p>对应的数字 5 ，下半部分是半个圆弧，同样也可以进行复用，不同的特征只有上面的 一横 这一部分。</p>
<img src="/img/machine_learning/image-20240323184805162.png" alt="image-20240323184805162" style="zoom:67%;">
<p>对神经网络的层数可以理解为：隐藏层越深，对数据的抽象程度越高。</p>
<blockquote>
<p>这里只是用了我们人能理解的特征进行描述，神经网络自己学习到的特征，可能人无法理解，但是预测结果同样十分准确。</p>
</blockquote>
<p>上述的就是对一个完整的神经网络的描述。</p>
<img src="/img/machine_learning/image-20240323185042001.png" alt="image-20240323185042001" style="zoom:67%;">
<blockquote>
<p>模型  -&gt; 隐藏层</p>
<p>策略 -&gt; 输出层</p>
<p>其实在输入层也需要对数据进行预处理。随着算力需求越来越大，如何对数据进行预处理使其得到最佳结果。也是一个非常重要的问题。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="算法---梯度下降算法">算法 - 梯度下降算法<a href="#算法---梯度下降算法" class="hash-link" aria-label="算法 - 梯度下降算法的直接链接" title="算法 - 梯度下降算法的直接链接">​</a></h2>
<p>在神经网络中，这个算法没有别的，就是反向传播（梯度下降）算法。</p>
<img src="/img/machine_learning/image-20240323185330009.png" alt="image-20240323185330009" style="zoom:67%;">
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="算法推导">算法推导<a href="#算法推导" class="hash-link" aria-label="算法推导的直接链接" title="算法推导的直接链接">​</a></h3>
<p>一个神经网络我们完全看作是一个这样的函数：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_w(X) = \hat{Y}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>只不过这个函数相当复杂而已。如果神经网络已经训练成功，在进行判断和决策的时候，他们的输入就是 X 系数 W 是作为参数。这个过程称之为正向传播。但是，如果一个神经网络正在被训练，他们之间的关系就会变得相关。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_X(W) = \hat{Y}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>x 作为已知的参数，系数作为变量，是需要求解的。因此，函数的图像也会发生相应的变化。如图为一个正向传播的函数图像：</p>
<img src="/img/machine_learning/image-20240323185807364.png" alt="image-20240323185807364" style="zoom:80%;">
<p>如果将系数 W 看作变量的话，坐标不再是 x1 和  x2 而是 w1 和 w2。</p>
<img src="/img/machine_learning/image-20240323185917793.png" alt="image-20240323185917793" style="zoom:80%;">
<p>上图为一个简化处理，这里我们假设不知道神经网络的具体情况，只是将 所有的系数看成是一个向量。后面我们会修正图像。这里的最高点就是我们在选择策略后希望出现的结果。</p>
<img src="/img/machine_learning/image-20240323190054804.png" alt="image-20240323190054804" style="zoom:50%;">
<p>我们这里的结果不是求出 Y 的值，而是求出令 Y 最大时 W 的取值。</p>
<p>这个 W 的取值就是最高点在系数平面上的投影：</p>
<img src="/img/machine_learning/image-20240323190459383.png" alt="image-20240323190459383" style="zoom:50%;">
<p>不过，我们在初始化一个神经网络的时候，系数 W 可能出现在任何一个位置，理想情况下，他到最优点的距离就是我们求解的目标：</p>
<img src="/img/machine_learning/image-20240323190600402.png" alt="image-20240323190600402" style="zoom:50%;">
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_x(W^*) = \hat{Y_*} </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">W - W^* = \Delta W</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>但是在实际场景，上述 W 的值很难直接计算出来。如果利用如下的方式，我们就可以求出：</p>
<p>在曲面上的任意一点：都可以求出一个向量：</p>
<img src="/img/machine_learning/image-20240323190857379.png" alt="image-20240323190857379" style="zoom:50%;">
<p>这个向量总是指向上升最快的方向：</p>
<img src="/img/machine_learning/image-20240323190950437.png" alt="image-20240323190950437" style="zoom:50%;">
<p>那么这个向量在参数平面上的<code>投影</code>就叫做 <code>梯度</code>。</p>
<img src="/img/machine_learning/image-20240323191034894.png" alt="image-20240323191034894" style="zoom:50%;">
<p>梯度总是指向上升最快的方向，那么为何称为梯度下降法呢？在选择策略的时候，有的策略是求最大，有的是求最小。为了将其统一看待，即便是求最大的问题，我们也可以在其上加上负号使其变成求最小的问题。</p>
<img src="/img/machine_learning/image-20240323191347399.png" alt="image-20240323191347399" style="zoom:50%;">
<p>不过虽然的这里曲面反了，但是梯度仍然是指向上升最快的方向。所以在具体操作的时候，会对梯度先求反，这样梯度就会指向下降最快的方向。这就是这个算法  <code>梯度下降法</code>的由来，不过其本质仍然相同。</p>
<img src="/img/machine_learning/image-20240323191619191.png" alt="image-20240323191619191" style="zoom:50%;">
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="梯度下降法在模型中的应用">梯度下降法在模型中的应用<a href="#梯度下降法在模型中的应用" class="hash-link" aria-label="梯度下降法在模型中的应用的直接链接" title="梯度下降法在模型中的应用的直接链接">​</a></h3>
<p>梯度总是指向上升最快的方向，即总是和等高线垂直。梯度本身是一个向量，所以就代表了他在所有参数维度上都有分量。</p>
<img src="/img/machine_learning/image-20240323191828250.png" alt="image-20240323191828250" style="zoom:50%;">
<p>如果所有的参数都按照梯度的分量进行调整，这样就代表参数 W 做出了当前情况下最好的选择。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1\\w_2 \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\pm</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\Delta{w_1}\\\Delta{w_2} \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>一次次慢慢移动，总会接近其级值点。</p>
<img src="/img/machine_learning/image-20240323191930106.png" alt="image-20240323191930106" style="zoom:50%;">
<p>即便在这样的场景下，仍然存在问题，梯度只是指向了上升最快的方向，而没有指出其上升时每一步的步长。</p>
<p>步长在梯度下降法中通常用 η 来表示，也就是通常所说的学习率了。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1\\w_2 \\ \cdots \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\pm</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\eta ·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\Delta{w_1}\\\Delta{w_2} \\ \cdots \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>它是一个超参数，不能由神经网络学习得到，需要手动进行配置。</p>
<blockquote>
<p>η 过大就会很快接近极值点，但是会造成反复横跳，无法收敛的结果。</p>
<p>η 过小，整体路径最优，移动相同次数，移动距离会比较短。</p>
<p>现在已经有了很多梯度下降的进阶方案。</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="算法实践">算法实践<a href="#算法实践" class="hash-link" aria-label="算法实践的直接链接" title="算法实践的直接链接">​</a></h3>
<p>现在我们已经理解了其思路，如何求出梯度？就是如何求出分量的具体值。如果非常笼统的看待：求梯度的答案为对函数求偏导。每一个变量的维度都要求偏导。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">w_1\\w_2 \\ \cdots \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\pm</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\eta ·</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f}}{\partial{w_1}}\\\frac{\partial{f}}{\partial{w_2}}\\ \cdots \\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上述中的梯度也可以用 ∇f 表示，读作 nablaf。</p>
<p>接下来的问题是具体如何求出偏导。如果我们把神经网络整体看作是一个黑盒。</p>
<img src="/img/machine_learning/image-20240323193708237.png" alt="image-20240323193708237" style="zoom:50%;">
<blockquote>
<p>输入层是 X 不同的系数 W 对应不同的 Y 值。w 全部在黑盒中。</p>
</blockquote>
<p>所谓的梯度下降便是：将计算出来的梯度反向传播到神经网络中，让所有的 W 进行修改。</p>
<img src="/img/machine_learning/image-20240323193835793.png" alt="image-20240323193835793" style="zoom:50%;">
<p>对于神经网络麻烦的一点是：不同的 W 之间是存在依赖关系的，不是单独存在。这个依赖关系就是神经网络的结构图。因此要想计算出每个系数对应梯度的分量还需要将黑盒拆开才行。那么，这个黑盒里面到底是什么？</p>
<p>其本质就是如下图中的三行表达式：</p>
<img src="/img/machine_learning/image-20240323194153127.png" alt="image-20240323194153127" style="zoom:50%;">
<p>这里的表达式都是在进行向量计算，所以为了后面的表达方便，将其使用下面的形式表示：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ReLU(X·W^{[1]}) = A^{[1]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_k^{[1]}(W^{[k]}_1) = a^{[1]}_k</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ReLU(A^{[1]}·W^{[2]}) = A^{[2]}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_j^{[2]}(A^{1},W^{[2]}_j) = a^{[2]}_j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">softmax(A^{2},W^{[3]})</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">f_i^{[3]}(A^{2},W^{[3]}_i) = a^{[3]}_i</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中 i,j,k 分别对应这一层不同的神经元。</p>
<p>我们先来分析最下面这一个表达式：它表示的是某一个节点上要完成的计算。</p>
<img src="/img/machine_learning/image-20240323194928901.png" alt="image-20240323194928901" style="zoom:50%;">
<p>它的梯度等于：对所有变量的维度求偏导。</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\nabla{f_i^{3}} = </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\left[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\begin{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f^{[3]}_i}}{\partial{w^{[3]}_{i,1}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f^{[3]}_i}}{\partial{w^{[3]}_{i,2}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\ \cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f^{[3]}_i}}{\partial{a^{[3]}_{1}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\frac{\partial{f^{[3]}_i}}{\partial{a^{[3]}_{2}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\\</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\cdots</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\end{matrix}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">\right]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里同时也要对 A 求偏导，因为 A 也是一个当前节点的输入数据，关系如下：</p>
<img src="/img/machine_learning/image-20240323195607817.png" alt="image-20240323195607817" style="zoom:50%;">
<p>我们在考虑之前一个神经元的参数求导时，需要结合前面一层神经元的影响，即 J 层的 a 系数的偏导表达式为：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">W_j^{[2]} \pm \eta^2·\frac{\partial{f_j^{[2]}}}{\partial{W_j^{[2]}}}\sum_{i=1}^4\frac{\partial{f_i^{[3]}}}{\partial{f_j^{[2]}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>K 层的偏导系数的表达式为：</p>
<div class="language-latex codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-latex codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">W_k^{[1]} \pm \eta^3\sum_{j=1}^7\sum_{i=1}^4\frac{\partial{f_k^{[1]}}}{\partial{W_k^{[1]}}}\frac{\partial{f_j^{[2]}}}{\partial{f_k^{[1]}}}\frac{\partial{f_i^{[3]}}}{\partial{f_j^{[2]}}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果反向传播的次数越多，那么学习率的次数就越高。我们知道学习率往往是小于 1 的，那么经过次方运算之后再和梯度相乘，就不会对参数做出多少调整，这也是我们经常说的梯度消失问题。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2>
<p>到这里为止，就描述完了神经网络里的模型，算法和策略。</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_Wr5y"></footer></article><div class="margin-bottom--md"><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link border-2 border-link hover:bg-[#a1d8f71b] pagination-nav__link--prev" href="/blog/2024-year-summary"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">2024 年终总结</div></a><a class="pagination-nav__link border-2 border-link hover:bg-[#a1d8f71b] pagination-nav__link--next" href="/blog/write-somethings"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">随笔 2024/11/24</div></a></nav></div><div>Loading Comments...</div><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_tR6u" type="button"></button></main><div class="col col--2 px-0.5"><div class="tableOfContents_jeP5 thin-scrollbar" style="opacity:0.0001;transform:translateX(100px)"><ul class="table-of-contents pl-0"><li><a href="#分类问题引入" class="table-of-contents__link toc-highlight">分类问题引入</a><ul><li><a href="#少维度分类" class="table-of-contents__link toc-highlight">少维度分类</a></li><li><a href="#多维度分类" class="table-of-contents__link toc-highlight">多维度分类</a><ul><li><a href="#推导数学结论" class="table-of-contents__link toc-highlight">推导数学结论</a></li><li><a href="#加入参数升维" class="table-of-contents__link toc-highlight">加入参数升维</a></li></ul></li></ul></li><li><a href="#训练--学习" class="table-of-contents__link toc-highlight">训练 &amp; 学习</a><ul><li><a href="#引入额外公设" class="table-of-contents__link toc-highlight">引入额外公设</a><ul><li><a href="#公设条件-1" class="table-of-contents__link toc-highlight">公设条件 1</a></li><li><a href="#公设条件-2" class="table-of-contents__link toc-highlight">公设条件 2</a></li><li><a href="#公设条件-3" class="table-of-contents__link toc-highlight">公设条件 3</a></li></ul></li></ul></li><li><a href="#机器学习中的模型" class="table-of-contents__link toc-highlight">机器学习中的模型</a><ul><li><a href="#数据模型分类问题" class="table-of-contents__link toc-highlight">数据模型分类问题</a></li><li><a href="#分类--回归问题" class="table-of-contents__link toc-highlight">分类 &amp; 回归问题</a></li><li><a href="#引入神经网络" class="table-of-contents__link toc-highlight">引入神经网络</a></li><li><a href="#激活函数" class="table-of-contents__link toc-highlight">激活函数</a></li></ul></li><li><a href="#激活函数深入" class="table-of-contents__link toc-highlight">激活函数深入</a><ul><li><a href="#多分类问题" class="table-of-contents__link toc-highlight">多分类问题</a></li><li><a href="#案例分析----判断面部表情--ocr" class="table-of-contents__link toc-highlight">案例分析  - 判断面部表情 &amp; OCR</a></li></ul></li><li><a href="#算法---梯度下降算法" class="table-of-contents__link toc-highlight">算法 - 梯度下降算法</a><ul><li><a href="#算法推导" class="table-of-contents__link toc-highlight">算法推导</a></li><li><a href="#梯度下降法在模型中的应用" class="table-of-contents__link toc-highlight">梯度下降法在模型中的应用</a></li><li><a href="#算法实践" class="table-of-contents__link toc-highlight">算法实践</a></li></ul></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul><hr class="hr_UhE0"><span class="percent_H6RK">0%<!-- --> </span></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">学习</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">博客</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/archive">归档</a></li></ul></div><div class="col footer__col"><div class="footer__title">有用的东西</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/yuluo-yx/use" target="_blank" rel="noopener noreferrer" class="footer__link-item">use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_INRw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/deigmata-paideias/deigmata-paideias" target="_blank" rel="noopener noreferrer" class="footer__link-item">deigmata_paideias<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_INRw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/friends">友链</a></li><li class="footer__item">
                <a href="https://docusaurus.io" target="_blank" rel="noreferrer noopener">
                  <img src="/img/buildwith.png" alt="build with docusaurus" width="120" height="50">
                </a>
                </li></ul></div><div class="col footer__col"><div class="footer__title">社交媒体</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about">关于我</a></li><li class="footer__item"><a href="https://github.com/yuluo-yx" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_INRw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/yuluo_yx" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_INRw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.csdn.net/qq_52397471" target="_blank" rel="noopener noreferrer" class="footer__link-item">CSDN<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_INRw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <p style="margin-bottom: 0;"><a href="http://beian.miit.gov.cn/">Everything Wins 🎉</a></p>
        <p style="display: inline-flex; align-items: center;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=undefined">----------------------------------------------</a></p>
        <p>Copyright © 2020 - 2025 牧生. | Built with Docusaurus.</p>
        </div></div></div></footer></div>
</body>
</html>