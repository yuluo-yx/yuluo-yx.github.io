<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>ç‰§ç”Ÿ</title>
        <link>https://yuluo-yx.github.io/blog</link>
        <description>feedId:41215011978385457+userId:41840354283324416</description>
        <lastBuildDate>Wed, 24 Dec 2025 23:34:54 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-CN</language>
        <copyright>Copyright Â© 2025 ç‰§ç”Ÿ Built with Docusaurus.&lt;p&gt;Everything Wins ğŸ‰&lt;/p&gt;.</copyright>
        <item>
            <title><![CDATA[Github è´¦å·æƒŠé­‚]]></title>
            <link>https://yuluo-yx.github.io/blog/github-account</link>
            <guid>https://yuluo-yx.github.io/blog/github-account</guid>
            <pubDate>Wed, 24 Dec 2025 23:34:54 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯ç»è¿‡]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="èƒŒæ™¯ç»è¿‡">èƒŒæ™¯ç»è¿‡<a href="https://yuluo-yx.github.io/blog/github-account#%E8%83%8C%E6%99%AF%E7%BB%8F%E8%BF%87" class="hash-link" aria-label="èƒŒæ™¯ç»è¿‡çš„ç›´æ¥é“¾æ¥" title="èƒŒæ™¯ç»è¿‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>alibaba/spring-ai-alibaba é¡¹ç›®ç»å¸¸æ”¶åˆ°åƒåœ¾ issue æ”»å‡»ï¼Œä¼šè¢«ä¸æ˜èº«ä»½çš„ Github è´¦å·åˆ›å»ºå¤§é‡åƒåœ¾ issueï¼Œåƒä¸‹é¢è¿™æ ·ï¼š</p>
<p><img decoding="async" loading="lazy" alt="Github spam issue" src="https://yuluo-yx.github.io/assets/images/image-24edc298a585141bd88d9df77d71f5ef.png" width="680" height="334" class="img_c29J"></p>
<p>åˆšå¼€å§‹çš„å‰æ®µæ—¶é—´ï¼Œç”¨ ai å†™äº†ä¸€ä¸ª Github actionï¼Œæ ¹æ® spam issue çš„ç‰¹å¾æ¥å…³é—­ issueã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œspam issue ä¸è§äº†ï¼Œäºæ˜¯åˆ é™¤äº† GHAã€‚</p>
<p>å¥½æ™¯ä¸é•¿ï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œåˆå‡ºç°äº†ï¼Œäºæ˜¯æˆ‘åœ¨æœ¬åœ°ç”¨ Github api + ä¹‹å‰ ai å†™çš„ python è„šæœ¬æ‰‹åŠ¨å…³é—­ issueã€‚è¿™æ ·æŒç»­äº†ä¸¤ä¸‰å¤©ã€‚</p>
<p>......</p>
<p>åœ¨ 1219 æ™šæ‰§è¡Œå®Œ python è„šæœ¬ä¹‹åï¼ˆé¢‘ç‡è¾ƒé«˜ï¼Œå·®ä¸å¤š 10 åˆ†é’Ÿ 100 æ¬¡å·¦å³ï¼‰ï¼Œåœ¨ 1220 ä¸­åˆæˆ‘å‘ç° Github è´¦å·è¢«å°ç¦äº†ã€‚emmmï½</p>
<p>éšå³å¼€å§‹ç½‘ä¸Šæ‰¾å¸–å­çœ‹ç›¸å…³é—®é¢˜ï¼Œæœ€ååæ€äº†å‰ä¸€å¤©æ™šä¸Šçš„è¡Œä¸ºï¼Œæœ€åå¾—å‡ºç»“è®ºæ˜¯ API è°ƒå¤ªé¢‘ç¹äº†ï¼Œè¢« Github çš„é£æ§ç³»ç»Ÿè‡ªåŠ¨å°å·äº†ã€‚åœ¨ 20 å·æ™šå¼€å§‹ç”³è¯‰ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç”³è¯‰ç»è¿‡">ç”³è¯‰ç»è¿‡<a href="https://yuluo-yx.github.io/blog/github-account#%E7%94%B3%E8%AF%89%E7%BB%8F%E8%BF%87" class="hash-link" aria-label="ç”³è¯‰ç»è¿‡çš„ç›´æ¥é“¾æ¥" title="ç”³è¯‰ç»è¿‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å…ˆæ˜¯åœ¨ <a href="https://support.github.com/contact-next" target="_blank" rel="noopener noreferrer">https://support.github.com/contact-next</a> ä¸Šç”¨é‚®ç®±éªŒè¯ï¼ŒéªŒè¯å®Œæˆä¹‹åï¼Œè¿˜è¦æ‰‹æœºå·éªŒè¯ï¼Ÿï¼Ÿï¼Ÿ</p>
<p><img decoding="async" loading="lazy" alt="Github spam issue" src="https://yuluo-yx.github.io/assets/images/image2-b9f51d9b6401f995a3f2c2234cf5fbf4.png" width="1278" height="736" class="img_c29J"></p>
<p>sms-active æ¥ç å¹³å°é€‰ Any Service å¼€å§‹æ¥ç ï¼Œè€æ˜¯å‡ºç°ä¸Šé¢çš„é—®é¢˜ï¼Œæ¢ IP å’Œæ¢åœ°åŒºï¼Œæ‰¾åˆ«äººè¯•éƒ½ä¸è¡Œã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p>æœ€ååœ¨ saa ç¤¾åŒºåŒå­¦çš„å¸®åŠ©ä¸‹ï¼Œå‘ç°åªè¦é‚®ç®±éªŒè¯äº†ï¼Œä¸ç”¨çŸ­ä¿¡éªŒè¯ä¹Ÿå¯ä»¥ï¼Ÿ</p>
<p>ç‚¹å‡»ä¸‹é¢çš„åœ°å€å°±å¥½äº†ï¼š<a href="https://support.github.com/contact-next/product-selection/account-restrictions" target="_blank" rel="noopener noreferrer">https://support.github.com/contact-next/product-selection/account-restrictions</a></p>
<p>ä¸€ç‚¹ï¼Œæœç„¶æ˜¯ã€‚ğŸ¥²</p>
<p>ç„¶åç»„ç»‡è¯­è¨€æäº†å·¥å•ï¼š</p>
<p>ç­‰äº†ä¸¤å¤©ä¹‹åï¼Œæ”¶åˆ°äº†å›ä¿¡ï¼š</p>
<p><img decoding="async" loading="lazy" alt="Github spam issue" src="https://yuluo-yx.github.io/assets/images/image3-402adbad1753e36b352ae70bce3947b1.png" width="1146" height="325" class="img_c29J"></p>
<p>éšåè´¦å·é¡ºåˆ©è§£å°ï¼å‰åå†æ—¶ 4 å¤©ã€‚</p>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>Github</category>
        </item>
        <item>
            <title><![CDATA[Could not initialize class é—®é¢˜æ’æŸ¥]]></title>
            <link>https://yuluo-yx.github.io/blog/class-not-init</link>
            <guid>https://yuluo-yx.github.io/blog/class-not-init</guid>
            <pubDate>Wed, 24 Dec 2025 23:34:54 GMT</pubDate>
            <description><![CDATA[èƒŒæ™¯å’Œé—®é¢˜è¡¨ç°]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="èƒŒæ™¯å’Œé—®é¢˜è¡¨ç°">èƒŒæ™¯å’Œé—®é¢˜è¡¨ç°<a href="https://yuluo-yx.github.io/blog/class-not-init#%E8%83%8C%E6%99%AF%E5%92%8C%E9%97%AE%E9%A2%98%E8%A1%A8%E7%8E%B0" class="hash-link" aria-label="èƒŒæ™¯å’Œé—®é¢˜è¡¨ç°çš„ç›´æ¥é“¾æ¥" title="èƒŒæ™¯å’Œé—®é¢˜è¡¨ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å…¬å¸é¡¹ç›®åœ¨æ•°æ®é¢„å¤„ç†æ—¶ä½¿ç”¨ seatunnelï¼Œåœ¨ init å®¹å™¨ä¸­å¯¼å…¥å’Œå¯¼å‡ºæ•°æ®ã€‚åœ¨ A æœºå™¨æ—¶ï¼Œseatunnel æ­£å¸¸å¯åŠ¨ï¼Œinit å®¹å™¨æ‰§è¡ŒæˆåŠŸï¼Œåœ¨ B æœºå™¨ä¸Šå¤±è´¥ã€‚</p>
<p>ç»å¸¸å‡ºç°ï¼š<code>java.lang.NoClassDefFoundError: Could not initialize class org.apache.hadoop.util.StringInterner</code></p>
<p>å¶å°”å‡ºç°ï¼š<code>Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.thirdparty.com.google.common.collect.Interners</code></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ’æŸ¥">æ’æŸ¥<a href="https://yuluo-yx.github.io/blog/class-not-init#%E6%8E%92%E6%9F%A5" class="hash-link" aria-label="æ’æŸ¥çš„ç›´æ¥é“¾æ¥" title="æ’æŸ¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å…ˆä»ç¬¬ä¸€ä¸ªé—®é¢˜å…¥æ‰‹ï¼š<code>java.lang.NoClassDefFoundError: Could not initialize class org.apache.hadoop.util.StringInterner</code>ã€‚</p>
<p>çœ‹ä¸‹æŠ¥é”™ç±»åœ¨å“ªä¸ª jarï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-rcl</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'org.apache.hadoop.util.StringInterner'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">seatunnel/lib/hadoop-common-3.3.6.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">seatunnel/lib/seatunnel-hadoop3-3.1.4-uber.jar</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç”¨åå°„åœ¨åŒ…è£…ä¹‹åçš„ seatunnel å®¹å™¨é‡Œå°è¯•åŠ è½½ç±»ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">vi</span><span class="token plain"> TestStringInterner.java</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class TestStringInterner </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static void main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        try </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            // å°è¯•åŠ è½½ StringInterner ç±»</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            Class.forName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"org.apache.hadoop.util.StringInterner"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"StringInterner loaded successfully"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> catch </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ClassNotFoundException e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Failed to load StringInterner: "</span><span class="token plain"> + e.getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">))</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># javac ç¼–è¯‘ï¼Œåç»­æ‰§è¡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">javac TestStringInterner.java</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">é¦–å…ˆåœ¨ A ä¸Šæµ‹è¯•ï¼š</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å°è¯•åŠ è½½æ‰€æœ‰çš„ä¾èµ– jar ==== æˆåŠŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-verbose:class</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-XX:+TraceClassLoading</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-cp</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">".:lib/*"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     TestStringInterner</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ä½¿ç”¨ä¸Šé¢æœåˆ°çš„ä¸¤ä¸ª jar åŠ è½½ ==== å¤±è´¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-verbose:class</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-XX:+TraceClassLoading</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-cp</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">".:lib/hadoop-common-3.3.6.jar:lib/seatunnel-hadoop3-3.1.4-uber.jar"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     TestStringInterner</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>å¤±è´¥å¹¶æŠ¥é”™å’Œä¹‹å‰é‡åˆ°çš„å¶å‘æŠ¥é”™ç›¸åŒï¼š</p>
<p><code>é—®é¢˜ï¼šCaused by: java.lang.ClassNotFoundException: org.apache.hadoop.thirdparty.com.google.common.collect.Interners</code></p>
<p>éšå³çœ‹ä¸‹ Github é‡Œ hadoop ä»£ç ï¼š<a href="https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/StringInterner.java" target="_blank" rel="noopener noreferrer">https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/StringInterner.java</a> ç”¨åˆ°äº† Interners ä¸”æ˜¯ä¸ªé™æ€æ–¹æ³•ã€‚</p>
</blockquote>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># å°è¯•æ¢ä¸ªä½ç½®åŠ è½½ ==== æˆåŠŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-verbose:class</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-XX:+TraceClassLoading</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-cp</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">".:lib/seatunnel-hadoop3-3.1.4-uber.jar:lib/hadoop-common-3.3.6.jar"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     TestStringInterner</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ä¸ºä»€ä¹ˆæ¢ä¸ªä½ç½®å°±æ‰§è¡ŒæˆåŠŸï¼Ÿseatunnel-hadoop3-3.1.4-uber æœ‰ guavaï¼Œhadoop-common æ²¡æœ‰ï¼Ÿ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bash-4.4</span><span class="token comment" style="color:hsl(230, 4%, 64%)"># jar tvf lib/seatunnel-hadoop3-3.1.4-uber.jar | grep -i guava</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> Thu Oct </span><span class="token number" style="color:hsl(35, 99%, 36%)">18</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">14</span><span class="token plain">:17:14 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">2018</span><span class="token plain"> META-INF/maven/com.google.guava/</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> Thu Oct </span><span class="token number" style="color:hsl(35, 99%, 36%)">18</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">14</span><span class="token plain">:17:14 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">2018</span><span class="token plain"> META-INF/maven/com.google.guava/guava/</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token number" style="color:hsl(35, 99%, 36%)">133</span><span class="token plain"> Thu Oct </span><span class="token number" style="color:hsl(35, 99%, 36%)">18</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">14</span><span class="token plain">:17:14 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">2018</span><span class="token plain"> META-INF/maven/com.google.guava/guava/pom.properties</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">8118</span><span class="token plain"> Thu Oct </span><span class="token number" style="color:hsl(35, 99%, 36%)">18</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">14</span><span class="token plain">:07:06 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">2018</span><span class="token plain"> META-INF/maven/com.google.guava/guava/pom.xml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> Tue Jan 01 03:00:00 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">1980</span><span class="token plain"> META-INF/maven/com.google.guava/failureaccess/</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">1671</span><span class="token plain"> Tue Jan 01 03:00:00 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">1980</span><span class="token plain"> META-INF/maven/com.google.guava/failureaccess/pom.xml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token number" style="color:hsl(35, 99%, 36%)">93</span><span class="token plain"> Tue Sep </span><span class="token number" style="color:hsl(35, 99%, 36%)">11</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">15</span><span class="token plain">:39:26 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">2018</span><span class="token plain"> META-INF/maven/com.google.guava/failureaccess/pom.properties</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> Tue Jan 01 03:00:00 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">1980</span><span class="token plain"> META-INF/maven/com.google.guava/listenablefuture/</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">2278</span><span class="token plain"> Tue Jan 01 03:00:00 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">1980</span><span class="token plain"> META-INF/maven/com.google.guava/listenablefuture/pom.xml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token number" style="color:hsl(35, 99%, 36%)">134</span><span class="token plain"> Tue Sep </span><span class="token number" style="color:hsl(35, 99%, 36%)">11</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">15</span><span class="token plain">:40:36 CST </span><span class="token number" style="color:hsl(35, 99%, 36%)">2018</span><span class="token plain"> META-INF/maven/com.google.guava/listenablefuture/pom.properties</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bash-4.4</span><span class="token comment" style="color:hsl(230, 4%, 64%)"># jar tvf lib/hadoop-common-3.3.6.jar | grep -i guava</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bash-4.4</span><span class="token comment" style="color:hsl(230, 4%, 64%)">#</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>æœç„¶æ˜¯ï¼Œseatunnel-hadoop3-3.1.4-uber æœ‰ guavaï¼Œè€Œ hadoop-common é‡Œçš„ static æ–¹æ³•åœ¨ç±»åŠ è½½æ—¶å°±å¼€å§‹åŠ è½½äº†ã€‚</p>
<p>å½“å…ˆæœ‰ hadoop-common åŠ è½½æ—¶å°±ä¼šå‡ºç°ç±»æ‰¾ä¸åˆ°å¼‚å¸¸ï¼Œè¿›è€Œå¯¼è‡´ StringInterners ç±»åˆå§‹åŒ–å¤±è´¥ã€‚</p>
</blockquote>
<p>æ€€ç–‘æ˜¯ç±»åŠ è½½æœºåˆ¶é—®é¢˜ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">seatunnel å¯åŠ¨å‘½ä»¤ï¼šä½¿ç”¨ </span><span class="token function" style="color:hsl(221, 87%, 60%)">cp</span><span class="token plain"> åŠ è½½ä¾èµ– jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token variable" style="color:hsl(221, 87%, 60%)">`</span><span class="token variable function" style="color:hsl(221, 87%, 60%)">java</span><span class="token variable" style="color:hsl(221, 87%, 60%)"> </span><span class="token variable parameter variable" style="color:hsl(221, 87%, 60%)">-Dcfg</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token variable" style="color:hsl(221, 87%, 60%)">cfg </span><span class="token variable parameter variable" style="color:hsl(221, 87%, 60%)">-cp</span><span class="token variable" style="color:hsl(221, 87%, 60%)"> /path/*</span><span class="token variable" style="color:hsl(221, 87%, 60%)">`</span><span class="token plain">, ä¸€é˜µ google + å¤§æ¨¡å‹ï¼Œå‘ç°å¹¶ä¸æ˜¯ï¼Œå’Œä¸Šé¢ä¸åŒé¡ºåºçš„ jar åŠ è½½é—®é¢˜å¯¹æ¯”ï¼Œ</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">å‘ç° * é‡Œçš„æ–‡ä»¶é¡ºåºæ˜¯æœ€ç»ˆé—®é¢˜åŸå› ï¼š</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>éšå³çœ‹ä¸‹æ˜¯ä¸æ˜¯æ–‡ä»¶ç³»ç»Ÿå¯¹ * é€šé…é‡Œçš„æ–‡ä»¶é¡ºåºé—®é¢˜ï¼Ÿseatunnel-hadoop3-3.1.4-uber/hadoop-commoné¡ºåºåäº†ï¼Ÿ</p>
</blockquote>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bash-4.4</span><span class="token comment" style="color:hsl(230, 4%, 64%)"># df -T .</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Filesystem     Type     1K-blocks      Used  Available Use% Mounted on</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">overlay        overlay </span><span class="token number" style="color:hsl(35, 99%, 36%)">2256141992</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">261706012</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1994435980</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">% /</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å› ä¸ºåœ¨ docker å®¹å™¨ä¸­ï¼Œdf -T çš„ç»“æœéƒ½æ˜¯ overlayï¼Œéœ€è¦é€€å‡ºæŸ¥çœ‹å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># A</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Filesystem     Type  1K-blocks       Used Available Use% Mounted on</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/dev/nvme0n1p1 ext4 </span><span class="token number" style="color:hsl(35, 99%, 36%)">1967874324</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1702433868</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">165404192</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">92</span><span class="token plain">% /home</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># B</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">base</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">root@g1055 ~</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token comment" style="color:hsl(230, 4%, 64%)"># df -T .</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æ–‡ä»¶ç³»ç»Ÿ              ç±»å‹      1K-å—      å·²ç”¨       å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/dev/mapper/klas-root xfs  </span><span class="token number" style="color:hsl(35, 99%, 36%)">2256141992</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">237719688</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2018422304</span><span class="token plain">   </span><span class="token number" style="color:hsl(35, 99%, 36%)">11</span><span class="token plain">% /</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">google å¾—åˆ°çš„ç»“æœæ˜¯ï¼šext4 åœ¨æ’åºæ—¶ä½¿ç”¨ inode </span><span class="token function" style="color:hsl(221, 87%, 60%)">id</span><span class="token plain"> æ’åºï¼Œè€Œ xfs é»˜è®¤å°±æ˜¯ç”¨ inode </span><span class="token function" style="color:hsl(221, 87%, 60%)">id</span><span class="token plain"> æ¥æ’åºï¼Œåœ¨æ–‡ä»¶å¤¹æœ‰å¾ˆå¤§å†…å®¹æ—¶ï¼Œæ’åºç­–ç•¥ä¼šæœ‰æ‰€è°ƒæ•´ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> ä¸å¯¹ç»“æœæ’åºï¼Œåªæ˜¾ç¤ºä¸€äº›ç®€å•ä¿¡æ¯ </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-i</span><span class="token plain"> æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿçš„ inode </span><span class="token function" style="color:hsl(221, 87%, 60%)">id</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># A</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bash-4.4</span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ls -fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773982</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><span class="token plain">			      </span><span class="token number" style="color:hsl(35, 99%, 36%)">88773986</span><span class="token plain"> postgresql-42.7.8.jar		 </span><span class="token number" style="color:hsl(35, 99%, 36%)">88773984</span><span class="token plain"> hadoop-common-3.3.6.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773983</span><span class="token plain"> DmJdbcDriver8.jar	      </span><span class="token number" style="color:hsl(35, 99%, 36%)">88773985</span><span class="token plain"> mysql-connector-j-8.0.33.jar	 </span><span class="token number" style="color:hsl(35, 99%, 36%)">88773930</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773989</span><span class="token plain"> seatunnel-transforms-v2.jar  </span><span class="token number" style="color:hsl(35, 99%, 36%)">88773987</span><span class="token plain"> seatunnel-hadoop3-3.1.4-uber.jar  </span><span class="token number" style="color:hsl(35, 99%, 36%)">88773988</span><span class="token plain"> seatunnel-hadoop-aws.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å®Œå…¨ä¹±åºï¼Œæ²¡æœ‰è§„åˆ™ï¼Œä½¿ç”¨ -l æ’åºçœ‹çœ‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bash-4.4</span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ls -li</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">total </span><span class="token number" style="color:hsl(35, 99%, 36%)">201196</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773983</span><span class="token plain"> -rw-rw-r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">1653596</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token plain">:43 DmJdbcDriver8.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773984</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">4603101</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 hadoop-common-3.3.6.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773985</span><span class="token plain"> -rw-rw-r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">2481560</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 mysql-connector-j-8.0.33.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773986</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">1116727</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 postgresql-42.7.8.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773987</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">43209805</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 seatunnel-hadoop3-3.1.4-uber.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773988</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">86818044</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 seatunnel-hadoop-aws.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">88773989</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">66131549</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 seatunnel-transforms-v2.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># inode æ’åº</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># B xfs</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bash-4.4</span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ls -fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526065</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><span class="token plain">		    </span><span class="token number" style="color:hsl(35, 99%, 36%)">30526067</span><span class="token plain"> hadoop-common-3.3.6.jar	   </span><span class="token number" style="color:hsl(35, 99%, 36%)">30526070</span><span class="token plain"> seatunnel-hadoop-aws.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526044</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">..</span><span class="token plain">		    </span><span class="token number" style="color:hsl(35, 99%, 36%)">30526068</span><span class="token plain"> mysql-connector-j-8.0.33.jar  </span><span class="token number" style="color:hsl(35, 99%, 36%)">30526071</span><span class="token plain"> seatunnel-hadoop3-3.1.4-uber.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526066</span><span class="token plain"> DmJdbcDriver8.jar  </span><span class="token number" style="color:hsl(35, 99%, 36%)">30526069</span><span class="token plain"> postgresql-42.7.8.jar	   </span><span class="token number" style="color:hsl(35, 99%, 36%)">30526072</span><span class="token plain"> seatunnel-transforms-v2.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># xfs å³ä½¿åœ¨ç”¨äº† -f å‚æ•°ä¹Ÿæ˜¯æœ‰åºçš„ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bash-4.4</span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ls -li</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">total </span><span class="token number" style="color:hsl(35, 99%, 36%)">201196</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526066</span><span class="token plain"> -rw-rw-r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">1653596</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token plain">:43 DmJdbcDriver8.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526067</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">4603101</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 hadoop-common-3.3.6.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526068</span><span class="token plain"> -rw-rw-r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">2481560</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 mysql-connector-j-8.0.33.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526069</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">1116727</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 postgresql-42.7.8.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526071</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">43209805</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 seatunnel-hadoop3-3.1.4-uber.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526070</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">86818044</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 seatunnel-hadoop-aws.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">30526072</span><span class="token plain"> -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">66131549</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">12</span><span class="token plain">æœˆ  </span><span class="token number" style="color:hsl(35, 99%, 36%)">9</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17</span><span class="token plain">:51 seatunnel-transforms-v2.jar</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åˆ°æ­¤å°±èƒ½è§£é‡Šé€šäº†ï¼Œxfs æ–‡ä»¶ç³»ç»Ÿæ°¸è¿œæ˜¯ hadoop-common åœ¨å‰åŠ è½½ï¼Œæ²¡æœ‰ guava ä¾èµ–ã€‚å¯¼è‡´å¤±è´¥äº†ã€‚
java ç±»åŠ è½½å™¨å¯¹æ–‡ä»¶ç³»ç»Ÿç»™çš„ç»“æœç›´æ¥åŠ è½½ï¼Œå¹¶æ²¡æœ‰ä»»ä½•å¤„ç†ã€‚</p>
<p>éšå³æ¥çœ‹ä¸‹ java -cp åŠ è½½ jar ä¾èµ–çš„çš„åº•å±‚æœºåˆ¶ï¼šå¤§æ¨¡å‹å›ç­”æ˜¯è°ƒç”¨ java File api, å†™ä¸ªä¾‹å­éªŒè¯ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">vi</span><span class="token plain"> ClassPathResolver.java</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">import</span><span class="token plain"> java.io.File</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">import</span><span class="token plain"> java.net.URL</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">import</span><span class="token plain"> java.util.ArrayList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">import</span><span class="token plain"> java.util.List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class ClassPathResolver </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static List</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> resolveClassPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">String path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> classPaths </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> new ArrayList</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        // å¤„ç†é€šé…ç¬¦è·¯å¾„</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">path.endsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/*"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">))</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            String dirPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> path.substring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, path.length</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> - </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            File </span><span class="token function" style="color:hsl(221, 87%, 60%)">dir</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> new File</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dirPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dir.exists</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> dir.isDirectory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">))</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                File</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> files </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> dir.listFiles</span><span class="token variable punctuation" style="color:hsl(119, 34%, 47%)">((</span><span class="token variable" style="color:hsl(221, 87%, 60%)">d</span><span class="token variable punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token variable" style="color:hsl(221, 87%, 60%)"> name</span><span class="token variable punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token variable" style="color:hsl(221, 87%, 60%)"> </span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token variable" style="color:hsl(221, 87%, 60%)"> name.toLowerCase</span><span class="token variable punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token variable punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token variable" style="color:hsl(221, 87%, 60%)">.endsWith</span><span class="token variable punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token variable" style="color:hsl(221, 87%, 60%)">".jar"</span><span class="token variable punctuation" style="color:hsl(119, 34%, 47%)">))</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">files </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">File </span><span class="token function" style="color:hsl(221, 87%, 60%)">file</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">:</span><span class="token plain"> files</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        classPaths.add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">file.getAbsolutePath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">))</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            // å¤„ç†æ™®é€šè·¯å¾„</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            classPaths.add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">return</span><span class="token plain"> classPaths</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static void main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        // æµ‹è¯•ä»£ç </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        String path </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"lib/*"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> paths </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> resolveClassPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        System.out.println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"æ‰¾åˆ°çš„JARæ–‡ä»¶:"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        paths.forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">System.out::println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">javac ClassPathResolver.java </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> ClassPathResolver</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># B xfs è¾“å‡ºï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æ‰¾åˆ°çš„JARæ–‡ä»¶:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/DmJdbcDriver8.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/hadoop-common-3.3.6.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/mysql-connector-j-8.0.33.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/postgresql-42.7.8.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/seatunnel-hadoop-aws.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/seatunnel-hadoop3-3.1.4-uber.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/seatunnel-transforms-v2.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># A ext4 è¾“å‡ºï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æ‰¾åˆ°çš„JARæ–‡ä»¶:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/DmJdbcDriver8.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/seatunnel-transforms-v2.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/postgresql-42.7.8.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/mysql-connector-j-8.0.33.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/seatunnel-hadoop3-3.1.4-uber.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/hadoop-common-3.3.6.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/home/pro/third_party/seatunnel/lib/seatunnel-hadoop-aws.jar</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">listFiles åº•å±‚æ˜¯ç”¨ native æ–¹æ³•ï¼š</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public native String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> list</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">File </span><span class="token function" style="color:hsl(221, 87%, 60%)">file</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è‡³æ­¤ï¼Œé—®é¢˜å·²ç»æ˜ç¡®äº†ï¼Œè§£å†³æ–¹æ¡ˆå°±æ˜¯æ‰‹åŠ¨ä¿®æ”¹ jar é¡ºåºï¼Œè®© seatunnel-hadoop3-3.1.4-uber åœ¨ hadoop-common ä¹‹å‰å³å¯ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é—®é¢˜å‚è€ƒé“¾æ¥">é—®é¢˜å‚è€ƒé“¾æ¥<a href="https://yuluo-yx.github.io/blog/class-not-init#%E9%97%AE%E9%A2%98%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5" class="hash-link" aria-label="é—®é¢˜å‚è€ƒé“¾æ¥çš„ç›´æ¥é“¾æ¥" title="é—®é¢˜å‚è€ƒé“¾æ¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li><a href="https://javaguide.cn/java/jvm/class-loading-process.html" target="_blank" rel="noopener noreferrer">https://javaguide.cn/java/jvm/class-loading-process.html</a></li>
<li><a href="https://oo.sb/blog/file-ordering-between-fs/" target="_blank" rel="noopener noreferrer">https://oo.sb/blog/file-ordering-between-fs/</a></li>
<li><a href="https://cloud.tencent.com.cn/developer/article/1832222?from=15425&amp;frompage=seopage" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com.cn/developer/article/1832222?from=15425&amp;frompage=seopage</a></li>
</ol>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>Java</category>
            <category>ext4</category>
            <category>xfs</category>
        </item>
        <item>
            <title><![CDATA[è¯­ä¹‰æ¨¡å‹]]></title>
            <link>https://yuluo-yx.github.io/blog/semantic-model</link>
            <guid>https://yuluo-yx.github.io/blog/semantic-model</guid>
            <pubDate>Wed, 05 Nov 2025 00:21:00 GMT</pubDate>
            <description><![CDATA[ä¸º Higress Semantic Router Plugin ä½œå‡†å¤‡ã€‚]]></description>
            <content:encoded><![CDATA[<p>ä¸º Higress Semantic Router Plugin ä½œå‡†å¤‡ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="transformers">Transformers<a href="https://yuluo-yx.github.io/blog/semantic-model#transformers" class="hash-link" aria-label="Transformersçš„ç›´æ¥é“¾æ¥" title="Transformersçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Huggingface Transformers æ˜¯åŸºäºä¸€ä¸ªå¼€æºåŸºäº transformer æ¨¡å‹ç»“æ„æä¾›çš„é¢„è®­ç»ƒè¯­è¨€åº“ï¼Œå®ƒæ”¯æŒ Pytorchï¼ŒTensorflow2.0ï¼Œå¹¶ä¸”æ”¯æŒä¸¤ä¸ªæ¡†æ¶çš„ç›¸äº’è½¬æ¢ã€‚</p>
<p>å…¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª Encoder-Decoder æ¶æ„ã€‚å› æ­¤ä¸­é—´éƒ¨åˆ†çš„ Transformer å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šEncoder å’Œ Decoderã€‚</p>
<p><img decoding="async" loading="lazy" alt="Transformes" src="https://yuluo-yx.github.io/assets/images/ai-23-39c594148db8b2e594018b480ae323aa.png" width="823" height="378" class="img_c29J"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="decoder-only--encoder-only">Decoder-Only &amp; Encoder-Only<a href="https://yuluo-yx.github.io/blog/semantic-model#decoder-only--encoder-only" class="hash-link" aria-label="Decoder-Only &amp; Encoder-Onlyçš„ç›´æ¥é“¾æ¥" title="Decoder-Only &amp; Encoder-Onlyçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="decoder-only-æ¨¡å‹">Decoder-Only æ¨¡å‹<a href="https://yuluo-yx.github.io/blog/semantic-model#decoder-only-%E6%A8%A1%E5%9E%8B" class="hash-link" aria-label="Decoder-Only æ¨¡å‹çš„ç›´æ¥é“¾æ¥" title="Decoder-Only æ¨¡å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>GPT Qwen ç­‰å±äº Decoder-Only æ¨¡å‹ï¼Œæ˜¯ç”Ÿæˆå¼æ¨¡å‹ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="encoder-only-æ¨¡å‹">Encoder-Only æ¨¡å‹<a href="https://yuluo-yx.github.io/blog/semantic-model#encoder-only-%E6%A8%A1%E5%9E%8B" class="hash-link" aria-label="Encoder-Only æ¨¡å‹çš„ç›´æ¥é“¾æ¥" title="Encoder-Only æ¨¡å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å…¶è¾“å‡ºæ˜¯ä¸€ä¸ªembeddingå‘é‡ã€‚ä¸ decoder-only çš„æ–‡æœ¬å›ç­”ä¸åŒï¼Œencoder-only æ¨¡å‹å°†å…¶â€œç­”æ¡ˆâ€ç¼–ç æˆè¿™ç§å‹ç¼©çš„æ•°å€¼å½¢å¼ã€‚</p>
<p>è¿™ä¸ªå‘é‡æ˜¯æ¨¡å‹è¾“å…¥çš„å‹ç¼©è¡¨ç¤ºï¼Œå› æ­¤æœ‰æ—¶ encoder-only æ¨¡å‹ä¹Ÿè¢«ç§°ä¸ºè¡¨å¾æ¨¡å‹ï¼ˆrepresentational modelsï¼‰ã€‚</p>
<p>ç»å¸¸ä¸ Decoder-Only çš„æ¨¡å‹ä¸€èµ·ä½¿ç”¨ï¼Œç»„å»ºæ›´å¼ºå¤§çš„ AI åº”ç”¨ï¼ˆä¾‹å¦‚ RAGï¼‰ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="bert">Bert<a href="https://yuluo-yx.github.io/blog/semantic-model#bert" class="hash-link" aria-label="Bertçš„ç›´æ¥é“¾æ¥" title="Bertçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Bert å…¨ç§°ä¸º Bidirectional Encoder Representations from Transformersã€‚æ˜¯ä¸€ç§åŸºäº Transformers çš„åŒå‘ç¼–ç å™¨è¡¨ç¤ºï¼Œå®ƒåªä½¿ç”¨äº† Transformer ä¸­çš„ Encoder éƒ¨åˆ†ï¼Œç”¨äºè¯­è¨€ç†è§£çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚æ”¹è¿›äº†å•å‘ç¼–ç å™¨çš„å±€é™æ€§ï¼Œé€šè¿‡åŒå‘ä¸Šä¸‹æ–‡æä¾›æ›´å¼ºå¤§çš„è¯­ä¹‰ä¿¡æ¯æå–èƒ½åŠ›ï¼Œå¹¿æ³›åº”ç”¨äºå¤šé¡¹NLPä»»åŠ¡ï¼Œå¹¶åœ¨å¤šä¸ªåŸºå‡†æµ‹è¯•ä¸­å–å¾—çªç ´æ€§æˆæœã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ç†è§£ä¸‹åŒå‘ç¼–ç å™¨ï¼š</p>
<blockquote>
<p>ä»Šå¤©å¤©æ°”å¾ˆå·®ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å–æ¶ˆæˆ·å¤–è¿åŠ¨ã€‚</p>
</blockquote>
<p>å°†å¥ä¸­çš„æŸä¸ªå­—æˆ–è¯æŒ–èµ°ï¼Œå¥å­å°±å˜æˆï¼š<code>ä»Šå¤©å¤©æ°”å¾ˆï¼ˆ ï¼‰ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å–æ¶ˆæˆ·å¤–è¿åŠ¨</code>ã€‚åˆ†åˆ«ä»å•å‘ç¼–ç ï¼ˆå¦‚ GPTï¼‰å’ŒåŒå‘ç¼–ç ï¼ˆå¦‚ BERTï¼‰çš„è§’åº¦æ¥è€ƒè™‘â€œï¼ˆ ï¼‰â€ä¸­åº”è¯¥å¡«ä»€ä¹ˆè¯ã€‚</p>
<p>å•å‘ç¼–ç åªä¼šä½¿ç”¨â€œä»Šå¤©å¤©æ°”å¾ˆâ€è¿™äº”ä¸ªå­—çš„ä¿¡æ¯æ¥æ¨æ–­â€œï¼ˆ ï¼‰â€å†…çš„å­—æˆ–è¯ï¼Œä»äººç±»è§’åº¦è€ƒè™‘ï¼Œä½¿ç”¨æ¦‚ç‡æœ€å¤§çš„è¯åº”è¯¥æ˜¯ï¼šâ€œå¥½â€â€œä¸é”™â€â€œå·®â€â€œç³Ÿç³•â€ï¼Œè€Œè¿™äº›è¯å¯ä»¥è¢«åˆ’åˆ†ä¸ºæˆªç„¶ä¸åŒçš„ä¸¤ç±»ã€‚</p>
<p>åŒå‘ç¼–ç å¯ä»¥åˆ©ç”¨ä¸‹æ–‡ä¿¡æ¯â€œæˆ‘ä»¬ä¸å¾—ä¸å–æ¶ˆæˆ·å¤–è¿åŠ¨â€æ¥å¸®åŠ©æ¨¡å‹åˆ¤æ–­ï¼Œä»äººç±»è§’åº¦è€ƒè™‘ï¼Œæ¦‚ç‡æœ€å¤§çš„è¯åº”è¯¥æ˜¯ï¼šâ€œå·®â€â€œç³Ÿç³•â€ã€‚</p>
<p>ä»¥æ­¤å°±å¯ä»¥ç›´è§‚åœ°æ„Ÿå—åˆ°ï¼Œä¸è€ƒè™‘æ¨¡å‹çš„å¤æ‚åº¦å’Œè®­ç»ƒæ•°æ®é‡ï¼ŒåŒå‘ç¼–ç ä¸å•å‘ç¼–ç ç›¸æ¯”ï¼Œå¯ä»¥åˆ©ç”¨æ›´å¤šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯æ¥è¾…åŠ©å½“å‰è¯çš„è¯­ä¹‰åˆ¤æ–­ã€‚åœ¨è¯­ä¹‰ç†è§£èƒ½åŠ›ä¸Šè¡¨ç°æ›´å¥½ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="modernbert">ModernBERT<a href="https://yuluo-yx.github.io/blog/semantic-model#modernbert" class="hash-link" aria-label="ModernBERTçš„ç›´æ¥é“¾æ¥" title="ModernBERTçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ModernBERT æ˜¯ BERT çš„ç°ä»£åŒ–ç‰ˆæœ¬ï¼Œæ—¨åœ¨æé«˜ä¸‹æ¸¸ä»»åŠ¡çš„æ€§èƒ½å’Œå¤„ç†æ•ˆç‡ã€‚ä¸å…¶å‰èº«ä¸åŒï¼Œå®ƒæ”¯æŒæ›´é•¿çš„ Tokenï¼Œæ›´ç°ä»£çš„è®­ç»ƒæ–¹å¼</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="gpt">GPT<a href="https://yuluo-yx.github.io/blog/semantic-model#gpt" class="hash-link" aria-label="GPTçš„ç›´æ¥é“¾æ¥" title="GPTçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Generative Pre-trained Transformerï¼ˆGPTï¼‰ç³»åˆ—æ˜¯ç”± OpenA æå‡ºçš„éå¸¸å¼ºå¤§çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œè¿™ä¸€ç³»åˆ—çš„æ¨¡å‹å¯ä»¥åœ¨éå¸¸å¤æ‚çš„ NLP ä»»åŠ¡ä¸­å–å¾—éå¸¸æƒŠè‰³çš„æ•ˆæœï¼Œä¾‹å¦‚æ–‡ç« ç”Ÿæˆï¼Œä»£ç ç”Ÿæˆï¼Œæœºå™¨ç¿»è¯‘ï¼ŒQ&amp;A ç­‰ã€‚ç°åœ¨å·²ç»è¢«å¹¿æ³›åº”ç”¨ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="qwen3">Qwen3<a href="https://yuluo-yx.github.io/blog/semantic-model#qwen3" class="hash-link" aria-label="Qwen3çš„ç›´æ¥é“¾æ¥" title="Qwen3çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å’Œ GPT ç³»åˆ—æ¨¡å‹ç±»ä¼¼ï¼Œéƒ½æ˜¯åŸºäº Transforms Decoder çš„ç”Ÿæˆå¼ AI æ¨¡å‹ï¼Œç”±é˜¿é‡Œäº‘å‘å¸ƒï¼Œåœ¨æ¶æ„ä¸Šå’Œ GPT ç•¥æœ‰ä¸åŒã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¨¡å‹æ–‡ä»¶ç»“æ„">æ¨¡å‹æ–‡ä»¶ç»“æ„<a href="https://yuluo-yx.github.io/blog/semantic-model#%E6%A8%A1%E5%9E%8B%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84" class="hash-link" aria-label="æ¨¡å‹æ–‡ä»¶ç»“æ„çš„ç›´æ¥é“¾æ¥" title="æ¨¡å‹æ–‡ä»¶ç»“æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¨¡å‹ä¿å­˜å½¢å¼">æ¨¡å‹ä¿å­˜å½¢å¼<a href="https://yuluo-yx.github.io/blog/semantic-model#%E6%A8%A1%E5%9E%8B%E4%BF%9D%E5%AD%98%E5%BD%A2%E5%BC%8F" class="hash-link" aria-label="æ¨¡å‹ä¿å­˜å½¢å¼çš„ç›´æ¥é“¾æ¥" title="æ¨¡å‹ä¿å­˜å½¢å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>.safetensors ç”± Hugging Face æå‡ºï¼Œä¾§é‡äºå®‰å…¨æ€§å’Œæ•ˆç‡ï¼Œé€‚åˆäºé‚£äº›å¸Œæœ›å¿«é€Ÿéƒ¨ç½²ä¸”å¯¹å®‰å…¨æœ‰è¾ƒé«˜è¦æ±‚çš„åœºæ™¯ï¼Œå°¤å…¶åœ¨Hugging Faceç”Ÿæ€ä¸­ã€‚</li>
<li>.ckpt æ–‡ä»¶æ˜¯ PyTorch Lightning æ¡†æ¶é‡‡ç”¨çš„æ¨¡å‹å­˜å‚¨æ ¼å¼ï¼Œå®ƒä¸ä»…åŒ…å«äº†æ¨¡å‹å‚æ•°ï¼Œè¿˜åŒ…æ‹¬ä¼˜åŒ–å™¨çŠ¶æ€ä»¥åŠå¯èƒ½çš„è®­ç»ƒå…ƒæ•°æ®ä¿¡æ¯ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ— ç¼åœ°æ¢å¤è®­ç»ƒæˆ–æ‰§è¡Œæ¨ç†ã€‚</li>
<li>.bin æ–‡ä»¶ä¸æ˜¯æ ‡å‡†åŒ–çš„æ¨¡å‹ä¿å­˜æ ¼å¼ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹å¯ç”¨äºå­˜å‚¨åŸå§‹äºŒè¿›åˆ¶æƒé‡æ•°æ®ï¼ŒåŠ è½½æ—¶éœ€é¢å¤–å¤„ç†ã€‚</li>
<li>.pth æ˜¯PyTorchçš„æ ‡å‡†æ¨¡å‹ä¿å­˜æ ¼å¼ï¼Œæ–¹ä¾¿æ¨¡å‹çš„æŒä¹…åŒ–å’Œå¤ç”¨ï¼Œæ”¯æŒå®Œæ•´æ¨¡å‹ç»“æ„å’Œå‚æ•°çš„ä¿å­˜ä¸æ¢å¤ã€‚</li>
<li>.onnxï¼ˆOpen Neural Network Exchangeï¼‰æ–‡ä»¶æ˜¯ä¸€ä¸ªå¼€æ”¾æ ¼å¼ï¼Œç”¨äºè¡¨ç¤ºæœºå™¨å­¦ä¹ æ¨¡å‹ã€‚å®ƒæ—¨åœ¨æä¾›ä¸€ç§æ ‡å‡†çš„æ–¹å¼æ¥è¡¨ç¤ºæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œä½¿å¾—æ¨¡å‹å¯ä»¥åœ¨ä¸åŒçš„æ¡†æ¶å’Œå·¥å…·ä¹‹é—´è¿›è¡Œè½¬æ¢å’Œäº’æ“ä½œ</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ–‡ä»¶ç»“æ„">æ–‡ä»¶ç»“æ„<a href="https://yuluo-yx.github.io/blog/semantic-model#%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84" class="hash-link" aria-label="æ–‡ä»¶ç»“æ„çš„ç›´æ¥é“¾æ¥" title="æ–‡ä»¶ç»“æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>ä»¥ Qwen 0.6B ä¸ºä¾‹ã€‚</p>
</blockquote>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Qwen3-0.6B</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ config.json							# æ§åˆ¶æ¨¡å‹çš„åç§°ã€æœ€ç»ˆè¾“å‡ºçš„æ ·å¼ã€éšè—å±‚å®½åº¦å’Œæ·±åº¦ã€æ¿€æ´»å‡½æ•°çš„ç±»åˆ«ç­‰</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ generation_config.json</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ LICENSE</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ merges.txt</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ model.safetensors</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ README.md</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ tokenizer_config.json</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ tokenizer.json					# tokenizer.json å’Œ tokenizer_config.json åˆ†è¯çš„é…ç½®æ–‡ä»¶</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€ vocab.json							# vocab.txt è¯å…¸æ–‡ä»¶</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ‰©å±•">æ‰©å±•<a href="https://yuluo-yx.github.io/blog/semantic-model#%E6%89%A9%E5%B1%95" class="hash-link" aria-label="æ‰©å±•çš„ç›´æ¥é“¾æ¥" title="æ‰©å±•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ¿€æ´»å‡½æ•°">æ¿€æ´»å‡½æ•°<a href="https://yuluo-yx.github.io/blog/semantic-model#%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0" class="hash-link" aria-label="æ¿€æ´»å‡½æ•°çš„ç›´æ¥é“¾æ¥" title="æ¿€æ´»å‡½æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç¥ç»ç½‘ç»œæ¨¡æ‹Ÿçš„æ˜¯äººè„‘ä¸­çš„ç¥ç»å…ƒç»“æ„ï¼Œæ¿€æ´»å‡½æ•°æ—¨åœ¨å¸®åŠ©ç½‘ç»œå­¦ä¹ æ•°æ®ä¸­çš„å¤æ‚æ¨¡å¼ã€‚åœ¨ç¥ç»å…ƒä¸­ï¼Œè¾“å…¥ç»è¿‡ä¸€ç³»åˆ—åŠ æƒæ±‚å’Œåä½œç”¨äºå¦ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯è¿™é‡Œçš„æ¿€æ´»å‡½æ•°ã€‚</p>
<p>é€šä¿—æ¥è®²ï¼Œå°±æ˜¯å°†è¾“å…¥å’Œè¾“å‡ºçš„æ˜ å°„å‡çº¬ï¼Œä½¿æ¨¡å‹é€‚é…æ›´å¤šçš„éçº¿æ€§æƒ…å†µã€‚æ¿€æ´»å‡½æ•°å¯ä»¥åˆ†ä¸º<strong>çº¿æ€§æ¿€æ´»å‡½æ•°</strong>ï¼ˆçº¿æ€§æ–¹ç¨‹æ§åˆ¶è¾“å…¥åˆ°è¾“å‡ºçš„æ˜ å°„ï¼Œå¦‚ <code>f(x)=x</code> ç­‰ï¼‰ä»¥åŠ<strong>éçº¿æ€§æ¿€æ´»å‡½æ•°</strong>ï¼ˆéçº¿æ€§æ–¹ç¨‹æ§åˆ¶è¾“å…¥åˆ°è¾“å‡ºçš„æ˜ å°„ï¼Œæ¯”å¦‚<a href="https://zhida.zhihu.com/search?content_id=169155866&amp;content_type=Article&amp;match_order=1&amp;q=Sigmoid&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQzODEsInEiOiJTaWdtb2lkIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6MTY5MTU1ODY2LCJjb250ZW50X3R5cGUiOiJBcnRpY2xlIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.QD5d-fd3mKsXsOCDrGUylt7MMdcCV2eV1LGOr7eDtlk&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">Sigmoid</a>ã€<a href="https://zhida.zhihu.com/search?content_id=169155866&amp;content_type=Article&amp;match_order=1&amp;q=Tanh&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQzODEsInEiOiJUYW5oIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6MTY5MTU1ODY2LCJjb250ZW50X3R5cGUiOiJBcnRpY2xlIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.PO9kZ1pGQRpCTWRFPVLeQ-78yKzhFckdRCaSvGteDVM&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">Tanh</a>ã€ReLUã€LReLUã€PReLUã€Swish ç­‰ï¼‰</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="tokenizer">Tokenizer<a href="https://yuluo-yx.github.io/blog/semantic-model#tokenizer" class="hash-link" aria-label="Tokenizerçš„ç›´æ¥é“¾æ¥" title="Tokenizerçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Tokenizeråˆ†è¯ç®—æ³•æ˜¯NLPå¤§æ¨¡å‹æœ€åŸºç¡€çš„ç»„ä»¶ï¼ŒåŸºäºTokenizerå¯ä»¥å°†æ–‡æœ¬è½¬æ¢æˆç‹¬ç«‹çš„tokenåˆ—è¡¨ï¼Œè¿›è€Œè½¬æ¢æˆè¾“å…¥çš„å‘é‡æˆä¸ºè®¡ç®—æœºå¯ä»¥ç†è§£çš„è¾“å…¥å½¢å¼ã€‚</p>
<p>æ ¹æ®ä¸åŒçš„åˆ‡åˆ†ç²’åº¦å¯ä»¥æŠŠtokenizeråˆ†ä¸º:</p>
<ol>
<li>åŸºäºè¯çš„åˆ‡åˆ†ï¼ŒåŸºäºå­—çš„åˆ‡åˆ†å’ŒåŸºäºsubwordçš„åˆ‡åˆ†ã€‚ åŸºäºsubwordçš„åˆ‡åˆ†æ˜¯ç›®å‰çš„ä¸»æµåˆ‡åˆ†æ–¹å¼ã€‚</li>
<li>subwordçš„åˆ‡åˆ†åŒ…æ‹¬: BPE(/BBPE), <a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=WordPiece&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJXb3JkUGllY2UiLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjoyMzI4OTE1NjgsImNvbnRlbnRfdHlwZSI6IkFydGljbGUiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.UXIQzv9zlpUGqPPcNroaBokJhi08uxqo3v33wL3az14&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">WordPiece</a> å’Œ Unigramä¸‰ç§åˆ†è¯æ¨¡å‹ã€‚å…¶ä¸­WordPieceå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§ç‰¹æ®Šçš„BPEã€‚</li>
<li>å®Œæ•´çš„åˆ†è¯æµç¨‹åŒ…æ‹¬ï¼šæ–‡æœ¬å½’ä¸€åŒ–ï¼Œé¢„åˆ‡åˆ†ï¼ŒåŸºäºåˆ†è¯æ¨¡å‹çš„åˆ‡åˆ†ï¼Œåå¤„ç†ã€‚</li>
<li>SentencePieceæ˜¯ä¸€ä¸ªåˆ†è¯å·¥å…·ï¼Œå†…ç½®BEPç­‰å¤šç§åˆ†è¯æ–¹æ³•ï¼ŒåŸºäºUnicodeç¼–ç å¹¶ä¸”å°†ç©ºæ ¼è§†ä¸ºç‰¹æ®Šçš„tokenã€‚è¿™æ˜¯å½“å‰å¤§æ¨¡å‹çš„ä¸»æµåˆ†è¯æ–¹æ¡ˆã€‚</li>
</ol>
<table><thead><tr><th>åˆ†è¯æ–¹æ³•</th><th>å…¸å‹æ¨¡å‹</th></tr></thead><tbody><tr><td>BPE</td><td><a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=GPT&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJHUFQiLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjoyMzI4OTE1NjgsImNvbnRlbnRfdHlwZSI6IkFydGljbGUiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.2vquQiMyKIUMP8Dzyj_jnPWo5lSaarXxJUochCxrtuk&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">GPT</a>, GPT-2, GPT-J, GPT-Neo, <a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=RoBERTa&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJSb0JFUlRhIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6MjMyODkxNTY4LCJjb250ZW50X3R5cGUiOiJBcnRpY2xlIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.ZektXrcR8blvvv34YbZtYVtHgwWUdbzmK16S8RDfB3o&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">RoBERTa</a>, <a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=BART&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJCQVJUIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6MjMyODkxNTY4LCJjb250ZW50X3R5cGUiOiJBcnRpY2xlIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.qycfCtAgps3rDUzxfkttgQ8xnTwZaucuDOvkGtOx5U0&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">BART</a>, <a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=LLaMA&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJMTGFNQSIsInpoaWRhX3NvdXJjZSI6ImVudGl0eSIsImNvbnRlbnRfaWQiOjIzMjg5MTU2OCwiY29udGVudF90eXBlIjoiQXJ0aWNsZSIsIm1hdGNoX29yZGVyIjoxLCJ6ZF90b2tlbiI6bnVsbH0.pj8R6K0qJEnn5cjbDQ4ExHfH5IHtNgnIr5udncucEWM&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">LLaMA</a>, ChatGLM-6B, <a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=Baichuan&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJCYWljaHVhbiIsInpoaWRhX3NvdXJjZSI6ImVudGl0eSIsImNvbnRlbnRfaWQiOjIzMjg5MTU2OCwiY29udGVudF90eXBlIjoiQXJ0aWNsZSIsIm1hdGNoX29yZGVyIjoxLCJ6ZF90b2tlbiI6bnVsbH0.ERUHdiUdB_BlembKDtdrSKxS8qWnjK_lWwC6PoiNzjM&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">Baichuan</a></td></tr><tr><td>WordPiece</td><td>BERT, <a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=DistilBERT&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJEaXN0aWxCRVJUIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6MjMyODkxNTY4LCJjb250ZW50X3R5cGUiOiJBcnRpY2xlIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.2RM9mvukGuHbul1PBTu01q5HvPoME9B0ES1ft9CItgo&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">DistilBERT</a>ï¼Œ<a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=MobileBERT&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJNb2JpbGVCRVJUIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6MjMyODkxNTY4LCJjb250ZW50X3R5cGUiOiJBcnRpY2xlIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.OJmwoGXJ-Z2S4h7xrJc5AJFgG1oB6I7JOX5UuTNZfVM&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">MobileBERT</a></td></tr><tr><td>Unigram</td><td><a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=AlBERT&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJBbEJFUlQiLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjoyMzI4OTE1NjgsImNvbnRlbnRfdHlwZSI6IkFydGljbGUiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.hAcxm-yKN_GbuT7PdGHTrrLI2AO3W_W3RJ0abr_4c6o&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">AlBERT</a>, <a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=T5&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJUNSIsInpoaWRhX3NvdXJjZSI6ImVudGl0eSIsImNvbnRlbnRfaWQiOjIzMjg5MTU2OCwiY29udGVudF90eXBlIjoiQXJ0aWNsZSIsIm1hdGNoX29yZGVyIjoxLCJ6ZF90b2tlbiI6bnVsbH0.FI844AWqW9iy7Iq-Nmy0Cf8WEaHjZrTi-uAJArPpONQ&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">T5</a>, <a href="https://zhida.zhihu.com/search?content_id=232891568&amp;content_type=Article&amp;match_order=1&amp;q=mBART&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjIxODQ5MDIsInEiOiJtQkFSVCIsInpoaWRhX3NvdXJjZSI6ImVudGl0eSIsImNvbnRlbnRfaWQiOjIzMjg5MTU2OCwiY29udGVudF90eXBlIjoiQXJ0aWNsZSIsIm1hdGNoX29yZGVyIjoxLCJ6ZF90b2tlbiI6bnVsbH0.025oeImLIZqtKFDfyL32sbO3M4ComzN4mJI7i6nWhrk&amp;zhida_source=entity" target="_blank" rel="noopener noreferrer">mBART</a>, XLNet</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="lora-å¾®è°ƒ">LoRA å¾®è°ƒ<a href="https://yuluo-yx.github.io/blog/semantic-model#lora-%E5%BE%AE%E8%B0%83" class="hash-link" aria-label="LoRA å¾®è°ƒçš„ç›´æ¥é“¾æ¥" title="LoRA å¾®è°ƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>LoRAï¼šLow-Rank Adaptation of Large Language Modelsï¼ˆä½é˜¶è‡ªé€‚åº”å‚æ•°é«˜æ•ˆå¾®è°ƒ ï¼‰ã€‚</p>
<p>åŸºæœ¬åŸç†æ˜¯å†»ç»“é¢„è®­ç»ƒå¥½çš„æ¨¡å‹æƒé‡å‚æ•°ï¼Œåœ¨å†»ç»“åŸæ¨¡å‹å‚æ•°çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å¾€æ¨¡å‹ä¸­åŠ å…¥é¢å¤–çš„ç½‘ç»œå±‚ï¼Œå¹¶åªè®­ç»ƒè¿™äº›æ–°å¢çš„ç½‘ç»œå±‚å‚æ•°ã€‚ç”±äºè¿™äº›æ–°å¢å‚æ•°æ•°é‡è¾ƒå°‘ï¼Œè¿™æ ·ä¸ä»… finetune çš„æˆæœ¬æ˜¾è‘—ä¸‹é™ï¼Œè¿˜èƒ½è·å¾—å’Œå…¨æ¨¡å‹å¾®è°ƒç±»ä¼¼çš„æ•ˆæœã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å‚è€ƒ">å‚è€ƒ<a href="https://yuluo-yx.github.io/blog/semantic-model#%E5%8F%82%E8%80%83" class="hash-link" aria-label="å‚è€ƒçš„ç›´æ¥é“¾æ¥" title="å‚è€ƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li><a href="https://zhuanlan.zhihu.com/p/535100411" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/535100411</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/1911115248053755995" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/1911115248053755995</a></li>
<li><a href="https://yuluo-yx.github.io/blog/deep-learn-init/#%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98%E5%BC%95%E5%85%A5" target="_blank" rel="noopener noreferrer">https://yuluo-yx.github.io/blog/deep-learn-init/#%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98%E5%BC%95%E5%85%A5</a></li>
<li><a href="https://yuluo-yx.github.io/docs/LLMs-AI-llms-what-token/#%E5%88%86%E8%AF%8D%E5%99%A8%E5%8E%9F%E7%90%86" target="_blank" rel="noopener noreferrer">https://yuluo-yx.github.io/docs/LLMs-AI-llms-what-token/#%E5%88%86%E8%AF%8D%E5%99%A8%E5%8E%9F%E7%90%86</a></li>
</ol>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>Model</category>
            <category>LLM</category>
        </item>
        <item>
            <title><![CDATA[å­¦ä¹ åŒæ‹¼è¾“å…¥]]></title>
            <link>https://yuluo-yx.github.io/blog/input</link>
            <guid>https://yuluo-yx.github.io/blog/input</guid>
            <pubDate>Sun, 19 Oct 2025 12:51:37 GMT</pubDate>
            <description><![CDATA[æ”¾åœ¨å‰é¢ï¼šå‚è€ƒå¸–å­ã€‚]]></description>
            <content:encoded><![CDATA[<p>æ”¾åœ¨å‰é¢ï¼šå‚è€ƒå¸–å­ã€‚</p>
<ul>
<li><a href="https://www.v2ex.com/t/1062757" target="_blank" rel="noopener noreferrer">https://www.v2ex.com/t/1062757</a></li>
<li><a href="https://sspai.com/post/42667" target="_blank" rel="noopener noreferrer">https://sspai.com/post/42667</a></li>
<li><a href="https://sspai.com/post/56134" target="_blank" rel="noopener noreferrer">https://sspai.com/post/56134</a></li>
<li>åŒæ‹¼è¾“å…¥ç»ƒä¹ ç½‘ç«™ï¼š<a href="https://api.ihint.me/shuang/" target="_blank" rel="noopener noreferrer">https://api.ihint.me/shuang/</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åŸå› ">åŸå› <a href="https://yuluo-yx.github.io/blog/input#%E5%8E%9F%E5%9B%A0" class="hash-link" aria-label="åŸå› çš„ç›´æ¥é“¾æ¥" title="åŸå› çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä¸åŒä½“éªŒè€Œå·²ï¼Œæ‡’äººä¸»ä¹‰ï¼Œæƒ³å°‘æ•²å‡ æ¬¡é”®ç›˜ã€‚ç›®å‰çœ‹ä¸‹æ¥å”¯ä¸€çš„å¥½å¤„æ˜¯åŒæ‹¼æ•²å‡»é”®ç›˜æ¬¡æ•°å˜å°‘äº†ã€‚</p>
<blockquote>
<p>ï¼ˆäº”ç¬”å¤ªéš¾äº†ï¼Œæ‡’å¾—è®°å­—æ ¹ã€‚ï¼‰</p>
</blockquote>
<p>ç°çŠ¶æ˜¯ï¼š</p>
<ul>
<li>
<p>ä¸­æ–‡æ‰‹æœºè¾“å…¥ç”¨ä¹å®«æ ¼ï¼›</p>
</li>
<li>
<p>ä¸­æ–‡ç”µè„‘è¾“å…¥ç”¨å…¨æ‹¼ï¼ˆå­¦ä¹ åŒæ‹¼ä¸­...ï¼‰ï¼›</p>
</li>
<li>
<p>è‹±æ–‡è¾“å…¥ 26 é”®ã€‚</p>
</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åŒæ‹¼è¾“å…¥æ–¹æ¡ˆ">åŒæ‹¼è¾“å…¥æ–¹æ¡ˆ<a href="https://yuluo-yx.github.io/blog/input#%E5%8F%8C%E6%8B%BC%E8%BE%93%E5%85%A5%E6%96%B9%E6%A1%88" class="hash-link" aria-label="åŒæ‹¼è¾“å…¥æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥" title="åŒæ‹¼è¾“å…¥æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åŒæ‹¼å’Œå…¨æ‹¼ä¸€æ ·ï¼Œä»ç„¶æ˜¯è½¬å½•å‘éŸ³ã€‚ä¸åƒäº”ç¬”è¿™ç§å½¢ç è¾“å…¥æ³•ï¼Œéœ€è¦æ‹†å­—+è®°å¿†å­—æ ¹ã€‚åŒæ‹¼åªéœ€è¦è®°å¿†éŸµæ¯çš„ä½ç½®å³å¯ã€‚</p>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä¸¾ä¸ªä¾‹å­ï¼š</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">è¾“å…¥ â€œé»„â€ </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  å…¨æ‹¼ï¼šhuang</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  åŒæ‹¼ï¼ˆå°é¹¤åŒæ‹¼ï¼‰ï¼šhl</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŒæ‹¼çš„ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œä¸ä¼šè¯»å°±æ²¡åŠæ³•è¾“ã€‚ä½†æ˜¯è¿™ä¸ªç¼ºç‚¹å¯¹å½¢ç è¾“å…¥æ²¡æœ‰é˜»ç¢ï¼Œçœ‹åˆ°ä¼šå†™ = èƒ½è¾“ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å°é¹¤åŒæ‹¼--è‡ªç„¶ç åŒæ‹¼">å°é¹¤åŒæ‹¼ &amp; è‡ªç„¶ç åŒæ‹¼<a href="https://yuluo-yx.github.io/blog/input#%E5%B0%8F%E9%B9%A4%E5%8F%8C%E6%8B%BC--%E8%87%AA%E7%84%B6%E7%A0%81%E5%8F%8C%E6%8B%BC" class="hash-link" aria-label="å°é¹¤åŒæ‹¼ &amp; è‡ªç„¶ç åŒæ‹¼çš„ç›´æ¥é“¾æ¥" title="å°é¹¤åŒæ‹¼ &amp; è‡ªç„¶ç åŒæ‹¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>è¿™æ˜¯åŒæ‹¼ä¸­ä½¿ç”¨æœ€å¤šçš„ä¸¤ä¸ªè¾“å…¥æ–¹æ¡ˆã€‚å’Œè‡ªç„¶ç åŒæ‹¼çš„åŒºåˆ«æ˜¯ç¼–ç è§„åˆ™ä¸åŒã€‚</p>
<blockquote>
<p>æ— è„‘é€‰å°é¹¤åŒæ‹¼ï¼</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="mac-åŸç”Ÿè¾“å…¥æ³•è®¾ç½®åŒæ‹¼">Mac åŸç”Ÿè¾“å…¥æ³•è®¾ç½®åŒæ‹¼<a href="https://yuluo-yx.github.io/blog/input#mac-%E5%8E%9F%E7%94%9F%E8%BE%93%E5%85%A5%E6%B3%95%E8%AE%BE%E7%BD%AE%E5%8F%8C%E6%8B%BC" class="hash-link" aria-label="Mac åŸç”Ÿè¾“å…¥æ³•è®¾ç½®åŒæ‹¼çš„ç›´æ¥é“¾æ¥" title="Mac åŸç”Ÿè¾“å…¥æ³•è®¾ç½®åŒæ‹¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>å«Œéº»çƒ¦ç›´æ¥å®‰è£…æœç‹—è¾“å…¥æ³•ï¼Œä½†æ˜¯æœ‰å¹¿å‘Š......</p>
<p>æ‰€ä»¥æŠ˜è…¾è‡ªå¸¦çš„åŸç”Ÿè¾“å…¥æ³•ã€‚</p>
<p>Tipsï¼š</p>
<ul>
<li>ctrl + command + ç©ºæ ¼ï¼šåœ¨è¾“å…¥æ³•èœå•ä¸­åˆ‡æ¢è¾“å…¥æ³•ï¼Œ<code>ABC - æ‹¼éŸ³</code></li>
</ul>
</blockquote>
<ul>
<li>
<p>è®¾ç½®åŒæ‹¼ï¼š<a href="https://support.apple.com/zh-cn/guide/chinese-input-method/cim119a8d473/104/mac/26" target="_blank" rel="noopener noreferrer">https://support.apple.com/zh-cn/guide/chinese-input-method/cim119a8d473/104/mac/26</a></p>
</li>
<li>
<p>æŸ¥çœ‹æ”¯æŒçš„åŒæ‹¼æ–¹æ¡ˆï¼š<a href="https://support.apple.com/zh-cn/guide/chinese-input-method/cimc29a772a9/mac" target="_blank" rel="noopener noreferrer">https://support.apple.com/zh-cn/guide/chinese-input-method/cimc29a772a9/mac</a></p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="step 1" src="https://yuluo-yx.github.io/assets/images/1-f64814faf5d82a06e18dbaadc07b3cb9.png" width="340" height="578" class="img_c29J"></p>
<p>æ‰“å¼€è®¾ç½®ï¼Œç‚¹å‡»å·¦ä¸‹è§’çš„æ·»åŠ ï¼š</p>
<p><img decoding="async" loading="lazy" alt="step 2" src="https://yuluo-yx.github.io/assets/images/2-4db7bb41abcb416143bc1986add037d7.png" width="705" height="628" class="img_c29J"></p>
<p>é€‰æ‹© <code>åŒæ‹¼-ä¸­æ–‡ç®€ä½“</code>ï¼Œæˆ‘å·²ç»åŠ è¿‡äº†ï¼Œæ‰€ä»¥æ˜¯ç½®ç°çš„ï¼š</p>
<p><img decoding="async" loading="lazy" alt="step 3" src="https://yuluo-yx.github.io/assets/images/3-a330dcade8253048bb6bdb260ced7db2.png" width="633" height="511" class="img_c29J"></p>
<p>è®¾ç½®ç¼–ç ç±»å‹ä¸ºå°é¹¤åŒæ‹¼æ–¹æ¡ˆï¼ˆé»˜è®¤ä¸ºå¾®è½¯åŒæ‹¼æ–¹æ¡ˆï¼‰ï¼š</p>
<p><img decoding="async" loading="lazy" alt="step 4" src="https://yuluo-yx.github.io/assets/images/4-bb9c9dd4cfe4a09e6eee864c3fbcfef9.png" width="610" height="373" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¼€å§‹">å¼€å§‹<a href="https://yuluo-yx.github.io/blog/input#%E5%BC%80%E5%A7%8B" class="hash-link" aria-label="å¼€å§‹çš„ç›´æ¥é“¾æ¥" title="å¼€å§‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>æ‰“å¼€ <a href="https://api.ihint.me/shuang/%EF%BC%9B" target="_blank" rel="noopener noreferrer">https://api.ihint.me/shuang/ï¼›</a></li>
<li>é€‰æ‹©å°é¹¤åŒæ‹¼ï¼›</li>
<li>å¼€å§‹æ‰“å­— ï¼ï¼ï¼</li>
</ol>
<p>å°é¹¤åŒæ‹¼å¥ä½ï¼š</p>
<p><img decoding="async" loading="lazy" alt="å°é¹¤åŒæ‹¼å¥ä½" src="https://yuluo-yx.github.io/assets/images/5-ff6f695ae9b1d5e213168d82dc9c9cbf.png" width="992" height="573" class="img_c29J"></p>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
        </item>
        <item>
            <title><![CDATA[VSR é¡¹ç›®è§£æ]]></title>
            <link>https://yuluo-yx.github.io/blog/vllm-sr-understand</link>
            <guid>https://yuluo-yx.github.io/blog/vllm-sr-understand</guid>
            <pubDate>Sat, 18 Oct 2025 23:36:16 GMT</pubDate>
            <description><![CDATA[æ‰¿ä¸Šæ–‡ Vllm Semantic-router MoM æ¶æ„ï¼Œç†è§£ä¸‹ VSR è¯­ä¹‰è·¯ç”±é¡¹ç›®æ•´ä½“éƒ¨åˆ†ã€‚]]></description>
            <content:encoded><![CDATA[<p>æ‰¿ä¸Šæ–‡ <a href="https://yuluo-yx.github.io/blog/vllm-sr-mom" target="_blank" rel="noopener noreferrer">Vllm Semantic-router MoM æ¶æ„</a>ï¼Œç†è§£ä¸‹ VSR è¯­ä¹‰è·¯ç”±é¡¹ç›®æ•´ä½“éƒ¨åˆ†ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æœ¯è¯­è§£é‡Š">æœ¯è¯­è§£é‡Š<a href="https://yuluo-yx.github.io/blog/vllm-sr-understand#%E6%9C%AF%E8%AF%AD%E8%A7%A3%E9%87%8A" class="hash-link" aria-label="æœ¯è¯­è§£é‡Šçš„ç›´æ¥é“¾æ¥" title="æœ¯è¯­è§£é‡Šçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>Ok, å¼€å§‹ä¹‹å‰ã€‚å…ˆå¯¹ä¸€äº›ä¸“ä¸šæœ¯è¯­æ‰«ç›²ï¼Œä»¥å…é€ æˆç†è§£é”™è¯¯ã€‚</p>
</blockquote>
<ul>
<li>Candle Hugging Face çš„æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰æ¡†æ¶ï¼Œç”± Rust ç¼–å†™ï¼›</li>
<li>FFI (Foreign Function Interface) Candle é€šè¿‡ FFI æš´éœ²ç»™ Go è°ƒç”¨ï¼›</li>
<li>decoder-onlyï¼šç”Ÿæˆæ¨¡å‹ï¼ŒGPT Qwen ç­‰ã€‚</li>
<li>encoder-onlyï¼šï¼ˆæœ‰æ—¶ä¹Ÿç§°è¡¨å¾æ¨¡å‹ï¼‰è¾“å‡ºæ˜¯ä¸€ä¸ª embedding å‘é‡ï¼›</li>
<li>BERT æ¨¡å‹ï¼šè‡ªç„¶è¯­è¨€ç†è§£æ¨¡å‹ï¼Œç†è§£è¯­ä¹‰ï¼›</li>
<li>ModernBERT æ¨¡å‹ï¼šæ›´å¤§ token çš„ BERT æ¨¡å‹ï¼ŒåŒæ³¨æ„åŠ›æœºåˆ¶ï¼›</li>
<li>LoRA ï¼š(Low-Rank Adaptation) å¾®è°ƒæ¨¡å‹ç”¨ï¼ŒåŠ é€Ÿæ¨¡å‹å¾®è°ƒï¼Œæ¨ç†é˜¶æ®µä¸å­˜åœ¨ï¼›</li>
<li>Jailbreak Detectionï¼šè¶Šç‹±æ£€æµ‹ã€‚é˜²æ­¢æ¶æ„ prompt æ”»å‡»ï¼Œåœ¨è¯·æ±‚åˆ°è¾¾ LLM ä¹‹å‰è¿›è¡Œå®‰å…¨è¿‡æ»¤ï¼›</li>
<li>Intent Classificationï¼šæ„å›¾åˆ†ç±»ï¼›</li>
<li>PII æ£€æµ‹ï¼šä¸ªäººèº«ä»½ä¿¡æ¯æ£€æµ‹ï¼›</li>
<li>Fine-tuning ï¼šå¾®è°ƒï¼Œä½¿ç”¨é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå°‘é‡æ ‡æ³¨æ•°æ®ï¼›</li>
<li>Pre-Traingï¼šé¢„è®­ç»ƒï¼›æµ·é‡æ•°æ®ï¼Œå¤§é‡ GPU èµ„æºä» 0 è®­ç»ƒã€‚</li>
</ul>
<p>ä¸€äº›æœ¯è¯­å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/14063328673" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/14063328673</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å·¥ä½œæµç¨‹">å·¥ä½œæµç¨‹<a href="https://yuluo-yx.github.io/blog/vllm-sr-understand#%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B" class="hash-link" aria-label="å·¥ä½œæµç¨‹çš„ç›´æ¥é“¾æ¥" title="å·¥ä½œæµç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><img decoding="async" loading="lazy" alt="image-20251018230818243" src="https://yuluo-yx.github.io/assets/images/3-9b4dd6940f6f300e661647602598c10d.png" width="1081" height="908" class="img_c29J"></p>
<p>VSR ç”±ä¸‰ç§è¯­è¨€å¼‚æ„ç»„åˆè€Œæˆï¼Œå…¶ä¸­ Golang è´Ÿè´£æµé‡æ¥å…¥å’Œè½¬å‘ï¼ŒRust è´Ÿè´£è°ƒç”¨æ¨¡å‹å¾—å‡ºç»“æœï¼ŒPython è´Ÿè´£è®­ç»ƒå’Œå¾®è°ƒ BERT æ¨¡å‹ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æ•´ä½“æ¶æ„">æ•´ä½“æ¶æ„<a href="https://yuluo-yx.github.io/blog/vllm-sr-understand#%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84" class="hash-link" aria-label="æ•´ä½“æ¶æ„çš„ç›´æ¥é“¾æ¥" title="æ•´ä½“æ¶æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><img decoding="async" loading="lazy" src="https://yuluo-yx.github.io/assets/images/2-d82c8db20a2548352f67777c38d8d96b.png" alt="VSR Arch" class="img_c29J"></p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒVSR ä¸»è¦å›´ç»•é«˜æ€§èƒ½çš„ Rust åˆ†ç±»æ„å»ºã€‚</p>
<p>å…¶ä»–æ¨¡å—ä¸»è¦èŒè´£ä¸ºï¼š</p>
<p>Pythonï¼š<code>src/training</code>æ¨¡å‹è®­ç»ƒè„šæœ¬ï¼Œè´Ÿè´£å¾®è°ƒå’Œè®­ç»ƒ BERT æ¨¡å‹ï¼›</p>
<p>Golangï¼šrouter è´Ÿè´£è·¯ç”±ç”¨æˆ·è¯·æ±‚æµé‡ï¼Œè°ƒç”¨ candle-bindingï¼›</p>
<p>Rustï¼šcandle-binding åŠ è½½è®­ç»ƒå®Œæˆçš„æ¨¡å‹ï¼Œè¯­ä¹‰åˆ†æ•°è®¡ç®—ï¼Œæ–‡æœ¬åˆ†ç±»ï¼Œè¿”å›ç»“æœç»™ Go clientï¼›</p>
<p>Envoyï¼šè°ƒç”¨ Backend LLMã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="candle-binding">Candle-binding<a href="https://yuluo-yx.github.io/blog/vllm-sr-understand#candle-binding" class="hash-link" aria-label="Candle-bindingçš„ç›´æ¥é“¾æ¥" title="Candle-bindingçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>VSR çš„å¤§è„‘éƒ¨åˆ†ã€‚ML æ¨ç†å¼•æ“ç»‘å®šã€‚æä¾›äº† rust candle çš„æœºå™¨å­¦ä¹ å’Œæ¨¡å‹æ¨ç†èƒ½åŠ›ï¼Œå¹¶é€šè¿‡ FFIï¼ˆForeign Function Interfaceï¼‰æš´éœ²ç»™ Go ä½¿ç”¨ã€‚</p>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚                  Go Application Layer                   â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚         (semantic-router.go - CGO Bindings)             â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”‚ FFI (C ABI)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚              Rust Native Library                        â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚        (libcandle_semantic_router.dylib/.so)            â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚                                                         â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚  â”œâ”€â”€ lib.rs           - ä¸»å…¥å£å’Œç›¸ä¼¼åº¦è®¡ç®—                 â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚  â”œâ”€â”€ bert_official.rs - å®˜æ–¹ BERT åˆ†ç±»å™¨                  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚  â”œâ”€â”€ modernbert.rs    - ModernBERT å®ç°                  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚  â””â”€â”€ unified_classifier.rs - ç»Ÿä¸€åˆ†ç±»å™¨ (LoRAæ”¯æŒ)        â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚           Candle ML Framework (Hugging Face)            â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚     - Rust åŸç”Ÿ ML æ¡†æ¶ (ç±»ä¼¼ PyTorch)                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚     - GPU/CPU åŠ é€Ÿæ”¯æŒ                                   â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚     - BERT/ModernBERT æ¨¡å‹å®ç°                           â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="train">Train<a href="https://yuluo-yx.github.io/blog/vllm-sr-understand#train" class="hash-link" aria-label="Trainçš„ç›´æ¥é“¾æ¥" title="Trainçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>VSR çš„è®­ç»ƒæ¨¡å—ã€‚candle æœ€ç»ˆè°ƒç”¨çš„æ¨¡å‹æ¥æºã€‚ä½¿ç”¨çš„æ•°æ®æ¥è‡ª HF çš„å…¬å¼€æ•°æ®é›†ã€‚</p>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Training</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  â”œâ”€ è¾“å…¥: æ•°æ®é›† + BERT åŸºç¡€æ¨¡å‹</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  â”œâ”€ è®­ç»ƒ: LoRA å¾®è°ƒ (1% å‚æ•°)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  â”‚   â””â”€ ä¼˜åŠ¿: å¿«é€Ÿã€çœå†…å­˜ã€æ•ˆæœå¥½</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  â””â”€ è¾“å‡º:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      â”œâ”€ LoRA é€‚é…å™¨ (1-2MB) - ä¸­é—´äº§ç‰©</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      â”‚   â””â”€ adapter_model.safetensors</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      â”‚   â””â”€ é€šå¸¸è¢«ä¸‹ä¸€æ­¥è¦†ç›–æˆ–åˆ é™¤</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      â””â”€ å®Œæ•´åˆå¹¶æ¨¡å‹ (440MB) </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          â””â”€ merge_and_unload() è‡ªåŠ¨æ‰§è¡Œåˆå¹¶</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          â””â”€ Rust/Candle ç”¨</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              â””â”€ Go æœåŠ¡è°ƒç”¨</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                  â””â”€ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">æ ¸å¿ƒæµç¨‹: LoRA æ¨¡å‹è¢«è‡ªåŠ¨åˆå¹¶</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">LoRA è®­ç»ƒ â†’ merge_and_unload() â†’ model.safetensors â†’ Candle åŠ è½½ â†’ æ¨ç†</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="lora-å¾®è°ƒ">LoRA å¾®è°ƒ<a href="https://yuluo-yx.github.io/blog/vllm-sr-understand#lora-%E5%BE%AE%E8%B0%83" class="hash-link" aria-label="LoRA å¾®è°ƒçš„ç›´æ¥é“¾æ¥" title="LoRA å¾®è°ƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">W_new = W_pretrained + B Ã— A</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">#</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold">       â†‘              â†‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">#</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold">    å†»ç»“ä¸åŠ¨      åªè®­ç»ƒè¿™ä¸¤ä¸ªå°çŸ©é˜µ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">#</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> å‚æ•°å¯¹æ¯”ï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">#</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> å®Œæ•´å¾®è°ƒ: è®­ç»ƒ 110M å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">#</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> LoRA å¾®è°ƒ: è®­ç»ƒ 1.2M å‚æ•° (â†“ 99%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">#</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> æ•ˆæœï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">#</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> - é€Ÿåº¦å¿« 3-5 å€</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">#</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> - å†…å­˜çœ 67%</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token title important punctuation" style="color:hsl(119, 34%, 47%);font-weight:bold">#</span><span class="token title important" style="color:hsl(230, 8%, 24%);font-weight:bold"> - æ€§èƒ½å‡ ä¹ç›¸åŒ (99.5%)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="go">Go<a href="https://yuluo-yx.github.io/blog/vllm-sr-understand#go" class="hash-link" aria-label="Goçš„ç›´æ¥é“¾æ¥" title="Goçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>é›†æˆ Envoy ExtProc å¤„ç†è¾“å…¥æµé‡ï¼Œå¾€åè°ƒç”¨ candleã€‚æ”¯æŒä»»ä½•å…¼å®¹ OpenAI API çš„ llm åç«¯æœåŠ¡ã€‚</p>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚                         å®Œæ•´è¯·æ±‚å¤„ç†æµç¨‹                                 â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ç”¨æˆ·è¯·æ±‚: POST /v1/chat/completions</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  "model": "gpt-3.5-turbo",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  "messages": [{"role": "user", "content": "å¸®æˆ‘è§£è¿™é“å¾®ç§¯åˆ†é¢˜"}]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ 1ï¸âƒ£  Envoy Proxy (ç«¯å£ 8801)                                            â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    - æ¥æ”¶ HTTP è¯·æ±‚                                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    - æå–è¯·æ±‚å¤´å’Œè¯·æ±‚ä½“                                                â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â†“ gRPC è°ƒç”¨</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ 2ï¸âƒ£  ExtProc (Go æœåŠ¡, ç«¯å£ 50051)                                      â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    pkg/extproc/processor.go                                           â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚                                                                        â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    Process() å¤„ç†æµ:                                                   â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ RequestHeaders  â†’ handleRequestHeaders()                        â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ RequestBody     â†’ handleRequestBody() â­ ä¸»è¦å¤„ç†                â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ ResponseHeaders â†’ handleResponseHeaders()                       â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â””â”€ ResponseBody    â†’ handleResponseBody()                          â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ 3ï¸âƒ£  è¯·æ±‚ä½“å¤„ç†: handleRequestBody()                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    pkg/extproc/request_handler.go                                     â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚                                                                        â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    æ­¥éª¤:                                                               â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ 1. è§£æ OpenAI è¯·æ±‚ä½“                                           â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ 2. æå–ç”¨æˆ·æ¶ˆæ¯å†…å®¹                                             â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ 3. æ£€æŸ¥è¯­ä¹‰ç¼“å­˜ (å¯é€‰)                                          â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ 4. è°ƒç”¨åˆ†ç±»å™¨ â¬‡ï¸                                                â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ 5. è°ƒç”¨ PII æ£€æµ‹ â¬‡ï¸                                              â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ 6. è°ƒç”¨è¶Šç‹±æ£€æµ‹ â¬‡ï¸                                               â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â”œâ”€ 7. è·¯ç”±å†³ç­–                                                     â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚    â””â”€ 8. ä¿®æ”¹è¯·æ±‚å¤´/ä½“                                                â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â†“                        â†“                     â†“                 â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ 4ï¸âƒ£  æ„å›¾åˆ†ç±»      â”‚  â”‚ 5ï¸âƒ£  PII æ£€æµ‹      â”‚  â”‚ 6ï¸âƒ£  è¶Šç‹±æ£€æµ‹       â”‚  â”‚å·¥å…· â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ (Classifier)     â”‚  â”‚ (PIIChecker)     â”‚  â”‚ (PromptGuard)     â”‚  â”‚åŒ¹é… â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚                        â”‚                     â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â†“ Go è°ƒç”¨                â†“                     â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ candle_binding   â”‚  â”‚ candle_binding   â”‚  â”‚ candle_binding    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ (CGO)            â”‚  â”‚ (CGO)            â”‚  â”‚ (CGO)             â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚                        â”‚                     â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â†“ FFI è°ƒç”¨               â†“                     â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ Rust Candle      â”‚  â”‚ Rust Candle      â”‚  â”‚ Rust Candle       â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ Intent Model     â”‚  â”‚ PII Model        â”‚  â”‚ Jailbreak Model   â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”‚ (BERT æ¨ç†)      â”‚  â”‚ (Token åˆ†ç±»)     â”‚  â”‚ (BERT æ¨ç†)       â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚                        â”‚                     â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚ è¿”å›ç»“æœ                â”‚                     â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚ Category: "math"       â”‚ HasPII: false       â”‚ IsJailbreak: false</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚ Confidence: 0.95       â”‚ Confidence: 0.98    â”‚ Confidence: 0.92</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â”‚                        â”‚                     â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚ 7ï¸âƒ£  è·¯ç”±å†³ç­–å¼•æ“      â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚                      â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚ è§„åˆ™:                â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚ â”œâ”€ IsJailbreak?      â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚ â”‚   â””â”€ Block (403)   â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚ â”œâ”€ HasPII?           â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚ â”‚   â””â”€ Log + å¯é€‰é˜»æ­¢â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚ â””â”€ Category + Conf?  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚     â””â”€ Select Model  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ 8ï¸âƒ£  ä¿®æ”¹è¯·æ±‚                  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚                              â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ æ·»åŠ è¯·æ±‚å¤´:                   â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ - x-selected-model: math-7b  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ - x-category: mathematics    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ - x-confidence: 0.95         â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ - x-gateway-destination:     â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚   http://math-llm:8000       â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ 9ï¸âƒ£  è¿”å› gRPC å“åº”ç»™ Envoy   â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚                              â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ ProcessingResponse {         â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚   HeaderMutation,            â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚   BodyMutation,              â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚   Status: CONTINUE           â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ }                            â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ ğŸ”Ÿ  Envoy è·¯ç”±åˆ°åç«¯ vLLM     â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚                              â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ æ ¹æ® x-gateway-destination:  â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ http://math-llm:8000         â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚                              â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ è½¬å‘è¯·æ±‚åˆ°ä¸“ç”¨æ¨¡å‹            â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ 1ï¸âƒ£1ï¸âƒ£  vLLM åç«¯ (math-llm)    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚                              â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ æ¥æ”¶è¯·æ±‚å¹¶ç”Ÿæˆå›å¤            â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ Model: meta-llama/Llama-7b   â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                                    â†“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â”‚ 1ï¸âƒ£2ï¸âƒ£  å“åº”è¿”å›ç»™ç”¨æˆ·          â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç®€åŒ–å›¾</p>
<div class="language-markdown codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-markdown codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ç”¨æˆ·è¯·æ±‚ â†’ Envoy (8801) â†’ ExtProc (Go, 50051)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”‚               â”‚               â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                æ„å›¾åˆ†ç±»         PIIæ£€æµ‹         è¶Šç‹±æ£€æµ‹</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”‚               â”‚               â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   CGO             CGO             CGO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”‚               â”‚               â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                Rust Candle     Rust Candle     Rust Candle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”‚               â”‚               â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              Category: "math"  HasPII: false  IsJailbreak: false</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              Confidence: 0.95  Entities: []   Confidence: 0.92</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”‚               â”‚               â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                            è·¯ç”±å†³ç­–å¼•æ“</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”‚                               â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              IsJailbreak?                    Category?</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    â”‚                               â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                  Block                       Select Model</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                (403)                         (math-llama-7b)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        Set Header:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        x-gateway-destination:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        http://math-llm:8000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        Return to Envoy</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                    â”‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        Route to Backend</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        (math-llm:8000)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¯è§‚æµ‹">å¯è§‚æµ‹<a href="https://yuluo-yx.github.io/blog/vllm-sr-understand#%E5%8F%AF%E8%A7%82%E6%B5%8B" class="hash-link" aria-label="å¯è§‚æµ‹çš„ç›´æ¥é“¾æ¥" title="å¯è§‚æµ‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åŸºäº OT + Prometheus + Grafana + Jaeger ã€‚é€šè¿‡ <code>/metrics</code> å¯¼å‡ºè§‚æµ‹æ•°æ®ã€‚ÃŸ</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="config">Config<a href="https://yuluo-yx.github.io/blog/vllm-sr-understand#config" class="hash-link" aria-label="Configçš„ç›´æ¥é“¾æ¥" title="Configçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>VSR æä¾›äº†å……è¶³çš„é…ç½®é¡¹ï¼Œé…ç½®å„ä¸ªåŸºæœ¬å±æ€§ã€‚æœ‰ä¸‹é¢å‡ ç§ç±»å‹ï¼š</p>
</blockquote>
<p>bert æ¨¡å‹é…ç½®</p>
<p>åˆ†ç±»å™¨é…ç½®</p>
<ul>
<li>æ„å›¾åˆ†ç±»</li>
<li>PII æ£€æµ‹</li>
<li>è¶Šç‹±æ£€æµ‹</li>
</ul>
<p>æ¨ç†æ¨¡å¼é…ç½®</p>
<p>ç±»åˆ«æ¨¡å¼ä¸è¯„åˆ†</p>
<p>è¯­ä¹‰ç¼“å­˜é…ç½®</p>
<p>å¯è§‚æµ‹é…ç½®</p>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>Vllm</category>
            <category>Canlde</category>
            <category>Semantic router</category>
        </item>
        <item>
            <title><![CDATA[Vllm Semantic-router MoM æ¶æ„]]></title>
            <link>https://yuluo-yx.github.io/blog/vllm-sr-mom</link>
            <guid>https://yuluo-yx.github.io/blog/vllm-sr-mom</guid>
            <pubDate>Wed, 15 Oct 2025 23:09:44 GMT</pubDate>
            <description><![CDATA[åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆçœ‹ä¸¤ä¸ªé—®é¢˜ï¼Œä½œä¸ºæ–‡ç« å¼•å­ã€‚]]></description>
            <content:encoded><![CDATA[<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆçœ‹ä¸¤ä¸ªé—®é¢˜ï¼Œä½œä¸ºæ–‡ç« å¼•å­ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç¬¬ä¸€ä¸ªé—®é¢˜ä»€ä¹ˆæ˜¯è·¯ç”±å¤§æ¨¡å‹ä¸­è·¯ç”±çš„æ˜¯ä»€ä¹ˆ">ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šä»€ä¹ˆæ˜¯è·¯ç”±ï¼Œå¤§æ¨¡å‹ä¸­è·¯ç”±çš„æ˜¯ä»€ä¹ˆï¼Ÿ<a href="https://yuluo-yx.github.io/blog/vllm-sr-mom#%E7%AC%AC%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98%E4%BB%80%E4%B9%88%E6%98%AF%E8%B7%AF%E7%94%B1%E5%A4%A7%E6%A8%A1%E5%9E%8B%E4%B8%AD%E8%B7%AF%E7%94%B1%E7%9A%84%E6%98%AF%E4%BB%80%E4%B9%88" class="hash-link" aria-label="ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šä»€ä¹ˆæ˜¯è·¯ç”±ï¼Œå¤§æ¨¡å‹ä¸­è·¯ç”±çš„æ˜¯ä»€ä¹ˆï¼Ÿçš„ç›´æ¥é“¾æ¥" title="ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šä»€ä¹ˆæ˜¯è·¯ç”±ï¼Œå¤§æ¨¡å‹ä¸­è·¯ç”±çš„æ˜¯ä»€ä¹ˆï¼Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><strong>è·¯ç”±</strong>åœ¨ç»´åŸºç™¾ç§‘ä¸­çš„å®šä¹‰æ˜¯ï¼š<strong>è·¯ç”±</strong>ï¼ˆ<strong>routing</strong>ï¼‰æ˜¯ä»»ä½•ç½‘ç»œä¸­é€‰å–è·¯å¾„çš„ç¨‹åºï¼Œåœ¨æ­¤"ç¨‹åº"æ˜¯æŒ‡ä¸€ç»„åœ¨ç”µè„‘ä¸­æ‰§è¡Œçš„ç¨‹åºã€‚ä¸€èˆ¬ç”± Gateway æ‹…ä»»è·¯ç”±è§’è‰²ï¼Œå°†æµé‡é€šè¿‡ä¸€äº›ç‰¹å¾è·¯ç”±åˆ°æŒ‡å®šçš„åç«¯æœåŠ¡ã€‚</p>
<p>åœ¨å¤§æ¨¡å‹ä¸­ï¼Œå°†è‡ªç„¶è¯­è¨€ä»»åŠ¡äº¤ç»™æ›´é€‚åˆçš„â€œæ¨¡å‹â€æ¥å®Œæˆä¾¿æ˜¯å¤§æ¨¡å‹è·¯ç”±ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç¬¬äºŒä¸ªé—®é¢˜å¤§æ¨¡å‹è·¯ç”±å¯ä»¥åšä»€ä¹ˆ">ç¬¬äºŒä¸ªé—®é¢˜ï¼šå¤§æ¨¡å‹è·¯ç”±å¯ä»¥åšä»€ä¹ˆï¼Ÿ<a href="https://yuluo-yx.github.io/blog/vllm-sr-mom#%E7%AC%AC%E4%BA%8C%E4%B8%AA%E9%97%AE%E9%A2%98%E5%A4%A7%E6%A8%A1%E5%9E%8B%E8%B7%AF%E7%94%B1%E5%8F%AF%E4%BB%A5%E5%81%9A%E4%BB%80%E4%B9%88" class="hash-link" aria-label="ç¬¬äºŒä¸ªé—®é¢˜ï¼šå¤§æ¨¡å‹è·¯ç”±å¯ä»¥åšä»€ä¹ˆï¼Ÿçš„ç›´æ¥é“¾æ¥" title="ç¬¬äºŒä¸ªé—®é¢˜ï¼šå¤§æ¨¡å‹è·¯ç”±å¯ä»¥åšä»€ä¹ˆï¼Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>è®¾æƒ³ä»¥ä¸‹å†…å®¹ï¼šæˆ‘çš„é—®é¢˜æ˜¯å¸®æˆ‘è®¡ç®—ä¸€ä¸ªæ•°å­¦é—®é¢˜ï¼š2x^2âˆ’4xâˆ’6=0 çš„è§£æ˜¯ä»€ä¹ˆï¼Ÿä¼—æ‰€å‘¨çŸ¥ï¼Œæ•°å­¦ä¸èƒ½åªçœ‹ç­”æ¡ˆï¼Œç†è§£æ€ä¹ˆå¾—å‡ºç»“æœçš„è¿‡ç¨‹æ‰æ˜¯æœ€é‡è¦çš„ã€‚é‚£æˆ‘å°±éœ€è¦å¤§æ¨¡å‹å¼€å¯ CoTï¼ˆChain-Of-Thoughtï¼‰æ·±åº¦æ€è€ƒæ¥è¯´æ˜æ˜¯æ€ä¹ˆå¾—å‡ºè§£ã€‚ç°åœ¨æˆ‘çš„é—®é¢˜æ¢æˆäº†ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿè¿™å¯¹æ¨¡å‹æ¥è¯´æ˜¯ç®€å•é—®é¢˜ï¼Œåªéœ€è¦ä¸€æ¬¡å·¥å…·è°ƒç”¨å³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p>
<p>å¯¹äºé—®é¢˜ä¸€ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯ DeepSeek-R1 æ¨¡å‹ï¼Œè‡ªå¸¦ CoT è¾“å‡ºï¼Œæ•ˆæœæ˜¯æœ€å¥½çš„ã€‚å¦‚æœæ˜¯ä¸å¸¦ CoT çš„è¾“å‡ºï¼Œåªç»™ä¸€ä¸ªç­”æ¡ˆï¼Œä¸ç¬¦åˆå®é™…ã€‚å¦‚æœæ˜¯å¤æ‚çš„æ•°å­¦é¢˜ï¼Œæˆ‘ä»¬é€‰æ‹©æ›´å‰å®³ã€æ›´è´µçš„ GPT5 æ¨¡å‹ï¼Œç®€å•çš„é—®é¢˜é€‰æ‹© GPT3 æ¨¡å‹ï¼ŒèŠ‚çº¦æˆæœ¬ã€‚</p>
<p>å¯¹äºé—®é¢˜äºŒï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯ DeepSeek-R1 æ¨¡å‹ï¼Œè°ƒç”¨å¤©æ°”å·¥å…·ï¼Œè¿˜è¦è¾“å‡º reasoning contentï¼Œå¤šæ­¤ä¸€ä¸¾è¿˜æµªè´¹ Tokenã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å°†é—®é¢˜æ”¾å¤§åˆ°ç”¨æˆ·è‡ªç„¶è¯­è¨€çš„è¾“å…¥ä¸Šï¼Œé¢å¯¹å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼ŒèŠ±è´¹æœ€å°‘çš„ Tokenã€æœ€å°‘çš„ç®—åŠ›æ¥è§£å†³ç”¨æˆ·çš„é—®é¢˜ï¼Œä¾¿æ˜¯æ¨¡å‹è·¯ç”±è¦è§£å†³çš„é—®é¢˜ã€‚</p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“äº†æ¨¡å‹è·¯ç”±æ˜¯ä»€ä¹ˆä»¥åŠéœ€è¦è§£å†³çš„é—®é¢˜ä¹‹åã€‚</p>
<p>åœ¨æ¥ç€å¾€ä¸‹ï¼Œè®¨è®ºå…³äºæ¨¡å‹è·¯ç”±çš„è§£å†³æ–¹æ¡ˆã€‚æ–‡ç« ä¸­å°†ä¼šä»‹ç»ä¸¤ç±»æ¨¡å‹è·¯ç”±æ–¹æ¡ˆï¼š MoE å’Œ Vllm SR æå‡ºæ¥çš„çš„ MoM æ¶æ„æ–¹æ¡ˆã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-mixture-of-expert-moe-æ¶æ„">1. Mixture-of-Expert (MoE) æ¶æ„<a href="https://yuluo-yx.github.io/blog/vllm-sr-mom#1-mixture-of-expert-moe-%E6%9E%B6%E6%9E%84" class="hash-link" aria-label="1. Mixture-of-Expert (MoE) æ¶æ„çš„ç›´æ¥é“¾æ¥" title="1. Mixture-of-Expert (MoE) æ¶æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><strong>æ··åˆä¸“å®¶</strong>ï¼ˆMixture-of-Expertsï¼Œç®€ç§° MoEï¼‰ã€‚</p>
<p>MOE æ¶æ„çš„åŸºæœ¬æ€æƒ³æ˜¯åœ¨ä¼ ç»Ÿ Transformer æ¨¡å‹ä¸­ï¼Œå°†æ¯ä¸ªå‰é¦ˆç½‘ç»œï¼ˆFFNï¼‰å±‚æ›¿æ¢ä¸ºä¸€ä¸ª MoE å±‚ã€‚ä¸€ä¸ª MOE å±‚é€šå¸¸ç”±ä¸¤ä¸ªå…³é”®éƒ¨åˆ†ç»„æˆï¼š</p>
<p><img decoding="async" loading="lazy" alt="MoE" src="https://yuluo-yx.github.io/assets/images/1-fd4dec9a53ef8eec07f924d15b5515d1.png" width="918" height="429" class="img_c29J"></p>
<ul>
<li><strong>ä¸“å®¶ç½‘ç»œï¼ˆExpertsï¼‰</strong>
æ¯ä¸ªä¸“å®¶æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å­ç½‘ç»œï¼ˆé€šå¸¸æ˜¯ FFNï¼‰ï¼Œåœ¨å®é™…è®¡ç®—ä¸­åªæœ‰éƒ¨åˆ†ä¸“å®¶ä¼šè¢«æ¿€æ´»å¹¶å‚ä¸å¤„ç†ã€‚é€šè¿‡è®©å¤šä¸ªä¸“å®¶åˆ†æ‹…ä¸åŒæ•°æ®å­é›†è®¡ç®—çš„æ–¹å¼ï¼Œæ¨¡å‹åœ¨é¢„è®­ç»ƒæ—¶å¯ä»¥ä»¥è¾ƒä½çš„ç®—åŠ›å¼€é”€è·å¾—å¤§å‚æ•°é‡å¸¦æ¥çš„æ¶Œç°èƒ½åŠ›â€‹ã€‚</li>
<li><strong>é—¨æ§ç½‘ç»œï¼ˆGating/Routerï¼‰</strong>
è´Ÿè´£æ ¹æ®è¾“å…¥çš„ Token ç‰¹å¾åŠ¨æ€é€‰æ‹©æ¿€æ´»å“ªäº›ä¸“å®¶ã€‚é—¨æ§ç½‘ç»œä¸€èˆ¬é‡‡ç”¨ä¸€ä¸ªå¸¦ softmax çš„ç®€å•å‰é¦ˆç½‘ç»œæ¥è®¡ç®—æ¯ä¸ªä¸“å®¶çš„æƒé‡ã€‚ç»è¿‡è®­ç»ƒåï¼Œé—¨æ§ç½‘ç»œä¼šé€æ­¥å­¦ä¼šå°†ç›¸ä¼¼çš„è¾“å…¥è·¯ç”±åˆ°è¡¨ç°æ›´å¥½çš„ä¸“å®¶â€‹ã€‚</li>
</ul>
<p>åœ¨ DeepSeekâ€‘V3 ç­‰ MOE å¤§æ¨¡å‹ä¸­ï¼Œé€šè¿‡å°† FFN å±‚æ›¿æ¢ä¸º MOE å±‚ï¼Œåœ¨æ‹¥æœ‰æµ·é‡å‚æ•°çš„åŒæ—¶ï¼Œå…¶å®é™…è®¡ç®—é‡å´ä¸ä¼ ç»Ÿç¨ å¯†æ¨¡å‹ç›¸å½“ï¼Œå®ç°äº†é«˜æ•ˆé¢„è®­ç»ƒå’Œå¿«é€Ÿæ¨ç†ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="11-å·¥ä½œåŸç†">1.1 å·¥ä½œåŸç†<a href="https://yuluo-yx.github.io/blog/vllm-sr-mom#11-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" class="hash-link" aria-label="1.1 å·¥ä½œåŸç†çš„ç›´æ¥é“¾æ¥" title="1.1 å·¥ä½œåŸç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å½“ä¸€ä¸ª Token çš„è¡¨ç¤ºä¼ å…¥ MoE å±‚æ—¶ï¼Œé¦–å…ˆä¼šç»è¿‡ Gate ç½‘ç»œï¼Œè¯¥ç½‘ç»œè´Ÿè´£è®¡ç®— token ä¸å„ä¸ªè·¯ç”±ä¸“å®¶ä¹‹é—´çš„åŒ¹é…å¾—åˆ†ã€‚å…·ä½“æµç¨‹æ˜¯ï¼š</p>
<ol>
<li><strong>è®¡ç®—åŒ¹é…å¾—åˆ†</strong>
Gate ç½‘ç»œé€šè¿‡çº¿æ€§å˜æ¢è®¡ç®—æ¯ä¸ª token ä¸æ‰€æœ‰è·¯ç”±ä¸“å®¶çš„å…¼å®¹æ€§å¾—åˆ†ã€‚å¾—åˆ†åæ˜ äº† token ä¸å„ä¸“å®¶â€œå¥‘åˆâ€çš„ç¨‹åº¦ã€‚</li>
<li><strong>é€‰æ‹© Top-K ä¸“å®¶</strong>
åŸºäºå¾—åˆ†ï¼ŒGate ç½‘ç»œä¸ºæ¯ä¸ª token é€‰æ‹© Top-K ä¸ªæœ€åˆé€‚çš„è·¯ç”±ä¸“å®¶ã€‚åœ¨ DeepSeekâ€V3 ä¸­ï¼Œæ¯ä¸ª token é€šå¸¸é€‰æ‹© 8 ä¸ªè·¯ç”±ä¸“å®¶ï¼ˆåœ¨ä¸€äº›å®ç°ä¸­è¿˜å¯èƒ½å¯¹è·¨èŠ‚ç‚¹è·¯ç”±åšé™åˆ¶ï¼Œå¦‚æœ€å¤šè·¯ç”±åˆ° 4 ä¸ªä¸åŒèŠ‚ç‚¹ï¼‰ï¼Œä»è€Œåªæ¿€æ´»æå°‘æ•°ä¸“å®¶è¿›è¡Œè®¡ç®—ï¼Œä½¿ç”¨æ›´å°‘å‚æ•°å’Œç®—åŠ›è§£å†³é—®é¢˜ã€‚</li>
<li><strong>ä¸“å®¶å¤„ç†ä¸åŠ æƒèšåˆ</strong>
è¢«é€‰ä¸­çš„ä¸“å®¶å„è‡ªå¯¹ token è¿›è¡Œç‹¬ç«‹å¤„ç†ï¼ˆä¸€èˆ¬é‡‡ç”¨ä¸€ä¸ªè½»é‡çº§çš„å‰é¦ˆç½‘ç»œï¼Œç±»ä¼¼äº Transformer ä¸­çš„ FFN æ¨¡å—ï¼‰ï¼Œäº§ç”Ÿå„è‡ªçš„è¾“å‡ºã€‚æœ€ç»ˆï¼Œè¿™äº›ä¸“å®¶çš„è¾“å‡ºä¼šæ ¹æ® Gate ç½‘ç»œç»™å‡ºçš„æƒé‡è¿›è¡ŒåŠ æƒèšåˆï¼Œå†ä¸å…±äº«ä¸“å®¶çš„è¾“å‡ºè¿›è¡Œèåˆï¼Œå½¢æˆå½“å‰ MoE å±‚çš„æœ€ç»ˆè¾“å‡ºè¡¨ç¤ºã€‚</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="12-ç®€å•ç†è§£">1.2 ç®€å•ç†è§£<a href="https://yuluo-yx.github.io/blog/vllm-sr-mom#12-%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3" class="hash-link" aria-label="1.2 ç®€å•ç†è§£çš„ç›´æ¥é“¾æ¥" title="1.2 ç®€å•ç†è§£çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨ä¸€ä¸ªè¶…å¤§çš„æ¨¡å‹é‡Œï¼Œæ”¾å¾ˆå¤šâ€œä¸“å®¶â€å­ç½‘ç»œï¼ŒToken è¾“å…¥è¿›æ¥ä¹‹åï¼Œrouter æ ¹æ® embedding è®¡ç®—åˆ†æ•°ï¼Œé€‰ top-k ä¸ªä¸“å®¶ï¼Œæ¿€æ´»å‚æ•°è¿›è¡Œæ¨ç†å¹¶å¾—å‡ºç»“æœã€‚ç†è®ºä¸Šï¼Œæ—¢èƒ½æ‰©å¤§å®¹é‡ï¼Œåˆèƒ½èŠ‚çœæ¨ç†å¼€é”€ã€‚</p>
<p><strong>ç”±æ­¤å¯ä»¥çœ‹åˆ°æ˜¾è€Œæ˜“è§çš„ç¼ºç‚¹ï¼šæ ¹æ® Token æ‰“åˆ†ï¼Œå¹¶æ²¡æœ‰çœŸæ­£ç†è§£ä¸Šä¸‹æ–‡è¯­ä¹‰ï¼Œä¹Ÿä¸çœŸæ­£å…³å¿ƒæ•´ä¸ªä»»åŠ¡ç›®æ ‡ã€‚æœ€ç»ˆé€‰æ‹©çš„ä¸“å®¶å¯èƒ½å¯¹å½“å‰çš„ç”¨æˆ·é—®é¢˜æ²¡æœ‰ä»»ä½•ç”¨æˆ·ï¼Œåªæ˜¯åˆ†æ•°æ¥è¿‘ã€‚</strong></p>
<p>å…³äº LLM Tokenï¼Œå‚è€ƒ <a href="https://yuluo-yx.github.io/docs/LLMs-AI-llms-what-token%E3%80%82" target="_blank" rel="noopener noreferrer">https://yuluo-yx.github.io/docs/LLMs-AI-llms-what-tokenã€‚</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-mixture-of-models-mom-æ¶æ„">2. Mixture of Models (MoM) æ¶æ„<a href="https://yuluo-yx.github.io/blog/vllm-sr-mom#2-mixture-of-models-mom-%E6%9E%B6%E6%9E%84" class="hash-link" aria-label="2. Mixture of Models (MoM) æ¶æ„çš„ç›´æ¥é“¾æ¥" title="2. Mixture of Models (MoM) æ¶æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><strong>æ··åˆæ¨¡å‹</strong> ï¼ˆMixture-of-Modelsï¼Œç®€ç§° MoMï¼‰ã€‚</p>
<p>äº†è§£äº†ä»€ä¹ˆæ˜¯ MoE æ¶æ„ï¼Œæ¥ä¸‹æ¥å†çœ‹çœ‹ MoM æ¶æ„ã€‚å’Œ MoE ä¸åŒçš„æ˜¯ï¼ŒMoM æ›´å¼ºè°ƒè¯­ä¹‰æ¦‚å¿µï¼Œé€šè¿‡ç†è§£è¯­ä¹‰ï¼Œç†æ¸…é—®é¢˜ï¼Œä¹‹åå†äº¤ç”±å…·ä½“çš„ experts å¤„ç†ã€‚</p>
<p>ä¸å†æ ¹æ®è¾“å…¥çš„ Token å»è®¡ç®—å¾—åˆ†å†³å®šç”±å“ªäº›ä¸“å®¶è§£å†³é—®é¢˜ï¼Œè€Œæ˜¯å½“ä¸€æ¡å®Œæ•´è¯·æ±‚è¿›æ¥æ—¶ï¼Œå…ˆç”¨ä¸€ä¸ªè½»é‡çš„è¯­ä¹‰ç¼–ç å™¨åšè¯­ä¹‰åˆ¤åˆ«ï¼Œç†è§£æ¸…æ¥šè¯·æ±‚è¯­ä¹‰ï¼Œç„¶åä¸€æ¬¡æ€§å†³å®šè¿™æ¡è¯·æ±‚è¯¥äº¤ç»™å“ªä¸€ä¸ªæ¨¡å‹æˆ–æ¨¡å‹ç»„åˆæ¥å¤„ç†ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ <strong>MoMï¼ˆMixture of Modelsï¼‰</strong>ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-semantic-router">3. Semantic Router<a href="https://yuluo-yx.github.io/blog/vllm-sr-mom#3-semantic-router" class="hash-link" aria-label="3. Semantic Routerçš„ç›´æ¥é“¾æ¥" title="3. Semantic Routerçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¯¹äºå¤§æ¨¡å‹æ¥è¯´ï¼Œç”¨æˆ·è¾“å…¥çš„ Prompt å¯èƒ½ä¼šæœ‰å¤šä¸ªç­”æ¡ˆè¾“å‡ºï¼Œå¹¶ä¸æ˜¯åƒä¼ ç»Ÿçš„è·¯ç”±æœåŠ¡ï¼Œè·¯ç”±åˆ°ä¸€ä¸ªç¡®å®šçš„ backendã€‚ç›¸åŒçš„æ¨¡å‹é¢å¯¹ç›¸åŒçš„ Prompt éƒ½ä¼šæœ‰ä¸åŒçš„è¾“å‡ºï¼Œæ‰€ä»¥æ˜¯ä¸å¯æ§çš„ã€‚</p>
<p>æ‰€ä»¥è¯­ä¹‰æ„ŸçŸ¥çš„è·¯ç”±ï¼šsleeè®© router ä¸åªæ˜¯è¦åˆ†é…â€œå“ªä¸ªæœºå™¨æ¥ç®—â€ï¼Œè€Œæ˜¯è¦ç†è§£â€œç”¨æˆ·åˆ°åº•æƒ³å¹²ä»€ä¹ˆâ€ï¼Œå†å†³å®šâ€œå“ªä¸ªæ¨¡å‹æœ€åˆé€‚</p>
<p>ä¸‹å›¾ä¸º Vllm SR çš„æ ¸å¿ƒæ¶æ„ï¼š</p>
<p><img decoding="async" loading="lazy" alt="Vllm SR MoM" src="https://yuluo-yx.github.io/assets/images/2-d82c8db20a2548352f67777c38d8d96b.png" width="1232" height="721" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3--å‚è€ƒé“¾æ¥">3.  å‚è€ƒé“¾æ¥<a href="https://yuluo-yx.github.io/blog/vllm-sr-mom#3--%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5" class="hash-link" aria-label="3.  å‚è€ƒé“¾æ¥çš„ç›´æ¥é“¾æ¥" title="3.  å‚è€ƒé“¾æ¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>Vllm SRï¼š<a href="https://github.com/vllm-project/" target="_blank" rel="noopener noreferrer">https://github.com/vllm-project/</a></li>
<li>MOE ï¼ˆMixture of Expertsï¼‰æ¶æ„ï¼š<a href="https://huggingface.co/blog/zh/moe" target="_blank" rel="noopener noreferrer">https://huggingface.co/blog/zh/moe</a></li>
<li>MOM ï¼ˆMixture of modelsï¼‰æ¶æ„ï¼š<a href="https://x.com/shao__meng/status/1811187309116895402" target="_blank" rel="noopener noreferrer">https://x.com/shao__meng/status/1811187309116895402</a></li>
<li>è¯­ä¹‰è·¯ç”±ï¼š<a href="https://thenewstack.io/semantic-router-and-its-role-in-designing-agentic-workflows/" target="_blank" rel="noopener noreferrer">https://thenewstack.io/semantic-router-and-its-role-in-designing-agentic-workflows/</a></li>
<li><a href="https://github.com/katanemo/archgw/tree/main/demos/use_cases/claude_code_router" target="_blank" rel="noopener noreferrer">https://github.com/katanemo/archgw/tree/main/demos/use_cases/claude_code_router</a></li>
<li><a href="https://arxiv.org/abs/2406.18665" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/2406.18665</a></li>
<li><a href="https://arxiv.org/abs/2506.16655" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/2506.16655</a></li>
<li><a href="https://mp.weixin.qq.com/s/S6un8mBPE53HlpYrgNs6Nw" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/s/S6un8mBPE53HlpYrgNs6Nw</a></li>
<li>Transformer æ¨¡å‹ï¼š <a href="https://zhuanlan.zhihu.com/p/338817680" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/338817680</a></li>
</ol>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>VLLM</category>
            <category>MoM</category>
            <category>AI</category>
        </item>
        <item>
            <title><![CDATA[å¼‚æ„æœåŠ¡é“¾è·¯è¿½è¸ª]]></title>
            <link>https://yuluo-yx.github.io/blog/trace-transfer</link>
            <guid>https://yuluo-yx.github.io/blog/trace-transfer</guid>
            <pubDate>Sun, 14 Sep 2025 20:49:08 GMT</pubDate>
            <description><![CDATA[æ–‡ä¸­ä½¿ç”¨çš„æ¡†æ¶å’ŒæœåŠ¡ï¼š]]></description>
            <content:encoded><![CDATA[<p>æ–‡ä¸­ä½¿ç”¨çš„æ¡†æ¶å’ŒæœåŠ¡ï¼š</p>
<p>ç½‘å…³ï¼šSpring Cloud Gateway</p>
<p>æœåŠ¡ä¸Šæ¸¸ï¼šSpring Boot 3.5.1 Spring Cloud 2025.0.0.0ï¼ˆJavaï¼‰</p>
<p>æœåŠ¡ä¸‹æ¸¸ï¼šKratos 2.8.0ï¼ˆGoï¼‰</p>
<p>é“¾è·¯è¿½è¸ªå·¥å…·ï¼šZipkin</p>
<p>Demo åœ°å€ï¼š<a href="https://github.com/deigmata-paideias/deigmata-paideias/trace-transfer" target="_blank" rel="noopener noreferrer">https://github.com/deigmata-paideias/deigmata-paideias/trace-transfer</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="zipkin-å¯åŠ¨">Zipkin å¯åŠ¨<a href="https://yuluo-yx.github.io/blog/trace-transfer#zipkin-%E5%90%AF%E5%8A%A8" class="hash-link" aria-label="Zipkin å¯åŠ¨çš„ç›´æ¥é“¾æ¥" title="Zipkin å¯åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">services</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">zipkin</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">image</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'openzipkin/zipkin:latest'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">container_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"spring-ai-alibaba-zipkin"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ports</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'9411:9411'</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>docker compose up -d</code> æµè§ˆå™¨è®¿é—® 9411.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å…³é”®æ€§é…ç½®">å…³é”®æ€§é…ç½®<a href="https://yuluo-yx.github.io/blog/trace-transfer#%E5%85%B3%E9%94%AE%E6%80%A7%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="å…³é”®æ€§é…ç½®çš„ç›´æ¥é“¾æ¥" title="å…³é”®æ€§é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="scg">SCG<a href="https://yuluo-yx.github.io/blog/trace-transfer#scg" class="hash-link" aria-label="SCGçš„ç›´æ¥é“¾æ¥" title="SCGçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>pom.xml</p>
<blockquote>
<p>tracing ç»„ä»¶</p>
</blockquote>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">io.micrometer</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">micrometer-tracing</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">io.micrometer</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">micrometer-tracing-bridge-brave</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">io.zipkin.reporter2</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">zipkin-reporter-brave</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Gateway</p>
</blockquote>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-webflux</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring Cloud Gateway --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-cloud-starter-gateway-server-webflux</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>application.yml</p>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">management</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">endpoints</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">web</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">exposure</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">include</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'*'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">endpoint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">health</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">show-details</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ALWAYS</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">logfile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">external-file</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> ./logs/$</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">spring.application.name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain">/console.log</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">tracing</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">enabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">sampling.probability</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">propagation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">type</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> w3c</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">zipkin</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">tracing</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">endpoint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">9411/api/v2/spans</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="user-service">user-service<a href="https://yuluo-yx.github.io/blog/trace-transfer#user-service" class="hash-link" aria-label="user-serviceçš„ç›´æ¥é“¾æ¥" title="user-serviceçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>pom.xml å’Œ application.yml ç›¸åŒã€‚</p>
<p>pom å·®å¼‚ï¼š</p>
<blockquote>
<p>openfeign è¿œç¨‹è°ƒç”¨</p>
</blockquote>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-cloud-starter-openfeign</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>FeignB3HeaderInterceptorConfig.java</p>
<blockquote>
<p>å¦‚æœä¸é…ç½®æ­¤è¯·æ±‚æ‹¦æˆªï¼Œopenfeign åœ¨ rpc è°ƒç”¨æ—¶ä¸ä¼šè‡ªåŠ¨é€ä¼ è¯·æ±‚å¤´ã€‚</p>
</blockquote>
<div class="language-javascript codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-javascript codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@</span><span class="token maybe-class-name">Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FeignB3HeaderInterceptorConfig</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @</span><span class="token maybe-class-name">Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token maybe-class-name">RequestInterceptor</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">b3HeaderInterceptor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> template </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token maybe-class-name">ServletRequestAttributes</span><span class="token plain"> attrs </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token maybe-class-name">ServletRequestAttributes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token maybe-class-name">RequestContextHolder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">getRequestAttributes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">attrs </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token maybe-class-name">HttpServletRequest</span><span class="token plain"> request </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> attrs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">getRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> b3 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">getHeader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"traceparent"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">b3 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    template</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">header</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"traceparent"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> b3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>OpenFeign Client</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@FeignClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">name </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"kratos-user-svc"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> url </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"http://localhost:8000"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">UserAPI</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">value </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/api/v1/user/{id}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">User</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getUser</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@PathVariable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"id"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸»ç±»æ·»åŠ  <code>@EnableFeignClients</code> æ³¨è§£ï¼Œå¼€å¯ FeignClientã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="kratos">Kratos<a href="https://yuluo-yx.github.io/blog/trace-transfer#kratos" class="hash-link" aria-label="Kratosçš„ç›´æ¥é“¾æ¥" title="Kratosçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>main.go</p>
<blockquote>
<p>Zipkin Init.</p>
</blockquote>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">zipkinTrace</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    exporter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">_</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> zipkin</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">New</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"http://localhost:9411/api/v2/spans"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    otel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">SetTracerProvider</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">trace</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">NewTracerProvider</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       trace</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">WithBatcher</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">exporter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       trace</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">WithSampler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">trace</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">AlwaysSample</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>zipkingTrace</strong>  å‡½æ•°æ”¾åœ¨ wireApp ä¹‹å‰ã€‚å¦åˆ™ä¼šå¯¼è‡´ trace å¤±è´¥ï¼Ÿ</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="zipkin-trace-æˆªå›¾">Zipkin trace æˆªå›¾<a href="https://yuluo-yx.github.io/blog/trace-transfer#zipkin-trace-%E6%88%AA%E5%9B%BE" class="hash-link" aria-label="Zipkin trace æˆªå›¾çš„ç›´æ¥é“¾æ¥" title="Zipkin trace æˆªå›¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><img decoding="async" loading="lazy" alt="image-20250914200501689" src="https://yuluo-yx.github.io/assets/images/trace-c5ab29a07e69b1392dd84487af4dc2d9.png" width="2537" height="560" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å…¶ä»–é—®é¢˜">å…¶ä»–é—®é¢˜<a href="https://yuluo-yx.github.io/blog/trace-transfer#%E5%85%B6%E4%BB%96%E9%97%AE%E9%A2%98" class="hash-link" aria-label="å…¶ä»–é—®é¢˜çš„ç›´æ¥é“¾æ¥" title="å…¶ä»–é—®é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>
<p><code>tracing.propagation.type: w3c</code> è¦å†™ <code>w3c</code> ï¼Œ<code>b3</code> ä¼šå¯¼è‡´è¯·æ±‚å¤´ä¼ é€’å¤±è´¥ï¼Œä¸²è”ä¸èµ·æ¥é“¾è·¯ï¼Ÿ</p>
<p>è¿™å¯èƒ½å’Œä¸‹é¢ä»£ç æœ‰å…³ï¼Œåˆå§‹åŒ–æˆ zipkin b3.</p>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">otel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">SetTracerProvider</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">trace</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">NewTracerProvider</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  trace</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">WithBatcher</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">exporter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  trace</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">WithSampler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">trace</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">AlwaysSample</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>OpenFeign å¿…é¡»è¦æ‰‹åŠ¨è½¬å‘ <code>tracing</code> headerï¼Ÿ</p>
</li>
<li>
<p>kratos http &amp; grpc ä¸­é—´ä»¶æ·»åŠ  <code>tracing.Server()</code>ï¼Ÿ</p>
</li>
</ol>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>Java</category>
            <category>Go</category>
            <category>Trace</category>
            <category>Heterogeneous</category>
        </item>
        <item>
            <title><![CDATA[go style]]></title>
            <link>https://yuluo-yx.github.io/blog/go-style</link>
            <guid>https://yuluo-yx.github.io/blog/go-style</guid>
            <pubDate>Sun, 07 Sep 2025 22:11:49 GMT</pubDate>
            <description><![CDATA[ä¸ªäººæ•´ç†çš„ä¸€äº›ä¸œè¥¿ styleï¼Œä½œä¸ºå‚è€ƒã€‚]]></description>
            <content:encoded><![CDATA[<p>ä¸ªäººæ•´ç†çš„ä¸€äº›ä¸œè¥¿ styleï¼Œä½œä¸ºå‚è€ƒã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="golang-ä»£ç -ç¼–ç¨‹è§„èŒƒ">Golang ä»£ç  ç¼–ç¨‹è§„èŒƒ<a href="https://yuluo-yx.github.io/blog/go-style#golang-%E4%BB%A3%E7%A0%81-%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83" class="hash-link" aria-label="Golang ä»£ç  ç¼–ç¨‹è§„èŒƒçš„ç›´æ¥é“¾æ¥" title="Golang ä»£ç  ç¼–ç¨‹è§„èŒƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Go ä»£ç åº”è¯¥ä»¥æœ€ç®€å•çš„æ–¹å¼ç¼–å†™ï¼Œä»¥å®ç°å…¶ç›®æ ‡ï¼Œæ— è®ºæ˜¯åœ¨è¡Œä¸ºè¿˜æ˜¯æ€§èƒ½æ–¹é¢ã€‚åœ¨ Google Go ä»£ç åº“ä¸­ï¼Œç®€å•ä»£ç ï¼š</p>
<ul>
<li>ä»ä¸Šåˆ°ä¸‹éƒ½æ˜“äºé˜…è¯»ï¼›</li>
<li>ä¸å‡è®¾ä½ å·²ç»çŸ¥é“å®ƒåœ¨åšä»€ä¹ˆï¼›</li>
<li>ä¸å‡è®¾ä½ å¯ä»¥è®°ä½æ‰€æœ‰å‰é¢çš„ä»£ç ï¼›</li>
<li>æ²¡æœ‰ä¸å¿…è¦çš„æŠ½è±¡å±‚æ¬¡ï¼›</li>
<li>æ²¡æœ‰èƒ½å¼•èµ·å…³æ³¨çš„ä¸–ä¿—åç§°ï¼›</li>
<li>è®©å¼€å‘è€…æ¸…æ¥šåœ°äº†è§£ä»·å€¼è§‚å’Œå†³ç­–çš„ä¼ æ’­ï¼›</li>
<li>æœ‰æ³¨é‡Šè§£é‡Šä»£ç ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Œè€Œä¸æ˜¯åšä»€ä¹ˆï¼Œä»¥é¿å…å°†æ¥å‡ºç°åå·®ï¼›</li>
<li>æœ‰ç‹¬ç«‹çš„æ–‡æ¡£ï¼›</li>
<li>æœ‰ æœ‰ç”¨çš„é”™è¯¯å’Œæœ‰ç”¨çš„å¤±è´¥æµ‹è¯•ï¼›</li>
<li>å¯èƒ½ç»å¸¸ä¸â€œèªæ˜â€çš„ä»£ç äº’ç›¸æ’æ–¥ã€‚</li>
</ul>
<p>å‚è€ƒæŒ‡å—ï¼š</p>
<ul>
<li>
<p><strong><a href="https://google.github.io/styleguide/go/best-practices" target="_blank" rel="noopener noreferrer">https://google.github.io/styleguide/go/best-practices</a></strong></p>
</li>
<li>
<p><strong><a href="https://go.dev/wiki/CodeReviewComments" target="_blank" rel="noopener noreferrer">https://go.dev/wiki/CodeReviewComments</a></strong></p>
</li>
<li>
<p><a href="https://google.github.io/styleguide/go/" target="_blank" rel="noopener noreferrer">https://google.github.io/styleguide/go/</a></p>
</li>
<li>
<p><a href="https://go.dev/doc/effective_go" target="_blank" rel="noopener noreferrer">https://go.dev/doc/effective_go</a></p>
</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-gofmt-ç»Ÿä¸€ä»£ç æ ¼å¼">1. gofmt ç»Ÿä¸€ä»£ç æ ¼å¼<a href="https://yuluo-yx.github.io/blog/go-style#1-gofmt-%E7%BB%9F%E4%B8%80%E4%BB%A3%E7%A0%81%E6%A0%BC%E5%BC%8F" class="hash-link" aria-label="1. gofmt ç»Ÿä¸€ä»£ç æ ¼å¼çš„ç›´æ¥é“¾æ¥" title="1. gofmt ç»Ÿä¸€ä»£ç æ ¼å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æ‰§è¡Œ <code>go fmt ./... </code>æ¥ç»Ÿä¸€ä»£ç æ ¼å¼ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-æ³¨é‡Šè¯´æ˜å¢å¼º">2. æ³¨é‡Šè¯´æ˜å¢å¼º<a href="https://yuluo-yx.github.io/blog/go-style#2-%E6%B3%A8%E9%87%8A%E8%AF%B4%E6%98%8E%E5%A2%9E%E5%BC%BA" class="hash-link" aria-label="2. æ³¨é‡Šè¯´æ˜å¢å¼ºçš„ç›´æ¥é“¾æ¥" title="2. æ³¨é‡Šè¯´æ˜å¢å¼ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åœ¨ä¼šå¼•å‘æ­§ä¹‰æˆ–è€…å’Œä¸Šæ–‡åˆ¤æ–­ä¸åŒæ—¶ä½¿ç”¨æ³¨é‡Šä»¥æé†’å¼€å‘è€…ã€‚</p>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">if err := doSomething(); err != nil {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">if err := doSomething(); err == nil { // if NO error</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-æ³¨é‡Šåº”è¯¥è¯´æ˜çš„æ˜¯ä¸ºä»€ä¹ˆè€Œä¸æ˜¯åšä»€ä¹ˆ">3. æ³¨é‡Šåº”è¯¥è¯´æ˜çš„æ˜¯â€ä¸ºä»€ä¹ˆâ€œï¼Œè€Œä¸æ˜¯â€åšä»€ä¹ˆâ€œ<a href="https://yuluo-yx.github.io/blog/go-style#3-%E6%B3%A8%E9%87%8A%E5%BA%94%E8%AF%A5%E8%AF%B4%E6%98%8E%E7%9A%84%E6%98%AF%E4%B8%BA%E4%BB%80%E4%B9%88%E8%80%8C%E4%B8%8D%E6%98%AF%E5%81%9A%E4%BB%80%E4%B9%88" class="hash-link" aria-label="3. æ³¨é‡Šåº”è¯¥è¯´æ˜çš„æ˜¯â€ä¸ºä»€ä¹ˆâ€œï¼Œè€Œä¸æ˜¯â€åšä»€ä¹ˆâ€œçš„ç›´æ¥é“¾æ¥" title="3. æ³¨é‡Šåº”è¯¥è¯´æ˜çš„æ˜¯â€ä¸ºä»€ä¹ˆâ€œï¼Œè€Œä¸æ˜¯â€åšä»€ä¹ˆâ€œçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// âŒ Bad</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Increment i by 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain">&nbsp;</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// âœ… Good</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Retry count is increased after each failed attempt.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">i</span><span class="token operator" style="color:hsl(221, 87%, 60%)">++</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="4-å½“æœ‰-contextcontext-å‚æ•°æ—¶å…¶æ°¸è¿œæ˜¯æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¹¶ä¸”ä¸è¢«æ”¾åœ¨ç»“æ„ä½“ä¸­">4. å½“æœ‰ context.Context å‚æ•°æ—¶ï¼Œå…¶æ°¸è¿œæ˜¯æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¹¶ä¸”ä¸è¢«æ”¾åœ¨ç»“æ„ä½“ä¸­<a href="https://yuluo-yx.github.io/blog/go-style#4-%E5%BD%93%E6%9C%89-contextcontext-%E5%8F%82%E6%95%B0%E6%97%B6%E5%85%B6%E6%B0%B8%E8%BF%9C%E6%98%AF%E6%96%B9%E6%B3%95%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%E5%B9%B6%E4%B8%94%E4%B8%8D%E8%A2%AB%E6%94%BE%E5%9C%A8%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%AD" class="hash-link" aria-label="4. å½“æœ‰ context.Context å‚æ•°æ—¶ï¼Œå…¶æ°¸è¿œæ˜¯æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¹¶ä¸”ä¸è¢«æ”¾åœ¨ç»“æ„ä½“ä¸­çš„ç›´æ¥é“¾æ¥" title="4. å½“æœ‰ context.Context å‚æ•°æ—¶ï¼Œå…¶æ°¸è¿œæ˜¯æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¹¶ä¸”ä¸è¢«æ”¾åœ¨ç»“æ„ä½“ä¸­çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">type ServerContext struct {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  ctx context.Context</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  // other </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func (s *ServerContext) doSomething(param any, ctx context.Context) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  // ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">type ServerContext struct {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  // other </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func (s *ServerContext) doSomething(ctx context.Context, param any) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  // ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="5-æ­£ç¡®å£°æ˜å˜é‡">5. æ­£ç¡®å£°æ˜å˜é‡<a href="https://yuluo-yx.github.io/blog/go-style#5-%E6%AD%A3%E7%A1%AE%E5%A3%B0%E6%98%8E%E5%8F%98%E9%87%8F" class="hash-link" aria-label="5. æ­£ç¡®å£°æ˜å˜é‡çš„ç›´æ¥é“¾æ¥" title="5. æ­£ç¡®å£°æ˜å˜é‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// nil </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">s := []int8{}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// éé›¶ä½†é•¿åº¦ä¸ºé›¶</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">var s []int</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">i := 42</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>[]T<!-- --> ä¼šé»˜è®¤åˆ†é…å†…å­˜ï¼Œvar s []T æ›´æ¸…æ™°ä¸é«˜æ•ˆã€‚</p>
<p>åœ¨ä½¿ç”¨éé›¶å€¼åˆå§‹åŒ–æ—¶ï¼Œä½¿ç”¨  <code>:=</code> èµ‹å€¼ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="6-ä»£ç ä¸­ä¸è¦å‡ºç°-panic">6. ä»£ç ä¸­ä¸è¦å‡ºç° panic<a href="https://yuluo-yx.github.io/blog/go-style#6-%E4%BB%A3%E7%A0%81%E4%B8%AD%E4%B8%8D%E8%A6%81%E5%87%BA%E7%8E%B0-panic" class="hash-link" aria-label="6. ä»£ç ä¸­ä¸è¦å‡ºç° panicçš„ç›´æ¥é“¾æ¥" title="6. ä»£ç ä¸­ä¸è¦å‡ºç° panicçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func ParseConfig(file *os.File, cfg any) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    decoder := yaml.NewDecoder(file)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    if err := decoder.Decode(cfg); err != nil {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        panic("failed to decode config: " + err.Error())</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func Parse(file *os.File, cfg any) error {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    decoder := yaml.NewDecoder(file)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    if err := decoder.Decode(cfg); err != nil {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return err</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    return nil</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¾èµ–åº“åº”è¯¥ä¼˜å…ˆè¿”å› errï¼Œè€Œä¸æ˜¯ç»ˆæ­¢ç¨‹åºã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="7-ä¿æŒé”™è¯¯ä¿¡æ¯å¹²å‡€ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—">7. ä¿æŒé”™è¯¯ä¿¡æ¯å¹²å‡€ï¼Œä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—<a href="https://yuluo-yx.github.io/blog/go-style#7-%E4%BF%9D%E6%8C%81%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF%E5%B9%B2%E5%87%80%E4%BD%BF%E7%94%A8%E7%BB%93%E6%9E%84%E5%8C%96%E6%97%A5%E5%BF%97" class="hash-link" aria-label="7. ä¿æŒé”™è¯¯ä¿¡æ¯å¹²å‡€ï¼Œä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—çš„ç›´æ¥é“¾æ¥" title="7. ä¿æŒé”™è¯¯ä¿¡æ¯å¹²å‡€ï¼Œä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">return&nbsp;fmt.Errorf("some error.")</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">return&nbsp;fmt.Errorf("some error.")</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>error msg å°å†™å¼€å¤´ä¸”ä¸ä»¥ä»»ä½•æ ‡ç‚¹ç»“å°¾ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="8-é¿å…å¤šä½™çš„-else-é€»è¾‘">8. é¿å…å¤šä½™çš„ else é€»è¾‘<a href="https://yuluo-yx.github.io/blog/go-style#8-%E9%81%BF%E5%85%8D%E5%A4%9A%E4%BD%99%E7%9A%84-else-%E9%80%BB%E8%BE%91" class="hash-link" aria-label="8. é¿å…å¤šä½™çš„ else é€»è¾‘çš„ç›´æ¥é“¾æ¥" title="8. é¿å…å¤šä½™çš„ else é€»è¾‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">if&nbsp;err !=&nbsp;nil&nbsp;{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;if&nbsp;something {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;return&nbsp;err</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}&nbsp;else&nbsp;{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; doSomething()</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">if&nbsp;err !=&nbsp;nil&nbsp;{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;return&nbsp;err</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">doSomething()</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°½æ—©è¿”å› error ä¸”é¿å…å¤šä½™çš„ else è¯­å¥ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="9-ä½¿ç”¨åŒ…åˆ«åå¯¼å…¥">9. ä½¿ç”¨åŒ…åˆ«åå¯¼å…¥<a href="https://yuluo-yx.github.io/blog/go-style#9-%E4%BD%BF%E7%94%A8%E5%8C%85%E5%88%AB%E5%90%8D%E5%AF%BC%E5%85%A5" class="hash-link" aria-label="9. ä½¿ç”¨åŒ…åˆ«åå¯¼å…¥çš„ç›´æ¥é“¾æ¥" title="9. ä½¿ç”¨åŒ…åˆ«åå¯¼å…¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>é™¤éä¸ºäº†é¿å…åç§°å†²çªï¼Œå¦åˆ™åº”é¿å…é‡å‘½åå¯¼å…¥ï¼›å¥½çš„åŒ…åç§°ä¸åº”è¯¥éœ€è¦é‡å‘½åã€‚å¦‚æœå‘ç”Ÿå†²çªï¼Œä¼˜å…ˆé‡å‘½åæœ¬åœ°æˆ–é¡¹ç›®ç‰¹å®šçš„å¯¼å…¥ã€‚</p>
<p><code>import pkg</code>  æ—¶æŒ‰ç»„ç»„ç»‡ï¼Œæ¯ç»„ä¹‹é—´ä»¥ç©ºè¡Œåˆ†éš”ã€‚æ ‡å‡†åº“åŒ…å§‹ç»ˆä½äºç¬¬ä¸€ç»„ï¼Œå…¶æ¬¡æ˜¯ç¬¬ä¸‰æ–¹åŒ…ï¼Œæœ€åæ˜¯é¡¹ç›®å†…éƒ¨åŒ…ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="10-ç¼©å†™ä¿æŒå¤§å†™å’Œå®˜æ–¹åº“ä¸€è‡´">10. ç¼©å†™ä¿æŒå¤§å†™å’Œå®˜æ–¹åº“ä¸€è‡´<a href="https://yuluo-yx.github.io/blog/go-style#10-%E7%BC%A9%E5%86%99%E4%BF%9D%E6%8C%81%E5%A4%A7%E5%86%99%E5%92%8C%E5%AE%98%E6%96%B9%E5%BA%93%E4%B8%80%E8%87%B4" class="hash-link" aria-label="10. ç¼©å†™ä¿æŒå¤§å†™å’Œå®˜æ–¹åº“ä¸€è‡´çš„ç›´æ¥é“¾æ¥" title="10. ç¼©å†™ä¿æŒå¤§å†™å’Œå®˜æ–¹åº“ä¸€è‡´çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">type&nbsp;HttpServer&nbsp;struct{}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">type&nbsp;HTTPServer&nbsp;struct{}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ ‡å‡†åº“å†™æ³•ï¼šHTTPã€IDã€JSONã€‚ä¿æŒä¸€è‡´æ€§.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="11-é¿å…è£¸è¿”å›">11. é¿å…è£¸è¿”å›<a href="https://yuluo-yx.github.io/blog/go-style#11-%E9%81%BF%E5%85%8D%E8%A3%B8%E8%BF%94%E5%9B%9E" class="hash-link" aria-label="11. é¿å…è£¸è¿”å›çš„ç›´æ¥é“¾æ¥" title="11. é¿å…è£¸è¿”å›çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;sum(a, b&nbsp;int)&nbsp;(result&nbsp;int) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; result = a + b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;sum(a, b&nbsp;int)&nbsp;int&nbsp;{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp;&nbsp;return&nbsp;a + b</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é™¤éå‡½æ•°éå¸¸çŸ­ï¼Œä¸€çœ¼çœ‹åˆ°åº•æ—¶ä½¿ç”¨è£¸è¿”å›ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="12-åŒ…åæ¥å—è€…åä¿æŒç®€å•ä¸ç®€æ´åˆ‡é¿å…å‡½æ•°åé‡å¤ä¸å•°å—¦">12. åŒ…åã€æ¥å—è€…åä¿æŒç®€å•ä¸ç®€æ´åˆ‡é¿å…å‡½æ•°åé‡å¤ä¸å•°å—¦<a href="https://yuluo-yx.github.io/blog/go-style#12-%E5%8C%85%E5%90%8D%E6%8E%A5%E5%8F%97%E8%80%85%E5%90%8D%E4%BF%9D%E6%8C%81%E7%AE%80%E5%8D%95%E4%B8%8E%E7%AE%80%E6%B4%81%E5%88%87%E9%81%BF%E5%85%8D%E5%87%BD%E6%95%B0%E5%90%8D%E9%87%8D%E5%A4%8D%E4%B8%8E%E5%95%B0%E5%97%A6" class="hash-link" aria-label="12. åŒ…åã€æ¥å—è€…åä¿æŒç®€å•ä¸ç®€æ´åˆ‡é¿å…å‡½æ•°åé‡å¤ä¸å•°å—¦çš„ç›´æ¥é“¾æ¥" title="12. åŒ…åã€æ¥å—è€…åä¿æŒç®€å•ä¸ç®€æ´åˆ‡é¿å…å‡½æ•°åé‡å¤ä¸å•°å—¦çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package&nbsp;my_utils</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;(this *Server)&nbsp;Start() {}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package&nbsp;yamlconfig</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;ParseYAMLConfig(input&nbsp;string)&nbsp;(*Config,&nbsp;error)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;OverrideFirstWithSecond(dest, source *Config)&nbsp;error</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// ä¸åº”ä¹¦å†™å‡½æ•°çš„è¿”å›å‚æ•°å,è¿™ä¼šå¯¼è‡´ goDoc æ··ä¹±</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func doSomething(a, b int) (sum int, err error) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  // logic</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package&nbsp;utils</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;(s *Server)&nbsp;Start() </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package&nbsp;yamlconfig</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;Parse(input&nbsp;string)&nbsp;(*Config,&nbsp;error)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;Override(dest, source *Config)&nbsp;error</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func doSomething(a, b int) (int,error) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  // logic</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>åŒ…åå°å†™ã€ç®€æ´ã€æ— ä¸‹åˆ’çº¿ï¼›</li>
<li>æ¥å—è€…å˜é‡ <code>s</code>, <code>r</code>, <code>c</code> è¿™ç§çŸ­å˜é‡å¸¸è§ä¸”æ¸…æ™°ï¼›</li>
<li>åŒ…åæä¾›ä¸Šä¸‹æ–‡ã€‚</li>
</ul>
<p>å½“éœ€è¦æ¶ˆé™¤ç±»ä¼¼åç§°çš„å‡½æ•°æ­§ä¹‰æ—¶ï¼Œå¯ä»¥åŒ…å«é¢å¤–çš„ä¿¡æ¯ã€‚</p>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func (c *Config) WriteTextTo(w io.Writer) (int64, error)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func (c *Config) WriteBinaryTo(w io.Writer) (int64, error)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="13-å‡½æ•°åä¸­ä¸åº”å‡ºç°è¿”å›ç±»å‹ä¸”å‘½åä½“ç°è¯­ä¹‰">13. å‡½æ•°åä¸­ä¸åº”å‡ºç°è¿”å›ç±»å‹ä¸”å‘½åä½“ç°è¯­ä¹‰<a href="https://yuluo-yx.github.io/blog/go-style#13-%E5%87%BD%E6%95%B0%E5%90%8D%E4%B8%AD%E4%B8%8D%E5%BA%94%E5%87%BA%E7%8E%B0%E8%BF%94%E5%9B%9E%E7%B1%BB%E5%9E%8B%E4%B8%94%E5%91%BD%E5%90%8D%E4%BD%93%E7%8E%B0%E8%AF%AD%E4%B9%89" class="hash-link" aria-label="13. å‡½æ•°åä¸­ä¸åº”å‡ºç°è¿”å›ç±»å‹ä¸”å‘½åä½“ç°è¯­ä¹‰çš„ç›´æ¥é“¾æ¥" title="13. å‡½æ•°åä¸­ä¸åº”å‡ºç°è¿”å›ç±»å‹ä¸”å‘½åä½“ç°è¯­ä¹‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;TransformToJSON(input *Config)&nbsp;*jsonconfig.Config</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;(c *Config)&nbsp;GetJobName(key&nbsp;string) (value&nbsp;string, ok&nbsp;bool)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;Transform(input *Config)&nbsp;*jsonconfig.Config</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// è¿”å›å€¼å‡½æ•°ä¸­ä¸è¦åŠ¨è¯</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;(c *Config)&nbsp;JobName(key&nbsp;string) (value&nbsp;string, ok&nbsp;bool)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// åŠ¨ä½œç”¨åŠ¨è¯ï¼Œå–å€¼ç”¨åè¯</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;(c *Config)&nbsp;ApplyChanges()&nbsp;error</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func&nbsp;ProcessData(data []byte)&nbsp;error</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŠ¨ä½œç”¨åŠ¨è¯ï¼Œå–å€¼ç”¨åè¯ä¸”è¿”å›å€¼å‡½æ•°ä¸­ä¸è¦åŠ¨è¯ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="14-æµ‹è¯•å†™æ³•ç¬¦åˆ-go-got-v-want-vé£æ ¼">14. æµ‹è¯•å†™æ³•ç¬¦åˆ Go <code>got %v, want %v</code>é£æ ¼<a href="https://yuluo-yx.github.io/blog/go-style#14-%E6%B5%8B%E8%AF%95%E5%86%99%E6%B3%95%E7%AC%A6%E5%90%88-go-got-v-want-v%E9%A3%8E%E6%A0%BC" class="hash-link" aria-label="14-æµ‹è¯•å†™æ³•ç¬¦åˆ-go-got-v-want-vé£æ ¼çš„ç›´æ¥é“¾æ¥" title="14-æµ‹è¯•å†™æ³•ç¬¦åˆ-go-got-v-want-vé£æ ¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âŒ Bad</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">if&nbsp;got != want {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; t.Errorf("expected %v but got %v", want, got)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// âœ… Good</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">if&nbsp;got != want {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">&nbsp; &nbsp; t.Errorf("got %v, want %v", got, want)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="15-å¸¸é‡ä¸ç»“æ„åŒ–é”™è¯¯å£°æ˜">15. å¸¸é‡ä¸ç»“æ„åŒ–é”™è¯¯å£°æ˜<a href="https://yuluo-yx.github.io/blog/go-style#15-%E5%B8%B8%E9%87%8F%E4%B8%8E%E7%BB%93%E6%9E%84%E5%8C%96%E9%94%99%E8%AF%AF%E5%A3%B0%E6%98%8E" class="hash-link" aria-label="15. å¸¸é‡ä¸ç»“æ„åŒ–é”™è¯¯å£°æ˜çš„ç›´æ¥é“¾æ¥" title="15. å¸¸é‡ä¸ç»“æ„åŒ–é”™è¯¯å£°æ˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">type Animal string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">var (</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // ErrDuplicate occurs if this animal has already been seen.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ErrDuplicate = errors.New("duplicate")</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // ErrMarsupial occurs because we're allergic to marsupials outside Australia.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // Sorry.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ErrMarsupial = errors.New("marsupials are not supported")</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func process(animal Animal) error {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    switch {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    case seen[animal]:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return ErrDuplicate</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    case marsupial(animal):</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return ErrMarsupial</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    seen[animal] = true</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    return nil</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ä½¿ç”¨åˆ°å¸¸é‡å®šä¹‰æˆ–è€…é”™è¯¯æ—¶ï¼Œå°†å…¶æœºæ„åŒ–å®šä¹‰åœ¨æ–‡ä»¶é¡¶éƒ¨æˆ–ç»Ÿä¸€ç®¡ç†ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="16-å½“å‡½æ•°å‚æ•°åˆ—è¡¨è¿‡å¤šæ—¶ä½¿ç”¨å¯å˜å‚æ•°å¤„ç†è¾“å…¥">16. å½“å‡½æ•°å‚æ•°åˆ—è¡¨è¿‡å¤šæ—¶ï¼Œä½¿ç”¨å¯å˜å‚æ•°å¤„ç†è¾“å…¥<a href="https://yuluo-yx.github.io/blog/go-style#16-%E5%BD%93%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8%E8%BF%87%E5%A4%9A%E6%97%B6%E4%BD%BF%E7%94%A8%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E5%A4%84%E7%90%86%E8%BE%93%E5%85%A5" class="hash-link" aria-label="16. å½“å‡½æ•°å‚æ•°åˆ—è¡¨è¿‡å¤šæ—¶ï¼Œä½¿ç”¨å¯å˜å‚æ•°å¤„ç†è¾“å…¥çš„ç›´æ¥é“¾æ¥" title="16. å½“å‡½æ•°å‚æ•°åˆ—è¡¨è¿‡å¤šæ—¶ï¼Œä½¿ç”¨å¯å˜å‚æ•°å¤„ç†è¾“å…¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">type SshProtocol struct {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	Host                 string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	Port                 string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	Timeout              string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	Username             string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	Password             string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	PrivateKey           string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	PrivateKeyPassphrase string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	ReuseConnection      string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	Script               string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	ParseType            string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	ProxyHost            string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	ProxyPort            string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	ProxyUsername        string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	ProxyPassword        string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	UseProxy             string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	ProxyPrivateKey      string</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">type SshProtocolConfigOptFunc func(option *SshProtocol)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func NewSshProtocol(host, port string, opts ...SshProtocolConfigOptFunc) *SshProtocol {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	option := &amp;SshProtocol{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		Host: host,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		Port: port,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	for _, opt := range opts {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		opt(option)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	return &amp;SshProtocol{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		Host:                 host,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		Port:                 port,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		Timeout:              option.Timeout,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		Username:             option.Username,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		Password:             option.Password,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		PrivateKey:           option.PrivateKey,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		PrivateKeyPassphrase: option.PrivateKeyPassphrase,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		ReuseConnection:      option.ReuseConnection,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		Script:               option.Script,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		ParseType:            option.ParseType,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		ProxyHost:            option.ProxyHost,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		ProxyPort:            option.ProxyPort,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		ProxyUsername:        option.ProxyUsername,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		ProxyPassword:        option.ProxyPassword,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		UseProxy:             option.UseProxy,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		ProxyPrivateKey:      option.ProxyPrivateKey,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">func (sp *SshProtocol) IsInvalid() error {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	return nil</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="17-å­—ç¬¦ä¸²æ‹¼æ¥">17. å­—ç¬¦ä¸²æ‹¼æ¥<a href="https://yuluo-yx.github.io/blog/go-style#17-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5" class="hash-link" aria-label="17. å­—ç¬¦ä¸²æ‹¼æ¥çš„ç›´æ¥é“¾æ¥" title="17. å­—ç¬¦ä¸²æ‹¼æ¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-golang codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-golang codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// è¿æ¥å°‘é‡å­—ç¬¦æ—¶ä½¿ç”¨ + </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">key := "projectid: " + p</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// æ„å»ºå¸¦æœ‰æ ¼å¼åŒ–çš„å¤æ‚å­—ç¬¦ä¸²æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ fmt.Sprintf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">str := fmt.Sprintf("%s [%s:%d]-&gt; %s", src, qos, mtu, dst)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// å­—ç¬¦ä¸²æ ¼å¼æ›´åŠ å¤æ‚æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ text/template æˆ– safehtml/template</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>golang</category>
        </item>
        <item>
            <title><![CDATA[ä¼˜é›…å…³é—­ GoRoutine]]></title>
            <link>https://yuluo-yx.github.io/blog/goroutine-close</link>
            <guid>https://yuluo-yx.github.io/blog/goroutine-close</guid>
            <pubDate>Tue, 02 Sep 2025 20:51:10 GMT</pubDate>
            <description><![CDATA[é¦–å…ˆéœ€è¦æ˜ç¡®åˆ«çš„æ˜¯ï¼šGo ä¸­å¹¶æ²¡æœ‰æ˜¾å¼ï¼ˆä¸»åŠ¨ï¼‰åœæ­¢ GoRoutine çš„æ–¹å¼ã€‚åªèƒ½é€šè¿‡ä¸»åŠ¨é€€å‡ºçš„æ–¹å¼ç»ˆæ­¢åç¨‹ï¼Œé€šå¸¸é€šè¿‡ä¸Šä¸‹æ–‡é€šä¿¡çš„æ–¹å¼å®ç°ã€‚]]></description>
            <content:encoded><![CDATA[<blockquote>
<p>é¦–å…ˆéœ€è¦æ˜ç¡®åˆ«çš„æ˜¯ï¼šGo ä¸­å¹¶æ²¡æœ‰æ˜¾å¼ï¼ˆä¸»åŠ¨ï¼‰åœæ­¢ GoRoutine çš„æ–¹å¼ã€‚åªèƒ½é€šè¿‡ä¸»åŠ¨é€€å‡ºçš„æ–¹å¼ç»ˆæ­¢åç¨‹ï¼Œé€šå¸¸é€šè¿‡ä¸Šä¸‹æ–‡é€šä¿¡çš„æ–¹å¼å®ç°ã€‚
é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆ goRoutine ä¸èƒ½è¢«å¼ºåˆ¶åœæ­¢ï¼Ÿ</p>
<ol>
<li>èµ„æºç®¡ç†ï¼šåç¨‹ä¸­å¯èƒ½ä¼šä½¿ç”¨åˆ°ä¸€äº›èµ„æºï¼Œå¦‚æ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥ç­‰ã€‚å¦‚æœå¼ºåˆ¶åœæ­¢åç¨‹ï¼Œè¿™äº›èµ„æºå¯èƒ½ä¸ä¼šè¢«æ­£ç¡®é‡Šæ”¾ï¼Œå¯¼è‡´èµ„æºæ³„æ¼ï¼›
æ•°æ®ä¸€è‡´æ€§ï¼šåç¨‹ä¸­å¯èƒ½ä¼šå¤„ç†å…±äº«çš„æ•°æ®ï¼Œå¦‚æœå¼ºåˆ¶åœæ­¢åç¨‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼›</li>
<li>defer æ— æ³•æ‰§è¡Œï¼šåç¨‹ä¸­å¯èƒ½ä¼šä½¿ç”¨ defer è¯­å¥æ¥æ‰§è¡Œä¸€äº›æ¸…ç†æ“ä½œï¼Œå¦‚æœå¼ºåˆ¶åœæ­¢åç¨‹ï¼Œè¿™äº›æ“ä½œå¯èƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼›</li>
<li>ä»£ç å¯ç»´æŠ¤æ€§é™ä½ï¼Œå¼€å‘è€…å¯èƒ½ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ goRoutine å°±ä¼šè¢«å…³é—­äº†ï¼Œå¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤ã€‚</li>
</ol>
</blockquote>
<hr>
<blockquote>
<p>goRoutine å¼ºè°ƒçš„æ˜¯ååŒå·¥ä½œçš„æ¦‚å¿µï¼Œè€Œä¸æ˜¯å¼ºåˆ¶ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-go-context">1. Go Context<a href="https://yuluo-yx.github.io/blog/goroutine-close#1-go-context" class="hash-link" aria-label="1. Go Contextçš„ç›´æ¥é“¾æ¥" title="1. Go Contextçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æ‰¿æ¥ä¸Šæ–‡ï¼š<a href="https://yuluo-yx.github.io/blog/golang-context">Go context</a> æ˜¯ Go å®˜æ–¹å‘å¸ƒçš„ç”¨æ¥ç®¡ç† GoRoutine çš„åŒ…ã€‚å¯ä»¥åœ¨åç¨‹ä¸­ä¼ é€’å‚æ•°ï¼Œæ§åˆ¶åç¨‹çš„ç”Ÿå‘½å‘¨æœŸç­‰ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-goroutine-å…³é—­">2. GoRoutine å…³é—­<a href="https://yuluo-yx.github.io/blog/goroutine-close#2-goroutine-%E5%85%B3%E9%97%AD" class="hash-link" aria-label="2. GoRoutine å…³é—­çš„ç›´æ¥é“¾æ¥" title="2. GoRoutine å…³é—­çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä¸‹é¢æ¥ç ”ç©¶ä¸‹å¦‚ä½•å…³é—­ goRoutineã€‚æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š</p>
<ol>
<li>ä½¿ç”¨ close å…³é—­ï¼›</li>
<li>ä½¿ç”¨ select è½®è¯¢å…³é—­ï¼›</li>
<li>ä½¿ç”¨ context å…³é—­ã€‚</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-close-å…³é—­æ–¹å¼">2.1 close å…³é—­æ–¹å¼<a href="https://yuluo-yx.github.io/blog/goroutine-close#21-close-%E5%85%B3%E9%97%AD%E6%96%B9%E5%BC%8F" class="hash-link" aria-label="2.1 close å…³é—­æ–¹å¼çš„ç›´æ¥é“¾æ¥" title="2.1 close å…³é—­æ–¹å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æœ€åŸå§‹çš„å…³é—­æ–¹å¼ï¼Œä½¿ç”¨ channel çš„ close æœºåˆ¶æ¥å‘é€ç»“æŸä¿¡æ¯ã€‚</p>
<p>å½“ä¸€ä¸ª channel è¢«å…³é—­æ—¶ï¼Œå¦‚æœç»§ç»­è¯»å–æ•°æ®ï¼Œä¼šè¿”å›ä¸€ä¸ªå•ä½é›¶å€¼å’Œä¸€ä¸ª false çš„å¸ƒå°”å€¼ï¼ŒgoRoutine å¯ä»¥é€šè¿‡å¸ƒå°”å€¼æ¥é€€å‡ºã€‚</p>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// will also set ok to false for a closed and empty channel.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">close</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">c </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">chan</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain"> Type</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>close å…³é—­ goRoutineï¼š</p>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"time"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åˆ›å»ºä¸€ä¸ªæ— ç¼“å†²çš„ int å‹ channelï¼Œç”¨äºåœ¨ä¸» goroutine ä¸åŒ¿åå­ goroutine ä¹‹é—´é€šä¿¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ch </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">make</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">chan</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">int</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¯åŠ¨ä¸€ä¸ªå­ goroutine è´Ÿè´£ç”Ÿäº§æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">go</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¾æ¬¡å‘é€ 0~9 å…± 10 ä¸ªæ•´æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i</span><span class="token operator" style="color:hsl(221, 87%, 60%)">++</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            ch </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å‘é€å®Œæ¯•åå…³é—­ channelï¼Œå‘æ¥æ”¶ç«¯å¹¿æ’­â€œæ— æ›´å¤šæ•°æ®â€ä¿¡å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token function" style="color:hsl(221, 87%, 60%)">close</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ch</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¸» goroutine é€šè¿‡ range å¾ªç¯ä¸æ–­ä» channel æ¥æ”¶æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å½“ channel è¢«å…³é—­ä¸”ç¼“å†²åŒºä¸ºç©ºæ—¶ï¼Œfor-range è‡ªåŠ¨ç»“æŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> v </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">range</span><span class="token plain"> ch </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Sleep</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">200</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Millisecond</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="211-ä¼˜ç‚¹">2.1.1 ä¼˜ç‚¹<a href="https://yuluo-yx.github.io/blog/goroutine-close#211-%E4%BC%98%E7%82%B9" class="hash-link" aria-label="2.1.1 ä¼˜ç‚¹çš„ç›´æ¥é“¾æ¥" title="2.1.1 ä¼˜ç‚¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>ç®€å•ç›´è§‚ï¼Œå®¹æ˜“ç†è§£ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="212-ç¼ºç‚¹">2.1.2 ç¼ºç‚¹<a href="https://yuluo-yx.github.io/blog/goroutine-close#212-%E7%BC%BA%E7%82%B9" class="hash-link" aria-label="2.1.2 ç¼ºç‚¹çš„ç›´æ¥é“¾æ¥" title="2.1.2 ç¼ºç‚¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åªèƒ½å…³é—­ä¸€æ¬¡ï¼Œä¸èƒ½é‡å¤å…³é—­ï¼›
æ— æ³•ä¼ é€’æ›´å…·ä½“çš„é”™è¯¯ä¿¡æ¯ï¼Œä¾‹å¦‚å…³é—­åŸå› ç­‰ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-select-è½®è¯¢æœºåˆ¶å…³é—­">2.2 select è½®è¯¢æœºåˆ¶å…³é—­<a href="https://yuluo-yx.github.io/blog/goroutine-close#22-select-%E8%BD%AE%E8%AF%A2%E6%9C%BA%E5%88%B6%E5%85%B3%E9%97%AD" class="hash-link" aria-label="2.2 select è½®è¯¢æœºåˆ¶å…³é—­çš„ç›´æ¥é“¾æ¥" title="2.2 select è½®è¯¢æœºåˆ¶å…³é—­çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>select æ˜¯ Go è¯­è¨€ä¸­ç”¨äºå¤„ç†å¤šä¸ª channel çš„æœºåˆ¶ï¼Œå®ƒå¯ä»¥åŒæ—¶ç›‘å¬å¤šä¸ª channelï¼Œå¹¶åœ¨å…¶ä¸­ä¸€ä¸ª channel æœ‰æ•°æ®å¯è¯»æ—¶æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚
ä¾‹å¦‚æ¥æ”¶åˆ°äº†å…³é—­ channel çš„æ•°æ®ï¼ŒgoRoutine å°±ä¼šé€€å‡ºã€‚ select ä¼šé˜»å¡ç›´åˆ°å…¶ä¸­ä¸€ä¸ª case æ»¡è¶³æ¡ä»¶ï¼Œç„¶åæ‰§è¡Œè¯¥ case ä¸­çš„ä»£ç ã€‚</p>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒgoRoutine é€šå¸¸ä¼šæ‰§è¡Œä»»åŠ¡å¹¶ç›‘å¬é€€å‡ºä¿¡å·ï¼Œå½“æ¥æ”¶åˆ°é€€å‡ºä¿¡å·æ—¶ï¼ŒgoRoutine ä¼šé€€å‡ºã€‚</p>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"time"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">worker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">workChan </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">chan</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">int</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> doneChan </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">chan</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">struct</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"work å¯åŠ¨..."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">select</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">case</span><span class="token plain"> v </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain">workChan</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"work æ¥æ”¶åˆ°æ•°æ®:"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">case</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain">doneChan</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"work ç»“æŸ..."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Sleep</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">200</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Millisecond</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    workChan </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">make</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">chan</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">int</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    doneChan </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">make</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">chan</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">struct</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">go</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">worker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">workChan</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> doneChan</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ¨¡æ‹Ÿä¸šåŠ¡é€»è¾‘å‘é€æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i</span><span class="token operator" style="color:hsl(221, 87%, 60%)">++</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        workChan </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// workChan æ‰§è¡Œç»“æŸï¼Œå»¶è¿Ÿä¸€ç§’åå‘é€ç»“æŸä¿¡å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Sleep</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    doneChan </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">struct</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Main ç»“æŸ..."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="221-ä¼˜ç‚¹">2.2.1 ä¼˜ç‚¹<a href="https://yuluo-yx.github.io/blog/goroutine-close#221-%E4%BC%98%E7%82%B9" class="hash-link" aria-label="2.2.1 ä¼˜ç‚¹çš„ç›´æ¥é“¾æ¥" title="2.2.1 ä¼˜ç‚¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æ›´åŠ çµæ´»ï¼Œå¯ä»¥ä¼ é€’æ›´å…·ä½“çš„é”™è¯¯ä¿¡æ¯ï¼Œä¾‹å¦‚å…³é—­åŸå› ç­‰ã€‚
ä½¿ç”¨ goRoutine æœ‰å¤æ‚é€»è¾‘æˆ–è€…é˜»å¡çš„åœºæ™¯ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="222-ç¼ºç‚¹">2.2.2 ç¼ºç‚¹<a href="https://yuluo-yx.github.io/blog/goroutine-close#222-%E7%BC%BA%E7%82%B9" class="hash-link" aria-label="2.2.2 ç¼ºç‚¹çš„ç›´æ¥é“¾æ¥" title="2.2.2 ç¼ºç‚¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>éœ€è¦å¼€å‘è€…æ‰‹åŠ¨ç»´æŠ¤ä¸€ä¸ª done chanï¼›
å…³é—­ä¹‹åï¼Œæ‰€æœ‰ç›‘å¬çš„ channel éƒ½ä¼šè¢«å…³é—­ï¼Œæ— æ³•å†æ¬¡ä½¿ç”¨ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="23-context-å…³é—­">2.3 context å…³é—­<a href="https://yuluo-yx.github.io/blog/goroutine-close#23-context-%E5%85%B3%E9%97%AD" class="hash-link" aria-label="2.3 context å…³é—­çš„ç›´æ¥é“¾æ¥" title="2.3 context å…³é—­çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ ‡å‡†åšæ³•ï¼Œæ‰€æœ‰ go å‡½æ•°å’Œåº“éƒ½å€¾å‘ä½¿ç”¨ context å…³é—­ goRoutineã€‚
context ä½œä¸ºå‡½æ•°å‚æ•°è¢«å±‚å±‚ä¼ é€’ï¼ŒgoRoutine å¯ä»¥é€šè¿‡ context åˆ¤æ–­æ˜¯å¦éœ€è¦é€€å‡ºã€‚</p>
<blockquote>
<p>PS: å®˜æ–¹æ¨èä»»ä½•ä¸€ä¸ªé•¿æœŸè¿è¡Œçš„å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°éƒ½åº”è¯¥æ˜¯ context.Contextã€‚</p>
</blockquote>
<p>æ”¯æŒè¾ƒä¸ºä¸°å¯Œçš„åŠŸèƒ½ï¼Œä¾‹å¦‚è¶…æ—¶é€€å‡ºï¼Œæ‰‹åŠ¨å–æ¶ˆç­‰ã€‚</p>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"context"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"sync"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"time"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">worker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> wg </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain">sync</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">WaitGroup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">defer</span><span class="token plain"> wg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Done</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¡®ä¿ goroutine é€€å‡ºæ—¶é€šçŸ¥ main</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"worker å¯åŠ¨..."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ticker </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">NewTicker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">200</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Millisecond</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">defer</span><span class="token plain"> ticker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Stop</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">select</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">case</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Done</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"worker æ¥æ”¶åˆ° Done ä¿¡å·ï¼Œé€€å‡º..."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">case</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain">ticker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">C</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"worker running..."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> cancel </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">WithCancel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Background</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">var</span><span class="token plain"> wg sync</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">WaitGroup</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    wg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">go</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">worker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;</span><span class="token plain">wg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 1 ç§’åå–æ¶ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Sleep</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">cancel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç­‰å¾… worker ä¼˜é›…é€€å‡º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    wg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Wait</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"main é€€å‡º"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>golang</category>
        </item>
        <item>
            <title><![CDATA[Mac Mini å…¥æ‰‹åç»­]]></title>
            <link>https://yuluo-yx.github.io/blog/mac-mini</link>
            <guid>https://yuluo-yx.github.io/blog/mac-mini</guid>
            <pubDate>Fri, 22 Aug 2025 23:34:54 GMT</pubDate>
            <description><![CDATA[ç”¨äº†äº”å¹´æˆ´å°”çš„ç”µè„‘è¶Šæ¥è¶Šå¡é¡¿ï¼Œé¡¹ç›®å¯åŠ¨è¶Šæ¥è¶Šæ…¢ã€‚å¼€æœºè¶Šæ¥è¶Šæ…¢ï¼Œäºæ˜¯å‡†å¤‡å¾ˆä¸‹å¿ƒæ¥ã€‚æ¢ç”µè„‘ï¼ï¼ï¼]]></description>
            <content:encoded><![CDATA[<p>ç”¨äº†äº”å¹´æˆ´å°”çš„ç”µè„‘è¶Šæ¥è¶Šå¡é¡¿ï¼Œé¡¹ç›®å¯åŠ¨è¶Šæ¥è¶Šæ…¢ã€‚å¼€æœºè¶Šæ¥è¶Šæ…¢ï¼Œäºæ˜¯å‡†å¤‡å¾ˆä¸‹å¿ƒæ¥ã€‚æ¢ç”µè„‘ï¼ï¼ï¼</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é€‰æ‹©åŠ¨æœº">é€‰æ‹©åŠ¨æœº<a href="https://yuluo-yx.github.io/blog/mac-mini#%E9%80%89%E6%8B%A9%E5%8A%A8%E6%9C%BA" class="hash-link" aria-label="é€‰æ‹©åŠ¨æœºçš„ç›´æ¥é“¾æ¥" title="é€‰æ‹©åŠ¨æœºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="win-å’Œ-mac">Win å’Œ Mac<a href="https://yuluo-yx.github.io/blog/mac-mini#win-%E5%92%8C-mac" class="hash-link" aria-label="Win å’Œ Macçš„ç›´æ¥é“¾æ¥" title="Win å’Œ Macçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç”¨äº†äº”å¹´çš„ Windows ç³»ç»Ÿï¼ŒæœŸé—´å®ä¹ ï¼Œå·¥ä½œéƒ½ç”¨çš„æ˜¯ Macã€‚è™½ç„¶ Windows ä¹Ÿå¥½ï¼Œä½†æ˜¯æˆ‘è§‰å¾— Mac å¯¹å¼€å‘æ›´å‹å¥½ä¸€äº›ã€‚è€Œä¸”æ›´ç¬¦åˆå…¨å¤©å€™çš„ä½¿ç”¨ä¹ æƒ¯ã€‚</p>
<p>ä¸Šç­ç”¨ Windows é”®ç›˜ï¼Œä¸‹ç­ç”¨ Macã€‚å®¹æ˜“é”®ä½æ··ä¹±ï¼Œç»å¸¸æ•²ä¹‹å‰éœ€è¦æ€è€ƒ ctrl å’Œ command, options??????</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç¬”è®°æœ¬å°å¼-or-mac-mini">ç¬”è®°æœ¬ã€å°å¼ or Mac Mini<a href="https://yuluo-yx.github.io/blog/mac-mini#%E7%AC%94%E8%AE%B0%E6%9C%AC%E5%8F%B0%E5%BC%8F-or-mac-mini" class="hash-link" aria-label="ç¬”è®°æœ¬ã€å°å¼ or Mac Miniçš„ç›´æ¥é“¾æ¥" title="ç¬”è®°æœ¬ã€å°å¼ or Mac Miniçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç¬”è®°æœ¬ä¸Šç­æœ‰äº†ï¼Œä¹Ÿæ²¡æœ‰éœ€è¦å¸¦å‡ºå»çš„éœ€æ±‚ï¼Ÿä¸è€ƒè™‘~~~</p>
<p>å°å¼æœºï¼Œä¸€ç›´ç”¨çš„æ˜¯ç¬”è®°æœ¬ï¼Œå°å¼è¿‡äºç¬¨é‡äº†ï¼Œä¸è€ƒè™‘~~~</p>
<p>Mac mini **ä¾¿å®œï¼Œæ»¡è¶³éœ€æ±‚ã€‚**å°±å®ƒäº†ï¼ï¼ï¼</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é…ç½®">é…ç½®<a href="https://yuluo-yx.github.io/blog/mac-mini#%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="é…ç½®çš„ç›´æ¥é“¾æ¥" title="é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒMac çš„å†…å­˜å’Œç¡¬ç›˜å­˜å‚¨å ªæ¯”é‡‘å­ã€‚æœ€ç»ˆé€‰äº†å¾®ä¸ç‰ˆé…ç½®ï¼Œè‡ªå·±å¤–ç½®ç¡¬ç›˜æ‰©å®¹ï¼Œ24 + 256ã€‚å¤–ç½®æš‚æ—¶ 512ï¼Œåé¢çœ‹éœ€æ±‚æ‰© 1Tã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="è´­ä¹°æ¸ é“">è´­ä¹°æ¸ é“<a href="https://yuluo-yx.github.io/blog/mac-mini#%E8%B4%AD%E4%B9%B0%E6%B8%A0%E9%81%93" class="hash-link" aria-label="è´­ä¹°æ¸ é“çš„ç›´æ¥é“¾æ¥" title="è´­ä¹°æ¸ é“çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç”µå­å’Œå¤§ç‰©ä»¶æˆ‘è¿˜æ˜¯å€¾å‘äºäº¬ä¸œï¼Œå­¦ç”Ÿä¼˜æƒ  + å›½è¡¥ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é…ä»¶å’Œç³»ç»Ÿé…ç½®">é…ä»¶å’Œç³»ç»Ÿé…ç½®<a href="https://yuluo-yx.github.io/blog/mac-mini#%E9%85%8D%E4%BB%B6%E5%92%8C%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="é…ä»¶å’Œç³»ç»Ÿé…ç½®çš„ç›´æ¥é“¾æ¥" title="é…ä»¶å’Œç³»ç»Ÿé…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é…ä»¶">é…ä»¶<a href="https://yuluo-yx.github.io/blog/mac-mini#%E9%85%8D%E4%BB%B6" class="hash-link" aria-label="é…ä»¶çš„ç›´æ¥é“¾æ¥" title="é…ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç»¿è”æ‰©å±•åï¼šäº¬ä¸œ 399ï¼›</p>
<p>ç»¿è”æ‰©å±•åçš„ç¡¬ç›˜æ˜¯å®‰è£…åœ¨ä¸‹é¢çš„ï¼Œå¯èƒ½ä¼šæœ‰å‘çƒ­ï¼Œæ‹¼å¤šå¤š 40 å—é’±çš„é“¶è‰²å¢é«˜æ•£çƒ­å«ä¸€ä¸ªï¼›</p>
<p>ç»¿è” USE éº¦å…‹é£ 70ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç³»ç»Ÿé…ç½®">ç³»ç»Ÿé…ç½®<a href="https://yuluo-yx.github.io/blog/mac-mini#%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="ç³»ç»Ÿé…ç½®çš„ç›´æ¥é“¾æ¥" title="ç³»ç»Ÿé…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¤–ç½®ç³»ç»Ÿå®‰è£…å‚è€ƒé“¾æ¥ 2ï¼Œéå¸¸è¯¦ç»†ã€‚ğŸ‘</p>
<blockquote>
<p>But å®‰è£…å¤–ç½®ç³»ç»Ÿæ—¶ï¼Œæœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æ³¨æ„äº‹é¡¹ï¼š<strong>æ‰©å±•åçš„è¿æ¥å£ä¸è¦æ’åœ¨ Mac Mini åé¢çš„é›·é›³å£ä¸Šï¼ï¼ï¼</strong></p>
<p>å¦åˆ™ä¼šå®‰è£…ç³»ç»Ÿå¤±è´¥ï¼Œemm è¯•äº†å¥½å‡ æ¬¡ã€‚æœ€å google æœäº†ä¸‹ï¼Œæ˜¯è¿™ä¸ªåŸå› ï¼Œä½†æ˜¯ä¹Ÿæœ‰äººè¯„è®ºå®‰è£…æˆåŠŸã€‚</p>
<p>é›·éœ¹æ¥å£åˆ—ä¸¾ï¼š<a href="https://support.apple.com/zh-cn/120694" target="_blank" rel="noopener noreferrer">https://support.apple.com/zh-cn/120694</a></p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="è½¯ä»¶å®‰è£…">è½¯ä»¶å®‰è£…<a href="https://yuluo-yx.github.io/blog/mac-mini#%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85" class="hash-link" aria-label="è½¯ä»¶å®‰è£…çš„ç›´æ¥é“¾æ¥" title="è½¯ä»¶å®‰è£…çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>å‚è€ƒï¼š<a href="https://github.com/yuluo-yx/use#%E5%BA%94%E7%94%A8%E6%95%B4%E7%90%86" target="_blank" rel="noopener noreferrer">https://github.com/yuluo-yx/use#%E5%BA%94%E7%94%A8%E6%95%B4%E7%90%86</a></p>
<p>SDK ç®¡ç†ï¼š<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager" target="_blank" rel="noopener noreferrer">https://yuluo-yx.github.io/blog/java-and-go-sdk-manager</a></p>
</blockquote>
<p>Orbstackï¼šDocker desktop å¹³æ›¿ï¼›</p>
<p>Raycastï¼šéå¸¸å¥½ä½¿çš„å¯åŠ¨å™¨</p>
<p>Monitorcontrolï¼šæ§åˆ¶å¤–æ¥æ˜¾ç¤ºå±äº®åº¦</p>
<p>Snipasteï¼šæˆªå›¾è½¯ä»¶</p>
<p>Rectangleï¼šçª—å£ç®¡ç†</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ä½¿ç”¨ä½“éªŒ">ä½¿ç”¨ä½“éªŒ<a href="https://yuluo-yx.github.io/blog/mac-mini#%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C" class="hash-link" aria-label="ä½¿ç”¨ä½“éªŒçš„ç›´æ¥é“¾æ¥" title="ä½¿ç”¨ä½“éªŒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å…ˆè¯´ç¬¬ä¸€ç‚¹ä½“éªŒï¼šæ¡Œé¢ç©ºé—´å¤§äº†ã€‚æ€§èƒ½æ–¹é¢çš„æ²¡å¾—è¯´ï¼Œæ¯”æˆ‘ä¹‹å‰ç”µè„‘å¥½å¤šäº†ã€‚</p>
<p>ç¼ºç‚¹ï¼šæ‰©å±•åä¸‹é¢çš„ç¡¬ç›˜åœ¨å¤§é‡è¯»å†™æ“ä½œæ—¶ä¼šå‘çƒ­ã€‚ä½†æ˜¯ Mac Mini æ•´ä½“å‘çƒ­è¡¨ç°è‰¯å¥½ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« <a href="https://yuluo-yx.github.io/blog/mac-mini#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0" class="hash-link" aria-label="å‚è€ƒæ–‡ç« çš„ç›´æ¥é“¾æ¥" title="å‚è€ƒæ–‡ç« çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li><a href="https://jimmysong.io/blog/my-new-mac-mini-m4/" target="_blank" rel="noopener noreferrer">https://jimmysong.io/blog/my-new-mac-mini-m4/</a></li>
<li><a href="https://www.xiaohongshu.com/explore/685d9b040000000015020624" target="_blank" rel="noopener noreferrer">https://www.xiaohongshu.com/explore/685d9b040000000015020624</a></li>
</ol>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>MacMini</category>
            <category>devTools</category>
        </item>
        <item>
            <title><![CDATA[golang context]]></title>
            <link>https://yuluo-yx.github.io/blog/golang-context</link>
            <guid>https://yuluo-yx.github.io/blog/golang-context</guid>
            <pubDate>Mon, 18 Aug 2025 20:04:11 GMT</pubDate>
            <description><![CDATA[context ä¸»è¦ä¸ºäº†è§£å†³åœ¨å¹¶å‘æ¨¡å‹ä¸‹ï¼Œå¤šä¸ª Goroutine ä¹‹é—´å–æ¶ˆä¿¡å·ï¼Œè¶…æ—¶ï¼Œæ•°æ®ä¼ é€’ç­‰é—®é¢˜ã€‚]]></description>
            <content:encoded><![CDATA[<p>context ä¸»è¦ä¸ºäº†è§£å†³åœ¨å¹¶å‘æ¨¡å‹ä¸‹ï¼Œå¤šä¸ª Goroutine ä¹‹é—´<strong>å–æ¶ˆä¿¡å·ï¼Œè¶…æ—¶ï¼Œæ•°æ®ä¼ é€’</strong>ç­‰é—®é¢˜ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-ç”¨é€”">1. ç”¨é€”<a href="https://yuluo-yx.github.io/blog/golang-context#1-%E7%94%A8%E9%80%94" class="hash-link" aria-label="1. ç”¨é€”çš„ç›´æ¥é“¾æ¥" title="1. ç”¨é€”çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ï¼Œå¯èƒ½ä¼šæ¶‰åŠåˆ°å¤šä¸ªæœåŠ¡ä¹‹é—´çš„è°ƒç”¨ï¼Œè¯·æ±‚ APIï¼Œè°ƒç”¨æ•°æ®åº“ç­‰ã€‚ä¾‹å¦‚ç”¨æˆ·ç™»å½•è¯·æ±‚ï¼š</p>
<ol>
<li>controller å±‚æ¥å—è¯·æ±‚ï¼›</li>
<li>è°ƒç”¨ service å±‚ï¼Œè¿›è¡Œç”¨æˆ·ç™»å½•éªŒè¯ï¼›</li>
<li>service å±‚è°ƒç”¨ user æ¨¡å—çš„ APIï¼ŒæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼›</li>
<li>user æ¨¡å—è°ƒç”¨æ•°æ®åº“ï¼ŒæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚</li>
</ol>
<p>åœ¨ç™»å½•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›è®¾ç½®è¶…æ—¶æ—¶é—´ç­‰å…¶ä»–åŠŸèƒ½å±æ€§ï¼Œä¾‹å¦‚</p>
<ol>
<li>åœ¨ 3s å†…ï¼Œç”¨æˆ·ç™»å½•æˆåŠŸï¼Œåˆ™è¿”å›æˆåŠŸï¼Œå¦åˆ™è¿”å›å¤±è´¥ï¼›</li>
<li>åŠ å…¥ traceIdï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜ï¼›</li>
<li>åŠ å…¥å–æ¶ˆä¿¡å·ï¼Œå½“ç”¨æˆ·å–æ¶ˆç™»å½•æ—¶ï¼Œåœæ­¢åç»­æ“ä½œç­‰ã€‚</li>
</ol>
<p>context å°±å¯ä»¥å®Œç¾è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-context-åŒ…åˆ†æ">2. Context åŒ…åˆ†æ<a href="https://yuluo-yx.github.io/blog/golang-context#2-context-%E5%8C%85%E5%88%86%E6%9E%90" class="hash-link" aria-label="2. Context åŒ…åˆ†æçš„ç›´æ¥é“¾æ¥" title="2. Context åŒ…åˆ†æçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä»¥ä¸‹åˆ†æåŸºäº Go SDK 1.24.6ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-context-æ¥å£">2.1 Context æ¥å£<a href="https://yuluo-yx.github.io/blog/golang-context#21-context-%E6%8E%A5%E5%8F%A3" class="hash-link" aria-label="2.1 Context æ¥å£çš„ç›´æ¥é“¾æ¥" title="2.1 Context æ¥å£çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// æœ¬è´¨æ˜¯ä¸€ä¸ªæ¥å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">type</span><span class="token plain"> Context </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è·å– context çš„æˆªæ­¢æ—¶é—´ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ok ä¸º false è¡¨ç¤ºæ²¡æœ‰è®¾ç½®æˆªæ­¢æ—¶é—´</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">Deadline</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">deadline time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> ok </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">bool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ ¸å¿ƒæ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªåªè¯» channelï¼Œå½“ context è¢«å–æ¶ˆæ—¶ï¼Œä¼šå…³é—­ Done channelã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¸‹æ¸¸çš„ Goroutine åªéœ€è¦åœ¨ select ä¸­ç›‘å¬ Done channelï¼Œå³å¯æ„ŸçŸ¥åˆ° context è¢«å–æ¶ˆã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä»è€Œåšå‡ºåœæ­¢åŠ¨ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">Done</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">chan</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">struct</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¿”å› context è¢«å–æ¶ˆçš„åŸå› ï¼ˆDone channel å–æ¶ˆçš„åŸå› ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// context.Canceledï¼šcontext è¢«ä¸»åŠ¨å–æ¶ˆã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// context.DeadlineExceededï¼šcontext å› è¶…æ—¶è€Œè¢«å–æ¶ˆã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">Err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä» context ä¸­è·å–ä¸€ä¸ªé”®å€¼å¯¹ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç”¨æ¥ä¼ é€’è¯·æ±‚èŒƒå›´çš„ä¸Šä¸‹æ–‡æ•°æ®ï¼Œä¾‹å¦‚ traceIdï¼Œç”¨æˆ·ä¿¡æ¯ç­‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">Value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key any</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> any</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-context-å®ç°">2.2 Context å®ç°<a href="https://yuluo-yx.github.io/blog/golang-context#22-context-%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="2.2 Context å®ç°çš„ç›´æ¥é“¾æ¥" title="2.2 Context å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨å¼€å‘ä¸­ï¼Œä¸ç›´æ¥æˆ–è€…å¾ˆå°‘ä½¿ç”¨ Context æ¥å£ï¼Œè€Œæ˜¯ä½¿ç”¨ context åŒ…æä¾›çš„æ´¾ç”Ÿå‡½æ•°æ¥ä½¿ç”¨ contextã€‚</p>
<ol>
<li>context.Background(): é€šå¸¸åœ¨ main å‡½æ•°ã€åˆå§‹åŒ–å’Œæµ‹è¯•ä»£ç ä¸­åˆ›å»ºï¼Œä½œä¸ºæ‰€æœ‰ context çš„æ ¹èŠ‚ç‚¹ã€‚å®ƒæ°¸è¿œä¸ä¼šè¢«å–æ¶ˆï¼›</li>
<li>context.TODO(): å½“ä½ ä¸ç¡®å®šè¯¥ç”¨å“ªä¸ª Contextï¼Œæˆ–è€…å½“å‰å‡½æ•°ä»¥åä¼šæ›´æ–°ä»¥ä¾¿æ¥æ”¶ä¸€ä¸ª Context å‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å®ƒã€‚å®ƒå’Œ Background ç±»ä¼¼ï¼›</li>
<li>context.WithCancel(parent Context): åŸºäºä¸€ä¸ªçˆ¶ context åˆ›å»ºä¸€ä¸ªæ–°çš„ context å’Œä¸€ä¸ª cancel å‡½æ•°ã€‚è°ƒç”¨ cancel å‡½æ•°ï¼Œæ–°çš„ context å°±ä¼šè¢«å–æ¶ˆï¼›</li>
<li>context.WithTimeout(parent Context, timeout time.Duration): å’Œ WithCancel ç±»ä¼¼ï¼Œä½†å®ƒå¤šäº†ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚æ—¶é—´ä¸€åˆ°ï¼Œè‡ªåŠ¨å–æ¶ˆï¼›</li>
<li>context.WithValue(parent Context, key, val any): åˆ›å»ºä¸€ä¸ªæºå¸¦é”®å€¼å¯¹çš„ contextã€‚</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-ä½¿ç”¨ç¤ºä¾‹">3. ä½¿ç”¨ç¤ºä¾‹<a href="https://yuluo-yx.github.io/blog/golang-context#3-%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B" class="hash-link" aria-label="3. ä½¿ç”¨ç¤ºä¾‹çš„ç›´æ¥é“¾æ¥" title="3. ä½¿ç”¨ç¤ºä¾‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="31-é”®å€¼å¯¹ä¼ é€’">3.1 é”®å€¼å¯¹ä¼ é€’<a href="https://yuluo-yx.github.io/blog/golang-context#31-%E9%94%AE%E5%80%BC%E5%AF%B9%E4%BC%A0%E9%80%92" class="hash-link" aria-label="3.1 é”®å€¼å¯¹ä¼ é€’çš„ç›´æ¥é“¾æ¥" title="3.1 é”®å€¼å¯¹ä¼ é€’çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// context ä¼ é€’ä¸Šä¸‹æ–‡ä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"context"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">type</span><span class="token plain"> TraceId </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> TraceIdKey </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">TraceId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"trace_id"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ctx </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">WithValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Background</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> TraceIdKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"main start..."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¬¬ä¸€è·³</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">processOne</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">processOne</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¬¬äºŒè·³</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">processTwo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">processTwo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    traceId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">_</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">TraceIdKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç»“æŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">traceId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="32-è¶…æ—¶å–æ¶ˆ">3.2 è¶…æ—¶å–æ¶ˆ<a href="https://yuluo-yx.github.io/blog/golang-context#32-%E8%B6%85%E6%97%B6%E5%8F%96%E6%B6%88" class="hash-link" aria-label="3.2 è¶…æ—¶å–æ¶ˆçš„ç›´æ¥é“¾æ¥" title="3.2 è¶…æ—¶å–æ¶ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// è°ƒç”¨å¤–éƒ¨æ¥å£æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°è¶…æ—¶çš„æƒ…å†µï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç”¨ context æ¥æ§åˆ¶ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"context"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"time"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">callAPI</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">error</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¼€å§‹è°ƒç”¨ API..."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶å¾ˆé•¿çš„æ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> err </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">longRunningTask</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> err </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"API è°ƒç”¨å®Œæˆã€‚ï¼ˆå¦‚æœçœ‹åˆ°æ­¤æ¶ˆæ¯ï¼Œè¯´æ˜æœªè¶…æ—¶ï¼‰"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">longRunningTask</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">error</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">select</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ¨¡æ‹Ÿè¿™ä¸ªä»»åŠ¡éœ€è¦ 5 ç§’æ‰èƒ½å®Œæˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">case</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain">time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">After</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">5</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åœ¨ä»»åŠ¡å®Œæˆå‰ï¼Œæ£€æŸ¥ context æ˜¯å¦è¢«å–æ¶ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">case</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Done</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Errorf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä»»åŠ¡è¢«ä¸­æ–­: %w"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åˆ›å»ºä¸€ä¸ª 3 ç§’åä¼šè¶…æ—¶çš„ context</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> cancel </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">WithTimeout</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Background</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain">time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">defer</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">cancel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> err </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">callAPI</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> err </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Printf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"API è°ƒç”¨å‡ºé”™: %v\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="33-ä¸»åŠ¨å–æ¶ˆ">3.3 ä¸»åŠ¨å–æ¶ˆ<a href="https://yuluo-yx.github.io/blog/golang-context#33-%E4%B8%BB%E5%8A%A8%E5%8F%96%E6%B6%88" class="hash-link" aria-label="3.3 ä¸»åŠ¨å–æ¶ˆçš„ç›´æ¥é“¾æ¥" title="3.3 ä¸»åŠ¨å–æ¶ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// å»ºç«‹ä¸€ä¸ªä¸»åŠ¨å–æ¶ˆçš„context</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å½“æˆ‘ä»¬éœ€è¦åœæ­¢ä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡æ—¶ï¼Œä½¿ç”¨ context å¯ä»¥æ–¹ä¾¿åœ°å‘å‡ºå–æ¶ˆä¿¡å·æ¥ç»“æŸä»»åŠ¡ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"context"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"time"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">monitor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> name </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Printf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ã€%sã€‘ç›‘æ§å¯åŠ¨...\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">select</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">case</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Done</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å½“ ctx.Done() è¢«å…³é—­æ—¶ï¼Œè¯´æ˜æ”¶åˆ°äº†å–æ¶ˆä¿¡å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Printf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ã€%sã€‘æ”¶åˆ°å–æ¶ˆä¿¡å·ï¼Œç›‘æ§åœæ­¢ã€‚åŸå› : %s\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">default</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ¨¡æ‹Ÿæ‰§è¡Œç›‘æ§ä»»åŠ¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Printf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ã€%sã€‘æ­£åœ¨ç›‘æ§ä¸­...\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Sleep</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åˆ›å»ºä¸€ä¸ªå¯ä»¥è¢«å–æ¶ˆçš„æ ¹ context</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> cancel </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">WithCancel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Background</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¯åŠ¨ä¸€ä¸ª goroutine æ‰§è¡Œç›‘æ§</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">go</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">monitor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"ç›‘æ§ 1 å·"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è®©ç›‘æ§è¿è¡Œ 5 ç§’</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Sleep</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">5</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 5 ç§’åï¼Œæ‰‹åŠ¨è°ƒç”¨ cancel å‡½æ•°ï¼Œå‘å‡ºå–æ¶ˆä¿¡å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä¸»ç¨‹åºï¼šå‘å‡ºå–æ¶ˆä¿¡å·ï¼"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">cancel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å†ç­‰å¾…ä¸€å°ä¼šï¼Œç¡®ä¿ goroutine å·²ç»é€€å‡º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Sleep</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä¸»ç¨‹åºï¼šé€€å‡ºã€‚"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="34-http-æœåŠ¡å™¨ä¼˜é›…å…³é—­">3.4 HTTP æœåŠ¡å™¨ä¼˜é›…å…³é—­<a href="https://yuluo-yx.github.io/blog/golang-context#34-http-%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BC%98%E9%9B%85%E5%85%B3%E9%97%AD" class="hash-link" aria-label="3.4 HTTP æœåŠ¡å™¨ä¼˜é›…å…³é—­çš„ç›´æ¥é“¾æ¥" title="3.4 HTTP æœåŠ¡å™¨ä¼˜é›…å…³é—­çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-go codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-go codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// context çš„ç»å…¸ç”¨æ³•ï¼ŒGo çš„ http.Server ä¸­ï¼Œæ¯ä¸ªè¯·æ±‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// çš„ http.Request éƒ½åŒ…å«ä¸€ä¸ª context.Context</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¯ä»¥ç”¨æ¥ä¼ é€’è¯·æ±‚çº§åˆ«çš„å€¼ï¼Œä»¥åŠå–æ¶ˆä¿¡å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å½“å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œctx.Done() ä¼šæ”¶åˆ°ä¿¡å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Gin åŸºäº context æ¥å£å®ç°äº†è‡ªå·±çš„ gin.Contextï¼Œç”¨æ¥å¤„ç†è¯·æ±‚å’Œå“åº”</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"log"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"net/http"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"time"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">slowHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> r </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain">http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// r.Context() è¯·æ±‚ç»‘å®šçš„ context</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ctx </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> r</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Handler å¼€å§‹å¤„ç†è¯·æ±‚"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">defer</span><span class="token plain"> log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Handler å¤„ç†è¯·æ±‚ç»“æŸ"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">select</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">case</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain">time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">After</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶ 10 ç§’çš„æ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        fmt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Fprintln</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"è¯·æ±‚å¤„ç†å®Œæ¯•ï¼"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"è¯·æ±‚å¤„ç†å®Œæ¯•ï¼"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">case</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;-</span><span class="token plain">ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Done</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¦‚æœå®¢æˆ·ç«¯æ–­å¼€è¿æ¥ï¼Œctx.Done() ä¼šæ”¶åˆ°ä¿¡å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        err </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Printf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"è¯·æ±‚è¢«å®¢æˆ·ç«¯å–æ¶ˆ: %v"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">StatusRequestTimeout</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">func</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">HandleFunc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/slow"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> slowHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"æœåŠ¡å™¨å¯åŠ¨ï¼Œç›‘å¬ç«¯å£ :8080"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"è¯·åœ¨æµè§ˆå™¨è®¿é—® http://localhost:8080/slowï¼Œç„¶ååœ¨ 10 ç§’å†…å…³é—­æˆ–åœæ­¢åŠ è½½é¡µé¢"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> err </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:=</span><span class="token plain"> http</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">ListenAndServe</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">":8080"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">nil</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> err </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">Fatal</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>golang</category>
        </item>
        <item>
            <title><![CDATA[Apache Shenyu æœ¬åœ°å¯åŠ¨åŠå¿«é€Ÿå…¥é—¨]]></title>
            <link>https://yuluo-yx.github.io/blog/shenyu-init</link>
            <guid>https://yuluo-yx.github.io/blog/shenyu-init</guid>
            <pubDate>Thu, 31 Jul 2025 22:41:01 GMT</pubDate>
            <description><![CDATA[Apache ShenYu is a Java native API Gateway for service proxy, protocol conversion and API governance.]]></description>
            <content:encoded><![CDATA[<p>Apache ShenYu is a Java native API Gateway for service proxy, protocol conversion and API governance.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-ç¯å¢ƒå‡†å¤‡">1. ç¯å¢ƒå‡†å¤‡<a href="https://yuluo-yx.github.io/blog/shenyu-init#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87" class="hash-link" aria-label="1. ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥" title="1. ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æœ¬æ–‡ä¸­ä½¿ç”¨ MySQL æ¥ä½œä¸º ShenYu æ•°æ®åº“ï¼Œä½¿ç”¨ Docker Compose éƒ¨ç½² MySQLã€‚</p>
<blockquote>
<p>æˆ–è€…ä½¿ç”¨æœ¬åœ° MySQL æ•°æ®åº“ä¹Ÿå¯ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®åº“æ—¶è·³è½¬åˆ° 1.3 é…ç½®æ•°æ®åº“è¡¨ã€‚</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="11-docker-composeyml">1.1 docker-compose.yml<a href="https://yuluo-yx.github.io/blog/shenyu-init#11-docker-composeyml" class="hash-link" aria-label="1.1 docker-compose.ymlçš„ç›´æ¥é“¾æ¥" title="1.1 docker-compose.ymlçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">services</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">db</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">image</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> mysql</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">container_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> mysql</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">restart</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> always</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">command</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">default</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">authentication</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">plugin=caching_sha2_password </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">character</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">set</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">server=utf8mb4 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">collation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">server=utf8mb4_unicode_ci </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">explicit_defaults_for_timestamp=true </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">lower_case_table_names=1 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">max_allowed_packet=128M;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ports</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> 3306</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token number" style="color:hsl(35, 99%, 36%)">3306</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">volumes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> ./data</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">/var/lib/mysql</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> ./my.cnf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">/etc/my.cnf</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">ro</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> ./log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">/var/log/mysql</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> ./initdb.d</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain">/docker</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">entrypoint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">initdb.d</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">environment</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">MYSQL_ROOT_PASSWORD</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> toor</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="12-mysql-æ•°æ®åº“é…ç½®">1.2 MySQL æ•°æ®åº“é…ç½®<a href="https://yuluo-yx.github.io/blog/shenyu-init#12-mysql-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="1.2 MySQL æ•°æ®åº“é…ç½®çš„ç›´æ¥é“¾æ¥" title="1.2 MySQL æ•°æ®åº“é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-conf codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-conf codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[mysqld]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">skip-host-cache</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">skip-name-resolve</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">datadir=/var/lib/mysql</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">socket=/var/lib/mysql/mysql.sock</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">secure-file-priv=/var/lib/mysql-files</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">user=mysql</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pid-file=/var/run/mysqld/mysqld.pid</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">tmpdir=/tmp</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="13-sql-æ–‡ä»¶é…ç½®">1.3 SQL æ–‡ä»¶é…ç½®ï¼š<a href="https://yuluo-yx.github.io/blog/shenyu-init#13-sql-%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="1.3 SQL æ–‡ä»¶é…ç½®ï¼šçš„ç›´æ¥é“¾æ¥" title="1.3 SQL æ–‡ä»¶é…ç½®ï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>SQL æ•°æ®æ–‡ä»¶ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/apache/shenyu/blob/master/db/init/mysql/schema.sql" target="_blank" rel="noopener noreferrer">https://github.com/apache/shenyu/blob/master/db/init/mysql/schema.sql</a></p>
<p>å°†æ•°æ®æ–‡ä»¶åœ¨åŒçº§ç›®å½•çš„ init.d ç›®å½•ä¸‹å¹¶æ”¹ä¸º init.sql.</p>
<blockquote>
<p>Tips: æˆ–è€…ä¸è‡ªåŠ¨æ‰§è¡Œ sql è„šæœ¬ï¼Œå¯åŠ¨ä¹‹åæ‰‹åŠ¨æ‰§è¡Œ sql æ–‡ä»¶ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-å·¥å…·å’Œä»£ç ä¸‹è½½">2. å·¥å…·å’Œä»£ç ä¸‹è½½<a href="https://yuluo-yx.github.io/blog/shenyu-init#2-%E5%B7%A5%E5%85%B7%E5%92%8C%E4%BB%A3%E7%A0%81%E4%B8%8B%E8%BD%BD" class="hash-link" aria-label="2. å·¥å…·å’Œä»£ç ä¸‹è½½çš„ç›´æ¥é“¾æ¥" title="2. å·¥å…·å’Œä»£ç ä¸‹è½½çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æœ¬æ–‡ä¸­ä½¿ç”¨ IDEAï¼Œä» Github clone ä»“åº“å¹¶ä½¿ç”¨ IDEA æ‰“å¼€ã€‚</p>
<p>Githubï¼š<a href="https://github.com/apache/shenyu" target="_blank" rel="noopener noreferrer">https://github.com/apache/shenyu</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-ç¼–è¯‘åŠå¯åŠ¨">3. ç¼–è¯‘åŠå¯åŠ¨<a href="https://yuluo-yx.github.io/blog/shenyu-init#3-%E7%BC%96%E8%AF%91%E5%8F%8A%E5%90%AF%E5%8A%A8" class="hash-link" aria-label="3. ç¼–è¯‘åŠå¯åŠ¨çš„ç›´æ¥é“¾æ¥" title="3. ç¼–è¯‘åŠå¯åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="31-å®‰è£…ç¼–è¯‘">3.1 å®‰è£…ç¼–è¯‘<a href="https://yuluo-yx.github.io/blog/shenyu-init#31-%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91" class="hash-link" aria-label="3.1 å®‰è£…ç¼–è¯‘çš„ç›´æ¥é“¾æ¥" title="3.1 å®‰è£…ç¼–è¯‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å°† shenyu å®‰è£…åˆ°æœ¬åœ°çš„ mvn ä»“åº“ï¼Œ<strong>åé¢å¯åŠ¨ example æ—¶éœ€è¦ç”¨åˆ°ã€‚</strong></p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">mvn clean </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'-Dmaven.javadoc.skip=true'</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'-B'</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'-Drat.skip=true'</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'-Djacoco.skip=true'</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'-DskipITs'</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'-DskipTests'</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="32-é…ç½®ä¿®æ”¹">3.2 é…ç½®ä¿®æ”¹<a href="https://yuluo-yx.github.io/blog/shenyu-init#32-%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9" class="hash-link" aria-label="3.2 é…ç½®ä¿®æ”¹çš„ç›´æ¥é“¾æ¥" title="3.2 é…ç½®ä¿®æ”¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ol>
<li>å°† shenyu-admin/src/resource/application.yml#24 ä¸­çš„æ¿€æ´»é…ç½®ä» h2 æ”¹ä¸º mysql</li>
<li>å°† shenyu-admin/src/resource/application-mysql.yml#25 ä¸­çš„ MySQL å¯†ç æ”¹ä¸º 1.1 ä¸­çš„ <code>toor</code> æˆ–è€…ä½ è‡ªå·±çš„æ•°æ®åº“å¯†ç ã€‚</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="33-å¯åŠ¨">3.3 å¯åŠ¨<a href="https://yuluo-yx.github.io/blog/shenyu-init#33-%E5%90%AF%E5%8A%A8" class="hash-link" aria-label="3.3 å¯åŠ¨çš„ç›´æ¥é“¾æ¥" title="3.3 å¯åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ol>
<li>å¯åŠ¨ Admin ç®¡ç†ç«¯ï¼ˆä½œä¸ºç½‘å…³æ§åˆ¶é¢ï¼‰ org.apache.shenyu.admin.ShenyuAdminBootstrap</li>
<li>å¯åŠ¨ ShenYu ç½‘å…³ï¼ˆä½œä¸ºç½‘å…³æ•°æ®é¢ï¼‰org.apache.shenyu.bootstrap.ShenyuBootstrapApplication</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="34-è®¿é—®-admin-é¡µé¢">3.4 è®¿é—® Admin é¡µé¢<a href="https://yuluo-yx.github.io/blog/shenyu-init#34-%E8%AE%BF%E9%97%AE-admin-%E9%A1%B5%E9%9D%A2" class="hash-link" aria-label="3.4 è®¿é—® Admin é¡µé¢çš„ç›´æ¥é“¾æ¥" title="3.4 è®¿é—® Admin é¡µé¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æµè§ˆå™¨è®¿é—® <code>http://127.0.0.1:9095</code>ï¼Œé»˜è®¤çš„ç”¨æˆ·åå¯†ç ä¸ºï¼šadmin/123456ã€‚</p>
<blockquote>
<p>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä½ å°†ä¼šçœ‹åˆ° shenyu ç½‘å…³çš„ Admin é¡µé¢ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="4-example-æµ‹è¯•">4. Example æµ‹è¯•<a href="https://yuluo-yx.github.io/blog/shenyu-init#4-example-%E6%B5%8B%E8%AF%95" class="hash-link" aria-label="4. Example æµ‹è¯•çš„ç›´æ¥é“¾æ¥" title="4. Example æµ‹è¯•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æ¥ä¸‹æ¥ä½¿ç”¨ shenyu-examples/shenyu-examples-http ä½œä¸ºæµ‹è¯•æœåŠ¡ï¼Œä½¿ç”¨ IDEA å•ç‹¬æ‰“å¼€æˆ–è€…ä¸ºå…¶è®¾ç½®å·¥ä½œç›®å½•ã€‚</p>
<blockquote>
<p>Tips: åŠ¡å¿…å®Œæˆ 3.1 çš„ç¼–è¯‘åŠ¨ä½œï¼</p>
</blockquote>
<p>å®Œæˆ example å¯åŠ¨ä¹‹åï¼Œè§‚å¯Ÿå„ä¸ªæœåŠ¡æ§åˆ¶å°ï¼Œä¼šçœ‹åˆ°æ—¥å¿—è¾“å‡ºã€‚</p>
<p>ç„¶ååœ¨ Admin æ§åˆ¶å°å¯ä»¥çœ‹åˆ°å·²ç»æ³¨å†Œçš„çš„ http è·¯ç”±ï¼š</p>
<p>å¯åŠ¨ä¹‹å‰ï¼š</p>
<p><img decoding="async" loading="lazy" alt="è·¯ç”±æœªæ³¨å†Œ" src="https://yuluo-yx.github.io/assets/images/image2-662abba61a59575946fe6eb1fcde1175.png" width="2248" height="833" class="img_c29J"></p>
<p>å¯åŠ¨ä¹‹åï¼š</p>
<p><img decoding="async" loading="lazy" alt="è·¯ç”±æ³¨å†ŒæˆåŠŸ" src="https://yuluo-yx.github.io/assets/images/image1-cfac9a8c90a60319e4d9b611b07f0508.png" width="1278" height="521" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="5-æµé‡å¤„ç†">5. æµé‡å¤„ç†<a href="https://yuluo-yx.github.io/blog/shenyu-init#5-%E6%B5%81%E9%87%8F%E5%A4%84%E7%90%86" class="hash-link" aria-label="5. æµé‡å¤„ç†çš„ç›´æ¥é“¾æ¥" title="5. æµé‡å¤„ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>é¦–å…ˆéœ€è¦æ˜ç¡®ä¸‹é¢ä¸€äº›ç»†èŠ‚é—®é¢˜ï¼š</p>
<ol>
<li>Shenyu ç½‘å…³æµé‡é€šè¿‡æ’ä»¶å’Œé€‰æ‹©å™¨ä»¥åŠè·¯ç”±è§„åˆ™æ¥æ§åˆ¶ï¼›</li>
<li>ç½‘å…³æµé‡å…¥å£åœ¨ï¼šorg.apache.shenyu.web.handler.ShenyuWebHandler.DefaultShenyuPluginChain#execute</li>
<li>æ’ä»¶æ‰§è¡Œé“¾è·¯åœ¨ï¼Œå®Œæˆè·¯ç”±è§„åˆ™çš„ç­›é€‰å¹¶äº¤ç”±æ’ä»¶å®ç°æ‰§è¡Œï¼šorg.apache.shenyu.plugin.base.AbstractShenyuPlugin#execute</li>
</ol>
<p>é€šè¿‡æ–­ç‚¹å³å¯çœ‹åˆ°æ‰§è¡Œçš„æ’ä»¶é“¾ä»¥åŠæ’ä»¶æ•°æ®ä¿¡æ¯ç­‰</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£<a href="https://yuluo-yx.github.io/blog/shenyu-init#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3" class="hash-link" aria-label="å‚è€ƒæ–‡æ¡£çš„ç›´æ¥é“¾æ¥" title="å‚è€ƒæ–‡æ¡£çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li><a href="https://shenyu.apache.org/zh/docs/deployment/deployment-before" target="_blank" rel="noopener noreferrer">https://shenyu.apache.org/zh/docs/deployment/deployment-before</a></li>
<li><a href="https://shenyu.apache.org/zh/docs/deployment/deployment-local" target="_blank" rel="noopener noreferrer">https://shenyu.apache.org/zh/docs/deployment/deployment-local</a></li>
<li><a href="https://shenyu.apache.org/zh/blog/Plugin-SourceCode-Analysis-Divide-Plugin/" target="_blank" rel="noopener noreferrer">https://shenyu.apache.org/zh/blog/Plugin-SourceCode-Analysis-Divide-Plugin/</a></li>
<li><a href="https://github.com/deigmata-paideias/deigmata-paideias/blob/main/docker-compose-tmpl/mysql" target="_blank" rel="noopener noreferrer">https://github.com/deigmata-paideias/deigmata-paideias/blob/main/docker-compose-tmpl/mysql</a></li>
</ol>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>shenyu</category>
            <category>gateway</category>
        </item>
        <item>
            <title><![CDATA[Java & Go SDK ç®¡ç†å®è·µ]]></title>
            <link>https://yuluo-yx.github.io/blog/java-and-go-sdk-manager</link>
            <guid>https://yuluo-yx.github.io/blog/java-and-go-sdk-manager</guid>
            <pubDate>Sat, 05 Jul 2025 21:19:22 GMT</pubDate>
            <description><![CDATA[æµè¡Œçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="æµè¡Œçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·">æµè¡Œçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#%E6%B5%81%E8%A1%8C%E7%9A%84%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7" class="hash-link" aria-label="æµè¡Œçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·çš„ç›´æ¥é“¾æ¥" title="æµè¡Œçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<table><thead><tr><th>ç±»åˆ«</th><th>å·¥å…·åç§°</th><th>GitHubé“¾æ¥</th><th>Staræ•°</th></tr></thead><tbody><tr><td>Java SDK</td><td>Jabba</td><td><a href="https://github.com/shyiko/jabba" target="_blank" rel="noopener noreferrer">https://github.com/shyiko/jabba</a></td><td>3.2k</td></tr><tr><td></td><td>Jenv</td><td><a href="https://github.com/jenv/jenv" target="_blank" rel="noopener noreferrer">https://github.com/jenv/jenv</a></td><td>6.2k</td></tr><tr><td></td><td>SDKMan</td><td><a href="https://github.com/sdkman/sdkman-cli" target="_blank" rel="noopener noreferrer">https://github.com/sdkman/sdkman-cli</a></td><td>6.4k</td></tr><tr><td>Go SDK</td><td>GVM</td><td><a href="https://github.com/moovweb/gvm" target="_blank" rel="noopener noreferrer">https://github.com/moovweb/gvm</a></td><td>10.9k</td></tr><tr><td></td><td>voidint/g</td><td><a href="https://github.com/voidint/g" target="_blank" rel="noopener noreferrer">https://github.com/voidint/g</a></td><td>2.2k</td></tr><tr><td></td><td>Goenv</td><td><a href="https://github.com/go-nv/goenv" target="_blank" rel="noopener noreferrer">https://github.com/go-nv/goenv</a></td><td>2.3k</td></tr></tbody></table>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="java-sdk-ç®¡ç†å·¥å…·å®è·µ">Java SDK ç®¡ç†å·¥å…·å®è·µ<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#java-sdk-%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E5%AE%9E%E8%B7%B5" class="hash-link" aria-label="Java SDK ç®¡ç†å·¥å…·å®è·µçš„ç›´æ¥é“¾æ¥" title="Java SDK ç®¡ç†å·¥å…·å®è·µçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¼€å§‹ä¹‹å‰å…ˆçœ‹ä¸‹è‡ªå·±æœ¬åœ°çš„ JDK ç‰ˆæœ¬ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># yuluo @ ğŸ’¯ Everything wins. in ~ [17:26:49]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-version</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">openjdk version </span><span class="token string" style="color:hsl(119, 34%, 47%)">"23.0.2"</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2025</span><span class="token plain">-01-21</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">OpenJDK Runtime Environment Homebrew </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">build </span><span class="token number" style="color:hsl(35, 99%, 36%)">23.0</span><span class="token plain">.2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">OpenJDK </span><span class="token number" style="color:hsl(35, 99%, 36%)">64</span><span class="token plain">-Bit Server VM Homebrew </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">build </span><span class="token number" style="color:hsl(35, 99%, 36%)">23.0</span><span class="token plain">.2, mixed mode, sharing</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å¸è½½ é€šè¿‡ brew install çš„ java å’Œ mvn</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">brew uninstall --ignore-dependencies </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">brew uninstall mvn</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å¦‚æœä¸æƒ³å¸è½½ï¼Œéœ€è¦å»ºç«‹è½¯é“¾æ¥è®© sdkman å¯ä»¥è¯†åˆ«åˆ°å·²ç»å®‰è£…çš„ java</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å‚è€ƒ https://blog.csdn.net/gp_911014/article/details/138579268</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>è¿™é‡Œé€‰æ‹©ä½¿ç”¨ star æ•°æœ€é«˜çš„ sdkmanã€‚</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="sdkman">SDKMan<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#sdkman" class="hash-link" aria-label="SDKMançš„ç›´æ¥é“¾æ¥" title="SDKMançš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å®‰è£…">å®‰è£…<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#%E5%AE%89%E8%A3%85" class="hash-link" aria-label="å®‰è£…çš„ç›´æ¥é“¾æ¥" title="å®‰è£…çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># ç»ˆç«¯ä¸­æ‰§è¡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-s</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"https://get.sdkman.io"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># è¾“å‡ºå¦‚ä¸‹ï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">All done</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">You are subscribed to the STABLE channel.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Please </span><span class="token function" style="color:hsl(221, 87%, 60%)">open</span><span class="token plain"> a new terminal, or run the following </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> the existing one:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">source</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/Users/yuluo/.sdkman/bin/sdkman-init.sh"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Then issue the following command:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    sdk </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">help</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Enjoy</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æ–°å¼€ä¸€ä¸ªç»ˆç«¯æ‰§è¡Œï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">source</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"</span><span class="token string environment constant" style="color:hsl(35, 99%, 36%)">$HOME</span><span class="token string" style="color:hsl(119, 34%, 47%)">/.sdkman/bin/sdkman-init.sh"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æ£€æŸ¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ sdk version</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">SDKMAN</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">script: </span><span class="token number" style="color:hsl(35, 99%, 36%)">5.19</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">native: </span><span class="token number" style="color:hsl(35, 99%, 36%)">0.7</span><span class="token plain">.4 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">macos aarch64</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ä½¿ç”¨">ä½¿ç”¨<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#%E4%BD%BF%E7%94%A8" class="hash-link" aria-label="ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="java-sdk">Java SDK<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#java-sdk" class="hash-link" aria-label="Java SDKçš„ç›´æ¥é“¾æ¥" title="Java SDKçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŸ¥çœ‹å¸®åŠ©</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">help</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">help</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŸ¥çœ‹å½“å‰çš„ java sdk</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk current</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># åˆ—å‡ºå¯å®‰è£…çš„ java sdk</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk list </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> Oracle        </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">     </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">24.0</span><span class="token plain">.1       </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> oracle  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">            </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">24.0</span><span class="token plain">.1-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">               </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">     </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">24</span><span class="token plain">           </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> oracle  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">            </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">24</span><span class="token plain">-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">               </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">     </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">23.0</span><span class="token plain">.2       </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> oracle  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">            </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">23.0</span><span class="token plain">.2-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">               </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">     </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">22.0</span><span class="token plain">.2       </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> oracle  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">            </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">22.0</span><span class="token plain">.2-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">               </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">     </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">21.0</span><span class="token plain">.7       </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> oracle  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">            </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">21.0</span><span class="token plain">.7-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">               </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">     </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">21.0</span><span class="token plain">.6       </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> oracle  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">            </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">21.0</span><span class="token plain">.6-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å®‰è£…ä¸€ä¸ª java sdk é€‰æ‹© oracle jdk</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># åˆ†åˆ«å®‰è£… 17 å’Œ 24 ç‰ˆæœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">24</span><span class="token plain">-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17.0</span><span class="token plain">.12-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ä½¿ç”¨ java 17</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk use </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17.0</span><span class="token plain">.12-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Using </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> version </span><span class="token number" style="color:hsl(35, 99%, 36%)">17.0</span><span class="token plain">.12-oracle </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> this shell</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŸ¥çœ‹å½“å‰çš„ java sdk</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk current</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># åˆ‡æ¢è‡³ 24 ç‰ˆæœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk use </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">24</span><span class="token plain">-oracle</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å¸è½½</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk uninstall </span><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">17.0</span><span class="token plain">.12-oracle</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="maven">Maven<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#maven" class="hash-link" aria-label="Mavençš„ç›´æ¥é“¾æ¥" title="Mavençš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<p>sdkman è¿˜èƒ½ç®¡ç† maven å’Œ gradleï¼Œscalaï¼Œgroovy ç­‰ã€‚</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># åˆ—å‡ºå¯ç”¨çš„ maven</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk list maven</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å®‰è£…</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sdk </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> maven</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŸ¥çœ‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">mvn </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-v</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>å¦‚æœå®‰è£…çš„ sdk å‘½ä»¤æ²¡æœ‰å‡ºç°æ—¶ï¼Œæ‰§è¡Œ</p>
<p><code>source "$HOME/.sdkman/bin/sdkman-init.sh"</code></p>
<p>å³å¯ã€‚</p>
</blockquote>
<h5 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="gradle">Gradle<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#gradle" class="hash-link" aria-label="Gradleçš„ç›´æ¥é“¾æ¥" title="Gradleçš„ç›´æ¥é“¾æ¥">â€‹</a></h5>
<p>gradle å’Œ maven åŒç†ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="go-sdk-ç®¡ç†å·¥å…·å®è·µ">Go SDK ç®¡ç†å·¥å…·å®è·µ<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#go-sdk-%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E5%AE%9E%E8%B7%B5" class="hash-link" aria-label="Go SDK ç®¡ç†å·¥å…·å®è·µçš„ç›´æ¥é“¾æ¥" title="Go SDK ç®¡ç†å·¥å…·å®è·µçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>é€‰æ‹©ä½¿ç”¨ star æ•°æœ€å¤šçš„ GVM</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å®‰è£…-1">å®‰è£…<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#%E5%AE%89%E8%A3%85-1" class="hash-link" aria-label="å®‰è£…çš„ç›´æ¥é“¾æ¥" title="å®‰è£…çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">zsh</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-s</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-S</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-L</span><span class="token plain"> https://raw.githubusercontent.com/moovweb/gvm/13b10b604255360a9a559c2ea23ba42e75cb536e/binscripts/gvm-installer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">source</span><span class="token plain"> ~/.gvm/scripts/gvm</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å‚æ•°è®¾ç½®">å‚æ•°è®¾ç½®<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE" class="hash-link" aria-label="å‚æ•°è®¾ç½®çš„ç›´æ¥é“¾æ¥" title="å‚æ•°è®¾ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># GVM çš„å®‰è£…åŒ…è·å–åœ°å€</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">GVM_GO_GET</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">'https://golang.google.cn/dl/'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Go proxy https://goproxy.cn/</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">GO111MODULE</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">on</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">GOPROXY</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">https://goproxy.cn</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å‘½ä»¤ä½¿ç”¨">å‘½ä»¤ä½¿ç”¨<a href="https://yuluo-yx.github.io/blog/java-and-go-sdk-manager#%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8" class="hash-link" aria-label="å‘½ä»¤ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="å‘½ä»¤ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¦‚é‡åˆ°ä¸‹è½½æ…¢ç­‰ï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://blog.csdn.net/Narutolxy/article/details/143017169" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/Narutolxy/article/details/143017169</a></p>
<div class="language-plain codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-plain codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¾“å…¥ gvm å¯ä»¥çœ‹åˆ°æä¾›çš„å‘½ä»¤</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gvm</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># å®‰è£… SDK æ‹‰å–æºç åŒ…ç¼–è¯‘å®‰è£…</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gvm install go1.24.2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ç›´æ¥ä¸‹è½½äºŒè¿›åˆ¶å®‰è£…</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gvm install go1.24.2 --binary</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># æ˜¾ç¤ºç‰ˆæœ¬</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ gvm list</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gvm gos (installed)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   go1.24.2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">=&gt; go1.24.4</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   system</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># åˆ‡æ¢ä¸´æ—¶ç‰ˆæœ¬</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gvm use go1.22.11</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># è®¾ç½®æŸä¸ªç‰ˆæœ¬ä¸ºé»˜è®¤ SDK</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gvm use go1.22.11 --default</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># éªŒè¯</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">go version</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>Java</category>
            <category>Go</category>
        </item>
        <item>
            <title><![CDATA[Google ADK Java QuickStart]]></title>
            <link>https://yuluo-yx.github.io/blog/google-adk-java-quickstart</link>
            <guid>https://yuluo-yx.github.io/blog/google-adk-java-quickstart</guid>
            <pubDate>Fri, 27 Jun 2025 23:34:54 GMT</pubDate>
            <description><![CDATA[1. ADK ä»‹ç»]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-adk-ä»‹ç»">1. ADK ä»‹ç»<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#1-adk-%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="1. ADK ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="1. ADK ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Agent Development Kit (ADK) æ˜¯ä¸€ä¸ªçµæ´»çš„æ¨¡å—åŒ–æ¡†æ¶ï¼Œç”¨äºå¼€å‘å’Œéƒ¨ç½² AI Agentã€‚ADK å¯¹ Gemini å’Œ Google ç”Ÿæ€ç³»ç»Ÿè¿›è¡Œäº†ä¼˜åŒ–ã€‚åŒæ—¶ä¸æ¨¡å‹å’Œéƒ¨ç½²æ— å…³ï¼Œå¹¶ä¸”ä¸å…¶ä»–æ¡†æ¶å…¼å®¹ã€‚ADK æ—¨åœ¨ä½¿ Agent å¼€å‘æ›´åƒè½¯ä»¶å¼€å‘é‚£æ ·ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ›´è½»æ¾åœ°åˆ›å»ºã€éƒ¨ç½²å’Œç¼–æ’ä»ç®€å•ä»»åŠ¡åˆ°å¤æ‚å·¥ä½œæµçš„ Agent åº”ç”¨ã€‚</p>
<p>ä¸»è¦ç‰¹ç‚¹</p>
<ul>
<li><strong>ä¸°å¯Œçš„å·¥å…·ç”Ÿæ€ç³»ç»Ÿ</strong>ï¼šåˆ©ç”¨é¢„å…ˆæ„å»ºçš„å·¥å…·ã€è‡ªå®šä¹‰åŠŸèƒ½ã€OpenAPI è§„èŒƒæˆ–é›†æˆç°æœ‰å·¥å…·ï¼Œä¸ºä»£ç†æä¾›å¤šæ ·åŒ–çš„åŠŸèƒ½ï¼Œæ‰€æœ‰è¿™äº›éƒ½æ˜¯ä¸ºäº†ä¸ Google ç”Ÿæ€ç³»ç»Ÿç´§å¯†é›†æˆã€‚</li>
<li><strong>ä»£ç ä¼˜å…ˆå¼€å‘</strong>ï¼šç›´æ¥åœ¨ Python ä¸­å®šä¹‰ä»£ç†é€»è¾‘ã€å·¥å…·å’Œç¼–æ’ï¼Œä»¥å®ç°æœ€å¤§çš„çµæ´»æ€§ã€å¯æµ‹è¯•æ€§å’Œç‰ˆæœ¬æ§åˆ¶ã€‚</li>
<li><strong>æ¨¡å—åŒ–å¤šä»£ç†ç³»ç»Ÿ</strong>ï¼šé€šè¿‡å°†å¤šä¸ªä¸“é—¨çš„ä»£ç†ç»„åˆæˆçµæ´»çš„å±‚æ¬¡ç»“æ„æ¥è®¾è®¡å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºã€‚</li>
<li><strong>éšå¤„éƒ¨ç½²</strong>ï¼šè½»æ¾åœ¨ Cloud Run ä¸Šå®¹å™¨åŒ–å’Œéƒ¨ç½²ä»£ç†ï¼Œæˆ–ä½¿ç”¨ Vertex AI Agent Engine æ— ç¼æ‰©å±•ã€‚</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-adk-java">2. ADK Java<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#2-adk-java" class="hash-link" aria-label="2. ADK Javaçš„ç›´æ¥é“¾æ¥" title="2. ADK Javaçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>è€Œ ADK Java åˆ™æ˜¯ ADK Python çš„ Java å®ç°ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-adk-java-examples">3. ADK Java Examples<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#3-adk-java-examples" class="hash-link" aria-label="3. ADK Java Examplesçš„ç›´æ¥é“¾æ¥" title="3. ADK Java Examplesçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ç¼–å†™ç¤ºä¾‹ä¹‹å‰éœ€è¦è·å–åˆ° Google Genmini æ¨¡å‹çš„ ak å¹¶é…ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">GOOGLE_GENAI_USE_VERTEXAI</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">FALSE</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">GOOGLE_API_KEY</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">AK</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="31-ä»£ç ">3.1 ä»£ç <a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#31-%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="3.1 ä»£ç çš„ç›´æ¥é“¾æ¥" title="3.1 ä»£ç çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ­¤ç¤ºä¾‹ä½¿ç”¨ ADK Java æ–‡æ¡£ä¸­çš„ä»£ç ï¼š<a href="https://google.github.io/adk-docs/get-started/quickstart/#create-agent-project" target="_blank" rel="noopener noreferrer">https://google.github.io/adk-docs/get-started/quickstart/#create-agent-project</a></p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">package</span><span class="token plain"> </span><span class="token namespace">indi</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">yuluo</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">java</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">agent</span><span class="token namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token namespace">multitool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">agents</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">BaseAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">agents</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">LlmAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">events</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">runner</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">InMemoryRunner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">sessions</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Session</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">tools</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Annotations</span><span class="token import punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Schema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">adk</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">tools</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">FunctionTool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">genai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">types</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">google</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">genai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">types</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">io</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">reactivex</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">rxjava3</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">core</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Flowable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">nio</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">charset</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">StandardCharsets</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">text</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Normalizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">time</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">ZoneId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">time</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">ZonedDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">time</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">format</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">DateTimeFormatter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Scanner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author yuluo</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author &lt;a href="mailto:yuluo08290126@gmail.com"&gt;yuluo&lt;/a&gt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MultiToolAgent</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">USER_ID</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"student"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">NAME</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"multi_tool_agent"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// The run your agent with Dev UI, the ROOT_AGENT should be a global public static variable.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaseAgent</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">ROOT_AGENT</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">initAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaseAgent</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">initAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LlmAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">NAME</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"gemini-2.0-flash"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">description</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Agent to answer questions about the time and weather in a city."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">instruction</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"You are a helpful agent who can answer user questions about the time and weather"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">" in a city."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FunctionTool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MultiToolAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"getCurrentTime"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FunctionTool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MultiToolAgent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"getWeather"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getCurrentTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Schema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">description </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"The name of the city for which to retrieve the current time"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> city</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> normalizedCity </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Normalizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">normalize</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">city</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Normalizer</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Form</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">NFD</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">trim</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toLowerCase</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">replaceAll</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"(\\p{IsM}+|\\p{IsP}+)"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">replaceAll</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\\s+"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"_"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ZoneId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getAvailableZoneIds</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">zid </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> zid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toLowerCase</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">endsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> normalizedCity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">findFirst</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        zid </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"status"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"success"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"The current time in "</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> city</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">" is "</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ZonedDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ZoneId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">zid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">format</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DateTimeFormatter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">ofPattern</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"HH:mm"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                                </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">orElse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"status"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"error"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"Sorry, I don't have timezone information for "</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> city </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getWeather</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Schema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">description </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"The name of the city for which to retrieve the weather report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> city</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">city</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toLowerCase</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"new york"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"status"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"success"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"The weather in New York is sunny with a temperature of 25 degrees Celsius (77 degrees"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                            </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">" Fahrenheit)."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token string" style="color:hsl(119, 34%, 47%)">"status"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"error"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"report"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"Weather information for "</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> city </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">" is not available."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">InMemoryRunner</span><span class="token plain"> runner </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">InMemoryRunner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">ROOT_AGENT</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Session</span><span class="token plain"> session </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                runner</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">sessionService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">createSession</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">NAME</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">USER_ID</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">blockingGet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Scanner</span><span class="token plain"> scanner </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Scanner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">in</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StandardCharsets</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">UTF_8</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">print</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\nYou &gt; "</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> userInput </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> scanner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nextLine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"quit"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equalsIgnoreCase</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">userInput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Content</span><span class="token plain"> userMsg </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">fromParts</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">fromText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">userInput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flowable</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Event</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> events </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> runner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">runAsync</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">USER_ID</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> session</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> userMsg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">print</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\nAgent &gt; "</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                events</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">blockingForEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stringifyContent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="32-è¿è¡Œ">3.2 è¿è¡Œ<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#32-%E8%BF%90%E8%A1%8C" class="hash-link" aria-label="3.2 è¿è¡Œçš„ç›´æ¥é“¾æ¥" title="3.2 è¿è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ol>
<li><strong>AdkWebServer</strong> ä¸èƒ½æ›´æ”¹ã€‚</li>
<li>è¿è¡Œæ­¤å‘½ä»¤éœ€è¦è·³è½¬åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼ˆæ—¢ pom.xml æ‰€åœ¨çš„ç›®å½•æ‰§è¡Œï¼‰</li>
</ol>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">mvn exec:java </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-Dexec.mainClass</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">"com.google.adk.web.AdkWebServer"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-Dexec.args</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">"--adk.agents.source-dir=src/main/java"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-Dexec.classpathScope</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">"compile"</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="33-è®¿é—®">3.3 è®¿é—®<a href="https://yuluo-yx.github.io/blog/google-adk-java-quickstart#33-%E8%AE%BF%E9%97%AE" class="hash-link" aria-label="3.3 è®¿é—®çš„ç›´æ¥é“¾æ¥" title="3.3 è®¿é—®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æµè§ˆå™¨æ‰“å¼€ localhost:8080 è®¿é—®å‰ç«¯é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ° Dev UIï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250626233522684" src="https://yuluo-yx.github.io/assets/images/image-20250626233522684-9a5f2073e17b5ac3d7e7d1e5ade84e08.png" width="1895" height="860" class="img_c29J"></p>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>AI</category>
            <category>ADK</category>
        </item>
        <item>
            <title><![CDATA[Gemini CLI QuickStart]]></title>
            <link>https://yuluo-yx.github.io/blog/gemini-cli-quickstart</link>
            <guid>https://yuluo-yx.github.io/blog/gemini-cli-quickstart</guid>
            <pubDate>Fri, 27 Jun 2025 23:34:00 GMT</pubDate>
            <description><![CDATA[Github ä»“åº“ï¼šhttps://github.com/google-gemini/gemini-cli]]></description>
            <content:encoded><![CDATA[<p>Github ä»“åº“ï¼š<a href="https://github.com/google-gemini/gemini-cli" target="_blank" rel="noopener noreferrer">https://github.com/google-gemini/gemini-cli</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ä»‹ç»">ä»‹ç»<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Gemini CLI æ˜¯ä¸€ä¸ªç”¨äºä¸ Google Gemini å¤§å‹è¯­è¨€æ¨¡å‹äº¤äº’çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ï¼ˆæ®ç›¸å…³æ¶ˆæ¯ï¼Œé€†å‘äº† Claude Codeï¼‰</p>
<p>ä¸ºå¼€å‘è€…ã€ç ”ç©¶å‘˜ä»¥åŠä»»ä½•éœ€è¦é€šè¿‡å‘½ä»¤è¡Œä¸ Gemini æ¨¡å‹äº¤äº’çš„ç”¨æˆ·æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„åŠŸèƒ½ã€‚</p>
<p>Gemini æ˜¯ Google DeepMind å¼€å‘çš„ä¸€ç³»åˆ—å¤šæ¨¡æ€äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œå…·å¤‡è¯­è¨€ã€éŸ³é¢‘ã€ä»£ç å’Œè§†é¢‘ç†è§£èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¤„ç†å¤šç§ä»»åŠ¡ï¼ŒåŒ…æ‹¬æ–‡æœ¬ç”Ÿæˆã€å¤šæ¨¡æ€å¯¹è¯ã€ä»£ç ç”Ÿæˆç­‰ã€‚</p>
<p>åœ¨ 6 æœˆ 25 æ—¥ï¼Œè°·æ­Œæ­£å¼æ¨å‡ºäº†<strong>Gemini CLI</strong> ï¼Œå°† Gemini å¤§æ¨¡å‹çš„å¼ºå¤§èƒ½åŠ›ç›´æ¥èå…¥åˆ°å¼€å‘è€…æ—¥å¸¸å‘½ä»¤è¡Œç•Œé¢ä¸­ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="star-èµ°åŠ¿">Star èµ°åŠ¿<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#star-%E8%B5%B0%E5%8A%BF" class="hash-link" aria-label="Star èµ°åŠ¿çš„ç›´æ¥é“¾æ¥" title="Star èµ°åŠ¿çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>ä¸å¾—ä¸æ Github star èµ°åŠ¿ã€‚åœ¨ 26 å·ï¼ŒGemini CLI é¡¹ç›® star çˆ†å‘å¼å¢é•¿ï¼Œæˆªæ­¢ 6 æœˆ 26 æ—¥ æ™šï¼Œå·²ç»åˆ°äº† 26k starã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20250626235009715" src="https://yuluo-yx.github.io/assets/images/image-20250626235009715-f9e804854278604cd6ef2d9f5c4ec3da.png" width="1131" height="744" class="img_c29J"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å®‰è£…">å®‰è£…<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E5%AE%89%E8%A3%85" class="hash-link" aria-label="å®‰è£…çš„ç›´æ¥é“¾æ¥" title="å®‰è£…çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># å®‰è£…</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">npm</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-g</span><span class="token plain"> @google/gemini-cli </span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é…ç½®">é…ç½®<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="é…ç½®çš„ç›´æ¥é“¾æ¥" title="é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åŒæ—¶ï¼ŒGemini CLI å¯ä»¥ä½¿ç”¨ Google è´¦å·ç™»é™†ï¼Œå…è®¸æ¯åˆ†é’Ÿæœ€å¤š 60 ä¸ªæ¨¡å‹è¯·æ±‚ï¼Œæ¯å¤©æœ€å¤š 1000 ä¸ªæ¨¡å‹è¯·æ±‚ã€‚</p>
<blockquote>
<p>åœ¨æ­¤ä¹‹å‰ï¼Œéœ€è¦æœ‰ Gemini çš„ AKã€‚å¦‚æœä½“éªŒé«˜çº§åŠŸèƒ½æˆ–è€…ç‰¹å®šæ¨¡å‹éœ€è¦æ­¤é…ç½®ã€‚</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="å¯åŠ¨">å¯åŠ¨<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E5%90%AF%E5%8A%A8" class="hash-link" aria-label="å¯åŠ¨çš„ç›´æ¥é“¾æ¥" title="å¯åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>
<p>åœ¨ terminal ä¸­è¾“å…¥ <code>gemini</code> å¯åŠ¨ cliï¼›</p>
</li>
<li>
<p>é€‰æ‹©ä¸»é¢˜ï¼š<strong>ï¼ˆé€šè¿‡ tab + æ–¹å‘ä¸Šä¸‹é”®é€‰æ‹©ï¼‰</strong></p>
<p>åœ¨è¾“å…¥ gemini ä¹‹åï¼Œå°†ä¼šçœ‹åˆ°å¦‚ä¸‹é¡µé¢</p>
<p><img decoding="async" loading="lazy" alt="image-20250626235840772" src="https://yuluo-yx.github.io/assets/images/image-20250626235840772-2d52b6bb4ac8f6e7136388b9300af4b9.png" width="2334" height="838" class="img_c29J"></p>
<p>é—æ†¾çš„æ˜¯ï¼Œä¸ªåˆ«ä¸»é¢˜å¯¹ windows ç»ˆç«¯é€‚é…æœ‰ bugï¼šåƒä¸‹é¢è¿™æ ·ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250626235953023" src="https://yuluo-yx.github.io/assets/images/image-20250626235953023-5a29c62957544b1251c58286b6f698ed.png" width="623" height="475" class="img_c29J"></p>
<p>è¿™é‡Œä¹Ÿæ˜¯é€‰äº†æœ€ç«çš„ Atom One ä¸»é¢˜ã€‚</p>
</li>
<li>
<p>èº«ä»½éªŒè¯ï¼Œå‡ºç°æ—¶ä½¿ç”¨ google è´¦å·ç™»å½•å³å¯ã€‚</p>
</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ä½¿ç”¨ä½“éªŒ">ä½¿ç”¨ä½“éªŒ<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C" class="hash-link" aria-label="ä½¿ç”¨ä½“éªŒçš„ç›´æ¥é“¾æ¥" title="ä½¿ç”¨ä½“éªŒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå°†ä¼šçœ‹åˆ°å¦‚ä¸‹çš„ç»ˆç«¯è¾“å…¥æ¡†ï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250627000142982" src="https://yuluo-yx.github.io/assets/images/image-20250627000142982-23efcbf11c89e24900d5292912cd84b3.png" width="2451" height="617" class="img_c29J"></p>
<p>æœ‰è¶£çš„æ˜¯ï¼Œåœ¨ç­‰å¾…è¿‡ç¨‹ä¸­ï¼Œgemini cli ä¼šè¾“å‡ºä¸€äº›å˜æ¢çš„ messageï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250627000907701" src="https://yuluo-yx.github.io/assets/images/image-20250627000907701-3341581bb4ad15af72b5966b3dca078f.png" width="975" height="187" class="img_c29J"></p>
<p>gemini cli è¿˜æ”¯æŒå…¶ä»–åŠŸèƒ½ï¼šç”Ÿæˆä¸€ä¸ªé¡¹ç›®ï¼Œè§£ææœ¬åœ°æ–‡ä»¶æ•°æ®ï¼Œè”ç½‘æœç´¢ç­‰ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="é—®é¢˜æ’æŸ¥">é—®é¢˜æ’æŸ¥<a href="https://yuluo-yx.github.io/blog/gemini-cli-quickstart#%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5" class="hash-link" aria-label="é—®é¢˜æ’æŸ¥çš„ç›´æ¥é“¾æ¥" title="é—®é¢˜æ’æŸ¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¦‚æœè®¿é—®å¤±è´¥ï¼Œé‚£ä¹ˆå°±ç”¨é­”æ³•ï¼š</p>
<p>Windows Powershellï¼š<code>$env:https_proxy="http://127.0.0.1:7890"</code></p>
<p>Mac/Linux: <code>$env:https_proxy="http://127.0.0.1:7890</code></p>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>AI</category>
            <category>Genmini CLI</category>
        </item>
        <item>
            <title><![CDATA[spring ai alibaba graph quickstart]]></title>
            <link>https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart</link>
            <guid>https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart</guid>
            <pubDate>Sat, 14 Jun 2025 23:40:21 GMT</pubDate>
            <description><![CDATA[æœ¬æ–‡ä¸­å°†é˜è¿°ä¸‹ AI æµç¨‹ç¼–æ’æ¡†æ¶å’Œ Spring AI Alibaba Graph ä»¥åŠå¦‚ä½•ä½¿ç”¨ã€‚]]></description>
            <content:encoded><![CDATA[<p>æœ¬æ–‡ä¸­å°†é˜è¿°ä¸‹ AI æµç¨‹ç¼–æ’æ¡†æ¶å’Œ Spring AI Alibaba Graph ä»¥åŠå¦‚ä½•ä½¿ç”¨ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-agent-æ™ºèƒ½ä½“">1. Agent æ™ºèƒ½ä½“<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#1-agent-%E6%99%BA%E8%83%BD%E4%BD%93" class="hash-link" aria-label="1. Agent æ™ºèƒ½ä½“çš„ç›´æ¥é“¾æ¥" title="1. Agent æ™ºèƒ½ä½“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ç»“åˆ Google å’Œ Authropic å¯¹ Agent çš„å®šä¹‰ï¼šAgent çš„å®šä¹‰ä¸ºï¼šæ™ºèƒ½ä½“ï¼ˆAgentï¼‰æ˜¯èƒ½å¤Ÿç‹¬ç«‹è¿è¡Œï¼Œæ„ŸçŸ¥å’Œç†è§£ç°å®ä¸–ç•Œå¹¶ä½¿ç”¨å·¥å…·æ¥å®ç°æœ€ç»ˆç›®æ ‡çš„åº”ç”¨ç¨‹åºã€‚</p>
<p>ä»æ¶æ„ä¸Šï¼Œå¯ä»¥å°† Agent åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ol>
<li>Workflows ç³»ç»Ÿï¼šäººç±»å¹²é¢„åšæ•´ä½“å†³ç­–ï¼ŒLLMs ä½œä¸º workflows é“¾è·¯çš„èŠ‚ç‚¹ã€‚<!-- -->
<ol>
<li>å…·æœ‰æ˜ç¡®è¯­ä¹‰çš„ç³»ç»Ÿï¼Œé¢„å…ˆå®šä¹‰å¥½ workflows æµç¨‹ï¼›</li>
<li>LLMs é€šè¿‡å„ä¸ª Node èŠ‚ç‚¹å¯¹ Workflows è·¯å¾„ç¼–æ’æ¥è¾¾åˆ°æœ€ç»ˆæ•ˆæœã€‚</li>
</ol>
</li>
<li>æ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆAgentsï¼‰ï¼šLLMs ä½œä¸ºå¤§è„‘å†³ç­–ï¼Œè‡ªé©±åŠ¨å®Œæˆä»»åŠ¡ã€‚<!-- -->
<ol>
<li>LLMs è‡ªå·±ç¼–æ’å’Œè§„åˆ’å·¥å…·è°ƒç”¨ï¼›</li>
<li>é€‚ç”¨äºæ¨¡å‹é©±åŠ¨å†³ç­–çš„åœºæ™¯ã€‚</li>
</ol>
</li>
</ol>
<p><strong>ä»¥ä¸Šä¸¤ç§æ¶æ„éƒ½åœ¨ Spring AI Alibaba é¡¹ç›®ä¸­æœ‰ä½“ç°ï¼šä¸€æ˜¯ JManus ç³»ç»Ÿã€‚äºŒæ˜¯åŸºäº spring ai alibaba graph æ„å»ºçš„ DeepResearch ç³»ç»Ÿã€‚</strong></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-ai-æ™ºèƒ½ä½“æ¡†æ¶ä»‹ç»">1. AI æ™ºèƒ½ä½“æ¡†æ¶ä»‹ç»<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#1-ai-%E6%99%BA%E8%83%BD%E4%BD%93%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="1. AI æ™ºèƒ½ä½“æ¡†æ¶ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="1. AI æ™ºèƒ½ä½“æ¡†æ¶ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨è¿‡å»ä¸€å¹´ä¸­ï¼ŒAI Infra å¿«é€Ÿå‘å±•ï¼Œæ¶Œç°äº†ä¸€ç³»åˆ—ä»¥ LangChain ä¸ºä»£ç çš„ AI åº”ç”¨å¼€å‘æ¡†æ¶ï¼Œåˆ°æœ€åŸºç¡€çš„åº”ç”¨å¼€å‘æ¡†æ¶åˆ°æ™ºèƒ½ä½“ç¼–æ’ï¼ŒAI åº”ç”¨è§‚æµ‹ç­‰ã€‚æ­¤ç« èŠ‚ä¸­ä¸»è¦ä»‹ç»ä¸‹ AI åº”ç”¨çš„æ™ºèƒ½ä½“ç¼–æ’æ¡†æ¶ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="11-microsoft-autogen">1.1 Microsoft AutoGen<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#11-microsoft-autogen" class="hash-link" aria-label="1.1 Microsoft AutoGençš„ç›´æ¥é“¾æ¥" title="1.1 Microsoft AutoGençš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Github  åœ°å€ï¼š<a href="https://github.com/microsoft/autogen" target="_blank" rel="noopener noreferrer">https://github.com/microsoft/autogen</a></p>
<p>ç”±å¾®è½¯å¼€æºçš„æ™ºèƒ½ä½“å¼€å‘æ¡†æ¶ï¼š<strong>AutoGen</strong> æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºå¯è‡ªä¸»è¡ŒåŠ¨æˆ–ä¸äººç±»ååŒå·¥ä½œçš„å¤šæ™ºèƒ½ä½“ AI åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="12-langgraph">1.2 LangGraph<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#12-langgraph" class="hash-link" aria-label="1.2 LangGraphçš„ç›´æ¥é“¾æ¥" title="1.2 LangGraphçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Github åœ°å€ï¼š<a href="https://github.com/langchain-ai/langgraph" target="_blank" rel="noopener noreferrer">https://github.com/langchain-ai/langgraph</a></p>
<p>ä»¥ LangGraph ä¸ºåŸºç¡€ï¼Œä½¿ç”¨å›¾ç»“æ„çš„ AI åº”ç”¨ç¼–æ’æ¡†æ¶ã€‚ç”± LangChain ç¤¾åŒºå¼€å‘ï¼Œç¤¾åŒºæ´»è·ƒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="13-crewai">1.3 CrewAI<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#13-crewai" class="hash-link" aria-label="1.3 CrewAIçš„ç›´æ¥é“¾æ¥" title="1.3 CrewAIçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Github åœ°å€ï¼š<a href="https://github.com/crewAIInc/crewAI" target="_blank" rel="noopener noreferrer">https://github.com/crewAIInc/crewAI</a></p>
<p>CrewAI æ˜¯ä¸€ä¸ªç²¾ç®€ã€å¿«é€Ÿçš„ Python æ¡†æ¶ï¼Œå®Œå…¨ä»é›¶æ„å»ºï¼Œå®Œå…¨<strong>ç‹¬ç«‹äº LangChain æˆ–å…¶ä»–ä»£ç†æ¡†æ¶</strong>ã€‚å®ƒä¸ºå¼€å‘äººå‘˜æä¾›äº†é«˜çº§çš„ç®€æ´æ€§å’Œç²¾ç¡®çš„åº•å±‚æ§åˆ¶ï¼Œéå¸¸é€‚åˆåˆ›å»ºé€‚åˆä»»ä½•åœºæ™¯çš„è‡ªä¸» AI ä»£ç†ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-spring-ai-alibaba-graph">2. Spring AI Alibaba Graph<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#2-spring-ai-alibaba-graph" class="hash-link" aria-label="2. Spring AI Alibaba Graphçš„ç›´æ¥é“¾æ¥" title="2. Spring AI Alibaba Graphçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Github åœ°å€ï¼š<a href="https://github.com/alibaba/spring-ai-alibaba/tree/main/spring-ai-alibaba-graph" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/spring-ai-alibaba/tree/main/spring-ai-alibaba-graph</a></p>
<blockquote>
<p>Spring AI Alibaba Graph æ˜¯ä¸€æ¬¾é¢å‘ Java å¼€å‘è€…çš„<strong>å·¥ä½œæµã€å¤šæ™ºèƒ½ä½“æ¡†æ¶</strong>ï¼Œç”¨äºæ„å»ºç”±å¤šä¸ª AI æ¨¡å‹æˆ–æ­¥éª¤ç»„æˆçš„å¤æ‚åº”ç”¨ã€‚é€šè¿‡å›¾ç»“æ„çš„å®šä¹‰ï¼Œæ¥æè¿°æ™ºèƒ½ä½“ä¸­çš„çŠ¶æ€æµè½¬é€»è¾‘ã€‚</p>
<p>æ¡†æ¶æ ¸å¿ƒåŒ…æ‹¬ï¼š<strong>StateGraph</strong>ï¼ˆçŠ¶æ€å›¾ï¼Œç”¨äºå®šä¹‰èŠ‚ç‚¹å’Œè¾¹ï¼‰ã€<strong>Node</strong>ï¼ˆèŠ‚ç‚¹ï¼Œå°è£…å…·ä½“æ“ä½œæˆ–æ¨¡å‹è°ƒç”¨ï¼‰ã€<strong>Edge</strong>ï¼ˆè¾¹ï¼Œè¡¨ç¤ºèŠ‚ç‚¹é—´çš„è·³è½¬å…³ç³»ï¼‰ä»¥åŠ <strong>OverAllState</strong>ï¼ˆå…¨å±€çŠ¶æ€ï¼Œè´¯ç©¿æµç¨‹å…±äº«æ•°æ®ï¼‰</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-å¿«é€Ÿå…¥é—¨">2.1 å¿«é€Ÿå…¥é—¨<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#21-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8" class="hash-link" aria-label="2.1 å¿«é€Ÿå…¥é—¨çš„ç›´æ¥é“¾æ¥" title="2.1 å¿«é€Ÿå…¥é—¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Demo åœ°å€ï¼š<a href="https://github.com/deigmata-paideias/deigmata-paideias/tree/main/ai/exmaple/spring-ai-alibaba-graph-demo" target="_blank" rel="noopener noreferrer">https://github.com/deigmata-paideias/deigmata-paideias/tree/main/ai/exmaple/spring-ai-alibaba-graph-demo</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="pomxml">pom.xml<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#pomxml" class="hash-link" aria-label="pom.xmlçš„ç›´æ¥é“¾æ¥" title="pom.xmlçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-dashscope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-graph-core</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.0.0.2</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.google.code.gson</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">gson</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencyManagement</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">3.4.5</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-bom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">1.0.0.2</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencyManagement</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="applicationyml">application.yml<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#applicationyml" class="hash-link" aria-label="application.ymlçš„ç›´æ¥é“¾æ¥" title="application.ymlçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">server</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">port</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">8081</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">dashscope</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">api-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">AI_DASHSCOPE_API_KEY</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="config">Config<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#config" class="hash-link" aria-label="Configçš„ç›´æ¥é“¾æ¥" title="Configçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">GraphRepresentation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">OverAllStateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">action</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">EdgeAction</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">exception</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">GraphStateException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">node</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">com</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">alibaba</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">cloud</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">state</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">strategy</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">ReplaceStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">indi</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">yuluo</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">graph</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">customnode</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">RecordingNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">slf4j</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">slf4j</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">chat</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">client</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">ai</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">chat</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">client</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">advisor</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">context</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Bean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">org</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">springframework</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">context</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">annotation</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Configuration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token import namespace">java</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import namespace">util</span><span class="token import namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token import static namespace">com</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">alibaba</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">cloud</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">ai</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">graph</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token import static punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static">END</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token import static namespace">com</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">alibaba</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">cloud</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">ai</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">graph</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token import static punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static">START</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token import static namespace">com</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">alibaba</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">cloud</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">ai</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">graph</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">action</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static class-name" style="color:hsl(35, 99%, 36%)">AsyncEdgeAction</span><span class="token import static punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static">edge_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token import static namespace">com</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">alibaba</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">cloud</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">ai</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">graph</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static namespace">action</span><span class="token import static namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static class-name" style="color:hsl(35, 99%, 36%)">AsyncNodeAction</span><span class="token import static punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token import static">node_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * Graph Demoï¼šé¦–å…ˆåˆ¤æ–­è¯„ä»·æ­£è´Ÿï¼Œå…¶æ¬¡ç»†åˆ†è´Ÿé¢é—®é¢˜ï¼Œæœ€åè¾“å‡ºå¤„ç†æ–¹æ¡ˆã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author yuluo</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> * @author &lt;a href="mailto:yuluo08290126@gmail.com"&gt;yuluo&lt;/a&gt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphAutoConfiguration</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphAutoConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å®šä¹‰ä¸€ä¸ªå·¥ä½œæµ StateGraph Bean.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">workflowGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token plain"> builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphStateException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// LLMs Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å®šä¹‰ä¸€ä¸ª OverAllStateFactoryï¼Œç”¨äºåœ¨æ¯æ¬¡æ‰§è¡Œå·¥ä½œæµæ—¶åˆ›å»ºåˆå§‹çš„å…¨å±€çŠ¶æ€å¯¹è±¡ã€‚é€šè¿‡æ³¨å†Œè‹¥å¹² Key åŠå…¶æ›´æ–°ç­–ç•¥æ¥ç®¡ç†ä¸Šä¸‹æ–‡æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ³¨å†Œä¸‰ä¸ªçŠ¶æ€ key åˆ†åˆ«ä¸º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 1. inputï¼šç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 2. classifier_outputï¼šåˆ†ç±»å™¨çš„è¾“å‡ºç»“æœ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 3. solutionï¼šæœ€ç»ˆè¾“å‡ºç»“è®º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä½¿ç”¨ ReplaceStrategyï¼ˆæ¯æ¬¡å†™å…¥æ›¿æ¢æ—§å€¼ï¼‰ç­–ç•¥å¤„ç†ä¸Šä¸‹æ–‡çŠ¶æ€å¯¹è±¡ä¸­çš„æ•°æ®ï¼Œç”¨äºåœ¨èŠ‚ç‚¹ä¸­ä¼ é€’æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllStateFactory</span><span class="token plain"> stateFactory </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token plain"> state </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">registerKeyAndStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"input"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ReplaceStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">registerKeyAndStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifier_output"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ReplaceStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">registerKeyAndStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"solution"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ReplaceStrategy</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åˆ›å»º workflows èŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä½¿ç”¨ Graph æ¡†æ¶é¢„å®šä¹‰çš„ QuestionClassifierNode æ¥å¤„ç†æ–‡æœ¬åˆ†ç±»ä»»åŠ¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¯„ä»·æ­£è´Ÿåˆ†ç±»èŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token plain"> feedbackClassifier </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputTextKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"input"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">categories</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive feedback"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"negative feedback"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">classificationInstructions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Try to understand the user's feeling when he/she is giving the feedback."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è´Ÿé¢è¯„ä»·å…·ä½“é—®é¢˜åˆ†ç±»èŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token plain"> specificQuestionClassifier </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionClassifierNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputTextKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"input"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">categories</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"after-sale service"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"transportation"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"product quality"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"others"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">classificationInstructions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"What kind of service or help the customer is trying to get from us? Classify the question based on your understanding."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¼–æ’ Node èŠ‚ç‚¹ï¼Œä½¿ç”¨ StateGraph çš„ APIï¼Œå°†ä¸Šè¿°èŠ‚ç‚¹åŠ å…¥å›¾ä¸­ï¼Œå¹¶è®¾ç½®èŠ‚ç‚¹é—´çš„è·³è½¬å…³ç³»</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// é¦–å…ˆå°†èŠ‚ç‚¹æ³¨å†Œåˆ°å›¾ï¼Œå¹¶ä½¿ç”¨ node_async(...) å°†æ¯ä¸ª NodeAction åŒ…è£…ä¸ºå¼‚æ­¥èŠ‚ç‚¹æ‰§è¡Œï¼ˆæé«˜ååæˆ–é˜²æ­¢é˜»å¡ï¼Œå…·ä½“å®ç°æ¡†æ¶å·²å°è£…ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token plain"> stateGraph </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Consumer Service Workflow Demo"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> stateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å®šä¹‰èŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"feedback_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">node_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">feedbackClassifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"specific_question_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">node_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">specificQuestionClassifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">node_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RecordingNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å®šä¹‰è¾¹ï¼ˆæµç¨‹é¡ºåºï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addEdge</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">START</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"feedback_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addConditionalEdges</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"feedback_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token function" style="color:hsl(221, 87%, 60%)">edge_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FeedbackQuestionDispatcher</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"negative"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"specific_question_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addConditionalEdges</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"specific_question_classifier"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token function" style="color:hsl(221, 87%, 60%)">edge_async</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpecificQuestionDispatcher</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"after-sale"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"transportation"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"quality"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"others"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å›¾çš„ç»“æŸèŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addEdge</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"recorder"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token constant" style="color:hsl(35, 99%, 36%)">END</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphRepresentation</span><span class="token plain"> graphRepresentation </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> stateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphRepresentation</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Type</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">PLANTUML</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"workflow graph"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\n\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">graphRepresentation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">println</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"\n\n"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> stateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FeedbackQuestionDispatcher</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">EdgeAction</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">apply</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> classifierOutput </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifier_output"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">orElse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifierOutput: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> classifierOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">classifierOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">contains</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"negative"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SpecificQuestionDispatcher</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">EdgeAction</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">apply</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> classifierOutput </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifier_output"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">orElse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifierOutput: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> classifierOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> classifierMap </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            classifierMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"after-sale"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"after-sale"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            classifierMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"quality"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"quality"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            classifierMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"transportation"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"transportation"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Entry</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> entry </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> classifierMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">entrySet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">classifierOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">contains</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"others"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="è‡ªå®šä¹‰-recordingnode-èŠ‚ç‚¹">è‡ªå®šä¹‰ RecordingNode èŠ‚ç‚¹<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#%E8%87%AA%E5%AE%9A%E4%B9%89-recordingnode-%E8%8A%82%E7%82%B9" class="hash-link" aria-label="è‡ªå®šä¹‰ RecordingNode èŠ‚ç‚¹çš„ç›´æ¥é“¾æ¥" title="è‡ªå®šä¹‰ RecordingNode èŠ‚ç‚¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RecordingNode</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">NodeAction</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RecordingNode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">apply</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">OverAllState</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> feedback </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"classifier_output"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> updatedState </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HashMap</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">feedback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">contains</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"positive"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Received positive feedback: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> feedback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            updatedState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"solution"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"Praise, no action taken."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Received negative feedback: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> feedback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            updatedState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"solution"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> feedback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> updatedState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="controller">Controller<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#controller" class="hash-link" aria-label="Controllerçš„ç›´æ¥é“¾æ¥" title="Controllerçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/graph/demo"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CompiledGraph</span><span class="token plain"> compiledGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"workflowGraph"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StateGraph</span><span class="token plain"> stateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GraphStateException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">compiledGraph </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> stateGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">compile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/chat"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">simpleChat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestParam</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"query"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> compiledGraph</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">invoke</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"input"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">flatMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">value</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"solution"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-è®¿é—®æµ‹è¯•">2.2 è®¿é—®æµ‹è¯•<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#22-%E8%AE%BF%E9%97%AE%E6%B5%8B%E8%AF%95" class="hash-link" aria-label="2.2 è®¿é—®æµ‹è¯•çš„ç›´æ¥é“¾æ¥" title="2.2 è®¿é—®æµ‹è¯•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">### æ­£é¢</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://localhost:8081/graph/demo/chat?query="This product is excellent, I love it!"</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># Praise, no action taken.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">### è´Ÿé¢ 1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://localhost:8081/graph/demo/chat?query="è¿™ä¸œè¥¿çœŸåƒåœ¾å•Šï¼Œå¤©å‘ï¼Œå¤ªéš¾ç”¨äº†ï¼"</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ```json</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># {"keywords": ["ä¸œè¥¿", "åƒåœ¾", "éš¾ç”¨"], "category_name": "product quality"}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ```</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">### è´Ÿé¢ 2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://localhost:8081/graph/demo/chat?query="The product broke after one day, very disappointed."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ```json</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># {"keywords": ["product", "broke", "one day", "disappointed"], "category_name": "product quality"}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"># ```</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-å‚è€ƒèµ„æ–™">3. å‚è€ƒèµ„æ–™<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-graph-quickstart#3-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" class="hash-link" aria-label="3. å‚è€ƒèµ„æ–™çš„ç›´æ¥é“¾æ¥" title="3. å‚è€ƒèµ„æ–™çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>Google Agent ç™½çš®ä¹¦ï¼š<a href="https://www.kaggle.com/whitepaper-agents" target="_blank" rel="noopener noreferrer">https://www.kaggle.com/whitepaper-agents</a></li>
<li>Authropic Agentï¼š<a href="https://www.anthropic.com/engineering/building-effective-agents" target="_blank" rel="noopener noreferrer">https://www.anthropic.com/engineering/building-effective-agents</a></li>
<li>IBM Agents æ™ºèƒ½ä½“ç¼–æ’ï¼š <a href="https://www.ibm.com/cn-zh/think/topics/ai-agent-orchestration" target="_blank" rel="noopener noreferrer">https://www.ibm.com/cn-zh/think/topics/ai-agent-orchestration</a></li>
<li>Spring AI Alibaba Graphï¼š<a href="https://github.com/alibaba/spring-ai-alibaba/blob/main/spring-ai-alibaba-graph/README-zh.md" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/spring-ai-alibaba/blob/main/spring-ai-alibaba-graph/README-zh.md</a></li>
</ol>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>spring ai alibaba graph</category>
            <category>agent</category>
        </item>
        <item>
            <title><![CDATA[è°·æ­Œå¼€æº gemini-fullstack-langgraph-quickstart ä½“éªŒ]]></title>
            <link>https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart</link>
            <guid>https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart</guid>
            <pubDate>Fri, 13 Jun 2025 23:34:54 GMT</pubDate>
            <description><![CDATA[- Github åœ°å€ï¼šhttps://github.com/google-gemini/gemini-fullstack-langgraph-quickstart]]></description>
            <content:encoded><![CDATA[<ul>
<li>Github åœ°å€ï¼š<a href="https://github.com/google-gemini/gemini-fullstack-langgraph-quickstart" target="_blank" rel="noopener noreferrer">https://github.com/google-gemini/gemini-fullstack-langgraph-quickstart</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-ç¯å¢ƒå‡†å¤‡">1. ç¯å¢ƒå‡†å¤‡<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87" class="hash-link" aria-label="1. ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥" title="1. ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>Node.js and npm (or yarn/pnpm)ï¼›</li>
<li>Python 3.8+ï¼›</li>
<li>Genmini æ¨¡å‹ APIKEYï¼Œåœ¨ <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a> ä¸­ç”³è¯·ã€‚</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-æœ¬åœ°å¯åŠ¨">2. æœ¬åœ°å¯åŠ¨<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#2-%E6%9C%AC%E5%9C%B0%E5%90%AF%E5%8A%A8" class="hash-link" aria-label="2. æœ¬åœ°å¯åŠ¨çš„ç›´æ¥é“¾æ¥" title="2. æœ¬åœ°å¯åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨ç¬¬ä¸€æ­¥ç¯å¢ƒå‡†å¤‡å®Œæˆä¹‹åï¼Œå¼€å§‹æ­¤æ­¥éª¤ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-clone-é¡¹ç›®">2.1 Clone é¡¹ç›®<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#21-clone-%E9%A1%B9%E7%9B%AE" class="hash-link" aria-label="2.1 Clone é¡¹ç›®çš„ç›´æ¥é“¾æ¥" title="2.1 Clone é¡¹ç›®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">git</span><span class="token plain"> clone https://github.com/google-gemini/gemini-fullstack-langgraph-quickstart.git</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-æ¨¡å‹-ak-è®¾ç½®">2.2 æ¨¡å‹ AK è®¾ç½®<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#22-%E6%A8%A1%E5%9E%8B-ak-%E8%AE%BE%E7%BD%AE" class="hash-link" aria-label="2.2 æ¨¡å‹ AK è®¾ç½®çš„ç›´æ¥é“¾æ¥" title="2.2 æ¨¡å‹ AK è®¾ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¤åˆ¶ backend ç›®å½•ä¸‹çš„ .env.example å¹¶é‡å‘½åä¸º .env</p>
<p>å†™å…¥åœ¨ç¬¬ä¸€æ­¥è·å¾—çš„ Genmini AKã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="23-é¡¹ç›®ä¾èµ–å®‰è£…">2.3 é¡¹ç›®ä¾èµ–å®‰è£…<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#23-%E9%A1%B9%E7%9B%AE%E4%BE%9D%E8%B5%96%E5%AE%89%E8%A3%85" class="hash-link" aria-label="2.3 é¡¹ç›®ä¾èµ–å®‰è£…çš„ç›´æ¥é“¾æ¥" title="2.3 é¡¹ç›®ä¾èµ–å®‰è£…çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å®‰è£…å‰ç«¯ä¾èµ–ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> gemini-fullstack-langgraph-quickstart/frontend</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">npm</span><span class="token plain"> i</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®‰è£…åç«¯ä¾èµ–ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> backend</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pip </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="24-å¯åŠ¨è¿è¡Œ">2.4 å¯åŠ¨è¿è¡Œ<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#24-%E5%90%AF%E5%8A%A8%E8%BF%90%E8%A1%8C" class="hash-link" aria-label="2.4 å¯åŠ¨è¿è¡Œçš„ç›´æ¥é“¾æ¥" title="2.4 å¯åŠ¨è¿è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†ä¼šåŒæ—¶å¯åŠ¨å‰åç«¯ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">make</span><span class="token plain"> dev</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ–è€…åˆ†å¼€è¿è¡Œï¼š</p>
<ul>
<li>åç«¯ï¼š<code>langgraph dev</code>ï¼ˆé»˜è®¤å¼€æ”¾æ¥å£äº <code>http://127.0.0.1:2024</code>ï¼‰</li>
<li>å‰ç«¯ï¼š<code>npm run dev</code>ï¼ˆé»˜è®¤åœ¨ <code>http://localhost:5173</code>ï¼‰</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-è®¿é—®æµ‹è¯•">3. è®¿é—®æµ‹è¯•<a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#3-%E8%AE%BF%E9%97%AE%E6%B5%8B%E8%AF%95" class="hash-link" aria-label="3. è®¿é—®æµ‹è¯•çš„ç›´æ¥é“¾æ¥" title="3. è®¿é—®æµ‹è¯•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨è¿è¡Œ <code>make dev</code> ä¹‹åï¼Œæ‰“å¼€ <code>http://localhost:5173</code> åœ°å€ï¼Œ</p>
<blockquote>
<p>PSï¼šå¦‚æœå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼Œæ‰‹åŠ¨å°† @ æ”¹ä¸º ../ çš„ç›¸å¯¹è·¯å¾„ï¼Œemmm~ æ²¡æ‰¾åˆ°åŸå› ã€‚</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[vite] Internal server error: Failed to resolve import "@/components/WelcomeScreen" from "src/App.tsx". Does the file exist?</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<p>åœ¨æµè§ˆå™¨é¡µé¢è¾“å…¥é—®é¢˜ï¼š<code>spring ai alibaba æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ç”¨ä»–å¼€å‘ä¸€ä¸ª ai åº”ç”¨</code></p>
<p>ç­‰å¾…ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå°†ä¼šçœ‹åˆ°ç ”ç©¶æŠ¥å‘Šè¾“å‡ºã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="4-å‚è€ƒæ–‡ç« ">4. å‚è€ƒæ–‡ç« <a href="https://yuluo-yx.github.io/blog/gemini-fullstack-langgraph-quickstart#4-%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0" class="hash-link" aria-label="4. å‚è€ƒæ–‡ç« çš„ç›´æ¥é“¾æ¥" title="4. å‚è€ƒæ–‡ç« çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li><a href="https://gist.github.com/JimLiu/ca25ba4e4fccac2b6a16270c8e82b11a" target="_blank" rel="noopener noreferrer">https://gist.github.com/JimLiu/ca25ba4e4fccac2b6a16270c8e82b11a</a></li>
<li><a href="https://ai.google.dev/gemini-api/docs/api-key?hl=zh-cn" target="_blank" rel="noopener noreferrer">https://ai.google.dev/gemini-api/docs/api-key?hl=zh-cn</a></li>
</ol>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>AI</category>
            <category>DeepResearch</category>
            <category>Genmini.</category>
        </item>
        <item>
            <title><![CDATA[Spring AI Alibaba Playground]]></title>
            <link>https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground</link>
            <guid>https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground</guid>
            <pubDate>Sat, 07 Jun 2025 19:26:00 GMT</pubDate>
            <description><![CDATA[Spring AI Alibaba Playground æ˜¯ Spring AI Alibaba ç¤¾åŒºä»¥ Spring AI Alibaba å’Œ Spring AI ä¸ºæ¡†æ¶æ­å»ºçš„ AI åº”ç”¨ã€‚åŒ…å«å®Œå–„çš„å‰ç«¯ UI + åç«¯å®ç°ï¼Œå…·å¤‡å¯¹è¯ï¼Œå›¾ç‰‡ç”Ÿæˆï¼Œå·¥å…·è°ƒç”¨ï¼ŒRAGï¼ŒMCP ç­‰ä¼—å¤š AI ç›¸å…³åŠŸèƒ½ã€‚åœ¨ playground çš„åŸºç¡€ä¹‹ä¸Šï¼Œæ‚¨å¯ä»¥å¿«é€Ÿå¤åˆ»å‡ºä¸€ä¸ªå±äºè‡ªå·±çš„ AI åº”ç”¨ã€‚å…¶ä¸­å·¥å…·è°ƒç”¨ï¼ŒMCP é›†æˆï¼ŒèŠå¤©æ¨¡å‹åˆ‡æ¢ç­‰åŠŸèƒ½äº¦å¯ä¸ºæ‚¨æ­å»ºè‡ªå·±çš„ AI åº”ç”¨æä¾›å‚è€ƒã€‚]]></description>
            <content:encoded><![CDATA[<p>Spring AI Alibaba Playground æ˜¯ Spring AI Alibaba ç¤¾åŒºä»¥ Spring AI Alibaba å’Œ Spring AI ä¸ºæ¡†æ¶æ­å»ºçš„ AI åº”ç”¨ã€‚åŒ…å«å®Œå–„çš„å‰ç«¯ UI + åç«¯å®ç°ï¼Œå…·å¤‡å¯¹è¯ï¼Œå›¾ç‰‡ç”Ÿæˆï¼Œå·¥å…·è°ƒç”¨ï¼ŒRAGï¼ŒMCP ç­‰ä¼—å¤š AI ç›¸å…³åŠŸèƒ½ã€‚åœ¨ playground çš„åŸºç¡€ä¹‹ä¸Šï¼Œæ‚¨å¯ä»¥å¿«é€Ÿå¤åˆ»å‡ºä¸€ä¸ªå±äºè‡ªå·±çš„ AI åº”ç”¨ã€‚å…¶ä¸­å·¥å…·è°ƒç”¨ï¼ŒMCP é›†æˆï¼ŒèŠå¤©æ¨¡å‹åˆ‡æ¢ç­‰åŠŸèƒ½äº¦å¯ä¸ºæ‚¨æ­å»ºè‡ªå·±çš„ AI åº”ç”¨æä¾›å‚è€ƒã€‚</p>
<p>Playground ä»£ç åœ°å€ï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground</a></p>
<p>é¡¹ç›®é¦–é¡µé¢„è§ˆï¼š</p>
<p><img decoding="async" loading="lazy" alt="image-20250607164742879" src="https://yuluo-yx.github.io/assets/images/image-20250607164742879-41e44ad9925e22233c344f6e7ff5edef.png" width="2848" height="1702" class="img_c29J"></p>
<p>æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œå†…å®¹è¾ƒå¤šã€‚æ¶‰åŠè¿è¡Œï¼Œé¡¹ç›®ä»‹ç»ï¼Œé…ç½®ä»‹ç»ç­‰ã€‚åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ä»‹ç» Spring AI Alibaba Playgroundï¼Œæ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è·³è½¬åˆ°ä¸åŒç« èŠ‚æµè§ˆã€‚</p>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç›®å½•">ç›®å½•<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#%E7%9B%AE%E5%BD%95" class="hash-link" aria-label="ç›®å½•çš„ç›´æ¥é“¾æ¥" title="ç›®å½•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#local_run">æœ¬åœ°è¿è¡Œ</a></li>
<li><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#config">é…ç½®ä»‹ç»</a></li>
<li><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#project">é¡¹ç›®ä»‹ç»</a></li>
</ol>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-æœ¬åœ°è¿è¡Œ"><span id="local_run">1. æœ¬åœ°è¿è¡Œ</span><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#1-%E6%9C%AC%E5%9C%B0%E8%BF%90%E8%A1%8C" class="hash-link" aria-label="1-æœ¬åœ°è¿è¡Œçš„ç›´æ¥é“¾æ¥" title="1-æœ¬åœ°è¿è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>æœ¬ç« èŠ‚ä¸­ï¼Œå°†ä¸»è¦ä»‹ç»å¦‚ä½•åœ¨æœ¬åœ°å¯åŠ¨ Playground é¡¹ç›®ã€‚</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-1-ä¸‹è½½æºç ">1. 1 ä¸‹è½½æºç <a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#1-1-%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81" class="hash-link" aria-label="1. 1 ä¸‹è½½æºç çš„ç›´æ¥é“¾æ¥" title="1. 1 ä¸‹è½½æºç çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>Playground ä»£ç åœ°å€ï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground</a></p>
<p>playground é¡¹ç›®ä½äº spring-ai-alibaba-example ä»“åº“ä¸‹ï¼Œè¢«è®¾è®¡ä¸ºä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œä¸ä¾èµ–äº spring-ai-alibaba-example pom ç®¡ç†ã€‚è¿™æ„å‘³ç€æ‚¨éœ€è¦ä½¿ç”¨ IDEA å•ç‹¬æ‰“å¼€ playground é¡¹ç›®ç›®å½•ã€‚è€Œä¸æ˜¯åœ¨ example æ ¹ç›®å½•ä¸‹ç›´æ¥å¯åŠ¨ã€‚</p>
<blockquote>
<p>PS: å¦‚æœç›´æ¥å¯åŠ¨éœ€è¦é…ç½® IDEA çš„è¿è¡Œå·¥ä½œç›®å½•ï¼Œè¯·å‚è€ƒ README æè¿°ï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/spring-ai-alibaba-playground/README.md" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/spring-ai-alibaba-playground/README.md</a></p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="12-é…ç½®å˜æ›´">1.2 é…ç½®å˜æ›´<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#12-%E9%85%8D%E7%BD%AE%E5%8F%98%E6%9B%B4" class="hash-link" aria-label="1.2 é…ç½®å˜æ›´çš„ç›´æ¥é“¾æ¥" title="1.2 é…ç½®å˜æ›´çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="121-mcp-é…ç½®å˜æ›´">1.2.1 MCP é…ç½®å˜æ›´<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#121-mcp-%E9%85%8D%E7%BD%AE%E5%8F%98%E6%9B%B4" class="hash-link" aria-label="1.2.1 MCP é…ç½®å˜æ›´çš„ç›´æ¥é“¾æ¥" title="1.2.1 MCP é…ç½®å˜æ›´çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å› ä¸º playground é¡¹ç›®å¼•å…¥äº† mcp stdio çš„æ–¹å¼æ¥æ¼”ç¤º Spring AI å¦‚ä½•æ¥å…¥ MCP æœåŠ¡ã€‚å› æ­¤å½“æ‚¨çš„å¯åŠ¨ç¯å¢ƒä¸º windows æ—¶ï¼Œéœ€è¦å®‰è£…å¹¶é…ç½®å¯åŠ¨ MCP Server éœ€è¦çš„ç¯å¢ƒã€‚</p>
<p>ä»¥ä¸‹é¢çš„ MCP Server json é…ç½®æ–‡ä»¶ä¸ºä¾‹ï¼š</p>
<div class="language-json codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-json codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"mcpServers"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token property" style="color:hsl(5, 74%, 59%)">"github"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"command"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"npx"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"args"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/c"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"npx"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-y"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"@modelcontextprotocol/server-github"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"env"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token property" style="color:hsl(5, 74%, 59%)">"GITHUB_PERSONAL_ACCESS_TOKEN"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"your_github_token"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‚¨éœ€è¦å®‰è£… NPX å·¥å…·ï¼Œå¦‚æœåœ¨ Windows ç³»ç»Ÿå¯åŠ¨ï¼Œéœ€è¦å˜æ›´ command ä¸º <code>npx.cmd</code>ã€‚å¦åˆ™ä¼šå¯åŠ¨å¤±è´¥ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="122-æ•°æ®åº“æ–‡ä»¶å˜æ›´">1.2.2 æ•°æ®åº“æ–‡ä»¶å˜æ›´<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#122-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6%E5%8F%98%E6%9B%B4" class="hash-link" aria-label="1.2.2 æ•°æ®åº“æ–‡ä»¶å˜æ›´çš„ç›´æ¥é“¾æ¥" title="1.2.2 æ•°æ®åº“æ–‡ä»¶å˜æ›´çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>Playground ä½¿ç”¨ SQLite ä½œä¸º Chat Memory çš„å­˜å‚¨æ•°æ®åº“ã€‚åœ¨é¡¹ç›®å¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨åœ¨ <code>src/main/resources</code> ç›®å½•ä¸‹åˆ›å»º saa.db çš„æ•°æ®åº“æ–‡ä»¶ï¼Œå¦‚æœå¯åŠ¨æ—¶æ²¡æœ‰è‡ªåŠ¨åˆ›å»ºï¼Œå‡ºç°å¯åŠ¨å¤±è´¥é”™è¯¯æ—¶ã€‚æ‚¨éœ€è¦æ‰‹åŠ¨åˆ›å»ºæ­¤æ–‡ä»¶ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="123-å‰ç«¯æ‰“åŒ…">1.2.3 å‰ç«¯æ‰“åŒ…<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#123-%E5%89%8D%E7%AB%AF%E6%89%93%E5%8C%85" class="hash-link" aria-label="1.2.3 å‰ç«¯æ‰“åŒ…çš„ç›´æ¥é“¾æ¥" title="1.2.3 å‰ç«¯æ‰“åŒ…çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>playground å‰ç«¯é¡¹ç›®é‡‡ç”¨æ‰“åŒ…ç¼–è¯‘åˆ° jar åŒ…ä¸­ä¸€èµ·å¯åŠ¨æ–¹å¼è¿è¡Œï¼Œå› æ­¤åœ¨å¯åŠ¨åç«¯æ—¶ï¼Œéœ€è¦è¿è¡Œ <code>mvn clean package</code>ã€‚ç¡®ä¿å‰ç«¯é¡¹ç›®æ­£ç¡®æ‰“åŒ…ç¼–è¯‘ï¼Œæ‚¨å¯ä»¥åœ¨ <code>target/classes/static</code> è·¯å¾„ä¸‹çœ‹åˆ°å‰ç«¯èµ„æºæ–‡ä»¶ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="124-å¯è§‚æµ‹é›†æˆ">1.2.4 å¯è§‚æµ‹é›†æˆ<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#124-%E5%8F%AF%E8%A7%82%E6%B5%8B%E9%9B%86%E6%88%90" class="hash-link" aria-label="1.2.4 å¯è§‚æµ‹é›†æˆçš„ç›´æ¥é“¾æ¥" title="1.2.4 å¯è§‚æµ‹é›†æˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>Playground é¡¹ç›®ä¸­é›†æˆäº† Spring AI çš„å¯è§‚æµ‹åŠŸèƒ½ï¼Œå¦‚æœæ‚¨ä¸æƒ³è§‚å¯Ÿ AI åº”ç”¨è¿è¡Œä¸­çš„ä¸€äº›æŒ‡æ ‡æ•°æ®ï¼Œæ‚¨å¯ä»¥å¿½ç•¥æ­¤æ­¥éª¤ã€‚</p>
<blockquote>
<p>PS: å› ä¸º AI å¤§æ¨¡å‹åº”ç”¨çš„è§‚æµ‹æ•°æ®ä¸­åŒ…å«ç”¨æˆ·çš„è¾“å…¥ç­‰ä¿¡æ¯ï¼Œåœ¨ç”Ÿäº§éƒ¨ç½²æ—¶ï¼Œè¯·<strong>ç¡®ä¿æ•æ„Ÿä¿¡æ¯é€‰é¡¹å…³é—­</strong>ã€‚</p>
</blockquote>
<p>åœ¨ spring-ai-alibaba-example ä»“åº“ docker-compose ç›®å½•å‡†å¤‡äº† AI åº”ç”¨å¸¸ç”¨çš„å·¥å…· docker-compose å¯åŠ¨æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥å‚è€ƒå¯åŠ¨ <a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/docker-compose/zipkin/docker-compose.yml" target="_blank" rel="noopener noreferrer">zipkin</a>ã€‚</p>
<p>å¯è§‚æµ‹å®ç°å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-alibaba-observability-arms/?spm=5176.29160081.0.0.2856aa5cenvkmu" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-alibaba-observability-arms/?spm=5176.29160081.0.0.2856aa5cenvkmu</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="125-apikey-é…ç½®">1.2.5 apiKey é…ç½®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#125-apikey-%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="1.2.5 apiKey é…ç½®çš„ç›´æ¥é“¾æ¥" title="1.2.5 apiKey é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>Playground é¡¹ç›®é›†æˆäº† RAGï¼Œå‘é‡æ•°æ®åº“å’Œ Function Call ç­‰åŠŸèƒ½ï¼Œå› æ­¤åœ¨å¯åŠ¨ä¹‹åˆæ‚¨åº”è¯¥é…ç½®å¯¹åº”çš„ akã€‚</p>
<blockquote>
<p>PS: playgrond ä¸­æ‰€æœ‰çš„ key éƒ½é€šè¿‡ env çš„æ–¹å¼æ³¨å…¥ï¼Œå¦‚æœé…ç½®äº† env ä¹‹åï¼Œé¡¹ç›®ä»ç„¶è·å–ä¸åˆ° akï¼Œè¯·<strong>é‡å¯ IDEA</strong></p>
</blockquote>
<ol>
<li>DashScope å¤§æ¨¡å‹ akï¼šAI åº”ç”¨ä½¿ç”¨</li>
<li>é˜¿é‡Œäº‘ IQS ä¿¡æ¯æ£€ç´¢æœåŠ¡ akï¼šæ¨¡å—åŒ– RAG ç¤ºä¾‹ï¼Œweb search ä½¿ç”¨</li>
<li>é˜¿é‡Œäº‘ Analytic é¡¹ç›®æ•°æ®åº“ akï¼šRAG ä½¿ç”¨ï¼›</li>
<li>ç™¾åº¦ç¿»è¯‘å’Œç™¾åº¦åœ°å›¾ akï¼šFunction Call è°ƒç”¨ä½¿ç”¨ï¼›</li>
<li>Github ä¸ªäºº secretï¼šMCP Server æ¼”ç¤ºä½¿ç”¨ã€‚</li>
</ol>
<p>å…³äº AK çš„è·å–æ–¹å¼è‡ªè¡Œæœç´¢ï¼Œè¿™é‡Œä¸åœ¨è¿‡å¤šèµ˜è¿°ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="13-å¯åŠ¨å¹¶è®¿é—®">1.3 å¯åŠ¨å¹¶è®¿é—®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#13-%E5%90%AF%E5%8A%A8%E5%B9%B6%E8%AE%BF%E9%97%AE" class="hash-link" aria-label="1.3 å¯åŠ¨å¹¶è®¿é—®çš„ç›´æ¥é“¾æ¥" title="1.3 å¯åŠ¨å¹¶è®¿é—®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å¦‚æœä¸Šé¢çš„é…ç½®æ­¥éª¤å…¨éƒ¨å®Œæˆï¼Œåœ¨ playground é¡¹ç›®å¯åŠ¨ä¹‹åï¼Œåœ¨æµè§ˆå™¨è¾“å…¥ <code>http://localhost:8080</code> æ‚¨å°†ä¼šçœ‹åˆ°æ–‡ç« å¼€å§‹æ—¶çš„é¦–é¡µé¡µé¢ã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20250607171739807" src="https://yuluo-yx.github.io/assets/images/image-20250607171739807-d26f673ee4c84498c474407cbf996319.png" width="2552" height="1270" class="img_c29J"></p>
<blockquote>
<p>PS: å¦‚æœä½“éªŒå¯¹åº”çš„ Function Call æˆ–è€… MCP åŠŸèƒ½æ—¶ï¼Œ<strong>è¯·ç¡®ä¿é…ç½®äº†å¯¹åº”çš„æœåŠ¡ AK ä¸” AK æœ‰æ•ˆ</strong>ã€‚</p>
<p><strong>æ­¤é¡¹ç›®ä»…ä½œä¸ºæ¼”ç¤ºä½¿ç”¨ï¼Œä¸€äº›åŠŸèƒ½åˆå…·å½¢çŠ¶ï¼Œå°šä¸å®Œå–„ã€‚æ¬¢è¿è´¡çŒ®ä»£ç å¹¶å®Œå–„é¡¹ç›®ï¼ğŸš€</strong></p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-é…ç½®ä»‹ç»"><span id="config">2. é…ç½®ä»‹ç»</span><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#2-%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="2-é…ç½®ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="2-é…ç½®ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>playground é¡¹ç›®ä½œä¸ºä¸€ä¸ªè¾ƒå®Œå–„çš„ AI åº”ç”¨é¡¹ç›®ï¼Œæ¶‰åŠè¾ƒå¤šçš„é…ç½®æ–‡ä»¶ï¼Œåœ¨æ­¤ç« èŠ‚ä¸­å°†ä¸€ä¸€è¯´æ˜ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-resources-é…ç½®">2.1 resources é…ç½®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#21-resources-%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="2.1 resources é…ç½®çš„ç›´æ¥é“¾æ¥" title="2.1 resources é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>resource ç›®å½•é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">resources</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ application-dev.yml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ application-prod.yml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ application.yml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ banner.txt</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ db</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ logback-spring.xml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ mcp-config.yml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ mcp-libs</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â”œâ”€â”€ models.yaml</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">â””â”€â”€ rag</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol>
<li>db ä¸º saa.db ç›®å½•ï¼Œä¸»è¦ä¸º playground çš„ chat memory æä¾›å­˜å‚¨æ”¯æŒï¼›</li>
<li>mcp-libsï¼šMCP Stdio çš„æœåŠ¡ jar ç›®å½•ï¼›</li>
<li>ragï¼šRAG åŠŸèƒ½çš„çŸ¥è¯†åº“æ–‡æ¡£ç›®å½•ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æ—¶ï¼Œå°†è‡ªåŠ¨å‘é‡åŒ–æ–‡æ¡£å¹¶å­˜å…¥å‘é‡æ•°æ®åº“ï¼›</li>
<li>mcp-config.yamlï¼špalyground é¡¹ç›®å¢å¼ºçš„ mcp-server é…ç½®ï¼›</li>
<li>application-*.ymlï¼šé¡¹ç›®å¯åŠ¨é…ç½®ã€‚</li>
</ol>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="211-mcp-config-å¢å¼º">2.1.1 MCP Config å¢å¼º<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#211-mcp-config-%E5%A2%9E%E5%BC%BA" class="hash-link" aria-label="2.1.1 MCP Config å¢å¼ºçš„ç›´æ¥é“¾æ¥" title="2.1.1 MCP Config å¢å¼ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>è§£å†³çš„é—®é¢˜ï¼šåœ¨ playground ä¸­ä½¿ç”¨ MCP Stdio çš„æ–¹å¼æ¥é›†æˆå’Œæ¼”ç¤º MCP åŠŸèƒ½ï¼Œåœ¨æ¶‰åŠåˆ°æœ¬åœ°æœåŠ¡æ—¶ï¼Œä¾‹å¦‚ä»¥ä¸‹é…ç½®ï¼š</p>
<div class="language-json codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-json codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"mcpServers"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token property" style="color:hsl(5, 74%, 59%)">"weather"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"command"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"java"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"args"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.ai.mcp.server.stdio=true"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dspring.main.web-application-type=none"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-Dlogging.pattern.console="</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"-jar"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"D:\\open_sources\\spring-ai-alibaba-examples\\spring-ai-alibaba-mcp-example\\spring-ai-alibaba-mcp-build-example\\mcp-stdio-server-example\\target\\mcp-stdio-server-example-1.0.0.jar"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token property" style="color:hsl(5, 74%, 59%)">"env"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨äºŒè¿›åˆ¶æ–‡ä»¶é…ç½®æ—¶ï¼Œå¿…é¡»è¦æ±‚ä½¿ç”¨ç»å¯¹è·¯å¾„é…ç½®ä¸” json é…ç½®è¾ƒéš¾ç†è§£ã€‚å› æ­¤ playground åœ¨é…ç½®åšäº†å¢å¼ºï¼Œå°† json è½¬ä¸ºäº†è¯­ä¹‰æ¸…æ™°çš„ yml æ–¹å¼å®šä¹‰ã€‚ç»†èŠ‚è¯·å‚è€ƒ <a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#mcp-config">MCP</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-pomxml-é…ç½®">2.2 pom.xml é…ç½®<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#22-pomxml-%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="2.2 pom.xml é…ç½®çš„ç›´æ¥é“¾æ¥" title="2.2 pom.xml é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ­¤ç« èŠ‚éƒ¨åˆ†å°†ä¸»è¦ä»‹ç»æ ¸å¿ƒä¾èµ–ï¼Œå…¶ä»–ä¾èµ–è¯·å‚è€ƒï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/spring-ai-alibaba-playground/pom.xml" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/blob/main/spring-ai-alibaba-playground/pom.xml</a></p>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Chat Memory åŠŸèƒ½å®ç°æ—¶éœ€è¦æ­¤ä¾èµ–é¡¹ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-data-jpa</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- playground æ–‡æœ¬æ€»ç»“åŠŸèƒ½ä¾èµ– tika å¯¹è¾“å…¥çš„å„ç±»æ–‡æœ¬è¿›è¡Œè§£æ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-tika-document-reader</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI MCP client ç›¸å…³ä¾èµ–--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-starter-mcp-client</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-autoconfigure-mcp-client</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI OpenAI Starter --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-starter-model-openai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI RAG markdown æ–‡æœ¬è¯»å…¥è§£æ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-markdown-document-reader</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI å‘é‡æ•°æ®åº“ Advisors --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-advisors-vector-store</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI Alibaba DashScope starter --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-dashscope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai-alibaba.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI Alibaba Memory å®ç° --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-memory</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai-alibaba.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI Alibaba analyticdb å‘é‡æ•°æ®åº“é›†æˆ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-store-analyticdb</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai-alibaba.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- DBï¼Œä¸º ChatMemory å’Œ playground æä¾›å­˜å‚¨æ”¯æŒ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.xerial</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">sqlite-jdbc</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${sqlite-jdbc.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.hibernate.orm</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">hibernate-community-dialects</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${hibernate.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Playground å¯è§‚æµ‹é›†æˆ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">io.micrometer</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">micrometer-tracing-bridge-brave</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${micrometr.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusions</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">slf4j-api</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.slf4j</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusion</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">exclusions</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">&lt;!-- Spring AI å’Œ Spring AI Alibaba ä¾èµ–ç®¡ç† --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencyManagement</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-boot.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-bom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai-alibaba.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-bom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">${spring-ai.version}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">type</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">scope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencies</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependencyManagement</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-é¡¹ç›®ä»‹ç»"><span id="project">3. é¡¹ç›®ä»‹ç»</span><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#3-%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="3-é¡¹ç›®ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="3-é¡¹ç›®ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨ playground ä¸­é›†æˆäº†è¾ƒå¤šåŠŸèƒ½ï¼ŒRAGï¼ŒMCPï¼ŒFunction Call ç­‰ã€‚æ­¤ç« èŠ‚ä¸­å°†ä¸»è¦å¯¹ RAG Web Searchï¼ŒMCP è°ƒç”¨ï¼ŒFunction Call æ‹†åˆ†ä»‹ç»ã€‚ä»¥ä¾¿èƒ½å¤ŸåŸºäºæ­¤ playground æ­å»ºç¬¦åˆè‡ªå·±éœ€æ±‚çš„ AI åº”ç”¨ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="31-rag-å®ç°">3.1 RAG å®ç°<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#31-rag-%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="3.1 RAG å®ç°çš„ç›´æ¥é“¾æ¥" title="3.1 RAG å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>RAG ä»ç„¶æ˜¯å½“ä»Šæœ€æµè¡Œçš„ AI åº”ç”¨ç»“åˆç§æœ‰çŸ¥è¯†åº“çš„æ–¹å¼ã€‚é€šè¿‡ RAG èƒ½å¤Ÿæ„å»ºé—®ç­”æœºå™¨äººï¼Œä¸“ä¸šé¢†åŸŸåŠ©æ‰‹ç­‰ã€‚</p>
<p>åœ¨ playground é¡¹ç›®ä¸­ï¼Œä½¿ç”¨çš„å‘é‡æ•°æ®åº“æ˜¯ analyticdb å’ŒåŸºäºå†…å­˜çš„ SimpleVectorStoreã€‚<strong>æ‚¨å¯ä»¥æ›¿æ¢ä¸ºä»»æ„æ‚¨æƒ³ä½¿ç”¨çš„å‘é‡æ•°æ®åº“</strong>ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="311-å‘é‡æ•°æ®åº“åˆå§‹åŒ–">3.1.1 å‘é‡æ•°æ®åº“åˆå§‹åŒ–<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#311-%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%9D%E5%A7%8B%E5%8C%96" class="hash-link" aria-label="3.1.1 å‘é‡æ•°æ®åº“åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥" title="3.1.1 å‘é‡æ•°æ®åº“åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åˆå§‹åŒ–é…ç½®ä»£ç ä½äºï¼šcom/alibaba/cloud/ai/application/config/rag</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CommandLineRunner</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">ingestTermOfServiceToVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token plain"> vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> args </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> type </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getenv</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"VECTOR_STORE_TYPE"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreInitializer</span><span class="token plain"> initializer </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreInitializer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       initializer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">init</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">type</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é€šè¿‡ VECTOR_STORE_TYPE çš„æ–¹å¼æ¥é€‰æ‹©ä½¿ç”¨é‚£ç§ç±»å‹çš„å‘é‡æ•°æ®åº“ï¼ŒVectorStoreDelegate ä»£ç å¦‚ä¸‹ï¼šå…¶ä½œç”¨æ˜¯é€šè¿‡ type çš„å€¼è¿”å›å‘é‡æ•°æ®åº“çš„å®ä¾‹ beanã€‚</p>
<blockquote>
<p>PSï¼šåœ¨è¿™é‡Œæ‚¨å¯ä»¥æ›¿æ¢ä¸ºæ‚¨æ‰€ä½¿ç”¨çš„å‘é‡æ•°æ®åº“æ¥æ„å»º RAG åŠŸèƒ½ã€‚</p>
</blockquote>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> simpleVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> analyticdbVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> simpleVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> analyticdbVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">simpleVectorStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> simpleVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">analyticdbVectorStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> analyticdbVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> vectorStoreType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStoreType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"analyticdb"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> analyticdbVectorStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> analyticdbVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> simpleVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="312-rag-æ–‡æ¡£åˆå§‹åŒ–">3.1.2 RAG æ–‡æ¡£åˆå§‹åŒ–<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#312-rag-%E6%96%87%E6%A1%A3%E5%88%9D%E5%A7%8B%E5%8C%96" class="hash-link" aria-label="3.1.2 RAG æ–‡æ¡£åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥" title="3.1.2 RAG æ–‡æ¡£åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åœ¨ VectorStoreInitializer ä¸­å°† resources/rag ä¸‹çš„ md æ–‡æ¡£å‘é‡åŒ–å¹¶åŠ è½½åˆ°å‘é‡æ•°æ®åº“ä¸­ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">init</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStore</span><span class="token plain"> vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">MarkdownDocumentReader</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> markdownDocumentReaderList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">loadMarkdownDocuments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> size </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">markdownDocumentReaderList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">warn</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"No markdown documents found in the directory."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Start to load markdown documents into vector store......"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MarkdownDocumentReader</span><span class="token plain"> markdownDocumentReader </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> markdownDocumentReaderList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">TokenTextSplitter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">2000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1024</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">transform</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">markdownDocumentReader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        size </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ‹†åˆ† documents åˆ—è¡¨ä¸ºæœ€å¤§ 25 ä¸ªå…ƒç´ çš„å­åˆ—è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">25</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> end </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">min</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">i </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">25</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> subList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">subList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> end</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            vectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">subList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Load markdown documents into vector store successfully. Load {} documents."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="313-æ„å»º-service">3.1.3 æ„å»º Service<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#313-%E6%9E%84%E5%BB%BA-service" class="hash-link" aria-label="3.1.3 æ„å»º Serviceçš„ç›´æ¥é“¾æ¥" title="3.1.3 æ„å»º Serviceçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åœ¨ä¸šåŠ¡ä»£ç ä¸­æ³¨å…¥å‘é‡æ•°æ®åº“ beanï¼Œå³å¯å®Œæˆ RAG åŠŸèƒ½çš„å®ç°ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAARAGService</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token plain"> vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> vectorStoreType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAARAGService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">VectorStoreDelegate</span><span class="token plain"> vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MessageChatMemoryAdvisor</span><span class="token plain"> messageChatMemoryAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"dashscopeChatModel"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"systemPromptTemplate"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token plain"> systemPromptTemplate</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">vectorStoreType </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getenv</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"VECTOR_STORE_TYPE"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">vectorStoreDelegate </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">client </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultSystem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   systemPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   messageChatMemoryAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   simpleLoggerAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">ragChat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> chatId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">advisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">memoryAdvisor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> memoryAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">param</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatMemory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">CONVERSATION_ID</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">advisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QuestionAnswerAdvisor</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStoreDelegate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getVectorStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">vectorStoreType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">searchRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                               </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SearchRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// TODO all documents retrieved from ADB are under 0.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//                                   .similarityThreshold(0.6d)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">topK</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">6</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                         </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>RAG å®ç°æ–‡ç« å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-alibaba-rag-ollama/?spm=5176.29160081.0.0.2856aa5cenvkmu" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-alibaba-rag-ollama/?spm=5176.29160081.0.0.2856aa5cenvkmu</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="32-web-search--åŠŸèƒ½å®ç°">3.2 Web Search  åŠŸèƒ½å®ç°<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#32-web-search--%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="3.2 Web Search  åŠŸèƒ½å®ç°çš„ç›´æ¥é“¾æ¥" title="3.2 Web Search  åŠŸèƒ½å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨ Qwen æ¨¡å‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>enable_search</code> å¼€å¯æ¨¡å‹çš„è”ç½‘æœç´¢èƒ½åŠ›ã€‚åœ¨ playground é€šè¿‡ Module RAG çš„æ–¹å¼æ¥é›†æˆè”ç½‘æœç´¢åŠŸèƒ½ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="321-module-rag-ä»‹ç»">3.2.1 Module RAG ä»‹ç»<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#321-module-rag-%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="3.2.1 Module RAG ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="3.2.1 Module RAG ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<img src="https://java2ai.com/img/blog/module-rag/module-rag.png">
<p>Spring AI å®ç°äº†æ¨¡å—åŒ– RAG æ¶æ„ï¼Œæ¶æ„çš„çµæ„Ÿæ¥è‡ªäºè®ºæ–‡â€œ<a href="https://arxiv.org/abs/2407.21059" target="_blank" rel="noopener noreferrer">æ¨¡å—åŒ– RAGï¼šå°† RAG ç³»ç»Ÿè½¬å˜ä¸ºç±»ä¼¼ä¹é«˜çš„å¯é‡æ„æ¡†æ¶</a>â€ä¸­è¯¦è¿°çš„æ¨¡å—åŒ–æ¦‚å¿µã€‚å°† RAG åˆ†ä¸ºä¸‰æ­¥ï¼š</p>
<p><strong>Pre-Retrieval</strong></p>
<blockquote>
<p>å¢å¼ºå’Œè½¬æ¢ç”¨æˆ·è¾“å…¥ï¼Œä½¿å…¶æ›´æœ‰æ•ˆåœ°æ‰§è¡Œæ£€ç´¢ä»»åŠ¡ï¼Œè§£å†³æ ¼å¼ä¸æ­£ç¡®çš„æŸ¥è¯¢ã€query è¯­ä¹‰ä¸æ¸…æ™°ã€æˆ–ä¸å—æ”¯æŒçš„è¯­è¨€ç­‰ã€‚</p>
</blockquote>
<ol>
<li>QueryAugmenter æŸ¥è¯¢å¢å¼ºï¼šä½¿ç”¨é™„åŠ çš„ä¸Šä¸‹æ–‡æ•°æ®ä¿¡æ¯å¢å¼ºç”¨æˆ· queryï¼Œæä¾›å¤§æ¨¡å‹å›ç­”é—®é¢˜æ—¶çš„å¿…è¦ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼›</li>
<li>QueryTransformer æŸ¥è¯¢æ”¹å†™ï¼šå› ä¸ºç”¨æˆ·çš„è¾“å…¥é€šå¸¸æ˜¯ç‰‡é¢çš„ï¼Œå…³é”®ä¿¡æ¯è¾ƒå°‘ï¼Œä¸ä¾¿äºå¤§æ¨¡å‹ç†è§£å’Œå›ç­”é—®é¢˜ã€‚å› æ­¤éœ€è¦ä½¿ç”¨ prompt è°ƒä¼˜æ‰‹æ®µæˆ–è€…å¤§æ¨¡å‹æ”¹å†™ç”¨æˆ· queryï¼›</li>
<li>QueryExpander æŸ¥è¯¢æ‰©å±•ï¼šå°†ç”¨æˆ· query æ‰©å±•ä¸ºå¤šä¸ªè¯­ä¹‰ä¸åŒçš„å˜ä½“ä»¥è·å¾—ä¸åŒè§†è§’ï¼Œæœ‰åŠ©äºæ£€ç´¢é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å¹¶å¢åŠ æ‰¾åˆ°ç›¸å…³ç»“æœçš„æœºä¼šã€‚</li>
</ol>
<p><strong>Retrieval</strong></p>
<blockquote>
<p>è´Ÿè´£æŸ¥è¯¢å‘é‡å­˜å‚¨ç­‰æ•°æ®ç³»ç»Ÿå¹¶æ£€ç´¢å’Œç”¨æˆ· query ç›¸å…³æ€§æœ€é«˜çš„ Documentã€‚</p>
</blockquote>
<ol>
<li>DocumentRetrieverï¼šæ£€ç´¢å™¨ï¼Œæ ¹æ® QueryExpander ä½¿ç”¨ä¸åŒçš„æ•°æ®æºè¿›è¡Œæ£€ç´¢ï¼Œä¾‹å¦‚ æœç´¢å¼•æ“ã€å‘é‡å­˜å‚¨ã€æ•°æ®åº“æˆ–çŸ¥è¯†å›¾ç­‰ï¼›</li>
<li>DocumentJoinerï¼šå°†ä»å¤šä¸ª query å’Œä»å¤šä¸ªæ•°æ®æºæ£€ç´¢åˆ°çš„ Document åˆå¹¶ä¸ºä¸€ä¸ª Document é›†åˆï¼›</li>
</ol>
<p><strong>Post-Retrieval</strong></p>
<blockquote>
<p>è´Ÿè´£å¤„ç†æ£€ç´¢åˆ°çš„ Document ä»¥è·å¾—æœ€ä½³çš„è¾“å‡ºç»“æœï¼Œè§£å†³æ¨¡å‹ä¸­çš„<em>ä¸­é—´ä¸¢å¤±</em>å’Œä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶ç­‰ã€‚</p>
<p><strong>PSï¼šSpring AI åœ¨ 1.0.0 ä¸­å¼ƒç”¨äº† DocumentRankerã€‚æ‚¨å¯ä»¥å®ç° DocumentPostProcessor æ¥å£æ¥å®ç°æ­¤åŠŸèƒ½ã€‚Playground å¾…è¡¥å……ã€‚</strong></p>
</blockquote>
<p><strong>ç”Ÿæˆ</strong></p>
<p>ç”Ÿæˆç”¨æˆ· Query å¯¹åº”çš„å¤§æ¨¡å‹è¾“å‡ºã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="322-æ•°æ®æ¥æº">3.2.2 æ•°æ®æ¥æº<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#322-%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90" class="hash-link" aria-label="3.2.2 æ•°æ®æ¥æºçš„ç›´æ¥é“¾æ¥" title="3.2.2 æ•°æ®æ¥æºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>è”ç½‘æœç´¢ï¼Œé¡¾åæ€ä¹‰ã€‚å°±æ˜¯å°†ç½‘ç»œä¸Šçš„æ•°æ®é€šè¿‡å®æ—¶æœç´¢çš„æ–¹å¼è·å–åˆ°å¹¶äº¤ç»™å¤§æ¨¡å‹æ¥è·å¾—æœ€æ–°å¾—æ¶ˆæ¯å’¨è¯¢ã€‚playground é¡¹ç›®ä¸­ä½¿ç”¨äº†é˜¿é‡Œäº‘çš„ IQSï¼Œä¿¡æ¯æ£€ç´¢æœåŠ¡ä½œä¸ºè”ç½‘æœç´¢çš„æ•°æ®æºã€‚æ‚¨å¯ä»¥ä½¿ç”¨æœç´¢å¼•æ“æœåŠ¡æ›¿æ¢ IQSã€‚</p>
<p>IIQS æœç´¢å®ç°å¦‚ä¸‹ï¼šå…¶æœ¬è´¨ä¸ºè¯·æ±‚æœåŠ¡æ¥å£æˆ–è°ƒç”¨ SDKã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">search</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// String encodeQ = URLEncoder.encode(query, StandardCharsets.UTF_8);</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ResponseEntity</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> resultResponseEntity </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">genericSearchResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">resultResponseEntity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ResponseEntity</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">restClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">uri</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string" style="color:hsl(119, 34%, 47%)">"/search/genericSearch?query={query}&amp;timeRange={timeRange}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token constant" style="color:hsl(35, 99%, 36%)">TIME_RANGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">retrieve</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toEntity</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="323-æ•°æ®åŠ å·¥">3.2.3 æ•°æ®åŠ å·¥<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#323-%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%B7%A5" class="hash-link" aria-label="3.2.3 æ•°æ®åŠ å·¥çš„ç›´æ¥é“¾æ¥" title="3.2.3 æ•°æ®åŠ å·¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œå°†æœç´¢å¼•æ“è·å–åˆ°çš„æ•°æ®è¿›è¡Œæ¸…æ´—å¹¶è½¬ä¸º Spring AI çš„ Document æ–‡æ¡£ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GenericSearchResult</span><span class="token plain"> respData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">URISyntaxException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> metadata </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getQueryMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">respData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ScorePageItem</span><span class="token plain"> pageItem </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> respData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getPageItems</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> pageItemMetadata </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getPageItemMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Double</span><span class="token plain"> score </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getScore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> text </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Media</span><span class="token plain"> media </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMedia</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token plain"> document </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItemMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">media</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">media</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">score</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">score</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token plain"> document </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">metadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">pageItemMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">text</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">score</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">score</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Double</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getScore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ScorePageItem</span><span class="token plain"> pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> pageItem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getScore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// .... çœç•¥æ•°æ®æ¸…æ´—ä»£ç </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// é™åˆ¶è”ç½‘æœç´¢çš„æ–‡æ¡£æ•°ï¼Œæé«˜è”ç½‘æœç´¢å“åº”é€Ÿåº¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">limitResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Document</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> minResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">int</span><span class="token plain"> limit </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">min</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">size</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> minResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> documents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">subList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> limit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="324-module-rag-æµç¨‹">3.2.4 Module RAG æµç¨‹<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#324-module-rag-%E6%B5%81%E7%A8%8B" class="hash-link" aria-label="3.2.4 Module RAG æµç¨‹çš„ç›´æ¥é“¾æ¥" title="3.2.4 Module RAG æµç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æ¥ä¸‹æ¥ï¼Œä¾¿æ˜¯ä½¿ç”¨ Module RAG API å¤„ç†ç”¨æˆ· Promptã€‚ä½¿å…¶æ›´ç¬¦åˆå¤§æ¨¡å‹çš„è¾“å…¥è¾“å‡ºï¼Œè·å¾—æ›´å¥½çš„æ•ˆæœ</p>
<p>å…·ä½“ä»£ç å‚è€ƒï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground/src/main/java/com/alibaba/cloud/ai/application/rag" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground/src/main/java/com/alibaba/cloud/ai/application/rag</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="325-web-search-æœåŠ¡ç±»">3.2.5 Web Search æœåŠ¡ç±»<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#325-web-search-%E6%9C%8D%E5%8A%A1%E7%B1%BB" class="hash-link" aria-label="3.2.5 Web Search æœåŠ¡ç±»çš„ç›´æ¥é“¾æ¥" title="3.2.5 Web Search æœåŠ¡ç±»çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<ol>
<li>åœ¨æ„é€ æ–¹æ³•ä¸­æ³¨å…¥ç›¸å…³ Beanï¼›</li>
<li>åœ¨ ChatClient ä¸­é€šè¿‡ RetrievalAugmentationAdvisor å¼•å…¥ advisor å®ç°æ¨¡å—åŒ– RAG çš„è”ç½‘æœç´¢åŠŸèƒ½ã€‚</li>
</ol>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAWebSearchService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DataClean</span><span class="token plain"> dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryExpander</span><span class="token plain"> queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IQSSearchEngine</span><span class="token plain"> searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">QueryTransformer</span><span class="token plain"> queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"dashscopeChatModel"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"queryArgumentPromptTemplate"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptTemplate</span><span class="token plain"> queryArgumentPromptTemplate</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">queryTransformer </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">queryExpander </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">queryArgumentPromptTemplate </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> queryArgumentPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// reasoning content for DeepSeek-r1 is integrated into the output</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">reasoningContentAdvisor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ReasoningContentAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Build chatClient</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">DashScopeChatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">withModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">DEFAULT_WEB_SEARCH_MODEL</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// stream æ¨¡å¼ä¸‹æ˜¯å¦å¼€å¯å¢é‡è¾“å‡º</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">withIncrementalOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ—¥å¿—</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">simpleLoggerAdvisor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">webSearchRetriever </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">WebSearchRetriever</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">searchEngine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dataCleaner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">maxResults</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//Handle user input</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">advisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             </span><span class="token function" style="color:hsl(221, 87%, 60%)">createRetrievalAugmentationAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             reasoningContentAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">             simpleLoggerAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RetrievalAugmentationAdvisor</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createRetrievalAugmentationAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RetrievalAugmentationAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">documentRetriever</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">webSearchRetriever</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">queryTransformers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">queryTransformer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">queryAugmenter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomContextQueryAugmenter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      queryArgumentPromptTemplate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">queryExpander</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">documentJoiner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConcatenationDocumentJoiner</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Web Search å®ç°æ–‡ç« å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-alibaba-module-rag/?spm=5176.29160081.0.0.2856aa5cenvkmu&amp;source=blog/" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-alibaba-module-rag/?spm=5176.29160081.0.0.2856aa5cenvkmu&amp;source=blog/</a></p>
<p>Spring AI RAGï¼š<a href="https://docs.spring.io/spring-ai/reference/api/retrieval-augmented-generation.html#_advisors" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/api/retrieval-augmented-generation.html#_advisors</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="33-mcp-é›†æˆ"><span id="mcp-config">3.3 MCP&nbsp; é›†æˆ</span><a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#33-mcp-%E9%9B%86%E6%88%90" class="hash-link" aria-label="33-mcp-é›†æˆçš„ç›´æ¥é“¾æ¥" title="33-mcp-é›†æˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="331-mcp-config-å¢å¼º">3.3.1 MCP Config å¢å¼º<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#331-mcp-config-%E5%A2%9E%E5%BC%BA" class="hash-link" aria-label="3.3.1 MCP Config å¢å¼ºçš„ç›´æ¥é“¾æ¥" title="3.3.1 MCP Config å¢å¼ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>ä¸ºäº†è§£å†³ MCP Stdio json é…ç½®æ–‡ä»¶éš¾ä»¥ç†è§£å’Œæœ¬åœ° MCP Server äºŒè¿›åˆ¶æ–‡ä»¶éœ€è¦ç»å¯¹è·¯å¾„çš„é—®é¢˜ã€‚åœ¨ playground ä¸­å¯¹ MCP Stdio é…ç½®åšäº†å¢å¼ºå¤„ç†ã€‚</p>
<p>å…¶ä¸»è¦æ­¥éª¤æ˜¯å°† McpStdioClientProperties å±æ€§é…ç½®é‡å†™ï¼Œä»¥ä¾¿åœ¨åç»­ MCP Client åˆå§‹åŒ–ä½¿ç”¨å¢å¼ºçš„ MCP é…ç½®ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomMcpStdioTransportConfigurationBeanPostProcessor</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BeanPostProcessor</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomMcpStdioTransportConfigurationBeanPostProcessor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">CustomMcpStdioTransportConfigurationBeanPostProcessor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token plain"> mcpStdioClientProperties</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">objectMapper </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">mcpStdioClientProperties </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">postProcessAfterInitialization</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Object</span><span class="token plain"> bean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@NotNull</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> beanName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BeansException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bean </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">instanceof</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StdioTransportAutoConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¢å¼º McpStdioTransportConfiguration bean start: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> beanName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token plain"> mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				mcpServerConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Handle the jar relative path issue in the configuration file.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Entry</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token generics class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Parameters</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> entry </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">entrySet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">command</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"java"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Parameters</span><span class="token plain"> serverConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> oldMcpLibsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">serverConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> rewriteMcpLibsAbsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpLibsAbsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">serverConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">rewriteMcpLibsAbsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							serverConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">remove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">oldMcpLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							serverConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">rewriteMcpLibsAbsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> msc </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">writeValueAsString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Registry McpServer config: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> msc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// write mcp client</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setServersConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ByteArrayResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">msc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getBytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StdioTransportAutoConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> bean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stdioTransports</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAAppException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"å¢å¼º McpStdioTransportConfiguration bean end: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> beanName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> bean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ MCPServerUtils ä¸­è¯»å– mcp-config.yaml é…ç½®å¹¶è½¬ä¸º McpServerConfigã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> mapper </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">YAMLFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">InputStream</span><span class="token plain"> resourceAsStream </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ModelsUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getClassLoader</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResourceAsStream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token constant" style="color:hsl(35, 99%, 36%)">MCP_CONFIG_FILE_PATH</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token plain"> mcpServerConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> mapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">readValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">resourceAsStream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> env </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nonNull</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">entrySet</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"${"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">endsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> envKey </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">substring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">length</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> envValue </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">System</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getenv</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">envKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// allow env is null.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">envValue </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">envValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                      env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">put</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> envValue</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                   </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="332-mcp-server-å·¥å…·å›æ˜¾">3.3.2 MCP Server å·¥å…·å›æ˜¾<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#332-mcp-server-%E5%B7%A5%E5%85%B7%E5%9B%9E%E6%98%BE" class="hash-link" aria-label="3.3.2 MCP Server å·¥å…·å›æ˜¾çš„ç›´æ¥é“¾æ¥" title="3.3.2 MCP Server å·¥å…·å›æ˜¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>ä¸ºäº†ä¾¿äºå±•ç¤º MCP Client å¦‚ä½•è°ƒç”¨ MCP Server çš„ tools å’Œå±•ç¤º MCP Server ä¸­æœ‰å“ªäº› Toolsï¼Œplayground ä¸­åšäº†ç‰¹æ®Šå¤„ç†ã€‚</p>
<p>è‡ªå®šä¹‰ MCP Server å­˜æ”¾ MCP Server çš„ tools ä¿¡æ¯ç”¨äºæµè§ˆå™¨æ˜¾ç¤ºï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> desc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Tools</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> toolList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å› ä¸º Spring AI çš„ SyncMcpToolCallback ä¸­çš„ MCPClient æ²¡æœ‰å¯¹å¤–æš´éœ²è·å– MCP Server çš„ç›¸å…³å±æ€§ï¼Œåªæœ‰ Tools å®šä¹‰ã€‚playground å¯¹ SyncMcpToolCallback åšäº†åŒ…è£…å¤„ç†ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallbackWrapper</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token plain"> callback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallbackWrapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token plain"> callback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">callback </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> callback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpSyncClient</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Field</span><span class="token plain"> field </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getDeclaredField</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"mcpClient"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			field</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setAccessible</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpSyncClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> field</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">callback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">NoSuchFieldException</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IllegalAccessException</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">RuntimeException</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ MCPServerUtils ä¸­åšäº† MCP Server å®¹å™¨çš„åˆå§‹åŒ–æ“ä½œï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">initMcpServerContainer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallbackProvider</span><span class="token plain"> toolCallbackProvider</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerConfig</span><span class="token plain"> mcpServerConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> mcpServerDescMap </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">initMcpServerDescMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token generics class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">Tools</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> toolsList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArrayList</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallback</span><span class="token plain"> toolCallback </span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> toolCallbackProvider</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// todo: æ‹¿ä¸åˆ° mcp client, å…ˆç”¨åŒ…è£…å™¨æ‹¿å§</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token plain"> mcpToolCallback </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> toolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallbackWrapper</span><span class="token plain"> syncMcpToolCallbackWrapper </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SyncMcpToolCallbackWrapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpToolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> currentMcpServerName </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> syncMcpToolCallbackWrapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getServerInfo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æŒ‰ç…§ mcp server name èšåˆ mcp server tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">equals</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> currentMcpServerName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Tools</span><span class="token plain"> tool </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setDesc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolDefinition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">description</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolDefinition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setParams</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolCallback</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolDefinition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputSchema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                toolsList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tool</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerContainer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addServer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">getId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">env</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">desc</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpServerDescMap</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toolList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolsList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                     </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                                    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>MCP Server å·¥å…·å›æ˜¾æ•ˆæœå¦‚ä¸‹ï¼šæ‚¨å¯ä»¥åœ¨ resource ä¸‹çš„ mcp-config.yaml ä¸­æ·»åŠ æ›´å¤š MCP Serverã€‚</p>
<p><img decoding="async" loading="lazy" alt="image-20250607190058038" src="https://yuluo-yx.github.io/assets/images/image-20250607190058038-9fa2436023389deebb0e3b2c939d5a65.png" width="2302" height="1245" class="img_c29J"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="333-mcp-å·¥å…·è°ƒç”¨">3.3.3 MCP å·¥å…·è°ƒç”¨<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#333-mcp-%E5%B7%A5%E5%85%B7%E8%B0%83%E7%94%A8" class="hash-link" aria-label="3.3.3 MCP å·¥å…·è°ƒç”¨çš„ç›´æ¥é“¾æ¥" title="3.3.3 MCP å·¥å…·è°ƒç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å®Œæˆä¸Šé¢ä¸€ç³»åˆ—çš„åˆå§‹åŒ–æ“ä½œä¹‹åï¼Œæ¥ä¸‹æ¥ä¾¿æ˜¯ç¼–å†™ MCP Service ç±»ï¼šä¸ºäº†èƒ½å¤Ÿè·å– MCP Server Tools çš„æ‰§è¡Œä¿¡æ¯ï¼Œè¿™é‡Œä½¿ç”¨äº† Spring AI Tools çš„ internalToolExecutionEnabled APIã€‚æ¥æ”¶é›†å¤§æ¨¡å‹çš„å·¥å…·å…¥å‚å’Œæ‰§è¡Œç»“æœç­‰ï¼Œåœ¨å‰ç«¯åšè°ƒç”¨å±•ç¤ºã€‚</p>
<p>ä¸ºäº†æ”¶é›† MCP Tools è°ƒç”¨è¿‡ç¨‹ä¸­çš„ä¿¡æ¯ã€‚Playground é¡¹ç›®ç¼–å†™äº† ToolCallResp ç±»æ¥æ”¶é›†ä¸€äº›ä¿¡æ¯ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool çš„æ‰§è¡ŒçŠ¶æ€</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token plain"> status</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool Name</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool æ‰§è¡Œå‚æ•°</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolParameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool æ‰§è¡Œç»“æœ</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œå¼€å§‹çš„æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token plain"> toolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œå®Œæˆçš„æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token plain"> toolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œçš„é”™è¯¯ä¿¡æ¯</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> errorMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œè¾“å…¥</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolInput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * å·¥å…·æ‰§è¡Œè€—æ—¶</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Long</span><span class="token plain"> toolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     * Tool è®°å½•toolè¿”å›çš„ä¸­é—´ç»“æœ</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> toolResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>MCP Service å®ç°ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAMcpService</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallbackProvider</span><span class="token plain"> tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingManager</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAMcpService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAMcpService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ObjectMapper</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallbackProvider</span><span class="token plain"> tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingManager</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"openAiChatModel"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">objectMapper </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">mcpStdioClientProperties </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Initialize chat client with non-blocking configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						simpleLoggerAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultToolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">tools </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">toolCallingManager </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">initMcpServerContainer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// manual run tools flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatOptions</span><span class="token plain"> chatOptions </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingChatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">internalToolExecutionEnabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatResponse</span><span class="token plain"> response </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ChatResponse: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">assert</span><span class="token plain"> response </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">AssistantMessage</span><span class="token generics class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ToolCall</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> toolCalls </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ToolCalls: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> responseByLLm </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Response by LLM: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// execute tools with no chat memory messages.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">var</span><span class="token plain"> tcr </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">TCR</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startExecute</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">arguments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolParameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">arguments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Start ToolCallResp: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolExecutionResult</span><span class="token plain"> toolExecutionResult </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				toolExecutionResult </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">executeToolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">FAILURE</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setErrorMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Error ToolCallResp: {}, msg: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// throw new RuntimeException("Tool execution failed, please check the logs for details.");</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> llmCallResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nonNull</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatResponse</span><span class="token plain"> finalResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">messages</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">conversationHistory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">finalResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					llmCallResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> finalResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token plain"> sb </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">StringBuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">conversationHistory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">filter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">message </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> message </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">instanceof</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolResponseMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">message </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolResponseMessage</span><span class="token plain"> toolResponseMessage </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolResponseMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> message</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							toolResponseMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResponses</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">forEach</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tooResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">								sb</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">append</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tooResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">responseData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">							</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">sb</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">SUCCESS</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">llmCallResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"End ToolCallResp: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ToolCalls is empty, no tool execution needed."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">run</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> envs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Optional</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">McpServer</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> runMcpServer </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerContainer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getServerById</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">runMcpServer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"McpServer not found, id: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">TCR</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> runMcpServerName </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> runMcpServer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">var</span><span class="token plain"> mcpServerConfig </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Parameters</span><span class="token plain"> parameters </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpStdioClientProperties</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">runMcpServerName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">command</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpServers</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">runMcpServerName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				envs</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">command</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startsWith</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"java"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> oldMcpLibsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> rewriteMcpLibsAbsPath </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getMcpLibsAbsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">McpServerUtils</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">remove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">oldMcpLibsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			parameters</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">args</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">rewriteMcpLibsAbsPath</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> mcpServerConfigJSON </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> objectMapper</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">writeValueAsString</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpServerConfig</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		mcpStdioClientProperties</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setServersConfiguration</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ByteArrayResource</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">mcpServerConfigJSON</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getBytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Function Call å‚è€ƒï¼š<a href="https://docs.spring.io/spring-ai/reference/api/tools.html" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-ai/reference/api/tools.html</a></p>
<p>MCP Server æ–‡ç« å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-alibaba-mcp/?spm=5176.29160081.0.0.2856aa5cenvkmu" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-alibaba-mcp/?spm=5176.29160081.0.0.2856aa5cenvkmu</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="34-function-call-é›†æˆ">3.4 Function Call é›†æˆ<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#34-function-call-%E9%9B%86%E6%88%90" class="hash-link" aria-label="3.4 Function Call é›†æˆçš„ç›´æ¥é“¾æ¥" title="3.4 Function Call é›†æˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>playground ä¸­å®ç°äº† Function Call çš„åŠŸèƒ½ï¼Œå’Œ MCP ä¸€æ ·ï¼Œæ”¯æŒè°ƒç”¨çŠ¶æ€æ˜¾ç¤ºã€‚å·¥å…·æµè§ˆå™¨å›æ˜¾åŒç†ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="341-function-tools-åˆå§‹åŒ–">3.4.1 Function Tools åˆå§‹åŒ–<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#341-function-tools-%E5%88%9D%E5%A7%8B%E5%8C%96" class="hash-link" aria-label="3.4.1 Function Tools åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥" title="3.4.1 Function Tools åˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ Spring AI Alibaba çš„æä¾›çš„ Tool Calling Starter æ¥å¼•å…¥å·¥å…·ï¼Œä¹Ÿå¯ä»¥åƒ Playground ä¸€æ ·ï¼Œé€šè¿‡ FunctionToolCallback æ¥è‡ªå®šä¹‰å·¥å…·ã€‚</p>
<p>Playground Tools: <a href="https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground/src/main/java/com/alibaba/cloud/ai/application/tools" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-examples/tree/main/spring-ai-alibaba-playground/src/main/java/com/alibaba/cloud/ai/application/tools</a></p>
<p>Tools åˆå§‹åŒ–ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ToolCallback</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">getTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">buildBaiduTranslateTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">buildBaiduMapTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallback</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">buildBaiduTranslateTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">FunctionToolCallback</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"BaiduTranslateService"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaiduTranslateTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">ak</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> sk</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> restClientbuilder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> responseErrorHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">description</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Baidu translation function for general text translation."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputSchema</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">"""</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                      {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                         "type": "object",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                         "properties": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                            "Request": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "type": "object",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "properties": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  "q": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "type": "string",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "description": "Content that needs to be translated."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  "from": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "type": "string",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "description": "Source language that needs to be translated."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  "to": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "type": "string",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "description": "Target language to translate into."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "required": ["q", "from", "to"],</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "description": "Request object to translate text to a target language."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                            },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                            "Response": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "type": "object",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "properties": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  "translatedText": {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "type": "string",</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                     "description": "The translated text."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                                  }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "required": ["translatedText"],</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                               "description": "Response object for the translation function, containing the translated text."</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                         },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                         "required": ["Request", "Response"]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                      }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token triple-quoted-string string" style="color:hsl(119, 34%, 47%)">                      """</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">inputType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaiduTranslateTools</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BaiduTranslateToolRequest</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toolMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolMetadata</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">returnDirect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="342-function-tools-è°ƒç”¨">3.4.2 Function Tools è°ƒç”¨<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#342-function-tools-%E8%B0%83%E7%94%A8" class="hash-link" aria-label="3.4.2 Function Tools è°ƒç”¨çš„ç›´æ¥é“¾æ¥" title="3.4.2 Function Tools è°ƒç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p>å®Œæˆäº†å·¥å…·å¼•å…¥æˆ–å®šä¹‰ä¹‹åã€‚æ¥ä¸‹æ¥ï¼Œä¾¿å¯ä»¥åœ¨ service ä¸­ä½¿ç”¨è¿™äº› Tools æ¥å¢å¼ºå¤§æ¨¡å‹çš„èƒ½åŠ›ã€‚å·¥å…·è°ƒç”¨ä»£ç å’Œ MCP Server Tools ç±»ä¼¼ã€‚</p>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAToolsService</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAToolsService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingManager</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolsInit</span><span class="token plain"> toolsInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SAAToolsService</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolsInit</span><span class="token plain"> toolsInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingManager</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">SimpleLoggerAdvisor</span><span class="token plain"> simpleLoggerAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MessageChatMemoryAdvisor</span><span class="token plain"> messageChatMemoryAdvisor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@Qualifier</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"openAiChatModel"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">toolsInit </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolsInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">toolCallingManager </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">chatClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">defaultAdvisors</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">						simpleLoggerAdvisor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//						messageChatMemoryAdvisor</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">chat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// manual run tools flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatOptions</span><span class="token plain"> chatOptions </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallingChatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">toolCallbacks</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolsInit</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getTools</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">internalToolExecutionEnabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token plain"> userPrompt </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatResponse</span><span class="token plain"> response </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">userPrompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ChatResponse: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">assert</span><span class="token plain"> response </span><span class="token operator" style="color:hsl(221, 87%, 60%)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">List</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">AssistantMessage</span><span class="token generics class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">ToolCall</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> toolCalls </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ToolCalls: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> responseByLLm </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Response by LLM: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// execute tools with no chat memory messages.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">var</span><span class="token plain"> tcr </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">TCR</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token plain">toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">isEmpty</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">startExecute</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">					toolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">get</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">arguments</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Start ToolCallResp: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolExecutionResult</span><span class="token plain"> toolExecutionResult </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				toolExecutionResult </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> toolCallingManager</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">executeToolCalls</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> chatOptions</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">FAILURE</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setErrorMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LocalDateTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">now</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"Error ToolCallResp: {}, msg: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getMessage</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token comment" style="color:hsl(230, 4%, 64%)">// throw new RuntimeException("Tool execution failed, please check the logs for details.");</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> llmCallResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">""</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Objects</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">nonNull</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//				ToolResponseMessage toolResponseMessage = (ToolResponseMessage) toolExecutionResult.conversationHistory()</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//						.get(toolExecutionResult.conversationHistory().size() - 1);</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//				llmCallResponse = toolResponseMessage.getResponses().get(0).responseData();</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatResponse</span><span class="token plain"> finalResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> chatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">messages</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">toolExecutionResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">conversationHistory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">call</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">chatResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">				llmCallResponse </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> finalResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getOutput</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getText</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setStatus</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolCallResp</span><span class="token class-name punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ToolState</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token constant" style="color:hsl(35, 99%, 36%)">SUCCESS</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">llmCallResponse</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolCostTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">long</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolEndTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getToolStartTime</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getNano</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"End ToolCallResp: {}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">debug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ToolCalls is empty, no tool execution needed."</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">			tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">setToolResult</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">responseByLLm</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> tcr</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Function Tools é›†æˆæ–‡ç« å‚è€ƒï¼š<a href="https://java2ai.com/blog/spring-ai-toolcalling/?spm=5176.29160081.0.0.2856aa5cenvkmu" target="_blank" rel="noopener noreferrer">https://java2ai.com/blog/spring-ai-toolcalling/?spm=5176.29160081.0.0.2856aa5cenvkmu</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="4-æ€»ç»“">4. æ€»ç»“<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-playground#4-%E6%80%BB%E7%BB%93" class="hash-link" aria-label="4. æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="4. æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Spring AI Alibaba å®˜æ–¹ç¤¾åŒºå¼€å‘äº†ä¸€ä¸ª<strong>åŒ…å«å®Œæ•´ <code>å‰ç«¯UI+åç«¯å®ç°</code> çš„æ™ºèƒ½ä½“ Playground ç¤ºä¾‹</strong>ã€‚æœªæ¥ç¤¾åŒºä¼šæŒç»­æ›´æ–°ç»´æŠ¤ã€‚ä»¥æ­¤æ¥æ¼”ç¤º Spring AI å’Œ Spring AI Alibaba çš„æœ€æ–°åŠŸèƒ½ã€‚</p>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>Spring AI Alibaba Playground</category>
        </item>
        <item>
            <title><![CDATA[Spring AI Alibaba åŠ¨æ€ Prompt æœ€ä½³å®è·µ]]></title>
            <link>https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt</link>
            <guid>https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt</guid>
            <pubDate>Thu, 05 Jun 2025 23:00:00 GMT</pubDate>
            <description><![CDATA[Spring AI Alibaba ä½¿ç”¨ Nacos çš„é…ç½®ä¸­å¿ƒèƒ½åŠ›æ¥åŠ¨æ€ç®¡ç† AI åº”ç”¨çš„ Promptã€‚ä»¥æ­¤æ¥å®ç°åŠ¨æ€æ›´æ–° Prompt çš„åŠŸèƒ½ã€‚]]></description>
            <content:encoded><![CDATA[<p>Spring AI Alibaba ä½¿ç”¨ Nacos çš„é…ç½®ä¸­å¿ƒèƒ½åŠ›æ¥åŠ¨æ€ç®¡ç† AI åº”ç”¨çš„ Promptã€‚ä»¥æ­¤æ¥å®ç°åŠ¨æ€æ›´æ–° Prompt çš„åŠŸèƒ½ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87" class="hash-link" aria-label="ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥" title="ç¯å¢ƒå‡†å¤‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Nacos: å…·å¤‡é…ç½®ä¸­å¿ƒèƒ½åŠ›çš„ Nacosï¼Œæœ¬ä¾‹ä¸­ä½¿ç”¨ Nacos 2.3.0ã€‚æœ€æ–°ç‰ˆæœ¬çš„ Nacos 3.X äº¦å¯ï¼Œ</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="ai-å·¥ç¨‹åˆ›å»º">AI å·¥ç¨‹åˆ›å»º<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#ai-%E5%B7%A5%E7%A8%8B%E5%88%9B%E5%BB%BA" class="hash-link" aria-label="AI å·¥ç¨‹åˆ›å»ºçš„ç›´æ¥é“¾æ¥" title="AI å·¥ç¨‹åˆ›å»ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Example å·¥ç¨‹åœ°å€ï¼š<a href="https://github.com/springaialibaba/spring-ai-alibaba-nacos-prompt-example" target="_blank" rel="noopener noreferrer">https://github.com/springaialibaba/spring-ai-alibaba-nacos-prompt-example</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="pomxml">Pom.xml<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#pomxml" class="hash-link" aria-label="Pom.xmlçš„ç›´æ¥é“¾æ¥" title="Pom.xmlçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<blockquote>
<p>Tips: é¡¹ç›®ä¸­å·²ç»å¼•å…¥äº† Spring AI Alibaba Bom å’Œ Spring Boot Bomã€‚å› æ­¤è¿™é‡Œçœç•¥äº†ç‰ˆæœ¬å·ã€‚æœ‰å…³ bom å®šä¹‰å‚è€ƒå¦‚ä¸Šçš„ Github ä»“åº“åœ°å€ã€‚</p>
</blockquote>
<div class="language-xml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-xml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-dashscope</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.alibaba.cloud.ai</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">spring-ai-alibaba-starter-nacos-prompt</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="applicationyml">Application.yml<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#applicationyml" class="hash-link" aria-label="Application.ymlçš„ç›´æ¥é“¾æ¥" title="Application.ymlçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ Nacos ç›‘å¬çš„ DataID ä»¥åŠ Nacos Server çš„ç”¨æˆ·åå’Œå¯†ç ç­‰ä¿¡æ¯ã€‚</p>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">server</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">port</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10010</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">application</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">alibaba</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">nacos</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">example</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># æŒ‡å®šç›‘å¬çš„ prompt é…ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">config</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">import</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"optional:nacos:prompt-config.json"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">nacos</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">username</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> nacos</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">password</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> nacos</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">ai</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># å¼€å¯ nacos çš„ prompt tmpl ç›‘å¬åŠŸèƒ½</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">nacos</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">template</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">enabled</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(230, 8%, 24%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="controller">Controller<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#controller" class="hash-link" aria-label="Controllerçš„ç›´æ¥é“¾æ¥" title="Controllerçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/nacos"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptController</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Logger</span><span class="token plain"> logger </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">org</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name namespace" style="color:hsl(35, 99%, 36%)">slf4j</span><span class="token class-name namespace punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">LoggerFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getLogger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">class</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">private</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">final</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurablePromptTemplateFactory</span><span class="token plain"> promptTemplateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">PromptController</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatModel</span><span class="token plain"> chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurablePromptTemplateFactory</span><span class="token plain"> promptTemplateFactory</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">client </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ChatClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">builder</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">chatModel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">build</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">promptTemplateFactory </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> promptTemplateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@GetMapping</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"/books"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Flux</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token generics class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token generics punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">generateJoke</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token annotation punctuation" style="color:hsl(119, 34%, 47%)">@RequestParam</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">value </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> required </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> defaultValue </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"é²è¿…"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">String</span><span class="token plain"> authorName</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä½¿ç”¨ nacos çš„ prompt tmpl åˆ›å»º prompt</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ConfigurablePromptTemplate</span><span class="token plain"> template </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> promptTemplateFactory</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string" style="color:hsl(119, 34%, 47%)">"please list the three most famous books by this {author}."</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Prompt</span><span class="token plain"> prompt </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> template</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">create</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Map</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">of</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> authorName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        logger</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">info</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">"æœ€ç»ˆæ„å»ºçš„ prompt ä¸ºï¼š{}"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getContents</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">stream</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="nacos-é…ç½®æ·»åŠ ">Nacos é…ç½®æ·»åŠ <a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#nacos-%E9%85%8D%E7%BD%AE%E6%B7%BB%E5%8A%A0" class="hash-link" aria-label="Nacos é…ç½®æ·»åŠ çš„ç›´æ¥é“¾æ¥" title="Nacos é…ç½®æ·»åŠ çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ol>
<li>
<p>å¯åŠ¨ Nacos æœåŠ¡ï¼›</p>
</li>
<li>
<p>å†™å…¥é…ç½®ï¼ŒdataId ä¸ºï¼šspring.ai.alibaba.configurable.prompt</p>
</li>
<li>
<p>åœ¨é…ç½®ä¸­å†™å…¥å¦‚ä¸‹é…ç½®ï¼š</p>
<div class="language-json codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-json codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"name"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"template"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"åˆ—å‡º {author} æœ‰åçš„è‘—ä½œ"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"model"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token property" style="color:hsl(5, 74%, 59%)">"key"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä½™å"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="åŠŸèƒ½æ¼”ç¤º">åŠŸèƒ½æ¼”ç¤º<a href="https://yuluo-yx.github.io/blog/spring-ai-alibaba-nacos-prompt#%E5%8A%9F%E8%83%BD%E6%BC%94%E7%A4%BA" class="hash-link" aria-label="åŠŸèƒ½æ¼”ç¤ºçš„ç›´æ¥é“¾æ¥" title="åŠŸèƒ½æ¼”ç¤ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å®Œæˆä¸Šè¿°é…ç½®ä¹‹åï¼Œå¯åŠ¨é¡¹ç›®ï¼š</p>
<ol>
<li>
<p>åœ¨å¯åŠ¨æ—¥å¿—ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼Œè¡¨æ˜å·²ç»å¼€å§‹ç›‘å¬æ­¤ DataID çš„é…ç½®ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">OnPromptTemplateConfigChange,templateName:author,template:åˆ—å‡º </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">author</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> æœ‰åçš„è‘—ä½œï¼Œåªéœ€è¦ä¹¦åæ¸…å•,model:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">key</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">ä½™å</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å‘é€è¯·æ±‚æŸ¥çœ‹è¾“å‡ºï¼š</p>
<blockquote>
<p>Tips: è¿™é‡Œè¾“å‡ºäº†é²è¿…çš„ä½œå“é›†æ˜¯å› ä¸ºåœ¨ controller ä¸­è®¾ç½®äº† defaultValue ä¸ºé²è¿….</p>
</blockquote>
<div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-java codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token constant" style="color:hsl(35, 99%, 36%)">GET</span><span class="token plain"> http</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token number" style="color:hsl(35, 99%, 36%)">127.0</span><span class="token number" style="color:hsl(35, 99%, 36%)">.0</span><span class="token number" style="color:hsl(35, 99%, 36%)">.1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token number" style="color:hsl(35, 99%, 36%)">10010</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">nacos</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">books</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">1.</span><span class="token plain"> ã€Šå‘å–Šã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">2.</span><span class="token plain"> ã€Šå½·å¾¨ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">3.</span><span class="token plain"> ã€ŠæœèŠ±å¤•æ‹¾ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">4.</span><span class="token plain"> ã€Šé˜¿</span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Q</span><span class="token plain">æ­£ä¼ ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">5.</span><span class="token plain"> ã€Šé‡è‰ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">6.</span><span class="token plain"> ã€ŠåŸã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">7.</span><span class="token plain"> ã€Šçƒ­é£ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">8.</span><span class="token plain"> ã€Šåç›–é›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">9.</span><span class="token plain"> ã€Šåç›–é›†ç»­ç¼–ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">10.</span><span class="token plain"> ã€Šæ•…äº‹æ–°ç¼–ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">11.</span><span class="token plain"> ã€Šä¸‰é—²é›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">12.</span><span class="token plain"> ã€ŠäºŒå¿ƒé›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">13.</span><span class="token plain"> ã€Šå—è…”åŒ—è°ƒé›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">14.</span><span class="token plain"> ã€Šä¼ªè‡ªç”±ä¹¦ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">15.</span><span class="token plain"> ã€Šå‡†é£æœˆè°ˆã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">16.</span><span class="token plain"> ã€ŠèŠ±è¾¹æ–‡å­¦ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">17.</span><span class="token plain"> ã€Šä¸”ä»‹äº­æ‚æ–‡ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">18.</span><span class="token plain"> ã€Šä¸”ä»‹äº­æ‚æ–‡äºŒé›†ã€‹  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">19.</span><span class="token plain"> ã€Šä¸”ä»‹äº­æ‚æ–‡æœ«ç¼–ã€‹</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">åˆ—å‡º é²è¿… æœ‰åçš„è‘—ä½œï¼Œåªéœ€è¦ä¹¦åæ¸…å•</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>åŠ¨æ€æ›´æ–° Nacos çš„ Prompt é…ç½®ï¼Œå†æ¬¡æŸ¥çœ‹è¯·æ±‚æŸ¥çœ‹æ•ˆæœ</p>
<blockquote>
<p>Tips: å› ä¸º controller ä¸­è®¾ç½®äº† defaultValue ä¸ºé²è¿…ï¼Œå› æ­¤ Prompt å˜æ›´ä»ç„¶å’Œæ–‡å­¦ä½œå®¶ç›¸å…³ã€‚</p>
</blockquote>
<p>å˜æ›´ Prompt ä¸ºï¼š</p>
<div class="language-json codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-json codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"name"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">"author"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"template"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä»‹ç» {author}ï¼Œåˆ—å‡ºå…¶ç”Ÿå¹³ç»å†å’Œæ–‡å­¦æˆå°±"</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property" style="color:hsl(5, 74%, 59%)">"model"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token property" style="color:hsl(5, 74%, 59%)">"key"</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">"ä½™å"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ç‚¹å‡»å‘å¸ƒ</strong>ä¹‹åï¼Œçœ‹åˆ°æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼Œè¯æ˜å˜æ›´æˆåŠŸï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">OnPromptTemplateConfigChange,templateName:author,template:ä»‹ç» {author}ï¼Œåˆ—å‡ºå…¶ç”Ÿå¹³ç»å†å’Œæ–‡å­¦æˆå°±,model:{key=ä½™å</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>å†æ¬¡å‘é€è¯·æ±‚ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">GET http://127.0.0.1:10010/nacos/books</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">é²è¿…ï¼ˆ1881å¹´9æœˆ25æ—¥ï¼1936å¹´10æœˆ19æ—¥ï¼‰ï¼ŒåŸåå‘¨æ ‘äººï¼Œå­—è±«æ‰ï¼Œæµ™æ±Ÿç»å…´äººï¼Œæ˜¯ä¸­å›½ç°ä»£æ–‡å­¦å²ä¸Šæœ€é‡è¦çš„ä½œå®¶ä¹‹ä¸€ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ€æƒ³å®¶ã€é©å‘½å®¶å’Œæ•™è‚²å®¶ã€‚ä»–ä»¥å…¶çŠ€åˆ©çš„ç¬”é”‹å’Œæ·±åˆ»çš„ç¤¾ä¼šæ‰¹åˆ¤ç²¾ç¥ï¼Œæˆä¸ºä¸­å›½æ–°æ–‡åŒ–è¿åŠ¨çš„æ——æ‰‹å’Œå¥ åŸºäººä¹‹ä¸€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">---</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">### **ç”Ÿå¹³ç»å†**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">. **æ—©å¹´ç”Ÿæ´»ä¸æ±‚å­¦**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1881</span><span class="token plain">å¹´å‡ºç”Ÿäºæµ™æ±Ÿç»å…´çš„ä¸€ä¸ªä¹¦é¦™é—¨ç¬¬å®¶åº­ï¼Œçˆ¶äº²å‘¨ä¼¯å®œæ˜¯ç§€æ‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - å°‘å¹´æ—¶å› å®¶åº­å˜æ•…è€Œç»å†äº†ä»å¯Œåˆ°è´«çš„ç”Ÿæ´»å˜åŒ–ï¼Œè¿™å¯¹ä»–åæ¥çš„æ€æƒ³å½¢æˆäº§ç”Ÿäº†æ·±è¿œå½±å“ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1898</span><span class="token plain">å¹´ï¼Œè€ƒå…¥å—äº¬æ°´å¸ˆå­¦å ‚ï¼Œåè½¬å…¥æ±Ÿå—é™†å¸ˆå­¦å ‚é™„è®¾çŸ¿åŠ¡é“è·¯å­¦å ‚å­¦ä¹ ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain">. **ç•™å­¦æ—¥æœ¬**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1902</span><span class="token plain">å¹´èµ´æ—¥æœ¬ç•™å­¦ï¼Œå…ˆåœ¨ä¸œäº¬å¼˜æ–‡å­¦é™¢å­¦ä¹ æ—¥è¯­ï¼Œåè¿›å…¥ä»™å°åŒ»å­¦ä¸“é—¨å­¦æ ¡ï¼ˆä»Šä¸œåŒ—å¤§å­¦åŒ»å­¦éƒ¨ï¼‰å­¦ä¹ åŒ»å­¦ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - åœ¨æ—¥æœ¬æœŸé—´ï¼Œé€æ¸è®¤è¯†åˆ°â€œåŒ»å…¶å¿ƒâ€æ¯”â€œåŒ»å…¶èº«â€æ›´é‡è¦ï¼Œå†³å®šå¼ƒåŒ»ä»æ–‡ï¼Œä»¥æ–‡å­¦å”¤é†’å›½æ°‘çš„ç²¾ç¥ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token plain">. **å›å›½ä¸æ•™ä¹¦ç”Ÿæ¶¯**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1909</span><span class="token plain">å¹´å›å›½åï¼Œå…ˆååœ¨åŒ—äº¬å¤§å­¦ã€åŒ—äº¬å¸ˆèŒƒå¤§å­¦ç­‰é«˜æ ¡ä»»æ•™ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä»äº‹æ–‡å­¦åˆ›ä½œçš„åŒæ—¶ï¼Œç§¯æå‚ä¸æ–°æ–‡åŒ–è¿åŠ¨ï¼Œæ¨åŠ¨ç™½è¯æ–‡å’Œæ–°æ–‡å­¦çš„å‘å±•ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">4</span><span class="token plain">. **åˆ›ä½œé«˜å³°**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1918</span><span class="token plain">å¹´å‘è¡¨ç¬¬ä¸€ç¯‡ç™½è¯å°è¯´ã€Šç‹‚äººæ—¥è®°ã€‹ï¼Œæ ‡å¿—ç€ä¸­å›½ç°ä»£å°è¯´çš„å¼€ç«¯ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - æ­¤åï¼Œé²è¿…çš„åˆ›ä½œè¿›å…¥é«˜å³°æœŸï¼Œå‘è¡¨äº†å¤§é‡æ‚æ–‡ã€å°è¯´ã€æ•£æ–‡ç­‰ä½œå“ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">5</span><span class="token plain">. **æ™šå¹´ç”Ÿæ´»**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1927</span><span class="token plain">å¹´åå®šå±…ä¸Šæµ·ï¼Œç»§ç»­å†™ä½œå¹¶å‚ä¸å·¦ç¿¼æ–‡åŒ–æ´»åŠ¨ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - </span><span class="token number" style="color:hsl(35, 99%, 36%)">1936</span><span class="token plain">å¹´å› è‚ºç—…åœ¨ä¸Šæµ·é€ä¸–ï¼Œäº«å¹´55å²ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">---</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">### **æ–‡å­¦æˆå°±**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">é²è¿…çš„ä½œå“æ¶µç›–äº†å°è¯´ã€æ•£æ–‡ã€æ‚æ–‡ã€è¯—æ­Œç­‰å¤šä¸ªé¢†åŸŸï¼Œå…·æœ‰æé«˜çš„è‰ºæœ¯ä»·å€¼å’Œç¤¾ä¼šæ„ä¹‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#### 1. **å°è¯´**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…çš„å°è¯´ä»¥æ·±åˆ»æ­ç¤ºç¤¾ä¼šé—®é¢˜å’Œäººæ€§å¼±ç‚¹è‘—ç§°ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä»£è¡¨ä½œï¼š</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     - ã€Šå‘å–Šã€‹ï¼šåŒ…æ‹¬ã€Šç‹‚äººæ—¥è®°ã€‹ã€Šé˜¿Qæ­£ä¼ ã€‹ã€Šæ•…ä¹¡ã€‹ç­‰ï¼Œæ­éœ²å°å»ºåˆ¶åº¦å¯¹äººçš„å‹è¿«ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     - ã€Šå½·å¾¨ã€‹ï¼šåŒ…æ‹¬ã€Šç¥ç¦ã€‹ã€Šä¼¤é€ã€‹ç­‰ï¼Œæå†™çŸ¥è¯†åˆ†å­çš„è¿·èŒ«ä¸æŒ£æ‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - è¢«èª‰ä¸ºâ€œä¸­å›½ç°ä»£å°è¯´ä¹‹çˆ¶â€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#### 2. **æ•£æ–‡**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - æ•£æ–‡é›†ã€ŠæœèŠ±å¤•æ‹¾ã€‹æ˜¯é²è¿…å›å¿†ç«¥å¹´å’Œé’å°‘å¹´ç”Ÿæ´»çš„ä½œå“ï¼Œè¯­è¨€ä¼˜ç¾ï¼Œæƒ…æ„ŸçœŸæŒšã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä»£è¡¨ä½œï¼šã€Šä»ç™¾è‰å›­åˆ°ä¸‰å‘³ä¹¦å±‹ã€‹ã€Šè—¤é‡å…ˆç”Ÿã€‹ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#### 3. **æ‚æ–‡**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…çš„æ‚æ–‡ä»¥çŠ€åˆ©çš„ç¬”è§¦æ‰¹åˆ¤ç¤¾ä¼šç°å®ï¼Œè¢«èª‰ä¸ºâ€œåŒ•é¦–ä¸æŠ•æªâ€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - æ‚æ–‡é›†ï¼šã€Šçƒ­é£ã€‹ã€Šåç›–é›†ã€‹ã€ŠåŸã€‹ã€Šä¸”ä»‹äº­æ‚æ–‡ã€‹ç­‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä¸»è¦é’ˆå¯¹å°å»ºç¤¼æ•™ã€å†›é˜€ç»Ÿæ²»ã€æ–‡åŒ–ä¿å®ˆä¸»ä¹‰ç­‰è¿›è¡Œæ‰¹åˆ¤ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#### 4. **ç¿»è¯‘ä¸ç ”ç©¶**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…è¿˜ç¿»è¯‘äº†è®¸å¤šå¤–å›½æ–‡å­¦ä½œå“ï¼Œå¦‚ä¿„å›½æœæˆˆé‡Œçš„ã€Šæ­»é­‚çµã€‹ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - åŒæ—¶è‡´åŠ›äºä¸­å›½å¤ä»£æ–‡åŒ–çš„æ•´ç†ä¸ç ”ç©¶ï¼Œå‡ºç‰ˆäº†ã€Šä¸­å›½å°è¯´å²ç•¥ã€‹ã€Šæ±‰æ–‡å­¦å²çº²è¦ã€‹ç­‰å­¦æœ¯è‘—ä½œã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">---</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">### **å†å²åœ°ä½ä¸å½±å“**</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">. **å¯¹ä¸­å›½æ–‡å­¦çš„è´¡çŒ®**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…å¼€åˆ›äº†ä¸­å›½ç°ä»£æ–‡å­¦çš„æ–°å±€é¢ï¼Œä»–çš„ä½œå“å¥ å®šäº†ä¸­å›½ç°ä»£æ–‡å­¦çš„åŸºç¡€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - æå€¡ç™½è¯æ–‡ï¼Œæ¨åŠ¨æ–‡å­¦è¯­è¨€çš„ç°ä»£åŒ–ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain">. **å¯¹ç¤¾ä¼šæ€æƒ³çš„å½±å“**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…çš„æ€æƒ³æ·±åˆ»å½±å“äº†å‡ ä»£ä¸­å›½äººï¼Œç‰¹åˆ«æ˜¯åœ¨åå¯¹å°å»ºç¤¼æ•™ã€å€¡å¯¼æ€æƒ³è§£æ”¾æ–¹é¢ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - ä»–çš„æ‚æ–‡æˆä¸ºæ‰¹è¯„ç¤¾ä¼šä¸å…¬å’Œæ­éœ²é»‘æš—çš„å…¸èŒƒã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token plain">. **å›½é™…å£°èª‰**  </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - é²è¿…çš„ä½œå“è¢«ç¿»è¯‘æˆå¤šç§è¯­è¨€ï¼Œåœ¨ä¸–ç•ŒèŒƒå›´å†…äº«æœ‰ç››èª‰ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   - è¢«èª‰ä¸ºâ€œä¸­å›½çš„è‰¯å¿ƒâ€å’Œâ€œæ°‘æ—é­‚â€ã€‚</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">é²è¿…çš„ä¸€ç”Ÿï¼Œæ—¢æ˜¯å¯¹ä¼ ç»Ÿæ–‡åŒ–çš„åæ€ï¼Œä¹Ÿæ˜¯å¯¹ç°ä»£ç¤¾ä¼šçš„æ¢ç´¢ã€‚ä»–çš„ä½œå“è‡³ä»Šä»å…·æœ‰å¼ºå¤§çš„ç”Ÿå‘½åŠ›å’Œç°å®æ„ä¹‰ã€‚</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æœ€ç»ˆæ„å»ºçš„ Prompt ä¸ºï¼š</p>
<div class="language-text codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ä»‹ç» é²è¿…ï¼Œåˆ—å‡ºå…¶ç”Ÿå¹³ç»å†å’Œæ–‡å­¦æˆå°±</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>Spring AI Alibaba</category>
            <category>Nacos</category>
            <category>Dunamic Prompt</category>
        </item>
        <item>
            <title><![CDATA[Opentelemetry é¡¹ç›®è§£è¯»]]></title>
            <link>https://yuluo-yx.github.io/blog/opentelemetry-project</link>
            <guid>https://yuluo-yx.github.io/blog/opentelemetry-project</guid>
            <pubDate>Sat, 19 Apr 2025 17:44:00 GMT</pubDate>
            <description><![CDATA[1. ä»€ä¹ˆæ˜¯ Opentelmetry]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="1-ä»€ä¹ˆæ˜¯-opentelmetry">1. ä»€ä¹ˆæ˜¯ Opentelmetry<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#1-%E4%BB%80%E4%B9%88%E6%98%AF-opentelmetry" class="hash-link" aria-label="1. ä»€ä¹ˆæ˜¯ Opentelmetryçš„ç›´æ¥é“¾æ¥" title="1. ä»€ä¹ˆæ˜¯ Opentelmetryçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Ot ç»Ÿä¸€äº†å¯è§‚æµ‹çš„ä¸‰ä¸ªé‡è¦ç»´åº¦ï¼šåˆ†åˆ«æ˜¯ Traceï¼ŒLogï¼ŒMetricsã€‚</p>
<p>åœ¨æ²¡æœ‰ ot ä¹‹å‰ï¼Œä¸åŒç»´åº¦çš„å¯è§‚æµ‹ç»„ä»¶éƒ½æ˜¯ä¸åŒçš„ï¼š</p>
<ol>
<li>åœ¨ Trace é¢†åŸŸï¼šskywalking ä¸€ç›´å¾ˆå—æ¬¢è¿ï¼›</li>
<li>åœ¨ Metrics é¢†åŸŸï¼šä¸»è¦ä»¥ Prometheus ä¸ºä¸»ï¼ŒVictoriaMetric ä¹Ÿå¾ˆå—æ¬¢è¿ï¼Œå ç”¨èµ„æºæ›´å°‘ï¼›</li>
<li>åœ¨ Log é¢†åŸŸï¼šELK ç»ä¹…ä¸è¡°ã€‚</li>
</ol>
<p>ä¸è¿‡ä¸ºäº†è§£å†³å¯è§‚æµ‹è¿™ä¸€é—®é¢˜ï¼ŒåŒæ—¶å¼•å…¥ä¸‰ä¸ªç»„ä»¶ï¼Œå¯¼è‡´æŠ€æœ¯æ ˆä¼—å¤šï¼Œç»´æŠ¤éº»çƒ¦ã€‚ot ä¾¿æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè®©å¼€å‘è€…èƒ½èŠ±è´¹å°‘é‡ç²¾åŠ›å®Œæˆå¯è§‚æµ‹å»ºè®¾ã€‚</p>
<p>ç”±  OpenTracingï¼ŒOpenCensus åˆå¹¶å…±åŒå‘å±•è€Œæ¥ã€‚ç°åœ¨å·²ç»æ˜¯ CNCF çš„é¡¶çº§é¡¹ç›®äº†ï¼Œå¹¶ä¸”å—åˆ°äº†å¾ˆå¤šå¤§å‚çš„æ”¯æŒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="11-opentelmetry-æ¶æ„">1.1 OpenTelmetry æ¶æ„<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#11-opentelmetry-%E6%9E%B6%E6%9E%84" class="hash-link" aria-label="1.1 OpenTelmetry æ¶æ„çš„ç›´æ¥é“¾æ¥" title="1.1 OpenTelmetry æ¶æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><img decoding="async" loading="lazy" alt="ot æ¶æ„" src="https://yuluo-yx.github.io/assets/images/ot-1-9ecb5fc7630c2aa60d7aac6b90d569be.png" width="1400" height="670" class="img_c29J"></p>
<p>ä»ä¸Šå›¾ä¸­çœ‹åˆ°ï¼Œæ•´ä¸ª Oentelmetry ç³»ç»Ÿå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªç»„æˆéƒ¨åˆ†ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="111-å®¢æˆ·ç«¯">1.1.1 å®¢æˆ·ç«¯<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#111-%E5%AE%A2%E6%88%B7%E7%AB%AF" class="hash-link" aria-label="1.1.1 å®¢æˆ·ç«¯çš„ç›´æ¥é“¾æ¥" title="1.1.1 å®¢æˆ·ç«¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å®¢æˆ·ç«¯å°±æ˜¯æˆ‘ä»¬ç¼–å†™å¾—ä¸šåŠ¡ç³»ç»Ÿçš„æœåŠ¡ï¼Œç”¨ Go æˆ–è€… Java ç¼–å†™ã€‚å¦‚æœæ˜¯ Java åº”ç”¨ï¼Œåœ¨ ot ä¸­ï¼Œåªéœ€è¦æŒ‚è½½ä¸€ä¸ª agent å°±å¯ä»¥é‡‡é›†åˆ°ç³»ç»Ÿçš„æŒ‡æ ‡ï¼Œé“¾è·¯å’Œæ—¥å¿—æ•°æ®ä¸Šä¼ åˆ° Collector ä¸­ã€‚æ—¢æ¶æ„å›¾ä¸­çš„å·¦è¾¹éƒ¨åˆ†ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="112-otel-collector">1.1.2 Otel Collector<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#112-otel-collector" class="hash-link" aria-label="1.1.2 Otel Collectorçš„ç›´æ¥é“¾æ¥" title="1.1.2 Otel Collectorçš„ç›´æ¥é“¾æ¥">â€‹</a></h4>
<p><img decoding="async" loading="lazy" alt="ot collector" src="https://yuluo-yx.github.io/assets/images/ot-2-eabbe2f740abac90c5c8e9dc18df0b14.png" width="984" height="698" class="img_c29J"></p>
<p>ot åœ¨è®¾è®¡æœ€åˆçš„ç›®çš„æ˜¯è¦åšåˆ°å‚å•†æ— å…³æ€§ï¼Œä¸å’Œä»»æ„ä¸€ä¸ªå‚å•†æˆ–è€…äº§å“ç»‘å®šã€‚å› æ­¤åœ¨ collector åšäº†æ›´é«˜å±‚çš„æŠ½è±¡è®¾è®¡ã€‚</p>
<p>å¦‚å›¾ä¸­çš„æ•°æ®æ¥å—å’Œå¯¼å‡ºç»„ä»¶ï¼ŒReceiverå’Œ Exporterã€‚éƒ½é‡‡ç”¨å¯æ’æ‹”çš„è®¾è®¡æ–¹å¼ã€‚ç¬¬ä¸‰æ–¹çš„å¼€å‘è€…å¯ä»¥åŸºäº ot çš„æ ‡å‡†åè®®å¼€å‘ä¸åŒçš„ Receiverå’Œ Exporter ç»„ä»¶æ¥å…¼å®¹ä¸åŒçš„äº§å“ï¼Œä»è€Œåšåˆ°å‚å•†æ— å…³æ€§ã€‚</p>
<p>Receiverï¼šç”¨äºæ¥å—å®¢æˆ·ç«¯ä¸ŠæŠ¥çš„æ•°æ®ï¼Œä¸æ­¢æ˜¯æ¥è‡ª agent çš„æ•°æ®ï¼Œä¹Ÿæœ‰å¯èƒ½æ¥è‡ªä¸åŒçš„æœåŠ¡äº§å“ã€‚ä¾‹å¦‚ k8sï¼Œkafka ç­‰ã€‚</p>
<p>Exporterï¼šåœ¨æ¥æ”¶åˆ° Receiverçš„æ•°æ®ï¼Œç”± collector å¤„ç†ä¹‹åå¯ä»¥å°†å…¶è¾“å‡ºåˆ°ä¸åŒçš„ç»„ä»¶ä¸­ï¼Œæ¯”å¦‚ï¼šKafkaï¼ŒJaeger ç­‰ã€‚</p>
<p>åœ¨ä½¿ç”¨ ot æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Nginx Receiveræ¥å—æ¥è‡ª nginx çš„æ•°æ®ï¼Œä½¿ç”¨ MySQL Receiveræ¥å—æ¥è‡ª MySQL çš„æ•°æ®ç­‰ã€‚é€šå¸¸ä½¿ç”¨æœ€å¤šçš„æ˜¯ otel Receiverï¼Œot å®˜æ–¹çš„ OTLP åè®®çš„æ•°æ®æ¥æ”¶å™¨ï¼Œæ¥å—æ¥è‡ª ot çš„ä¸€äº›æŒ‡æ ‡ã€‚ä¾‹å¦‚åªä½¿ç”¨äº† Java agent ä¸ŠæŠ¥å¯è§‚æµ‹æ•°æ®æ—¶ã€‚</p>
<p>Exporter ä¸»è¦è´Ÿè´£å°†ä¸åŒçš„æŒ‡æ ‡æ•°æ®å†™å…¥åˆ°ä¸åŒçš„ç»„ä»¶ä¸­ï¼Œä¾‹å¦‚å°†æŒ‡æ ‡ç›¸å…³æ•°æ®å†™å…¥åˆ° Prometheusï¼Œæ—¥å¿—å†™å…¥åˆ° es ç­‰ã€‚</p>
<p>å¯¹æ¯”ä¹‹ä¸‹ï¼Œot collector çš„ Receiver å’Œ Exporter å¯ä»¥éå¸¸çµæ´»çš„æ­é…ï¼Œæ•°æ®å­˜å‚¨çš„å˜æ›´ï¼Œä¸ä¼šç›´æ¥å½±å“åˆ°ä¸šåŠ¡ç³»ç»Ÿã€‚ä¸šåŠ¡ç³»ç»Ÿåªéœ€è¦æŒ‰ç…§ OTLP åè®®çš„æ ¼å¼ä¸ŠæŠ¥æ•°æ®å³å¯ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="2-opentelmetry-é¡¹ç›®">2. Opentelmetry é¡¹ç›®<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#2-opentelmetry-%E9%A1%B9%E7%9B%AE" class="hash-link" aria-label="2. Opentelmetry é¡¹ç›®çš„ç›´æ¥é“¾æ¥" title="2. Opentelmetry é¡¹ç›®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ä»ä¸Šé¢çš„æ¶æ„å›¾äº†è§£åˆ°ï¼šot çš„æ•´ä¸ªé¡¹ç›®ä¸»è¦åˆ†ä¸ºå®¢æˆ·ç«¯å’Œ collector ç«¯ã€‚é™¤äº† java ä¹‹å¤–ï¼Œot è¿˜æ”¯æŒå…¶ä»–è¯­è¨€çš„å®¢æˆ·ç«¯ã€‚å¤§éƒ¨åˆ†éƒ½è¾¾åˆ°äº†ç”Ÿäº§å¯ç”¨çš„ç¨‹åº¦ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæ·±å…¥äº†è§£ä¸‹ opentelemetry-java å’Œ opentelemetry-java-instrumentationã€‚</p>
<p>åœ¨æ—¥å¸¸ä½¿ç”¨ä¸­ï¼Œç”¨åˆ°æœ€å¤šçš„é¡¹ç›®æ˜¯ï¼šopentelemetry-java-instrumentationã€‚æä¾›äº† ot çš„ java agent ã€‚</p>
<p>åœ¨å¯åŠ¨é¡¹ç›®æ—¶ï¼Œåªéœ€è¦åŠ ä¸Š java agent å°±å¯ä»¥è‡ªåŠ¨å®ç°å¯è§‚æµ‹æ•°æ®çš„ä¸ŠæŠ¥ï¼š</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">java</span><span class="token plain"> -javaagent:path/to/opentelemetry-javaagent.jar </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-jar</span><span class="token plain"> myapp.jar</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="21-opentelemetry-java">2.1 opentelemetry-java<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#21-opentelemetry-java" class="hash-link" aria-label="2.1 opentelemetry-javaçš„ç›´æ¥é“¾æ¥" title="2.1 opentelemetry-javaçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>opentelemetry-java-instrumentation åŸºäº opentelemetry-java åˆ›å»ºã€‚æ˜¯ ot Java ç‰ˆæœ¬çš„æ ¸å¿ƒåŸºç¡€åº“ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="22-opentelemetry-java-instrumentation">2.2 opentelemetry-java-instrumentation<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#22-opentelemetry-java-instrumentation" class="hash-link" aria-label="2.2 opentelemetry-java-instrumentationçš„ç›´æ¥é“¾æ¥" title="2.2 opentelemetry-java-instrumentationçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>é›†æˆäº†å¸¸ç”¨çš„ Java çš„ä¸åŒæ¡†æ¶ï¼Œåº“çš„å¯è§‚æµ‹æ•°æ®ã€‚</p>
<p>å…¶ä»–é¡¹ç›®å¤§è‡´ç»“æ„ç±»ä¼¼ã€‚ä¾‹å¦‚ collector åˆ†ä¸ºï¼š<strong>OpenTelemetry Collector</strong> å’Œ <strong>OpenTelemetry Collector Contrib</strong></p>
<p>opentelemetry-collectorï¼šç”± ot å®˜æ–¹ç»´æŠ¤ï¼Œæä¾›æœ€åŸºç¡€çš„æ ¸å¿ƒèƒ½åŠ›ï¼›æ¯”å¦‚åªåŒ…å«äº†æœ€åŸºæœ¬çš„ otlp çš„ receiver å’Œ exporterã€‚</p>
<p>opentelemetry-collector-contribï¼šåŒ…å«äº†å®˜æ–¹çš„ collectorï¼ŒåŒæ—¶ç»´æŠ¤äº†ç¤¾åŒºæä¾›çš„å„ç§ receiver å’Œ exporterï¼›å°±å¦‚ä¸Šæ–‡æåˆ°çš„ï¼Œä¸€äº›ç¤¾åŒºç»„ä»¶ï¼ˆpulsarã€MySQLã€Kafkaï¼‰ç­‰éƒ½ç»´æŠ¤åœ¨è¿™ä¸ªä»“åº“ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="3-æ€»ç»“">3. æ€»ç»“<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#3-%E6%80%BB%E7%BB%93" class="hash-link" aria-label="3. æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="3. æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>OpenTelemetry æƒ³è¦è§£å†³çš„æ˜¯æ•´ä¸ªå¯è§‚æµ‹é¢†åŸŸçš„æ‰€æœ‰éœ€æ±‚ï¼Œåšåˆ°çœŸæ­£çš„å‚å•†æ— å…³æ€§ï¼Œå› æ­¤è‡ªèº«æœ‰éå¸¸å¤šçš„ Receiver å’Œ Exporterã€‚</p>
<p>ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œå°†ä¼šä»‹ç»å¦‚ä½•åœ¨ opentelemetry-java-instrumentation ä»“åº“ä¸­ä¸º Java åº“å’Œæ¡†æ¶æä¾›å¯è§‚æµ‹æ”¯æŒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_vMh4" id="31-å‚è€ƒé“¾æ¥">3.1 å‚è€ƒé“¾æ¥ï¼š<a href="https://yuluo-yx.github.io/blog/opentelemetry-project#31-%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5" class="hash-link" aria-label="3.1 å‚è€ƒé“¾æ¥ï¼šçš„ç›´æ¥é“¾æ¥" title="3.1 å‚è€ƒé“¾æ¥ï¼šçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><a href="https://juejin.cn/post/7358450927110357026?from=search-suggest" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7358450927110357026?from=search-suggest</a></p>
<p><a href="https://opentelemetry.io/ecosystem/registry/" target="_blank" rel="noopener noreferrer">https://opentelemetry.io/ecosystem/registry/</a></p>
<p><a href="https://github.com/open-telemetry/opentelemetry-java-instrumentation" target="_blank" rel="noopener noreferrer">open-telemetry/opentelemetry-java-instrumentation: OpenTelemetry auto-instrumentation and instrumentation libraries for Java</a></p>
<p><a href="https://github.com/open-telemetry/opentelemetry-java-instrumentation/blob/main/docs/supported-libraries.md#libraries--frameworks" target="_blank" rel="noopener noreferrer">https://github.com/open-telemetry/opentelemetry-java-instrumentation/blob/main/docs/supported-libraries.md#libraries--frameworks</a></p>]]></content:encoded>
            <author>yuluo08290126@gmail.com (ç‰§ç”Ÿ)</author>
            <category>Opentelemetry-java-instrumentation</category>
            <category>OT</category>
            <category>Java</category>
            <category>OTEL</category>
        </item>
    </channel>
</rss>