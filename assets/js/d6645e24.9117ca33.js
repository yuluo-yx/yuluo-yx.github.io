"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[7075],{19037:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var o=t(48576),r=t(25105),s=t(89999);const i={slug:"spring-boot-web-app-request-debug",title:"Spring Boot Web \u5e94\u7528\u8bf7\u6c42\u6545\u969c\u6392\u67e5",date:new Date("2024-08-01T16:09:46.000Z"),authors:"yuluo",tags:["Spring Boot"],keywords:["Spring Boot","Bugs","Debug"]},a=void 0,l={authorsImageUrls:[void 0]},c=[{value:"\u573a\u666f\u590d\u73b0",id:"\u573a\u666f\u590d\u73b0",level:2},{value:"\u6d4b\u8bd5",id:"\u6d4b\u8bd5",level:2},{value:"\u6392\u67e5",id:"\u6392\u67e5",level:2},{value:"\u89e3\u51b3\u65b9\u6848",id:"\u89e3\u51b3\u65b9\u6848",level:2}];function p(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"\u7ebf\u4e0a\u63a5\u53e3\u54cd\u5e94\u592a\u6162\uff0cSpring Boot + \u5185\u5d4c\u7684 Tomcat \u670d\u52a1\u5668\uff0cTomcat \u5904\u7406\u8bf7\u6c42\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u666e\u901a\u60c5\u51b5\u662f 150 \u5de6\u53f3\uff0c\u6700\u5927\u662f 200\uff0c\u6240\u4ee5\u5f53\u540c\u65f6\u5904\u7406\u7684\u8bf7\u6c42\u8fc7\u591a\uff0c\u5e76\u4e14\u6bcf\u4e2a\u8bf7\u6c42\u4e00\u76f4\u6ca1\u6709\u5904\u7406\u5b8c\u6210\u3002\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u5728\u7e41\u5fd9\uff0c\u6ca1\u6709\u529e\u6cd5\u5904\u7406\u65b0\u7684\u8bf7\u6c42\uff0c\u5c31\u4f1a\u5bfc\u81f4\u65b0\u7684\u8bf7\u6c42\u6392\u961f\u7b49\u5f85\u5904\u7406\uff0c\u4ece\u800c\u9020\u6210\u4e86\u8fdf\u8fdf\u65e0\u6cd5\u54cd\u5e94\u7684\u7ebf\u4e0a\u4e8b\u6545\uff0c\u7528\u6237\u4f53\u9a8c\u592a\u5dee\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u573a\u666f\u590d\u73b0",children:"\u573a\u666f\u590d\u73b0"}),"\n",(0,r.jsx)(n.p,{children:"\u4e00\u4e2a\u7b80\u5355\u7684 controller \u63a5\u53e3"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@RestController\npublic class SpringBootController {\n\n @GetMapping("/")\n public String index() throws InterruptedException {\n\n  // \u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u7761\u7720\uff0c\u6a21\u62df\u4e1a\u52a1\u63a5\u53e3\u54cd\u5e94\u6162\u7684\u95ee\u9898\n  Thread.sleep(60 * 30 * 1000);\n  System.out.println("current thread: " + Thread.currentThread().getName());\n\n  return "Hello Spring Boot!";\n }\n\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u968f\u540e\u8bbe\u7f6e tomcat \u670d\u52a1\u5668\u7684\u6700\u5927\u7ebf\u7a0b\u4e3a 5 \uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:"server:\n  port: 8080\n  tomcat:\n    threads:\n      max: 5\n\nspring:\n  application:\n    name: simple-application\n    \n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6d4b\u8bd5",children:"\u6d4b\u8bd5"}),"\n",(0,r.jsx)(n.p,{children:"\u4e4b\u540e\u6211\u4eec\u5728\u5355\u5143\u6d4b\u8bd5\u4e2d\u6a21\u62df 10 \u4e2a\u7ebf\u7a0b\u5bf9\u63a5\u53e3\u53d1\u8d77\u8bf7\u6c42"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public class RequestTest {\n\n public static void main(String[] args) {\n  \n  for (int i = 0; i < 10; i++) {\n   new Thread(new RequestTask()).start();\n  }\n }\n\n private static class RequestTask implements Runnable {\n  @Override\n  public void run() {\n   try {\n    URL url = new URL("http://localhost:8080/");\n    HttpURLConnection connection = (HttpURLConnection) url.openConnection();\n    connection.setRequestMethod("GET");\n    int responseCode = connection.getResponseCode();\n    System.out.println("Response Code: " + responseCode);\n   }\n   catch (IOException e) {\n    e.printStackTrace();\n   }\n  }\n }\n \n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u9996\u5148\uff0c\u6211\u4eec\u6ce8\u91ca\u6389 controller \u4e2d\u7684\u7761\u7720\u4ee3\u7801\uff0c\u8fd0\u884c\u6d4b\u8bd5\u5f97\u5230\u4ee5\u4e0b\u7684\u8f93\u51fa\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"spring boot web \u5e94\u7528\u54cd\u5e94\u8f93\u51fa\uff1a\n2024-08-01T15:56:25.369+08:00  INFO 7304 --- [simple-application] [nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms\ncurrent thread: http-nio-8080-exec-4\ncurrent thread: http-nio-8080-exec-5\ncurrent thread: http-nio-8080-exec-1\ncurrent thread: http-nio-8080-exec-2\ncurrent thread: http-nio-8080-exec-3\ncurrent thread: http-nio-8080-exec-5\ncurrent thread: http-nio-8080-exec-2\ncurrent thread: http-nio-8080-exec-4\ncurrent thread: http-nio-8080-exec-1\ncurrent thread: http-nio-8080-exec-3\n    \n\u6d4b\u8bd5\u8f93\u51fa\uff1a\nResponse Code: 200\nResponse Code: 200\nResponse Code: 200\nResponse Code: 200\nResponse Code: 200\nResponse Code: 200\nResponse Code: 200\nResponse Code: 200\nResponse Code: 200\nResponse Code: 200\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6211\u4eec\u770b\u5230\u7ebf\u7a0b\u5728\u54cd\u5e94\u8f93\u51fa\u3002\u63a5\u4e0b\u6765\uff0c\u6253\u5f00\u6ce8\u91ca\u4ee3\u7801\uff0c\u6a21\u62df\u4e8b\u6545\u73b0\u573a\u3002\u5c06\u4f1a\u5728\u63a7\u5236\u53f0\u770b\u4e0d\u5230\u4efb\u4f55\u8f93\u51fa\uff0c\u6d4b\u8bd5\u65b9\u6cd5\u4e5f\u4f1a\u5361\u4f4f\u4e0d\u52a8\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u6392\u67e5",children:"\u6392\u67e5"}),"\n",(0,r.jsx)(n.p,{children:"\u6211\u4eec\u4f7f\u7528 JVM \u7684\u4e00\u4e9b\u547d\u4ee4\u6765\u8fdb\u884c\u6392\u67e5\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# \u9996\u5148\u67e5\u770b java \u7684\u8fdb\u7a0b id\nC:\\Users\\Administrator>jps -l\n18400 indi.yuluo.tomcat.SpringBootApplication\n10324 jdk.jcmd/sun.tools.jps.Jps\n16872 org.jetbrains.jps.cmdline.Launcher\n18072 org.jetbrains.idea.maven.server.RemoteMavenServer36\n9624\n7372 inid.yuluo.tomcat.RequestTest\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6211\u4eec\u770b\u5230 SpringBootApplication \u548c RequestTest \u5728\u8fd0\u884c\uff0c\u4e4b\u540e\u4f7f\u7528 jstack \u547d\u4ee4\u751f\u6210\u7ebf\u7a0b\u5feb\u7167\uff0c\u5e76\u4fdd\u5b58\u4e3a\u6587\u4ef6\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"C:\\Users\\Administrator>jstack 18400 > C:\\Users\\Administrator\\Desktop\\spring-boot-thread_dump.txt\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6253\u5f00\u7ebf\u7a0b\u5feb\u7167\u6587\u4ef6\uff0c\u641c\u7d22 ",(0,r.jsx)(n.code,{children:"http-nio"})," \u5c31\u80fd\u770b\u5230 Tomcat \u7684\u8bf7\u6c42\u5904\u7406\u7ebf\u7a0b\uff0c\u6240\u6709\u7684\u8bf7\u6c42\u5904\u7406\u7ebf\u7a0b\u72b6\u6001\u90fd\u662f ",(0,r.jsx)(n.code,{children:"TIMED_WAITING"})," \uff0c\u8868\u793a\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u7279\u5b9a\u7684\u52a8\u4f5c\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u6307\u5b9a\u7684\u7b49\u5f85\u65f6\u95f4\u3002\u800c\u4e14\u80fd\u76f4\u63a5\u770b\u5230\u8bf7\u6c42\u662f\u963b\u585e\u5728\u4e86\u54ea\u4e2a\u4ee3\u7801\u4f4d\u7f6e\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'"http-nio-8080-exec-2" #28 daemon prio=5 os_prio=0 cpu=0.00ms elapsed=187.14s tid=0x0000015ffe6089f0 nid=0x1ee4 waiting on condition  [0x00000026eb5fc000]\n      # `TIMED_WAITING`\n   java.lang.Thread.State: TIMED_WAITING (sleeping)\n at java.lang.Thread.sleep(java.base@17.0.1/Native Method)\n # \u963b\u585e\u4f4d\u7f6e\uff1a\n at indi.yuluo.tomcat.controller.SpringBootController.index(SpringBootController.java:18)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u89e3\u51b3\u65b9\u6848",children:"\u89e3\u51b3\u65b9\u6848"}),"\n",(0,r.jsx)(n.p,{children:"\u9002\u5f53\u4fee\u6539 Tomcat \u7684\u6700\u5927\u7ebf\u7a0b\u6570\uff0c\u53ef\u4ee5\u589e\u52a0\u5e76\u53d1\u8bf7\u6c42\u7684\u5904\u7406\u80fd\u529b\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u9002\u5f53\u8c03\u5927 Tomcat \u7684\u6700\u5c0f\u7a7a\u95f2\u7ebf\u7a0b\u6570\uff0c\u53ef\u4ee5\u786e\u4fdd\u5728\u5e76\u53d1\u9ad8\u5cf0\u65f6\u523b\uff0cTomcat \u80fd\u8fc5\u901f\u54cd\u5e94\u65b0\u7684\u8bf7\u6c42\uff0c\u800c\u4e0d\u9700\u8981\u91cd\u65b0\u521b\u5efa\u7ebf\u7a0b\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u4fee\u6539\u503c\u9700\u8981\u5bf9\u7528\u6237\u4f53\u91cf\u505a\u51fa\u9884\u4f30\u4e4b\u540e\uff0c\u8fdb\u884c\u6d4b\u8bd5\u4e4b\u540e\u786e\u5b9a\u3002"})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},89999:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var o=t(58101);const r={},s=o.createContext(r);function i(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:n},e.children)}},48576:e=>{e.exports=JSON.parse('{"permalink":"/blog/spring-boot-web-app-request-debug","editUrl":"https://github.com/yuluo-yx/blog/edit/master/blog/Bug-summary/Spring-Boot-Web-\u5e94\u7528\u8bf7\u6c42\u6545\u969c\u6392\u67e5.md","source":"@site/blog/Bug-summary/Spring-Boot-Web-\u5e94\u7528\u8bf7\u6c42\u6545\u969c\u6392\u67e5.md","title":"Spring Boot Web \u5e94\u7528\u8bf7\u6c42\u6545\u969c\u6392\u67e5","description":"\u7ebf\u4e0a\u63a5\u53e3\u54cd\u5e94\u592a\u6162\uff0cSpring Boot + \u5185\u5d4c\u7684 Tomcat \u670d\u52a1\u5668\uff0cTomcat \u5904\u7406\u8bf7\u6c42\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u666e\u901a\u60c5\u51b5\u662f 150 \u5de6\u53f3\uff0c\u6700\u5927\u662f 200\uff0c\u6240\u4ee5\u5f53\u540c\u65f6\u5904\u7406\u7684\u8bf7\u6c42\u8fc7\u591a\uff0c\u5e76\u4e14\u6bcf\u4e2a\u8bf7\u6c42\u4e00\u76f4\u6ca1\u6709\u5904\u7406\u5b8c\u6210\u3002\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u5728\u7e41\u5fd9\uff0c\u6ca1\u6709\u529e\u6cd5\u5904\u7406\u65b0\u7684\u8bf7\u6c42\uff0c\u5c31\u4f1a\u5bfc\u81f4\u65b0\u7684\u8bf7\u6c42\u6392\u961f\u7b49\u5f85\u5904\u7406\uff0c\u4ece\u800c\u9020\u6210\u4e86\u8fdf\u8fdf\u65e0\u6cd5\u54cd\u5e94\u7684\u7ebf\u4e0a\u4e8b\u6545\uff0c\u7528\u6237\u4f53\u9a8c\u592a\u5dee\u3002","date":"2024-08-01T16:09:46.000Z","tags":[{"inline":true,"label":"Spring Boot","permalink":"/blog/tags/spring-boot"}],"readingTime":2.5633333333333335,"hasTruncateMarker":true,"authors":[{"name":"\u7267\u751f","title":"Java & go developer","url":"https://github.com/yuluo-yx","email":"yuluo08290126@gmail.com","socials":{"x":"https://x.com/yuluo","github":"https://github.com/yuluo-yx"},"imageURL":"https://kuizuo.cn/img/logo.png","key":"yuluo","page":null}],"frontMatter":{"slug":"spring-boot-web-app-request-debug","title":"Spring Boot Web \u5e94\u7528\u8bf7\u6c42\u6545\u969c\u6392\u67e5","date":"2024-08-01T16:09:46.000Z","authors":"yuluo","tags":["Spring Boot"],"keywords":["Spring Boot","Bugs","Debug"]},"unlisted":false,"prevItem":{"title":"\u7531\u5355\u5143\u6d4b\u8bd5\u53d1\u73b0\u7684\u4ee3\u7801 Bug","permalink":"/blog/case-by-unit-test"},"nextItem":{"title":"CocA 2024","permalink":"/blog/coca-2024"}}')}}]);